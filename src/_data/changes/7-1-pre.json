[
  {
    "message": "*   Disables the session in `ActiveStorage::Blobs::ProxyController`\n    and `ActiveStorage::Representations::ProxyController`\n    in order to allow caching by default in some CDNs as CloudFlare\n\n    Fixes #44136\n\n    *Bruno Prieto*",
    "project": "activestorage",
    "date_merged": 1691092834000,
    "author": "Bruno Prieto",
    "sha": "8a88ce194319b951237104c0235e70d655db8ccd",
    "pr": "48869",
    "merge_sha": "83e59883e990704fd57572708b7d61f776113345",
    "html": "<p>Disables the session in <code>ActiveStorage::Blobs::ProxyController</code><br />\nand <code>ActiveStorage::Representations::ProxyController</code><br />\nin order to allow caching by default in some CDNs as CloudFlare</p>\n\n<p>Fixes #44136</p>\n\n<p><em>Bruno Prieto</em></p>\n"
  },
  {
    "message": "*   Add `tags` to `ActiveStorage::Analyzer::AudioAnalyzer` output\n\n    *Keaton Roux*",
    "project": "activestorage",
    "date_merged": 1690504708000,
    "author": "Keaton Roux",
    "sha": "dc4eb0f3b553874dff371c1a3c3ecc8998e7a13c",
    "pr": "48823",
    "merge_sha": "814f8ee068814e3d4832a607f49f155e02a609c0",
    "html": "<p>Add <code>tags</code> to <code>ActiveStorage::Analyzer::AudioAnalyzer</code> output</p>\n\n<p><em>Keaton Roux</em></p>\n"
  },
  {
    "message": "*   Add an option to preprocess variants\n\n    ActiveStorage variants are processed on the fly when they are needed but\n    sometimes we're sure that they are accessed and want to processed them\n    upfront.\n\n    `preprocessed` option is added when declaring variants.\n\n    ```\n    class User < ApplicationRecord\n      has_one_attached :avatar do |attachable|\n        attachable.variant :thumb, resize_to_limit: [100, 100], preprocessed: true\n      end\n    end\n    ```\n\n    *Shouichi Kamiya*",
    "project": "activestorage",
    "date_merged": 1688390703000,
    "author": "Shouichi Kamiya",
    "sha": "b1c544b1d109e6e9861c58c36d43f8763edf0cab",
    "pr": "47473",
    "merge_sha": "c388a4dcf580281aef4e341f87c52956b0b0057a",
    "html": "<p>Add an option to preprocess variants</p>\n\n<p>ActiveStorage variants are processed on the fly when they are needed but<br />\nsometimes we’re sure that they are accessed and want to processed them<br />\nupfront.</p>\n\n<p><code>preprocessed</code> option is added when declaring variants.</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  has_one_attached :avatar do |attachable|\n    attachable.variant :thumb, resize_to_limit: [100, 100], preprocessed: true\n  end\nend\n</code></pre>\n\n<p><em>Shouichi Kamiya</em></p>\n"
  },
  {
    "message": "*   Fix variants not included when eager loading multiple records containing a single attachment\n\n    When using the `with_attached_#{name}` scope for a `has_one_attached` relation,\n    attachment variants were not eagerly loaded.\n\n    *Russell Porter*",
    "project": "activestorage",
    "date_merged": 1688066886000,
    "author": "Russell Porter",
    "sha": "19e0dd97733106d5315639a5c0bc0348ffbcffde",
    "pr": "47370",
    "merge_sha": "b180e2c522c372f5d028d6a5113e69ff416128ab",
    "html": "<p>Fix variants not included when eager loading multiple records containing a single attachment</p>\n\n<p>When using the <code>with_attached_#{name}</code> scope for a <code>has_one_attached</code> relation,<br />\nattachment variants were not eagerly loaded.</p>\n\n<p><em>Russell Porter</em></p>\n"
  },
  {
    "message": "*   Allow an ActiveStorage attachment to be removed via a form post\n\n    Attachments can already be removed by updating the attachment to be nil such as:\n    ```ruby\n    User.find(params[:id]).update!(avatar: nil)\n    ```\n\n    However, a form cannot post a nil param, it can only post an empty string. But, posting an\n    empty string would result in an `ActiveSupport::MessageVerifier::InvalidSignature: mismatched digest`\n    error being raised, because it's being treated as a signed blob id.\n\n    Now, nil and an empty string are treated as a delete, which allows attachments to be removed via:\n    ```ruby\n    User.find(params[:id]).update!(params.require(:user).permit(:avatar))\n\n    ```\n\n    *Nate Matykiewicz*",
    "project": "activestorage",
    "date_merged": 1685661422000,
    "author": "Nate Matykiewicz",
    "sha": "dd894b2fc261594fde3d39028066d86b91e22070",
    "pr": "48339",
    "merge_sha": "e94999fab862c2a22087c4bc6cd0a6f7dc4e4c98",
    "html": "<p>Allow an ActiveStorage attachment to be removed via a form post</p>\n\n<p>Attachments can already be removed by updating the attachment to be nil such as:</p>\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">User</span><span class=\"p\">.</span><span class=\"nf\">find</span><span class=\"p\">(</span><span class=\"n\">params</span><span class=\"p\">[</span><span class=\"ss\">:id</span><span class=\"p\">]).</span><span class=\"nf\">update!</span><span class=\"p\">(</span><span class=\"ss\">avatar: </span><span class=\"kp\">nil</span><span class=\"p\">)</span>\n</code></pre></div></div>\n\n<p>However, a form cannot post a nil param, it can only post an empty string. But, posting an<br />\nempty string would result in an <code>ActiveSupport::MessageVerifier::InvalidSignature: mismatched digest</code><br />\nerror being raised, because it’s being treated as a signed blob id.</p>\n\n<p>Now, nil and an empty string are treated as a delete, which allows attachments to be removed via:</p>\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">User</span><span class=\"p\">.</span><span class=\"nf\">find</span><span class=\"p\">(</span><span class=\"n\">params</span><span class=\"p\">[</span><span class=\"ss\">:id</span><span class=\"p\">]).</span><span class=\"nf\">update!</span><span class=\"p\">(</span><span class=\"n\">params</span><span class=\"p\">.</span><span class=\"nf\">require</span><span class=\"p\">(</span><span class=\"ss\">:user</span><span class=\"p\">).</span><span class=\"nf\">permit</span><span class=\"p\">(</span><span class=\"ss\">:avatar</span><span class=\"p\">))</span>\n\n</code></pre></div></div>\n\n<p><em>Nate Matykiewicz</em></p>\n"
  },
  {
    "message": "*   Remove mini_mime usage in favour of marcel.\n\n    We have two libraries that are have similar usage. This change removes\n    dependency on mini_mime and makes use of similar methods from marcel.\n\n    *Vipul A M*",
    "project": "activestorage",
    "date_merged": 1679943256000,
    "author": "Vipul A M",
    "sha": "3d414f3986c6488829da7734bd1be5085e405b3f",
    "pr": "47754",
    "merge_sha": "71a1f61926c7e6370ec3297d668390c0730e0f87",
    "html": "<p>Remove mini_mime usage in favour of marcel.</p>\n\n<p>We have two libraries that are have similar usage. This change removes<br />\ndependency on mini_mime and makes use of similar methods from marcel.</p>\n\n<p><em>Vipul A M</em></p>\n"
  },
  {
    "message": "*   Allow destroying active storage variants\n\n    ```ruby\n    User.first.avatar.variant(resize_to_limit: [100, 100]).destroy\n    ```\n\n    *Shouichi Kamiya*, *Yuichiro NAKAGAWA*, *Ryohei UEDA*",
    "project": "activestorage",
    "date_merged": 1679763306000,
    "author": "Shouichi Kamiya",
    "sha": "98abeea7b6cae376533b7c0176d139f561a9e347",
    "pr": "47150",
    "merge_sha": "febd9ab4f62c21ed3ac66392a9ad4b3a3685d6ac",
    "html": "<p>Allow destroying active storage variants</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">User</span><span class=\"p\">.</span><span class=\"nf\">first</span><span class=\"p\">.</span><span class=\"nf\">avatar</span><span class=\"p\">.</span><span class=\"nf\">variant</span><span class=\"p\">(</span><span class=\"ss\">resize_to_limit: </span><span class=\"p\">[</span><span class=\"mi\">100</span><span class=\"p\">,</span> <span class=\"mi\">100</span><span class=\"p\">]).</span><span class=\"nf\">destroy</span>\n</code></pre></div></div>\n\n<p><em>Shouichi Kamiya</em>, <em>Yuichiro NAKAGAWA</em>, <em>Ryohei UEDA</em></p>\n"
  },
  {
    "message": "*   Add `sample_rate` to `ActiveStorage::Analyzer::AudioAnalyzer` output\n\n    *Matija Čupić*",
    "project": "activestorage",
    "date_merged": 1679599030000,
    "author": "Matija Čupić",
    "sha": "c0465cf6aa224bd06fc5cae4d1a12284ecc3cdeb",
    "pr": "47749",
    "merge_sha": "097f703d59a64da1164bf63ea020ff85e3b32004",
    "html": "<p>Add <code>sample_rate</code> to <code>ActiveStorage::Analyzer::AudioAnalyzer</code> output</p>\n\n<p><em>Matija Čupić</em></p>\n"
  },
  {
    "message": "*   Remove deprecated `purge` and `purge_later` methods from the attachments association.\n\n    *Rafael Mendonça França*",
    "project": "activestorage",
    "date_merged": 1677805729000,
    "author": "Rafael Mendonça França",
    "sha": "18e53fbb2c1b76e4e0b906e602edb4ad7291b621",
    "pr": "47556",
    "merge_sha": "dd7ecb073c67fee00e409049f02d72accece94a2",
    "html": "<p>Remove deprecated <code>purge</code> and <code>purge_later</code> methods from the attachments association.</p>\n\n<p><em>Rafael Mendonça França</em></p>\n"
  },
  {
    "message": "*   Remove deprecated behavior when assigning to a collection of attachments.\n\n    Instead of appending to the collection, the collection is now replaced.\n\n    *Rafael Mendonça França*",
    "project": "activestorage",
    "date_merged": 1677805729000,
    "author": "Rafael Mendonça França",
    "sha": "c720b7eba8bab1d227553ad4f962bf35abd41c88",
    "pr": "47556",
    "merge_sha": "dd7ecb073c67fee00e409049f02d72accece94a2",
    "html": "<p>Remove deprecated behavior when assigning to a collection of attachments.</p>\n\n<p>Instead of appending to the collection, the collection is now replaced.</p>\n\n<p><em>Rafael Mendonça França</em></p>\n"
  },
  {
    "message": "*   Remove deprecated `ActiveStorage::Current#host` and `ActiveStorage::Current#host=` methods.\n\n    *Rafael Mendonça França*",
    "project": "activestorage",
    "date_merged": 1677805729000,
    "author": "Rafael Mendonça França",
    "sha": "0591de55af5cb1fa249237772309e94b07a640c2",
    "pr": "47556",
    "merge_sha": "dd7ecb073c67fee00e409049f02d72accece94a2",
    "html": "<p>Remove deprecated <code>ActiveStorage::Current#host</code> and <code>ActiveStorage::Current#host=</code> methods.</p>\n\n<p><em>Rafael Mendonça França</em></p>\n"
  },
  {
    "message": "*   Remove deprecated invalid default content types in Active Storage configurations.\n\n    *Rafael Mendonça França*",
    "project": "activestorage",
    "date_merged": 1677805729000,
    "author": "Rafael Mendonça França",
    "sha": "4edaa4120bd76fafa770dc654f85f83f1c2c6d78",
    "pr": "47556",
    "merge_sha": "dd7ecb073c67fee00e409049f02d72accece94a2",
    "html": "<p>Remove deprecated invalid default content types in Active Storage configurations.</p>\n\n<p><em>Rafael Mendonça França</em></p>\n"
  },
  {
    "message": "*   Add missing preview event to `ActiveStorage::LogSubscriber`\n\n    A `preview` event is being instrumented in `ActiveStorage::Previewer`.\n    However it was not added inside ActiveStorage's LogSubscriber class.\n\n    This will allow to have logs for when a preview happens\n    in the same fashion as all other ActiveStorage events such as\n    `upload` and `download` inside `Rails.logger`.\n\n    *Chedli Bourguiba*",
    "project": "activestorage",
    "date_merged": 1666432443000,
    "author": "Chedli Bourguiba",
    "sha": "0b8496fa7eca9e6e8f03f8f226a472a846458e63",
    "pr": "46291",
    "merge_sha": "e067745438c29fa553372bc5d1a1ca8717e2c457",
    "html": "<p>Add missing preview event to <code>ActiveStorage::LogSubscriber</code></p>\n\n<p>A <code>preview</code> event is being instrumented in <code>ActiveStorage::Previewer</code>.<br />\nHowever it was not added inside ActiveStorage’s LogSubscriber class.</p>\n\n<p>This will allow to have logs for when a preview happens<br />\nin the same fashion as all other ActiveStorage events such as<br />\n<code>upload</code> and <code>download</code> inside <code>Rails.logger</code>.</p>\n\n<p><em>Chedli Bourguiba</em></p>\n"
  },
  {
    "message": "*   Fix retrieving rotation value from FFmpeg on version 5.0+.\n\n    In FFmpeg version 5.0+ the rotation value has been removed from tags.\n    Instead the value can be found in side_data_list. Along with\n    this update it's possible to have values of -90, -270 to denote the video\n    has been rotated.\n\n    *Haroon Ahmed*",
    "project": "activestorage",
    "date_merged": 1664306220000,
    "author": "Haroon Ahmed",
    "sha": "206a826c8d231a331b30e27afa98d8eb1fe593f7",
    "pr": "45837",
    "merge_sha": "7de66704380281ead474c2e6723407b3d1246f77",
    "html": "<p>Fix retrieving rotation value from FFmpeg on version 5.0+.</p>\n\n<p>In FFmpeg version 5.0+ the rotation value has been removed from tags.<br />\nInstead the value can be found in side_data_list. Along with<br />\nthis update it’s possible to have values of -90, -270 to denote the video<br />\nhas been rotated.</p>\n\n<p><em>Haroon Ahmed</em></p>\n"
  },
  {
    "message": "*   Touch all corresponding model records after ActiveStorage::Blob is analyzed\n\n    This fixes a race condition where a record can be requested and have a cache entry built, before\n    the initial `analyze_later` completes, which will not be invalidated until something else\n    updates the record. This also invalidates cache entries when a blob is re-analyzed, which\n    is helpful if a bug is fixed in an analyzer or a new analyzer is added.\n\n    *Nate Matykiewicz*",
    "project": "activestorage",
    "date_merged": 1658853258000,
    "author": "Nate Matykiewicz",
    "sha": "294c2710620871a691e4ca5fefb5e5ace279195d",
    "pr": "45579",
    "merge_sha": "b01027fc2faf0f9c919152bdf0c4d5db56ea41fb",
    "html": "<p>Touch all corresponding model records after ActiveStorage::Blob is analyzed</p>\n\n<p>This fixes a race condition where a record can be requested and have a cache entry built, before<br />\nthe initial <code>analyze_later</code> completes, which will not be invalidated until something else<br />\nupdates the record. This also invalidates cache entries when a blob is re-analyzed, which<br />\nis helpful if a bug is fixed in an analyzer or a new analyzer is added.</p>\n\n<p><em>Nate Matykiewicz</em></p>\n"
  },
  {
    "message": "*   Add ability to use pre-defined variants when calling `preview` or\n    `representation` on an attachment.\n\n    ```ruby\n    class User < ActiveRecord::Base\n      has_one_attached :file do |attachable|\n        attachable.variant :thumb, resize_to_limit: [100, 100]\n      end\n    end\n\n    <%= image_tag user.file.representation(:thumb) %>\n    ```\n\n    *Richard Böhme*",
    "project": "activestorage",
    "date_merged": 1658245532000,
    "author": "Richard Böhme",
    "sha": "acf767dbd6fe95792caad72dc34a5054911acd6a",
    "pr": "45098",
    "merge_sha": "4ab6927b983a8d44585fb7ecb9f3cc7280b9deab",
    "html": "<p>Add ability to use pre-defined variants when calling <code>preview</code> or<br />\n<code>representation</code> on an attachment.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">class</span> <span class=\"nc\">User</span> <span class=\"o\">&lt;</span> <span class=\"no\">ActiveRecord</span><span class=\"o\">::</span><span class=\"no\">Base</span>\n  <span class=\"n\">has_one_attached</span> <span class=\"ss\">:file</span> <span class=\"k\">do</span> <span class=\"o\">|</span><span class=\"n\">attachable</span><span class=\"o\">|</span>\n    <span class=\"n\">attachable</span><span class=\"p\">.</span><span class=\"nf\">variant</span> <span class=\"ss\">:thumb</span><span class=\"p\">,</span> <span class=\"ss\">resize_to_limit: </span><span class=\"p\">[</span><span class=\"mi\">100</span><span class=\"p\">,</span> <span class=\"mi\">100</span><span class=\"p\">]</span>\n  <span class=\"k\">end</span>\n<span class=\"k\">end</span>\n\n<span class=\"o\">&lt;</span><span class=\"sx\">%= image_tag user.file.representation(:thumb) %&gt;\n</span></code></pre></div></div>\n\n<p><em>Richard Böhme</em></p>\n"
  },
  {
    "message": "*   Method `attach` always returns the attachments except when the record\n    is persisted, unchanged, and saving it fails, in which case it returns `nil`.\n\n    *Santiago Bartesaghi*",
    "project": "activestorage",
    "date_merged": 1655828898000,
    "author": "Santiago Bartesaghi",
    "sha": "7acdfcb12c6c83df1c401cd8d05678ffa91b6bd5",
    "pr": "45397",
    "merge_sha": "3ea99f53fafbcacfda58b11e2c0537fc043742f2",
    "html": "<p>Method <code>attach</code> always returns the attachments except when the record<br />\nis persisted, unchanged, and saving it fails, in which case it returns <code>nil</code>.</p>\n\n<p><em>Santiago Bartesaghi</em></p>\n"
  },
  {
    "message": "*   Fixes multiple `attach` calls within transaction not uploading files correctly.\n\n    In the following example, the code failed to upload all but the last file to the configured service.\n    ```ruby\n      ActiveRecord::Base.transaction do\n        user.attachments.attach({\n          content_type: \"text/plain\",\n          filename: \"dummy.txt\",\n          io: ::StringIO.new(\"dummy\"),\n        })\n        user.attachments.attach({\n          content_type: \"text/plain\",\n          filename: \"dummy2.txt\",\n          io: ::StringIO.new(\"dummy2\"),\n        })\n      end\n\n      assert_equal 2, user.attachments.count\n      assert user.attachments.first.service.exist?(user.attachments.first.key)  # Fails\n    ```\n\n    This was addressed by keeping track of the subchanges pending upload, and uploading them\n    once the transaction is committed.\n\n    Fixes #41661\n\n    *Santiago Bartesaghi*, *Bruno Vezoli*, *Juan Roig*, *Abhay Nikam*",
    "project": "activestorage",
    "date_merged": 1654592667000,
    "author": "Santiago Bartesaghi",
    "sha": "2895c6b9a22b856f2ba22e0866524162701886c1",
    "pr": "41661",
    "merge_sha": "d921f203c356a0d6902a3f75067f08993f4e33fa",
    "html": "<p>Fixes multiple <code>attach</code> calls within transaction not uploading files correctly.</p>\n\n<p>In the following example, the code failed to upload all but the last file to the configured service.</p>\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>  <span class=\"no\">ActiveRecord</span><span class=\"o\">::</span><span class=\"no\">Base</span><span class=\"p\">.</span><span class=\"nf\">transaction</span> <span class=\"k\">do</span>\n    <span class=\"n\">user</span><span class=\"p\">.</span><span class=\"nf\">attachments</span><span class=\"p\">.</span><span class=\"nf\">attach</span><span class=\"p\">({</span>\n      <span class=\"ss\">content_type: </span><span class=\"s2\">\"text/plain\"</span><span class=\"p\">,</span>\n      <span class=\"ss\">filename: </span><span class=\"s2\">\"dummy.txt\"</span><span class=\"p\">,</span>\n      <span class=\"ss\">io: </span><span class=\"o\">::</span><span class=\"no\">StringIO</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"s2\">\"dummy\"</span><span class=\"p\">),</span>\n    <span class=\"p\">})</span>\n    <span class=\"n\">user</span><span class=\"p\">.</span><span class=\"nf\">attachments</span><span class=\"p\">.</span><span class=\"nf\">attach</span><span class=\"p\">({</span>\n      <span class=\"ss\">content_type: </span><span class=\"s2\">\"text/plain\"</span><span class=\"p\">,</span>\n      <span class=\"ss\">filename: </span><span class=\"s2\">\"dummy2.txt\"</span><span class=\"p\">,</span>\n      <span class=\"ss\">io: </span><span class=\"o\">::</span><span class=\"no\">StringIO</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"s2\">\"dummy2\"</span><span class=\"p\">),</span>\n    <span class=\"p\">})</span>\n  <span class=\"k\">end</span>\n\n  <span class=\"n\">assert_equal</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">user</span><span class=\"p\">.</span><span class=\"nf\">attachments</span><span class=\"p\">.</span><span class=\"nf\">count</span>\n  <span class=\"n\">assert</span> <span class=\"n\">user</span><span class=\"p\">.</span><span class=\"nf\">attachments</span><span class=\"p\">.</span><span class=\"nf\">first</span><span class=\"p\">.</span><span class=\"nf\">service</span><span class=\"p\">.</span><span class=\"nf\">exist?</span><span class=\"p\">(</span><span class=\"n\">user</span><span class=\"p\">.</span><span class=\"nf\">attachments</span><span class=\"p\">.</span><span class=\"nf\">first</span><span class=\"p\">.</span><span class=\"nf\">key</span><span class=\"p\">)</span>  <span class=\"c1\"># Fails</span>\n</code></pre></div></div>\n\n<p>This was addressed by keeping track of the subchanges pending upload, and uploading them<br />\nonce the transaction is committed.</p>\n\n<p>Fixes #41661</p>\n\n<p><em>Santiago Bartesaghi</em>, <em>Bruno Vezoli</em>, <em>Juan Roig</em>, <em>Abhay Nikam</em></p>\n"
  },
  {
    "message": "*   Raise an exception if `config.active_storage.service` is not set.\n\n    If Active Storage is configured and `config.active_storage.service` is not\n    set in the respective environment's configuration file, then an exception\n    is raised with a meaningful message when attempting to use Active Storage.\n\n    *Ghouse Mohamed*",
    "project": "activestorage",
    "date_merged": 1654019493000,
    "author": "Ghouse Mohamed",
    "sha": "06c83d93cf0ea28cda553830023717204eb77b9f",
    "pr": "45224",
    "merge_sha": "2d62fd01b65739dc0c2955c47afd40da68f146f6",
    "html": "<p>Raise an exception if <code>config.active_storage.service</code> is not set.</p>\n\n<p>If Active Storage is configured and <code>config.active_storage.service</code> is not<br />\nset in the respective environment’s configuration file, then an exception<br />\nis raised with a meaningful message when attempting to use Active Storage.</p>\n\n<p><em>Ghouse Mohamed</em></p>\n"
  },
  {
    "message": "*   Fixes proxy downloads of files over 5mb\n\n    Previously, trying to view and/or download files larger than 5mb stored in\n    services like S3 via proxy mode could return corrupted files at around\n    5.2mb or cause random halts in the download. Now,\n    `ActiveStorage::Blobs::ProxyController` correctly handles streaming these\n    larger files from the service to the client without any issues.\n\n    Fixes #44679\n\n    *Felipe Raul*",
    "project": "activestorage",
    "date_merged": 1654019493000,
    "author": "Ghouse Mohamed",
    "sha": "06c83d93cf0ea28cda553830023717204eb77b9f",
    "pr": "45224",
    "merge_sha": "2d62fd01b65739dc0c2955c47afd40da68f146f6",
    "html": "<p>Fixes proxy downloads of files over 5mb</p>\n\n<p>Previously, trying to view and/or download files larger than 5mb stored in<br />\nservices like S3 via proxy mode could return corrupted files at around<br />\n5.2mb or cause random halts in the download. Now,<br />\n<code>ActiveStorage::Blobs::ProxyController</code> correctly handles streaming these<br />\nlarger files from the service to the client without any issues.</p>\n\n<p>Fixes #44679</p>\n\n<p><em>Felipe Raul</em></p>\n"
  },
  {
    "message": "*   Saving attachment(s) to a record returns the blob/blobs object\n\n    Previously, saving attachments did not return the blob/blobs that\n    were attached. Now, saving attachments to a record with `#attach`\n    method returns the blob or array of blobs that were attached to\n    the record. If it fails to save the attachment(s), then it returns\n    `false`.\n\n    *Ghouse Mohamed*",
    "project": "activestorage",
    "date_merged": 1645823941000,
    "author": "Ghouse Mohamed",
    "sha": "fbfb6e6885e65f212771430a235359ee86654512",
    "pr": "44439",
    "merge_sha": "fb88db58d7ec1c1998d90d3fdadf819200786a7c",
    "html": "<p>Saving attachment(s) to a record returns the blob/blobs object</p>\n\n<p>Previously, saving attachments did not return the blob/blobs that<br />\nwere attached. Now, saving attachments to a record with <code>#attach</code><br />\nmethod returns the blob or array of blobs that were attached to<br />\nthe record. If it fails to save the attachment(s), then it returns<br />\n<code>false</code>.</p>\n\n<p><em>Ghouse Mohamed</em></p>\n"
  },
  {
    "message": "*   Don't stream responses in redirect mode\n\n    Previously, both redirect mode and proxy mode streamed their\n    responses which caused a new thread to be created, and could end\n    up leaking connections in the connection pool. But since redirect\n    mode doesn't actually send any data, it doesn't need to be\n    streamed.\n\n    *Luke Lau*",
    "project": "activestorage",
    "date_merged": 1643199285000,
    "author": "Luke Lau",
    "sha": "7e61f808c684b22b175271530a8bf3ced0815dfb",
    "pr": "44244",
    "merge_sha": "bd41655d17ff85c3118a4c69d19bad47b6a2890f",
    "html": "<p>Don’t stream responses in redirect mode</p>\n\n<p>Previously, both redirect mode and proxy mode streamed their<br />\nresponses which caused a new thread to be created, and could end<br />\nup leaking connections in the connection pool. But since redirect<br />\nmode doesn’t actually send any data, it doesn’t need to be<br />\nstreamed.</p>\n\n<p><em>Luke Lau</em></p>\n"
  },
  {
    "message": "*   Safe for direct upload on Libraries or Frameworks\n\n    Enable the use of custom headers during direct uploads, which allows for\n    the inclusion of Authorization bearer tokens or other forms of authorization\n    tokens through headers.\n\n    *Radamés Roriz*",
    "project": "activestorage",
    "date_merged": 1679949445000,
    "author": "Radamés Roriz",
    "sha": "26b209437b46409c79577a7f18c5ab47a6954363",
    "pr": "47773",
    "merge_sha": "1ed5ef6bb32df8ad61ea0ccc79fd67c91de81027",
    "html": "<p>Safe for direct upload on Libraries or Frameworks</p>\n\n<p>Enable the use of custom headers during direct uploads, which allows for<br />\nthe inclusion of Authorization bearer tokens or other forms of authorization<br />\ntokens through headers.</p>\n\n<p><em>Radamés Roriz</em></p>\n"
  },
  {
    "message": "*   Use `Rails::HTML5::SafeListSanitizer` by default in the Rails 7.1 configuration if it is\n    supported.\n\n    Action Text's sanitizer can be configured by setting\n    `config.action_text.sanitizer_vendor`. Supported values are `Rails::HTML4::Sanitizer` or\n    `Rails::HTML5::Sanitizer`.\n\n    The Rails 7.1 configuration will set this to `Rails::HTML5::Sanitizer` when it is supported, and\n    fall back to `Rails::HTML4::Sanitizer`. Previous configurations default to\n    `Rails::HTML4::Sanitizer`.\n\n    As a result of this change, the defaults for `ActionText::ContentHelper.allowed_tags` and\n    `.allowed_attributes` are applied at runtime, so the value of these attributes is now 'nil'\n    unless set by the application. You may call `sanitizer_allowed_tags` or\n    `sanitizer_allowed_attributes` to inspect the tags and attributes being allowed by the\n    sanitizer.\n\n    *Mike Dalessio*",
    "project": "actiontext",
    "date_merged": 1688504879000,
    "author": "Mike Dalessio",
    "sha": "44d3b44d9d7f42658bda1037f6c7713d02d4b1c0",
    "pr": "48644",
    "merge_sha": "fe6b96afd1afaadb67cd70924a698ba99f8cc9e2",
    "html": "<p>Use <code>Rails::HTML5::SafeListSanitizer</code> by default in the Rails 7.1 configuration if it is<br />\nsupported.</p>\n\n<p>Action Text’s sanitizer can be configured by setting<br />\n<code>config.action_text.sanitizer_vendor</code>. Supported values are <code>Rails::HTML4::Sanitizer</code> or<br />\n<code>Rails::HTML5::Sanitizer</code>.</p>\n\n<p>The Rails 7.1 configuration will set this to <code>Rails::HTML5::Sanitizer</code> when it is supported, and<br />\nfall back to <code>Rails::HTML4::Sanitizer</code>. Previous configurations default to<br />\n<code>Rails::HTML4::Sanitizer</code>.</p>\n\n<p>As a result of this change, the defaults for <code>ActionText::ContentHelper.allowed_tags</code> and<br />\n<code>.allowed_attributes</code> are applied at runtime, so the value of these attributes is now ‘nil’<br />\nunless set by the application. You may call <code>sanitizer_allowed_tags</code> or<br />\n<code>sanitizer_allowed_attributes</code> to inspect the tags and attributes being allowed by the<br />\nsanitizer.</p>\n\n<p><em>Mike Dalessio</em></p>\n"
  },
  {
    "message": "*   Attachables now can override default attachment missing template.\n\n    When rendering Action Text attachments where the underlying attachable model has\n    been removed, a fallback template is used. You now can override this template on\n    a per-model basis. For example, you could render a placeholder image for a file\n    attachment or the text \"Deleted User\" for a User attachment.\n\n    *Matt Swanson*, *Joel Drapper*",
    "project": "actiontext",
    "date_merged": 1679762994000,
    "author": "Matt Swanson",
    "sha": "fbf0145f19948ce3a4caf3438a1665ffc3e00baa",
    "pr": "46101",
    "merge_sha": "6aaa9db6472c1017e6dbd12163a56a4902e813ff",
    "html": "<p>Attachables now can override default attachment missing template.</p>\n\n<p>When rendering Action Text attachments where the underlying attachable model has<br />\nbeen removed, a fallback template is used. You now can override this template on<br />\na per-model basis. For example, you could render a placeholder image for a file<br />\nattachment or the text “Deleted User” for a User attachment.</p>\n\n<p><em>Matt Swanson</em>, <em>Joel Drapper</em></p>\n"
  },
  {
    "message": "*   Update bundled Trix version from `1.3.1` to `2.0.4`.\n\n    *Sarah Ridge*, *Sean Doyle*",
    "project": "actiontext",
    "date_merged": 1680039583000,
    "author": "Sarah Ridge",
    "sha": "de317f9d6ae2ac830c8b19aafaebe0a97f7a87c0",
    "pr": "47679",
    "merge_sha": "dda3e02b78a0e8ad8f31dd519ecf94e3493909a3",
    "html": "<p>Update bundled Trix version from <code>1.3.1</code> to <code>2.0.4</code>.</p>\n\n<p><em>Sarah Ridge</em>, <em>Sean Doyle</em></p>\n"
  },
  {
    "message": "*   Apply `field_error_proc` to `rich_text_area` form fields.\n\n    *Kaíque Kandy Koga*",
    "project": "actiontext",
    "date_merged": 1671733672000,
    "author": "Kaíque Kandy Koga",
    "sha": "0dc71acf3981834f9a88061d98483ab13369d24b",
    "pr": "44786",
    "merge_sha": "95fb5b4bc1dd8b0c103564030f1a4abe9a11cee9",
    "html": "<p>Apply <code>field_error_proc</code> to <code>rich_text_area</code> form fields.</p>\n\n<p><em>Kaíque Kandy Koga</em></p>\n"
  },
  {
    "message": "*   Action Text attachment URLs rendered in a background job (a la Turbo\n    Streams) now use `Rails.application.default_url_options` and\n    `Rails.application.config.force_ssl` instead of `http://example.org`.\n\n    *Jonathan Hefner*",
    "project": "actiontext",
    "date_merged": 1671144302000,
    "author": "Jonathan Hefner",
    "sha": "93038baad70d477f6cbb06fa9d48c8e429fb192f",
    "pr": "46649",
    "merge_sha": "12c0c0a4c17249c24eb0c1892f5d2093fe6ca073",
    "html": "<p>Action Text attachment URLs rendered in a background job (a la Turbo<br />\nStreams) now use <code>Rails.application.default_url_options</code> and<br />\n<code>Rails.application.config.force_ssl</code> instead of <code>http://example.org</code>.</p>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Support `strict_loading:` option for `has_rich_text` declaration\n\n    *Sean Doyle*",
    "project": "actiontext",
    "date_merged": 1670593447000,
    "author": "Sean Doyle",
    "sha": "4a743b9e0a98a5e45d83c124c5ecf13ce470d063",
    "pr": "46271",
    "merge_sha": "f002536a5d46dd57650640c1ce944d161f5ec97d",
    "html": "<p>Support <code>strict_loading:</code> option for <code>has_rich_text</code> declaration</p>\n\n<p><em>Sean Doyle</em></p>\n"
  },
  {
    "message": "*   Update ContentAttachment so that it can encapsulate arbitrary HTML content in a document.\n\n    *Jamis Buck*",
    "project": "actiontext",
    "date_merged": 1662488110000,
    "author": "Jamis Buck",
    "sha": "c8ea92cf2714d940a39dc3700cd6fb21d21c08ea",
    "pr": "45739",
    "merge_sha": "01d345c4d6b9639a21b92482046e075ef195da92",
    "html": "<p>Update ContentAttachment so that it can encapsulate arbitrary HTML content in a document.</p>\n\n<p><em>Jamis Buck</em></p>\n"
  },
  {
    "message": "*   Fix an issue that caused the content layout to render multiple times when a\n    rich_text field was updated.\n\n    *Jacob Herrington*",
    "project": "actiontext",
    "date_merged": 1653232209000,
    "author": "Jacob Herrington",
    "sha": "5811097ece8b2f0dcab442f94f14043043e47edb",
    "pr": "43706",
    "merge_sha": "327ba2d9796d1c630ede63bbc3bc9ebfc8f8740c",
    "html": "<p>Fix an issue that caused the content layout to render multiple times when a<br />\nrich_text field was updated.</p>\n\n<p><em>Jacob Herrington</em></p>\n"
  },
  {
    "message": "*   Add `drb`, `mutex_m` and `base64` that are bundled gem candidates for Ruby 3.4\n\n    *Yasuo Honda*",
    "project": "activesupport",
    "date_merged": 1691537444000,
    "author": "Yasuo Honda",
    "sha": "3e52adf28e90af490f7e3bdc4bcc85618a4e0867",
    "pr": "48907",
    "merge_sha": "4e01a7e8753c30e22264e185082524a9ea5e0c90",
    "html": "<p>Add <code>drb</code>, <code>mutex_m</code> and <code>base64</code> that are bundled gem candidates for Ruby 3.4</p>\n\n<p><em>Yasuo Honda</em></p>\n"
  },
  {
    "message": "*   When using cache format version >= 7.1 or a custom serializer, expired and\n    version-mismatched cache entries can now be detected without deserializing\n    their values.\n\n    *Jonathan Hefner*",
    "project": "activesupport",
    "date_merged": 1690490550000,
    "author": "Jonathan Hefner",
    "sha": "36f9cfdd9060b013386b9ddff3008d9da8ba25bb",
    "pr": "48754",
    "merge_sha": "a632f26c2d18758b92056978a7a56dc4535ad15c",
    "html": "<p>When using cache format version &gt;= 7.1 or a custom serializer, expired and<br />\nversion-mismatched cache entries can now be detected without deserializing<br />\ntheir values.</p>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Make all cache stores return a boolean for `#delete`\n\n    Previously the `RedisCacheStore#delete` would return `1` if the entry\n    exists and `0` otherwise. Now it returns true if the entry exists and false\n    otherwise, just like the other stores.\n\n    The `FileStore` would return `nil` if the entry doesn't exists and returns\n    `false` now as well.\n\n    *Petrik de Heus*",
    "project": "activesupport",
    "date_merged": 1690440533000,
    "author": "Petrik",
    "sha": "3601a236dd35d3b232feafb446e5d2136294487f",
    "pr": "48638",
    "merge_sha": "b7b741b02a05c7fc10c30a14a0f94029e93cd2b6",
    "html": "<p>Make all cache stores return a boolean for <code>#delete</code></p>\n\n<p>Previously the <code>RedisCacheStore#delete</code> would return <code>1</code> if the entry<br />\nexists and <code>0</code> otherwise. Now it returns true if the entry exists and false<br />\notherwise, just like the other stores.</p>\n\n<p>The <code>FileStore</code> would return <code>nil</code> if the entry doesn’t exists and returns<br />\n<code>false</code> now as well.</p>\n\n<p><em>Petrik de Heus</em></p>\n"
  },
  {
    "message": "*   Active Support cache stores now support replacing the default compressor via\n    a `:compressor` option. The specified compressor must respond to `deflate`\n    and `inflate`. For example:\n\n      ```ruby\n      module MyCompressor\n        def self.deflate(string)\n          # compression logic...\n        end\n\n        def self.inflate(compressed)\n          # decompression logic...\n        end\n      end\n\n      config.cache_store = :redis_cache_store, { compressor: MyCompressor }\n      ```\n\n    *Jonathan Hefner*",
    "project": "activesupport",
    "date_merged": 1690407562000,
    "author": "Jonathan Hefner",
    "sha": "3efb84486e4b467bcfe9fb70c67aa3a639de84ad",
    "pr": "48451",
    "merge_sha": "1334919732da4fc692623f54205ed6f507c07565",
    "html": "<p>Active Support cache stores now support replacing the default compressor via<br />\na <code>:compressor</code> option. The specified compressor must respond to <code>deflate</code><br />\nand <code>inflate</code>. For example:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>  <span class=\"k\">module</span> <span class=\"nn\">MyCompressor</span>\n    <span class=\"k\">def</span> <span class=\"nc\">self</span><span class=\"o\">.</span><span class=\"nf\">deflate</span><span class=\"p\">(</span><span class=\"n\">string</span><span class=\"p\">)</span>\n      <span class=\"c1\"># compression logic...</span>\n    <span class=\"k\">end</span>\n\n    <span class=\"k\">def</span> <span class=\"nc\">self</span><span class=\"o\">.</span><span class=\"nf\">inflate</span><span class=\"p\">(</span><span class=\"n\">compressed</span><span class=\"p\">)</span>\n      <span class=\"c1\"># decompression logic...</span>\n    <span class=\"k\">end</span>\n  <span class=\"k\">end</span>\n\n  <span class=\"n\">config</span><span class=\"p\">.</span><span class=\"nf\">cache_store</span> <span class=\"o\">=</span> <span class=\"ss\">:redis_cache_store</span><span class=\"p\">,</span> <span class=\"p\">{</span> <span class=\"ss\">compressor: </span><span class=\"no\">MyCompressor</span> <span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Active Support cache stores now support a `:serializer` option. Similar to\n    the `:coder` option, serializers must respond to `dump` and `load`. However,\n    serializers are only responsible for serializing a cached value, whereas\n    coders are responsible for serializing the entire `ActiveSupport::Cache::Entry`\n    instance.  Additionally, the output from serializers can be automatically\n    compressed, whereas coders are responsible for their own compression.\n\n    Specifying a serializer instead of a coder also enables performance\n    optimizations, including the bare string optimization introduced by cache\n    format version 7.1.\n\n    The `:serializer` and `:coder` options are mutually exclusive. Specifying\n    both will raise an `ArgumentError`.\n\n    *Jonathan Hefner*",
    "project": "activesupport",
    "date_merged": 1690407562000,
    "author": "Jonathan Hefner",
    "sha": "3efb84486e4b467bcfe9fb70c67aa3a639de84ad",
    "pr": "48451",
    "merge_sha": "1334919732da4fc692623f54205ed6f507c07565",
    "html": "<p>Active Support cache stores now support a <code>:serializer</code> option. Similar to<br />\nthe <code>:coder</code> option, serializers must respond to <code>dump</code> and <code>load</code>. However,<br />\nserializers are only responsible for serializing a cached value, whereas<br />\ncoders are responsible for serializing the entire <code>ActiveSupport::Cache::Entry</code><br />\ninstance.  Additionally, the output from serializers can be automatically<br />\ncompressed, whereas coders are responsible for their own compression.</p>\n\n<p>Specifying a serializer instead of a coder also enables performance<br />\noptimizations, including the bare string optimization introduced by cache<br />\nformat version 7.1.</p>\n\n<p>The <code>:serializer</code> and <code>:coder</code> options are mutually exclusive. Specifying<br />\nboth will raise an <code>ArgumentError</code>.</p>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Fix `ActiveSupport::Inflector.humanize(nil)` raising ``NoMethodError: undefined method `end_with?' for nil:NilClass``.\n\n    *James Robinson*",
    "project": "activesupport",
    "date_merged": 1690313667000,
    "author": "James Robinson",
    "sha": "016b81f0b205b0d59aa59a22bdaa9fd503a22a6b",
    "pr": "48800",
    "merge_sha": "d580a776c3b33fd3bb75109929f0f758d3e400ad",
    "html": "<p>Fix <code>ActiveSupport::Inflector.humanize(nil)</code> raising <code>NoMethodError: undefined method `end_with?' for nil:NilClass</code>.</p>\n\n<p><em>James Robinson</em></p>\n"
  },
  {
    "message": "*   Don't show secrets for `ActiveSupport::KeyGenerator#inspect`.\n\n    Before:\n\n    ```ruby\n    ActiveSupport::KeyGenerator.new(secret).inspect\n    \"#<ActiveSupport::KeyGenerator:0x0000000104888038 ... @secret=\\\"\\\\xAF\\\\bFh]LV}q\\\\nl\\\\xB2U\\\\xB3 ... >\"\n    ```\n\n    After:\n\n    ```ruby\n    ActiveSupport::KeyGenerator::Aes256Gcm(secret).inspect\n    \"#<ActiveSupport::KeyGenerator:0x0000000104888038>\"\n    ```\n\n    *Petrik de Heus*",
    "project": "activesupport",
    "date_merged": 1689011778000,
    "author": "Petrik",
    "sha": "5117da2b653e01ac27306a2088659a4b2af3c78f",
    "pr": "48680",
    "merge_sha": "66676ce499a32e4c62220bd05f8ee2cdf0e15f0c",
    "html": "<p>Don’t show secrets for <code>ActiveSupport::KeyGenerator#inspect</code>.</p>\n\n<p>Before:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">ActiveSupport</span><span class=\"o\">::</span><span class=\"no\">KeyGenerator</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"n\">secret</span><span class=\"p\">).</span><span class=\"nf\">inspect</span>\n<span class=\"s2\">\"#&lt;ActiveSupport::KeyGenerator:0x0000000104888038 ... @secret=</span><span class=\"se\">\\\"\\\\</span><span class=\"s2\">xAF</span><span class=\"se\">\\\\</span><span class=\"s2\">bFh]LV}q</span><span class=\"se\">\\\\</span><span class=\"s2\">nl</span><span class=\"se\">\\\\</span><span class=\"s2\">xB2U</span><span class=\"se\">\\\\</span><span class=\"s2\">xB3 ... &gt;\"</span>\n</code></pre></div></div>\n\n<p>After:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">ActiveSupport</span><span class=\"o\">::</span><span class=\"no\">KeyGenerator</span><span class=\"o\">::</span><span class=\"no\">Aes256Gcm</span><span class=\"p\">(</span><span class=\"n\">secret</span><span class=\"p\">).</span><span class=\"nf\">inspect</span>\n<span class=\"s2\">\"#&lt;ActiveSupport::KeyGenerator:0x0000000104888038&gt;\"</span>\n</code></pre></div></div>\n\n<p><em>Petrik de Heus</em></p>\n"
  },
  {
    "message": "*   Improve error message when EventedFileUpdateChecker is used without a\n    compatible version of the Listen gem\n\n    *Hartley McGuire*",
    "project": "activesupport",
    "date_merged": 1688274648000,
    "author": "Hartley McGuire",
    "sha": "f31172582cfe6da662bae6eec2e56aeeb1ce0488",
    "pr": "48622",
    "merge_sha": "f46d3452ae30c46d3e213c687decbbca0cee9119",
    "html": "<p>Improve error message when EventedFileUpdateChecker is used without a<br />\ncompatible version of the Listen gem</p>\n\n<p><em>Hartley McGuire</em></p>\n"
  },
  {
    "message": "*   Add `:report` behavior for Deprecation\n\n    Setting `config.active_support.deprecation = :report` uses the error\n    reporter to report deprecation warnings to `ActiveSupport::ErrorReporter`.\n\n    Deprecations are reported as handled errors, with a severity of `:warning`.\n\n    Useful to report deprecations happening in production to your bug tracker.\n\n    *Étienne Barrié*",
    "project": "activesupport",
    "date_merged": 1687800478000,
    "author": "Étienne Barrié",
    "sha": "78c73430577ac3925c98efeee78167fb51b63509",
    "pr": "48578",
    "merge_sha": "fe52de644b1c3a3d60d160c52b5a31b28cb42645",
    "html": "<p>Add <code>:report</code> behavior for Deprecation</p>\n\n<p>Setting <code>config.active_support.deprecation = :report</code> uses the error<br />\nreporter to report deprecation warnings to <code>ActiveSupport::ErrorReporter</code>.</p>\n\n<p>Deprecations are reported as handled errors, with a severity of <code>:warning</code>.</p>\n\n<p>Useful to report deprecations happening in production to your bug tracker.</p>\n\n<p><em>Étienne Barrié</em></p>\n"
  },
  {
    "message": "*   Rename `Range#overlaps?` to `#overlap?` and add alias for backwards compatibility\n\n    *Christian Schmidt*",
    "project": "activesupport",
    "date_merged": 1687642578000,
    "author": "Christian Schmidt",
    "sha": "11ed5b5c52c4f545bf06f10ce89c70d9c9b514b2",
    "pr": "48565",
    "merge_sha": "672376c0773e45c81192533a0b0d25a2d651eb31",
    "html": "<p>Rename <code>Range#overlaps?</code> to <code>#overlap?</code> and add alias for backwards compatibility</p>\n\n<p><em>Christian Schmidt</em></p>\n"
  },
  {
    "message": "*   Fix `EncryptedConfiguration` returning incorrect values for some `Hash`\n    methods\n\n    *Hartley McGuire*",
    "project": "activesupport",
    "date_merged": 1687421762000,
    "author": "Hartley McGuire",
    "sha": "8355658a56dfa944cc5e87b2d7bece880caf8e00",
    "pr": "48556",
    "merge_sha": "06da26afbabb1681d3d680cac13f70f7623cf69a",
    "html": "<p>Fix <code>EncryptedConfiguration</code> returning incorrect values for some <code>Hash</code><br />\nmethods</p>\n\n<p><em>Hartley McGuire</em></p>\n"
  },
  {
    "message": "*   Don't show secrets for `MessageEncryptor#inspect`.\n\n    Before:\n\n    ```ruby\n    ActiveSupport::MessageEncryptor.new(secret, cipher: \"aes-256-gcm\").inspect\n    \"#<ActiveSupport::MessageEncryptor:0x0000000104888038 ... @secret=\\\"\\\\xAF\\\\bFh]LV}q\\\\nl\\\\xB2U\\\\xB3 ... >\"\n    ```\n\n    After:\n\n    ```ruby\n    ActiveSupport::MessageEncryptor.new(secret, cipher: \"aes-256-gcm\").inspect\n    \"#<ActiveSupport::MessageEncryptor:0x0000000104888038>\"\n    ```\n\n    *Petrik de Heus*",
    "project": "activesupport",
    "date_merged": 1686944901000,
    "author": "Petrik",
    "sha": "3f1526ae767b6fbcad039e0922fe55d61af90081",
    "pr": "48499",
    "merge_sha": "d15aff474dbaad75781ab18411292360910f9308",
    "html": "<p>Don’t show secrets for <code>MessageEncryptor#inspect</code>.</p>\n\n<p>Before:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">ActiveSupport</span><span class=\"o\">::</span><span class=\"no\">MessageEncryptor</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"n\">secret</span><span class=\"p\">,</span> <span class=\"ss\">cipher: </span><span class=\"s2\">\"aes-256-gcm\"</span><span class=\"p\">).</span><span class=\"nf\">inspect</span>\n<span class=\"s2\">\"#&lt;ActiveSupport::MessageEncryptor:0x0000000104888038 ... @secret=</span><span class=\"se\">\\\"\\\\</span><span class=\"s2\">xAF</span><span class=\"se\">\\\\</span><span class=\"s2\">bFh]LV}q</span><span class=\"se\">\\\\</span><span class=\"s2\">nl</span><span class=\"se\">\\\\</span><span class=\"s2\">xB2U</span><span class=\"se\">\\\\</span><span class=\"s2\">xB3 ... &gt;\"</span>\n</code></pre></div></div>\n\n<p>After:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">ActiveSupport</span><span class=\"o\">::</span><span class=\"no\">MessageEncryptor</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"n\">secret</span><span class=\"p\">,</span> <span class=\"ss\">cipher: </span><span class=\"s2\">\"aes-256-gcm\"</span><span class=\"p\">).</span><span class=\"nf\">inspect</span>\n<span class=\"s2\">\"#&lt;ActiveSupport::MessageEncryptor:0x0000000104888038&gt;\"</span>\n</code></pre></div></div>\n\n<p><em>Petrik de Heus</em></p>\n"
  },
  {
    "message": "*   Don't show contents for `EncryptedConfiguration#inspect`.\n\n    Before:\n    ```ruby\n    Rails.application.credentials.inspect\n    \"#<ActiveSupport::EncryptedConfiguration:0x000000010d2b38e8 ... @config={:secret=>\\\"something secret\\\"} ... @key_file_contents=\\\"915e4ea054e011022398dc242\\\" ...>\"\n    ```\n\n    After:\n    ```ruby\n    Rails.application.credentials.inspect\n    \"#<ActiveSupport::EncryptedConfiguration:0x000000010d2b38e8>\"\n    ```\n\n    *Petrik de Heus*",
    "project": "activesupport",
    "date_merged": 1686939952000,
    "author": "Petrik",
    "sha": "7ecd72e5c162c6aaac178717c33c9febb5b3c0b9",
    "pr": "48498",
    "merge_sha": "5f4f9166c1793b44f570514da3593181185639fc",
    "html": "<p>Don’t show contents for <code>EncryptedConfiguration#inspect</code>.</p>\n\n<p>Before:</p>\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">Rails</span><span class=\"p\">.</span><span class=\"nf\">application</span><span class=\"p\">.</span><span class=\"nf\">credentials</span><span class=\"p\">.</span><span class=\"nf\">inspect</span>\n<span class=\"s2\">\"#&lt;ActiveSupport::EncryptedConfiguration:0x000000010d2b38e8 ... @config={:secret=&gt;</span><span class=\"se\">\\\"</span><span class=\"s2\">something secret</span><span class=\"se\">\\\"</span><span class=\"s2\">} ... @key_file_contents=</span><span class=\"se\">\\\"</span><span class=\"s2\">915e4ea054e011022398dc242</span><span class=\"se\">\\\"</span><span class=\"s2\"> ...&gt;\"</span>\n</code></pre></div></div>\n\n<p>After:</p>\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">Rails</span><span class=\"p\">.</span><span class=\"nf\">application</span><span class=\"p\">.</span><span class=\"nf\">credentials</span><span class=\"p\">.</span><span class=\"nf\">inspect</span>\n<span class=\"s2\">\"#&lt;ActiveSupport::EncryptedConfiguration:0x000000010d2b38e8&gt;\"</span>\n</code></pre></div></div>\n\n<p><em>Petrik de Heus</em></p>\n"
  },
  {
    "message": "*   `ERB::Util.html_escape_once` always returns an `html_safe` string.\n\n    This method previously maintained the `html_safe?` property of a string on the return\n    value. Because this string has been escaped, however, not marking it as `html_safe` causes\n    entities to be double-escaped.\n\n    As an example, take this view snippet:\n\n      ```html\n      <p><%= html_escape_once(\"this & that &amp; the other\") %></p>\n      ```\n\n    Before this change, that would be double-escaped and render as:\n\n      ```html\n      <p>this &amp;amp; that &amp;amp; the other</p>\n      ```\n\n    After this change, it renders correctly as:\n\n      ```html\n      <p>this &amp; that &amp; the other</p>\n      ```\n\n    Fixes #48256\n\n    *Mike Dalessio*",
    "project": "activesupport",
    "date_merged": 1684749815000,
    "author": "Mike Dalessio",
    "sha": "aea88498211445d82aa1b20eec2d1d0e774dbce3",
    "pr": "48265",
    "merge_sha": "1c69f508cc6f4960bf8a22972d5fb1d974d29b2b",
    "html": "<p><code>ERB::Util.html_escape_once</code> always returns an <code>html_safe</code> string.</p>\n\n<p>This method previously maintained the <code>html_safe?</code> property of a string on the return<br />\nvalue. Because this string has been escaped, however, not marking it as <code>html_safe</code> causes<br />\nentities to be double-escaped.</p>\n\n<p>As an example, take this view snippet:</p>\n\n<div class=\"language-html highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>  <span class=\"nt\">&lt;p&gt;&lt;</span><span class=\"err\">%=</span> <span class=\"na\">html_escape_once</span><span class=\"err\">(\"</span><span class=\"na\">this</span> <span class=\"err\">&amp;</span> <span class=\"na\">that</span> <span class=\"err\">&amp;</span><span class=\"na\">amp</span><span class=\"err\">;</span> <span class=\"na\">the</span> <span class=\"na\">other</span><span class=\"err\">\")</span> <span class=\"err\">%</span><span class=\"nt\">&gt;&lt;/p&gt;</span>\n</code></pre></div></div>\n\n<p>Before this change, that would be double-escaped and render as:</p>\n\n<div class=\"language-html highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>  <span class=\"nt\">&lt;p&gt;</span>this <span class=\"ni\">&amp;amp;</span>amp; that <span class=\"ni\">&amp;amp;</span>amp; the other<span class=\"nt\">&lt;/p&gt;</span>\n</code></pre></div></div>\n\n<p>After this change, it renders correctly as:</p>\n\n<div class=\"language-html highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>  <span class=\"nt\">&lt;p&gt;</span>this <span class=\"ni\">&amp;amp;</span> that <span class=\"ni\">&amp;amp;</span> the other<span class=\"nt\">&lt;/p&gt;</span>\n</code></pre></div></div>\n\n<p>Fixes #48256</p>\n\n<p><em>Mike Dalessio</em></p>\n"
  },
  {
    "message": "*   Deprecate `SafeBuffer#clone_empty`.\n\n    This method has not been used internally since Rails 4.2.0.\n\n    *Mike Dalessio*",
    "project": "activesupport",
    "date_merged": 1684628149000,
    "author": "Mike Dalessio",
    "sha": "4b6894168b0fba6fc6f42cf2f10b5398a78b8766",
    "pr": "48264",
    "merge_sha": "5deec01ef15bd834184f9c2b0f23bc89fbe1c0ce",
    "html": "<p>Deprecate <code>SafeBuffer#clone_empty</code>.</p>\n\n<p>This method has not been used internally since Rails 4.2.0.</p>\n\n<p><em>Mike Dalessio</em></p>\n"
  },
  {
    "message": "*   `MessageEncryptor`, `MessageVerifier`, and `config.active_support.message_serializer`\n    now accept `:message_pack` and `:message_pack_allow_marshal` as serializers.\n    These serializers require the [`msgpack` gem](https://rubygems.org/gems/msgpack)\n    (>= 1.7.0).\n\n    The Message Pack format can provide improved performance and smaller payload\n    sizes. It also supports round-tripping some Ruby types that are not supported\n    by JSON. For example:\n\n      ```ruby\n      verifier = ActiveSupport::MessageVerifier.new(\"secret\")\n      data = [{ a: 1 }, { b: 2 }.with_indifferent_access, 1.to_d, Time.at(0, 123)]\n      message = verifier.generate(data)\n\n      # BEFORE with config.active_support.message_serializer = :json\n      verifier.verified(message)\n      # => [{\"a\"=>1}, {\"b\"=>2}, \"1.0\", \"1969-12-31T18:00:00.000-06:00\"]\n      verifier.verified(message).map(&:class)\n      # => [Hash, Hash, String, String]\n\n      # AFTER with config.active_support.message_serializer = :message_pack\n      verifier.verified(message)\n      # => [{:a=>1}, {\"b\"=>2}, 0.1e1, 1969-12-31 18:00:00.000123 -0600]\n      verifier.verified(message).map(&:class)\n      # => [Hash, ActiveSupport::HashWithIndifferentAccess, BigDecimal, Time]\n      ```\n\n    The `:message_pack` serializer can fall back to deserializing with\n    `ActiveSupport::JSON` when necessary, and the `:message_pack_allow_marshal`\n    serializer can fall back to deserializing with `Marshal` as well as\n    `ActiveSupport::JSON`. Additionally, the `:marshal`, `:json`, and\n    `:json_allow_marshal` serializers can now fall back to deserializing with\n    `ActiveSupport::MessagePack` when necessary. These behaviors ensure old\n    messages can still be read so that migration is easier.\n\n    *Jonathan Hefner*",
    "project": "activesupport",
    "date_merged": 1683575970000,
    "author": "Jonathan Hefner",
    "sha": "af6d83521ca1d3c46061e55b5cf8206de81e7bbb",
    "pr": "47964",
    "merge_sha": "6b52c1b175fc92439b3fb852f57e11f0489d8363",
    "html": "<p><code>MessageEncryptor</code>, <code>MessageVerifier</code>, and <code>config.active_support.message_serializer</code><br />\nnow accept <code>:message_pack</code> and <code>:message_pack_allow_marshal</code> as serializers.<br />\nThese serializers require the <a href=\"https://rubygems.org/gems/msgpack\"><code>msgpack</code> gem</a><br />\n(&gt;= 1.7.0).</p>\n\n<p>The Message Pack format can provide improved performance and smaller payload<br />\nsizes. It also supports round-tripping some Ruby types that are not supported<br />\nby JSON. For example:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>  <span class=\"n\">verifier</span> <span class=\"o\">=</span> <span class=\"no\">ActiveSupport</span><span class=\"o\">::</span><span class=\"no\">MessageVerifier</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"s2\">\"secret\"</span><span class=\"p\">)</span>\n  <span class=\"n\">data</span> <span class=\"o\">=</span> <span class=\"p\">[{</span> <span class=\"ss\">a: </span><span class=\"mi\">1</span> <span class=\"p\">},</span> <span class=\"p\">{</span> <span class=\"ss\">b: </span><span class=\"mi\">2</span> <span class=\"p\">}.</span><span class=\"nf\">with_indifferent_access</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">.</span><span class=\"nf\">to_d</span><span class=\"p\">,</span> <span class=\"no\">Time</span><span class=\"p\">.</span><span class=\"nf\">at</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">123</span><span class=\"p\">)]</span>\n  <span class=\"n\">message</span> <span class=\"o\">=</span> <span class=\"n\">verifier</span><span class=\"p\">.</span><span class=\"nf\">generate</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"p\">)</span>\n\n  <span class=\"c1\"># BEFORE with config.active_support.message_serializer = :json</span>\n  <span class=\"n\">verifier</span><span class=\"p\">.</span><span class=\"nf\">verified</span><span class=\"p\">(</span><span class=\"n\">message</span><span class=\"p\">)</span>\n  <span class=\"c1\"># =&gt; [{\"a\"=&gt;1}, {\"b\"=&gt;2}, \"1.0\", \"1969-12-31T18:00:00.000-06:00\"]</span>\n  <span class=\"n\">verifier</span><span class=\"p\">.</span><span class=\"nf\">verified</span><span class=\"p\">(</span><span class=\"n\">message</span><span class=\"p\">).</span><span class=\"nf\">map</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"ss\">:class</span><span class=\"p\">)</span>\n  <span class=\"c1\"># =&gt; [Hash, Hash, String, String]</span>\n\n  <span class=\"c1\"># AFTER with config.active_support.message_serializer = :message_pack</span>\n  <span class=\"n\">verifier</span><span class=\"p\">.</span><span class=\"nf\">verified</span><span class=\"p\">(</span><span class=\"n\">message</span><span class=\"p\">)</span>\n  <span class=\"c1\"># =&gt; [{:a=&gt;1}, {\"b\"=&gt;2}, 0.1e1, 1969-12-31 18:00:00.000123 -0600]</span>\n  <span class=\"n\">verifier</span><span class=\"p\">.</span><span class=\"nf\">verified</span><span class=\"p\">(</span><span class=\"n\">message</span><span class=\"p\">).</span><span class=\"nf\">map</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"ss\">:class</span><span class=\"p\">)</span>\n  <span class=\"c1\"># =&gt; [Hash, ActiveSupport::HashWithIndifferentAccess, BigDecimal, Time]</span>\n</code></pre></div></div>\n\n<p>The <code>:message_pack</code> serializer can fall back to deserializing with<br />\n<code>ActiveSupport::JSON</code> when necessary, and the <code>:message_pack_allow_marshal</code><br />\nserializer can fall back to deserializing with <code>Marshal</code> as well as<br />\n<code>ActiveSupport::JSON</code>. Additionally, the <code>:marshal</code>, <code>:json</code>, and<br />\n<code>:json_allow_marshal</code> serializers can now fall back to deserializing with<br />\n<code>ActiveSupport::MessagePack</code> when necessary. These behaviors ensure old<br />\nmessages can still be read so that migration is easier.</p>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   A new `7.1` cache format is available which includes an optimization for\n    bare string values such as view fragments.\n\n    The `7.1` cache format is used by default for new apps, and existing apps\n    can enable the format by setting `config.load_defaults 7.1` or by setting\n    `config.active_support.cache_format_version = 7.1` in `config/application.rb`\n    or a `config/environments/*.rb` file.\n\n    Cache entries written using the `6.1` or `7.0` cache formats can be read\n    when using the `7.1` format. To perform a rolling deploy of a Rails 7.1\n    upgrade, wherein servers that have not yet been upgraded must be able to\n    read caches from upgraded servers, leave the cache format unchanged on the\n    first deploy, then enable the `7.1` cache format on a subsequent deploy.\n\n    *Jonathan Hefner*",
    "project": "activesupport",
    "date_merged": 1683236226000,
    "author": "Jonathan Hefner",
    "sha": "daa0cb80db4eca30d27c83ad2adcc154603c8a7b",
    "pr": "48122",
    "merge_sha": "c94760cc0bb69a1fb52c23085c8f1a70f2de9adc",
    "html": "<p>A new <code>7.1</code> cache format is available which includes an optimization for<br />\nbare string values such as view fragments.</p>\n\n<p>The <code>7.1</code> cache format is used by default for new apps, and existing apps<br />\ncan enable the format by setting <code>config.load_defaults 7.1</code> or by setting<br />\n<code>config.active_support.cache_format_version = 7.1</code> in <code>config/application.rb</code><br />\nor a <code>config/environments/*.rb</code> file.</p>\n\n<p>Cache entries written using the <code>6.1</code> or <code>7.0</code> cache formats can be read<br />\nwhen using the <code>7.1</code> format. To perform a rolling deploy of a Rails 7.1<br />\nupgrade, wherein servers that have not yet been upgraded must be able to<br />\nread caches from upgraded servers, leave the cache format unchanged on the<br />\nfirst deploy, then enable the <code>7.1</code> cache format on a subsequent deploy.</p>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Active Support cache stores can now use a preconfigured serializer based on\n    `ActiveSupport::MessagePack` via the `:serializer` option:\n\n      ```ruby\n      config.cache_store = :redis_cache_store, { serializer: :message_pack }\n      ```\n\n    The `:message_pack` serializer can reduce cache entry sizes and improve\n    performance, but requires the [`msgpack` gem](https://rubygems.org/gems/msgpack)\n    (>= 1.7.0).\n\n    The `:message_pack` serializer can read cache entries written by the default\n    serializer, and the default serializer can now read entries written by the\n    `:message_pack` serializer. These behaviors make it easy to migrate between\n    serializer without invalidating the entire cache.\n\n    *Jonathan Hefner*",
    "project": "activesupport",
    "date_merged": 1690407562000,
    "author": "Jonathan Hefner",
    "sha": "3efb84486e4b467bcfe9fb70c67aa3a639de84ad",
    "pr": "48451",
    "merge_sha": "1334919732da4fc692623f54205ed6f507c07565",
    "html": "<p>Active Support cache stores can now use a preconfigured serializer based on<br />\n<code>ActiveSupport::MessagePack</code> via the <code>:serializer</code> option:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>  <span class=\"n\">config</span><span class=\"p\">.</span><span class=\"nf\">cache_store</span> <span class=\"o\">=</span> <span class=\"ss\">:redis_cache_store</span><span class=\"p\">,</span> <span class=\"p\">{</span> <span class=\"ss\">serializer: :message_pack</span> <span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>The <code>:message_pack</code> serializer can reduce cache entry sizes and improve<br />\nperformance, but requires the <a href=\"https://rubygems.org/gems/msgpack\"><code>msgpack</code> gem</a><br />\n(&gt;= 1.7.0).</p>\n\n<p>The <code>:message_pack</code> serializer can read cache entries written by the default<br />\nserializer, and the default serializer can now read entries written by the<br />\n<code>:message_pack</code> serializer. These behaviors make it easy to migrate between<br />\nserializer without invalidating the entire cache.</p>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   `Object#deep_dup` no longer duplicate named classes and modules.\n\n    Before:\n\n    ```ruby\n    hash = { class: Object, module: Kernel }\n    hash.deep_dup # => {:class=>#<Class:0x00000001063ffc80>, :module=>#<Module:0x00000001063ffa00>}\n    ```\n\n    After:\n\n    ```ruby\n    hash = { class: Object, module: Kernel }\n    hash.deep_dup # => {:class=>Object, :module=>Kernel}\n    ```\n\n    *Jean Boussier*",
    "project": "activesupport",
    "date_merged": 1683019503000,
    "author": "Jean Boussier",
    "sha": "e54ef0ab14bcca7e0e34791ea331efb6b57f0b0a",
    "pr": "48106",
    "merge_sha": "8bdf5e35579c3211d2d6d7624d5167e0f673c3bd",
    "html": "<p><code>Object#deep_dup</code> no longer duplicate named classes and modules.</p>\n\n<p>Before:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nb\">hash</span> <span class=\"o\">=</span> <span class=\"p\">{</span> <span class=\"ss\">class: </span><span class=\"no\">Object</span><span class=\"p\">,</span> <span class=\"ss\">module: </span><span class=\"no\">Kernel</span> <span class=\"p\">}</span>\n<span class=\"nb\">hash</span><span class=\"p\">.</span><span class=\"nf\">deep_dup</span> <span class=\"c1\"># =&gt; {:class=&gt;#&lt;Class:0x00000001063ffc80&gt;, :module=&gt;#&lt;Module:0x00000001063ffa00&gt;}</span>\n</code></pre></div></div>\n\n<p>After:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nb\">hash</span> <span class=\"o\">=</span> <span class=\"p\">{</span> <span class=\"ss\">class: </span><span class=\"no\">Object</span><span class=\"p\">,</span> <span class=\"ss\">module: </span><span class=\"no\">Kernel</span> <span class=\"p\">}</span>\n<span class=\"nb\">hash</span><span class=\"p\">.</span><span class=\"nf\">deep_dup</span> <span class=\"c1\"># =&gt; {:class=&gt;Object, :module=&gt;Kernel}</span>\n</code></pre></div></div>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   Consistently raise an `ArgumentError` if the `ActiveSupport::Cache` key is blank.\n\n    *Joshua Young*",
    "project": "activesupport",
    "date_merged": 1682512767000,
    "author": "Joshua Young",
    "sha": "2b88e78067e263d854ed0c3e6a2aef115e2e2cd4",
    "pr": "48043",
    "merge_sha": "5940955ead7d1876d930f2d1008ff5887bfc6490",
    "html": "<p>Consistently raise an <code>ArgumentError</code> if the <code>ActiveSupport::Cache</code> key is blank.</p>\n\n<p><em>Joshua Young</em></p>\n"
  },
  {
    "message": "*   Deprecate usage of the singleton `ActiveSupport::Deprecation`.\n\n    All usage of `ActiveSupport::Deprecation` as a singleton is deprecated, the most common one being\n    `ActiveSupport::Deprecation.warn`. Gem authors should now create their own deprecator (`ActiveSupport::Deprecation`\n    object), and use it to emit deprecation warnings.\n\n    Calling any of the following without specifying a deprecator argument is also deprecated:\n      * Module.deprecate\n      * deprecate_constant\n      * DeprecatedObjectProxy\n      * DeprecatedInstanceVariableProxy\n      * DeprecatedConstantProxy\n      * deprecation-related test assertions\n\n    Use of `ActiveSupport::Deprecation.silence` and configuration methods like `behavior=`, `disallowed_behavior=`,\n    `disallowed_warnings=` should now be aimed at the [application's deprecators](https://api.rubyonrails.org/classes/Rails/Application.html#method-i-deprecators).\n\n    ```ruby\n    Rails.application.deprecators.silence do\n      # code that emits deprecation warnings\n    end\n    ```\n\n    If your gem has a Railtie or Engine, it's encouraged to add your deprecator to the application's deprecators, that\n    way the deprecation related configuration options will apply to it as well, e.g.\n    `config.active_support.report_deprecations` set to `false` in the production environment will also disable your\n    deprecator.\n\n    ```ruby\n    initializer \"my_gem.deprecator\" do |app|\n      app.deprecators[:my_gem] = MyGem.deprecator\n    end\n    ```\n\n    *Étienne Barrié*",
    "project": "activesupport",
    "date_merged": 1680790838000,
    "author": "Étienne Barrié",
    "sha": "a3061e902e97f5614194455e146102a45b880b18",
    "pr": "47354",
    "merge_sha": "2f08f9ac2ca6a130498fe192bdf28c8cb06617aa",
    "html": "<p>Deprecate usage of the singleton <code>ActiveSupport::Deprecation</code>.</p>\n\n<p>All usage of <code>ActiveSupport::Deprecation</code> as a singleton is deprecated, the most common one being<br />\n<code>ActiveSupport::Deprecation.warn</code>. Gem authors should now create their own deprecator (<code>ActiveSupport::Deprecation</code><br />\nobject), and use it to emit deprecation warnings.</p>\n\n<p>Calling any of the following without specifying a deprecator argument is also deprecated:</p>\n<ul>\n  <li>Module.deprecate</li>\n  <li>deprecate_constant</li>\n  <li>DeprecatedObjectProxy</li>\n  <li>DeprecatedInstanceVariableProxy</li>\n  <li>DeprecatedConstantProxy</li>\n  <li>deprecation-related test assertions</li>\n</ul>\n\n<p>Use of <code>ActiveSupport::Deprecation.silence</code> and configuration methods like <code>behavior=</code>, <code>disallowed_behavior=</code>,<br />\n<code>disallowed_warnings=</code> should now be aimed at the <a href=\"https://api.rubyonrails.org/classes/Rails/Application.html#method-i-deprecators\">application’s deprecators</a>.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">Rails</span><span class=\"p\">.</span><span class=\"nf\">application</span><span class=\"p\">.</span><span class=\"nf\">deprecators</span><span class=\"p\">.</span><span class=\"nf\">silence</span> <span class=\"k\">do</span>\n  <span class=\"c1\"># code that emits deprecation warnings</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p>If your gem has a Railtie or Engine, it’s encouraged to add your deprecator to the application’s deprecators, that<br />\nway the deprecation related configuration options will apply to it as well, e.g.<br />\n<code>config.active_support.report_deprecations</code> set to <code>false</code> in the production environment will also disable your<br />\ndeprecator.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">initializer</span> <span class=\"s2\">\"my_gem.deprecator\"</span> <span class=\"k\">do</span> <span class=\"o\">|</span><span class=\"n\">app</span><span class=\"o\">|</span>\n  <span class=\"n\">app</span><span class=\"p\">.</span><span class=\"nf\">deprecators</span><span class=\"p\">[</span><span class=\"ss\">:my_gem</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"no\">MyGem</span><span class=\"p\">.</span><span class=\"nf\">deprecator</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p><em>Étienne Barrié</em></p>\n"
  },
  {
    "message": "*   Add `Object#with` to set and restore public attributes around a block\n\n    ```ruby\n    client.timeout # => 5\n    client.with(timeout: 1) do\n      client.timeout # => 1\n    end\n    client.timeout # => 5\n    ```\n\n    *Jean Boussier*",
    "project": "activesupport",
    "date_merged": 1678090650000,
    "author": "Jean Boussier",
    "sha": "1884323574b35b3a2286850f3c98f677633728f1",
    "pr": "46681",
    "merge_sha": "091e04ab53880302ab092cabc65f786191a628b3",
    "html": "<p>Add <code>Object#with</code> to set and restore public attributes around a block</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">client</span><span class=\"p\">.</span><span class=\"nf\">timeout</span> <span class=\"c1\"># =&gt; 5</span>\n<span class=\"n\">client</span><span class=\"p\">.</span><span class=\"nf\">with</span><span class=\"p\">(</span><span class=\"ss\">timeout: </span><span class=\"mi\">1</span><span class=\"p\">)</span> <span class=\"k\">do</span>\n  <span class=\"n\">client</span><span class=\"p\">.</span><span class=\"nf\">timeout</span> <span class=\"c1\"># =&gt; 1</span>\n<span class=\"k\">end</span>\n<span class=\"n\">client</span><span class=\"p\">.</span><span class=\"nf\">timeout</span> <span class=\"c1\"># =&gt; 5</span>\n</code></pre></div></div>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   Remove deprecated support to generate incorrect RFC 4122 UUIDs when providing a namespace ID that is not one of the\n    constants defined on `Digest::UUID`.\n\n    *Rafael Mendonça França*",
    "project": "activesupport",
    "date_merged": 1677805729000,
    "author": "Rafael Mendonça França",
    "sha": "7b4affc78bf2fdd349a86c60b940b7c172e111df",
    "pr": "47556",
    "merge_sha": "dd7ecb073c67fee00e409049f02d72accece94a2",
    "html": "<p>Remove deprecated support to generate incorrect RFC 4122 UUIDs when providing a namespace ID that is not one of the<br />\nconstants defined on <code>Digest::UUID</code>.</p>\n\n<p><em>Rafael Mendonça França</em></p>\n"
  },
  {
    "message": "*   Deprecate `config.active_support.use_rfc4122_namespaced_uuids`.\n\n    *Rafael Mendonça França*",
    "project": "activesupport",
    "date_merged": 1677805729000,
    "author": "Rafael Mendonça França",
    "sha": "7b4affc78bf2fdd349a86c60b940b7c172e111df",
    "pr": "47556",
    "merge_sha": "dd7ecb073c67fee00e409049f02d72accece94a2",
    "html": "<p>Deprecate <code>config.active_support.use_rfc4122_namespaced_uuids</code>.</p>\n\n<p><em>Rafael Mendonça França</em></p>\n"
  },
  {
    "message": "*   Remove implicit conversion of objects into `String` by `ActiveSupport::SafeBuffer`.\n\n    *Rafael Mendonça França*",
    "project": "activesupport",
    "date_merged": 1677805729000,
    "author": "Rafael Mendonça França",
    "sha": "f02998d2b5982434faf2d258fe2977074ee4424f",
    "pr": "47556",
    "merge_sha": "dd7ecb073c67fee00e409049f02d72accece94a2",
    "html": "<p>Remove implicit conversion of objects into <code>String</code> by <code>ActiveSupport::SafeBuffer</code>.</p>\n\n<p><em>Rafael Mendonça França</em></p>\n"
  },
  {
    "message": "*   Remove deprecated `active_support/core_ext/range/include_time_with_zone` file.\n\n    *Rafael Mendonça França*",
    "project": "activesupport",
    "date_merged": 1677805729000,
    "author": "Rafael Mendonça França",
    "sha": "f0ddb7709bcd076256d8e4ce494963a7bef3ec29",
    "pr": "47556",
    "merge_sha": "dd7ecb073c67fee00e409049f02d72accece94a2",
    "html": "<p>Remove deprecated <code>active_support/core_ext/range/include_time_with_zone</code> file.</p>\n\n<p><em>Rafael Mendonça França</em></p>\n"
  },
  {
    "message": "*   Deprecate `config.active_support.remove_deprecated_time_with_zone_name`.\n\n    *Rafael Mendonça França*",
    "project": "activesupport",
    "date_merged": 1677805729000,
    "author": "Rafael Mendonça França",
    "sha": "34e296d4927938a69caf118c98ab9f8a7afa10a5",
    "pr": "47556",
    "merge_sha": "dd7ecb073c67fee00e409049f02d72accece94a2",
    "html": "<p>Deprecate <code>config.active_support.remove_deprecated_time_with_zone_name</code>.</p>\n\n<p><em>Rafael Mendonça França</em></p>\n"
  },
  {
    "message": "*   Remove deprecated override of `ActiveSupport::TimeWithZone.name`.\n\n    *Rafael Mendonça França*",
    "project": "activesupport",
    "date_merged": 1677805729000,
    "author": "Rafael Mendonça França",
    "sha": "34e296d4927938a69caf118c98ab9f8a7afa10a5",
    "pr": "47556",
    "merge_sha": "dd7ecb073c67fee00e409049f02d72accece94a2",
    "html": "<p>Remove deprecated override of <code>ActiveSupport::TimeWithZone.name</code>.</p>\n\n<p><em>Rafael Mendonça França</em></p>\n"
  },
  {
    "message": "*   Deprecate `config.active_support.disable_to_s_conversion`.\n\n    *Rafael Mendonça França*",
    "project": "activesupport",
    "date_merged": 1677805729000,
    "author": "Rafael Mendonça França",
    "sha": "e420c3380eb2b698a4fe84ed196f914d18f7844a",
    "pr": "47556",
    "merge_sha": "dd7ecb073c67fee00e409049f02d72accece94a2",
    "html": "<p>Deprecate <code>config.active_support.disable_to_s_conversion</code>.</p>\n\n<p><em>Rafael Mendonça França</em></p>\n"
  },
  {
    "message": "*   Remove deprecated option to passing a format to `#to_s` in `Array`, `Range`, `Date`, `DateTime`, `Time`,\n    `BigDecimal`, `Float` and, `Integer`.\n\n    *Rafael Mendonça França*",
    "project": "activesupport",
    "date_merged": 1677811871000,
    "author": "Yasuo Honda",
    "sha": "78fd178512483b4694392b027dfaaeeefb57a676",
    "pr": "47568",
    "merge_sha": "f067caae165af3646ddc06b21fee3c628d8909b0",
    "html": "<p>Remove deprecated option to passing a format to <code>#to_s</code> in <code>Array</code>, <code>Range</code>, <code>Date</code>, <code>DateTime</code>, <code>Time</code>,<br />\n<code>BigDecimal</code>, <code>Float</code> and, <code>Integer</code>.</p>\n\n<p><em>Rafael Mendonça França</em></p>\n"
  },
  {
    "message": "*   Remove deprecated `ActiveSupport::PerThreadRegistry`.\n\n    *Rafael Mendonça França*",
    "project": "activesupport",
    "date_merged": 1677805729000,
    "author": "Rafael Mendonça França",
    "sha": "4eb6441dd8f0409ae432f1596cf35d7c5468292c",
    "pr": "47556",
    "merge_sha": "dd7ecb073c67fee00e409049f02d72accece94a2",
    "html": "<p>Remove deprecated <code>ActiveSupport::PerThreadRegistry</code>.</p>\n\n<p><em>Rafael Mendonça França</em></p>\n"
  },
  {
    "message": "*   Remove deprecated override of `Enumerable#sum`.\n\n    *Rafael Mendonça França*",
    "project": "activesupport",
    "date_merged": 1677805729000,
    "author": "Rafael Mendonça França",
    "sha": "3ec629784cac7a8b518feb402475153465cd8e96",
    "pr": "47556",
    "merge_sha": "dd7ecb073c67fee00e409049f02d72accece94a2",
    "html": "<p>Remove deprecated override of <code>Enumerable#sum</code>.</p>\n\n<p><em>Rafael Mendonça França</em></p>\n"
  },
  {
    "message": "*   Deprecated initializing a `ActiveSupport::Cache::MemCacheStore` with an instance of `Dalli::Client`.\n\n    Deprecate the undocumented option of providing an already-initialized instance of `Dalli::Client` to `ActiveSupport::Cache::MemCacheStore`. Such clients could be configured with unrecognized options, which could lead to unexpected behavior. Instead, provide addresses as documented.\n\n    *aledustet*",
    "project": "activesupport",
    "date_merged": 1677616513000,
    "author": "Alejandro Dustet",
    "sha": "78b74e92271e72b60e570646ce736eeb64d86ab0",
    "pr": "47340",
    "merge_sha": "6c51cd399e1e682fdbc0e636f0b96f384a172d16",
    "html": "<p>Deprecated initializing a <code>ActiveSupport::Cache::MemCacheStore</code> with an instance of <code>Dalli::Client</code>.</p>\n\n<p>Deprecate the undocumented option of providing an already-initialized instance of <code>Dalli::Client</code> to <code>ActiveSupport::Cache::MemCacheStore</code>. Such clients could be configured with unrecognized options, which could lead to unexpected behavior. Instead, provide addresses as documented.</p>\n\n<p><em>aledustet</em></p>\n"
  },
  {
    "message": "*   Stub `Time.new()` in `TimeHelpers#travel_to`\n\n      ```ruby\n      travel_to Time.new(2004, 11, 24) do\n        # Inside the `travel_to` block `Time.new` is stubbed\n        assert_equal Time.new.year, 2004\n      end\n      ```\n\n    *fatkodima*",
    "project": "activesupport",
    "date_merged": 1676400954000,
    "author": "fatkodima",
    "sha": "0c4e9d35bb75819f467db48f60ae142e9f8546d3",
    "pr": "47315",
    "merge_sha": "f0845ec14d4541d1780a5988d4c43c30a9ba3d90",
    "html": "<p>Stub <code>Time.new()</code> in <code>TimeHelpers#travel_to</code></p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>  <span class=\"n\">travel_to</span> <span class=\"no\">Time</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"mi\">2004</span><span class=\"p\">,</span> <span class=\"mi\">11</span><span class=\"p\">,</span> <span class=\"mi\">24</span><span class=\"p\">)</span> <span class=\"k\">do</span>\n    <span class=\"c1\"># Inside the `travel_to` block `Time.new` is stubbed</span>\n    <span class=\"n\">assert_equal</span> <span class=\"no\">Time</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">.</span><span class=\"nf\">year</span><span class=\"p\">,</span> <span class=\"mi\">2004</span>\n  <span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p><em>fatkodima</em></p>\n"
  },
  {
    "message": "*   Raise `ActiveSupport::MessageEncryptor::InvalidMessage` from\n    `ActiveSupport::MessageEncryptor#decrypt_and_verify` regardless of cipher.\n    Previously, when a `MessageEncryptor` was using a non-AEAD cipher such as\n    AES-256-CBC, a corrupt or tampered message would raise\n    `ActiveSupport::MessageVerifier::InvalidSignature`.  Now, all ciphers raise\n    the same error:\n\n      ```ruby\n      encryptor = ActiveSupport::MessageEncryptor.new(\"x\" * 32, cipher: \"aes-256-gcm\")\n      message = encryptor.encrypt_and_sign(\"message\")\n      encryptor.decrypt_and_verify(message.next)\n      # => raises ActiveSupport::MessageEncryptor::InvalidMessage\n\n      encryptor = ActiveSupport::MessageEncryptor.new(\"x\" * 32, cipher: \"aes-256-cbc\")\n      message = encryptor.encrypt_and_sign(\"message\")\n      encryptor.decrypt_and_verify(message.next)\n      # BEFORE:\n      # => raises ActiveSupport::MessageVerifier::InvalidSignature\n      # AFTER:\n      # => raises ActiveSupport::MessageEncryptor::InvalidMessage\n      ```\n\n    *Jonathan Hefner*",
    "project": "activesupport",
    "date_merged": 1676238651000,
    "author": "Jonathan Hefner",
    "sha": "d3917f5fdd73630b40b6acec8cd1de8b01cad14a",
    "pr": "47326",
    "merge_sha": "7e57537bb957106428393c7488db1e2012938ed1",
    "html": "<p>Raise <code>ActiveSupport::MessageEncryptor::InvalidMessage</code> from<br />\n<code>ActiveSupport::MessageEncryptor#decrypt_and_verify</code> regardless of cipher.<br />\nPreviously, when a <code>MessageEncryptor</code> was using a non-AEAD cipher such as<br />\nAES-256-CBC, a corrupt or tampered message would raise<br />\n<code>ActiveSupport::MessageVerifier::InvalidSignature</code>.  Now, all ciphers raise<br />\nthe same error:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>  <span class=\"n\">encryptor</span> <span class=\"o\">=</span> <span class=\"no\">ActiveSupport</span><span class=\"o\">::</span><span class=\"no\">MessageEncryptor</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"s2\">\"x\"</span> <span class=\"o\">*</span> <span class=\"mi\">32</span><span class=\"p\">,</span> <span class=\"ss\">cipher: </span><span class=\"s2\">\"aes-256-gcm\"</span><span class=\"p\">)</span>\n  <span class=\"n\">message</span> <span class=\"o\">=</span> <span class=\"n\">encryptor</span><span class=\"p\">.</span><span class=\"nf\">encrypt_and_sign</span><span class=\"p\">(</span><span class=\"s2\">\"message\"</span><span class=\"p\">)</span>\n  <span class=\"n\">encryptor</span><span class=\"p\">.</span><span class=\"nf\">decrypt_and_verify</span><span class=\"p\">(</span><span class=\"n\">message</span><span class=\"p\">.</span><span class=\"nf\">next</span><span class=\"p\">)</span>\n  <span class=\"c1\"># =&gt; raises ActiveSupport::MessageEncryptor::InvalidMessage</span>\n\n  <span class=\"n\">encryptor</span> <span class=\"o\">=</span> <span class=\"no\">ActiveSupport</span><span class=\"o\">::</span><span class=\"no\">MessageEncryptor</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"s2\">\"x\"</span> <span class=\"o\">*</span> <span class=\"mi\">32</span><span class=\"p\">,</span> <span class=\"ss\">cipher: </span><span class=\"s2\">\"aes-256-cbc\"</span><span class=\"p\">)</span>\n  <span class=\"n\">message</span> <span class=\"o\">=</span> <span class=\"n\">encryptor</span><span class=\"p\">.</span><span class=\"nf\">encrypt_and_sign</span><span class=\"p\">(</span><span class=\"s2\">\"message\"</span><span class=\"p\">)</span>\n  <span class=\"n\">encryptor</span><span class=\"p\">.</span><span class=\"nf\">decrypt_and_verify</span><span class=\"p\">(</span><span class=\"n\">message</span><span class=\"p\">.</span><span class=\"nf\">next</span><span class=\"p\">)</span>\n  <span class=\"c1\"># BEFORE:</span>\n  <span class=\"c1\"># =&gt; raises ActiveSupport::MessageVerifier::InvalidSignature</span>\n  <span class=\"c1\"># AFTER:</span>\n  <span class=\"c1\"># =&gt; raises ActiveSupport::MessageEncryptor::InvalidMessage</span>\n</code></pre></div></div>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Support `nil` original values when using `ActiveSupport::MessageVerifier#verify`.\n    Previously, `MessageVerifier#verify` did not work with `nil` original\n    values, though both `MessageVerifier#verified` and\n    `MessageEncryptor#decrypt_and_verify` do:\n\n      ```ruby\n      encryptor = ActiveSupport::MessageEncryptor.new(secret)\n      message = encryptor.encrypt_and_sign(nil)\n\n      encryptor.decrypt_and_verify(message)\n      # => nil\n\n      verifier = ActiveSupport::MessageVerifier.new(secret)\n      message = verifier.generate(nil)\n\n      verifier.verified(message)\n      # => nil\n\n      verifier.verify(message)\n      # BEFORE:\n      # => raises ActiveSupport::MessageVerifier::InvalidSignature\n      # AFTER:\n      # => nil\n      ```\n\n    *Jonathan Hefner*",
    "project": "activesupport",
    "date_merged": 1676238651000,
    "author": "Jonathan Hefner",
    "sha": "d3917f5fdd73630b40b6acec8cd1de8b01cad14a",
    "pr": "47326",
    "merge_sha": "7e57537bb957106428393c7488db1e2012938ed1",
    "html": "<p>Support <code>nil</code> original values when using <code>ActiveSupport::MessageVerifier#verify</code>.<br />\nPreviously, <code>MessageVerifier#verify</code> did not work with <code>nil</code> original<br />\nvalues, though both <code>MessageVerifier#verified</code> and<br />\n<code>MessageEncryptor#decrypt_and_verify</code> do:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>  <span class=\"n\">encryptor</span> <span class=\"o\">=</span> <span class=\"no\">ActiveSupport</span><span class=\"o\">::</span><span class=\"no\">MessageEncryptor</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"n\">secret</span><span class=\"p\">)</span>\n  <span class=\"n\">message</span> <span class=\"o\">=</span> <span class=\"n\">encryptor</span><span class=\"p\">.</span><span class=\"nf\">encrypt_and_sign</span><span class=\"p\">(</span><span class=\"kp\">nil</span><span class=\"p\">)</span>\n\n  <span class=\"n\">encryptor</span><span class=\"p\">.</span><span class=\"nf\">decrypt_and_verify</span><span class=\"p\">(</span><span class=\"n\">message</span><span class=\"p\">)</span>\n  <span class=\"c1\"># =&gt; nil</span>\n\n  <span class=\"n\">verifier</span> <span class=\"o\">=</span> <span class=\"no\">ActiveSupport</span><span class=\"o\">::</span><span class=\"no\">MessageVerifier</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"n\">secret</span><span class=\"p\">)</span>\n  <span class=\"n\">message</span> <span class=\"o\">=</span> <span class=\"n\">verifier</span><span class=\"p\">.</span><span class=\"nf\">generate</span><span class=\"p\">(</span><span class=\"kp\">nil</span><span class=\"p\">)</span>\n\n  <span class=\"n\">verifier</span><span class=\"p\">.</span><span class=\"nf\">verified</span><span class=\"p\">(</span><span class=\"n\">message</span><span class=\"p\">)</span>\n  <span class=\"c1\"># =&gt; nil</span>\n\n  <span class=\"n\">verifier</span><span class=\"p\">.</span><span class=\"nf\">verify</span><span class=\"p\">(</span><span class=\"n\">message</span><span class=\"p\">)</span>\n  <span class=\"c1\"># BEFORE:</span>\n  <span class=\"c1\"># =&gt; raises ActiveSupport::MessageVerifier::InvalidSignature</span>\n  <span class=\"c1\"># AFTER:</span>\n  <span class=\"c1\"># =&gt; nil</span>\n</code></pre></div></div>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Maintain `html_safe?` on html_safe strings when sliced with `slice`, `slice!`, or `chr` method.\n\n    Previously, `html_safe?` was only maintained when the html_safe strings were sliced\n    with `[]` method. Now, `slice`, `slice!`, and `chr` methods will maintain `html_safe?` like `[]` method.\n\n    ```ruby\n    string = \"<div>test</div>\".html_safe\n    string.slice(0, 1).html_safe? # => true\n    string.slice!(0, 1).html_safe? # => true\n    # maintain html_safe? after the slice!\n    string.html_safe? # => true\n    string.chr # => true\n    ```\n\n    *Michael Go*",
    "project": "activesupport",
    "date_merged": 1675977848000,
    "author": "Michael Go",
    "sha": "2e52d0a39d13ff8cb0c26a88be2380f7bc3452fd",
    "pr": "47343",
    "merge_sha": "8231a4c61e649ab84877053de9b03b4896edf1d1",
    "html": "<p>Maintain <code>html_safe?</code> on html_safe strings when sliced with <code>slice</code>, <code>slice!</code>, or <code>chr</code> method.</p>\n\n<p>Previously, <code>html_safe?</code> was only maintained when the html_safe strings were sliced<br />\nwith <code>[]</code> method. Now, <code>slice</code>, <code>slice!</code>, and <code>chr</code> methods will maintain <code>html_safe?</code> like <code>[]</code> method.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">string</span> <span class=\"o\">=</span> <span class=\"s2\">\"&lt;div&gt;test&lt;/div&gt;\"</span><span class=\"p\">.</span><span class=\"nf\">html_safe</span>\n<span class=\"n\">string</span><span class=\"p\">.</span><span class=\"nf\">slice</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">).</span><span class=\"nf\">html_safe?</span> <span class=\"c1\"># =&gt; true</span>\n<span class=\"n\">string</span><span class=\"p\">.</span><span class=\"nf\">slice!</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">).</span><span class=\"nf\">html_safe?</span> <span class=\"c1\"># =&gt; true</span>\n<span class=\"c1\"># maintain html_safe? after the slice!</span>\n<span class=\"n\">string</span><span class=\"p\">.</span><span class=\"nf\">html_safe?</span> <span class=\"c1\"># =&gt; true</span>\n<span class=\"n\">string</span><span class=\"p\">.</span><span class=\"nf\">chr</span> <span class=\"c1\"># =&gt; true</span>\n</code></pre></div></div>\n\n<p><em>Michael Go</em></p>\n"
  },
  {
    "message": "*   Add `Object#in?` support for open ranges.\n\n    ```ruby\n    assert Date.today.in?(..Date.tomorrow)\n    assert_not Date.today.in?(Date.tomorrow..)\n    ```\n\n    *Ignacio Galindo*",
    "project": "activesupport",
    "date_merged": 1677288938000,
    "author": "Carlos Antonio da Silva",
    "sha": "b6964e8c8841e171e3bfb8cf693b54c87d75c06c",
    "pr": "47316",
    "merge_sha": "b146cd473b5ad90c629d9350f0535d0bcf77febe",
    "html": "<p>Add <code>Object#in?</code> support for open ranges.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">assert</span> <span class=\"no\">Date</span><span class=\"p\">.</span><span class=\"nf\">today</span><span class=\"p\">.</span><span class=\"nf\">in?</span><span class=\"p\">(</span><span class=\"o\">..</span><span class=\"no\">Date</span><span class=\"p\">.</span><span class=\"nf\">tomorrow</span><span class=\"p\">)</span>\n<span class=\"n\">assert_not</span> <span class=\"no\">Date</span><span class=\"p\">.</span><span class=\"nf\">today</span><span class=\"p\">.</span><span class=\"nf\">in?</span><span class=\"p\">(</span><span class=\"no\">Date</span><span class=\"p\">.</span><span class=\"nf\">tomorrow</span><span class=\"o\">..</span><span class=\"p\">)</span>\n</code></pre></div></div>\n\n<p><em>Ignacio Galindo</em></p>\n"
  },
  {
    "message": "*   `config.i18n.raise_on_missing_translations = true` now raises on any missing translation.\n\n    Previously it would only raise when called in a view or controller. Now it will raise\n    anytime `I18n.t` is provided an unrecognised key.\n\n    If you do not want this behaviour, you can customise the i18n exception handler. See the\n    upgrading guide or i18n guide for more information.\n\n    *Alex Ghiculescu*",
    "project": "activesupport",
    "date_merged": 1674501050000,
    "author": "Alex Ghiculescu",
    "sha": "e18c23fc2b5a3a35af0b177396f0f63b653e27de",
    "pr": "47105",
    "merge_sha": "4af571c22d39cb727260856410f7dc2dee46bc9f",
    "html": "<p><code>config.i18n.raise_on_missing_translations = true</code> now raises on any missing translation.</p>\n\n<p>Previously it would only raise when called in a view or controller. Now it will raise<br />\nanytime <code>I18n.t</code> is provided an unrecognised key.</p>\n\n<p>If you do not want this behaviour, you can customise the i18n exception handler. See the<br />\nupgrading guide or i18n guide for more information.</p>\n\n<p><em>Alex Ghiculescu</em></p>\n"
  },
  {
    "message": "*   `ActiveSupport::CurrentAttributes` now raises if a restricted attribute name is used.\n\n    Attributes such as `set` and `reset` cannot be used as they clash with the\n    `CurrentAttributes` public API.\n\n    *Alex Ghiculescu*",
    "project": "activesupport",
    "date_merged": 1673863835000,
    "author": "Alex Ghiculescu",
    "sha": "1284df528649d3b8cb6c5ad9c34e645e43e4e505",
    "pr": "47017",
    "merge_sha": "f1b1ad6d7e43a7fd9e3d3eef90e25d3b9c56222c",
    "html": "<p><code>ActiveSupport::CurrentAttributes</code> now raises if a restricted attribute name is used.</p>\n\n<p>Attributes such as <code>set</code> and <code>reset</code> cannot be used as they clash with the<br />\n<code>CurrentAttributes</code> public API.</p>\n\n<p><em>Alex Ghiculescu</em></p>\n"
  },
  {
    "message": "*   `HashWithIndifferentAccess#transform_keys` now takes a Hash argument, just\n    as Ruby's `Hash#transform_keys` does.\n\n    *Akira Matsuda*",
    "project": "activesupport",
    "date_merged": 1673462027000,
    "author": "Akira Matsuda",
    "sha": "7a63a7a66868b9629ff7101917b459698c480213",
    "pr": "46846",
    "merge_sha": "a81be79d4b553fe1bf296e387babaa9b073934b2",
    "html": "<p><code>HashWithIndifferentAccess#transform_keys</code> now takes a Hash argument, just<br />\nas Ruby’s <code>Hash#transform_keys</code> does.</p>\n\n<p><em>Akira Matsuda</em></p>\n"
  },
  {
    "message": "*   `delegate` now defines method with proper arity when delegating to a Class.\n    With this change, it defines faster method (3.5x faster with no argument).\n    However, in order to gain this benefit, the delegation target method has to\n    be defined before declaring the delegation.\n\n    ```ruby\n    # This defines 3.5 times faster method than before\n    class C\n      def self.x() end\n      delegate :x, to: :class\n    end\n\n    class C\n      # This works but silently falls back to old behavior because\n      # `delegate` cannot find the definition of `x`\n      delegate :x, to: :class\n      def self.x() end\n    end\n    ```\n\n    *Akira Matsuda*",
    "project": "activesupport",
    "date_merged": 1673386010000,
    "author": "Akira Matsuda",
    "sha": "8b2f57dc6fc4400a1554a11b24dfb6c854310d81",
    "pr": "46875",
    "merge_sha": "13783f36ad6c4adbe2121272bd0c4d239bb153ab",
    "html": "<p><code>delegate</code> now defines method with proper arity when delegating to a Class.<br />\nWith this change, it defines faster method (3.5x faster with no argument).<br />\nHowever, in order to gain this benefit, the delegation target method has to<br />\nbe defined before declaring the delegation.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># This defines 3.5 times faster method than before</span>\n<span class=\"k\">class</span> <span class=\"nc\">C</span>\n  <span class=\"k\">def</span> <span class=\"nc\">self</span><span class=\"o\">.</span><span class=\"nf\">x</span><span class=\"p\">()</span> <span class=\"k\">end</span>\n  <span class=\"n\">delegate</span> <span class=\"ss\">:x</span><span class=\"p\">,</span> <span class=\"ss\">to: :class</span>\n<span class=\"k\">end</span>\n\n<span class=\"k\">class</span> <span class=\"nc\">C</span>\n  <span class=\"c1\"># This works but silently falls back to old behavior because</span>\n  <span class=\"c1\"># `delegate` cannot find the definition of `x`</span>\n  <span class=\"n\">delegate</span> <span class=\"ss\">:x</span><span class=\"p\">,</span> <span class=\"ss\">to: :class</span>\n  <span class=\"k\">def</span> <span class=\"nc\">self</span><span class=\"o\">.</span><span class=\"nf\">x</span><span class=\"p\">()</span> <span class=\"k\">end</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p><em>Akira Matsuda</em></p>\n"
  },
  {
    "message": "*   `assert_difference` message now includes what changed.\n\n    This makes it easier to debug non-obvious failures.\n\n    Before:\n\n    ```\n    \"User.count\" didn't change by 32.\n    Expected: 1611\n      Actual: 1579\n    ```\n\n    After:\n\n    ```\n    \"User.count\" didn't change by 32, but by 0.\n    Expected: 1611\n      Actual: 1579\n    ```\n\n    *Alex Ghiculescu*",
    "project": "activesupport",
    "date_merged": 1673115255000,
    "author": "Alex Ghiculescu",
    "sha": "293349c959c05de69879f9de666dd871ab65dbee",
    "pr": "46863",
    "merge_sha": "05acc18d7331c12107b8ea0b99278ad6a3f8bfa1",
    "html": "<p><code>assert_difference</code> message now includes what changed.</p>\n\n<p>This makes it easier to debug non-obvious failures.</p>\n\n<p>Before:</p>\n\n<pre><code>\"User.count\" didn't change by 32.\nExpected: 1611\n  Actual: 1579\n</code></pre>\n\n<p>After:</p>\n\n<pre><code>\"User.count\" didn't change by 32, but by 0.\nExpected: 1611\n  Actual: 1579\n</code></pre>\n\n<p><em>Alex Ghiculescu</em></p>\n"
  },
  {
    "message": "*   Add ability to match exception messages to `assert_raises` assertion\n\n    Instead of this\n    ```ruby\n    error = assert_raises(ArgumentError) do\n      perform_service(param: 'exception')\n    end\n    assert_match(/incorrect param/i, error.message)\n    ```\n\n    you can now write this\n    ```ruby\n    assert_raises(ArgumentError, match: /incorrect param/i) do\n      perform_service(param: 'exception')\n    end\n    ```\n\n    *fatkodima*",
    "project": "activesupport",
    "date_merged": 1672775419000,
    "author": "fatkodima",
    "sha": "767ecc41313e071cb7efc89dedaaca0d16f9a684",
    "pr": "46611",
    "merge_sha": "c70a8f75d7a41212cbe358b2a0122a28321b040d",
    "html": "<p>Add ability to match exception messages to <code>assert_raises</code> assertion</p>\n\n<p>Instead of this</p>\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">error</span> <span class=\"o\">=</span> <span class=\"n\">assert_raises</span><span class=\"p\">(</span><span class=\"no\">ArgumentError</span><span class=\"p\">)</span> <span class=\"k\">do</span>\n  <span class=\"n\">perform_service</span><span class=\"p\">(</span><span class=\"ss\">param: </span><span class=\"s1\">'exception'</span><span class=\"p\">)</span>\n<span class=\"k\">end</span>\n<span class=\"n\">assert_match</span><span class=\"p\">(</span><span class=\"sr\">/incorrect param/i</span><span class=\"p\">,</span> <span class=\"n\">error</span><span class=\"p\">.</span><span class=\"nf\">message</span><span class=\"p\">)</span>\n</code></pre></div></div>\n\n<p>you can now write this</p>\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">assert_raises</span><span class=\"p\">(</span><span class=\"no\">ArgumentError</span><span class=\"p\">,</span> <span class=\"ss\">match: </span><span class=\"sr\">/incorrect param/i</span><span class=\"p\">)</span> <span class=\"k\">do</span>\n  <span class=\"n\">perform_service</span><span class=\"p\">(</span><span class=\"ss\">param: </span><span class=\"s1\">'exception'</span><span class=\"p\">)</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p><em>fatkodima</em></p>\n"
  },
  {
    "message": "*   Add `Rails.env.local?` shorthand for `Rails.env.development? || Rails.env.test?`.\n\n    *DHH*",
    "project": "activesupport",
    "date_merged": 1671653275000,
    "author": "David Heinemeier Hansson",
    "sha": "47eaf8881c049495ca414496a23127e5952d59f0",
    "pr": "46786",
    "merge_sha": "52146dee06de7535339c2550434eb3dfd1b7115c",
    "html": "<p>Add <code>Rails.env.local?</code> shorthand for <code>Rails.env.development? || Rails.env.test?</code>.</p>\n\n<p><em>DHH</em></p>\n"
  },
  {
    "message": "*   `ActiveSupport::Testing::TimeHelpers` now accepts named `with_usec` argument\n    to `freeze_time`, `travel`, and `travel_to` methods. Passing true prevents\n    truncating the destination time with `change(usec: 0)`.\n\n    *KevSlashNull*, and *serprex*",
    "project": "activesupport",
    "date_merged": 1671032468000,
    "author": "Philip Dubé",
    "sha": "499e9dc7374a842ba9cf9011eb15c80fc0b6db59",
    "pr": "46663",
    "merge_sha": "810343abe1e8f548188df312d991fe6d6790038e",
    "html": "<p><code>ActiveSupport::Testing::TimeHelpers</code> now accepts named <code>with_usec</code> argument<br />\nto <code>freeze_time</code>, <code>travel</code>, and <code>travel_to</code> methods. Passing true prevents<br />\ntruncating the destination time with <code>change(usec: 0)</code>.</p>\n\n<p><em>KevSlashNull</em>, and <em>serprex</em></p>\n"
  },
  {
    "message": "*   `ActiveSupport::CurrentAttributes.resets` now accepts a method name\n\n    The block API is still the recommended approach, but now both APIs are supported:\n\n    ```ruby\n    class Current < ActiveSupport::CurrentAttributes\n      resets { Time.zone = nil }\n      resets :clear_time_zone\n    end\n    ```\n\n    *Alex Ghiculescu*",
    "project": "activesupport",
    "date_merged": 1668725670000,
    "author": "Alex Ghiculescu",
    "sha": "be155f135af01e393bad6aeec13268db9f6fe560",
    "pr": "45698",
    "merge_sha": "994bce4e32306b957eb61b8d6edd1cbb3f3120b8",
    "html": "<p><code>ActiveSupport::CurrentAttributes.resets</code> now accepts a method name</p>\n\n<p>The block API is still the recommended approach, but now both APIs are supported:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">class</span> <span class=\"nc\">Current</span> <span class=\"o\">&lt;</span> <span class=\"no\">ActiveSupport</span><span class=\"o\">::</span><span class=\"no\">CurrentAttributes</span>\n  <span class=\"n\">resets</span> <span class=\"p\">{</span> <span class=\"no\">Time</span><span class=\"p\">.</span><span class=\"nf\">zone</span> <span class=\"o\">=</span> <span class=\"kp\">nil</span> <span class=\"p\">}</span>\n  <span class=\"n\">resets</span> <span class=\"ss\">:clear_time_zone</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p><em>Alex Ghiculescu</em></p>\n"
  },
  {
    "message": "*   Ensure `ActiveSupport::Testing::Isolation::Forking` closes pipes\n\n    Previously, `Forking.run_in_isolation` opened two ends of a pipe. The fork\n    process closed the read end, wrote to it, and then terminated (which\n    presumably closed the file descriptors on its end). The parent process\n    closed the write end, read from it, and returned, never closing the read\n    end.\n\n    This resulted in an accumulation of open file descriptors, which could\n    cause errors if the limit is reached.\n\n    *Sam Bostock*",
    "project": "activesupport",
    "date_merged": 1667599521000,
    "author": "Sam Bostock",
    "sha": "1bd522037e2e6409fc62bcf1fa1e2d928eb6e926",
    "pr": "45667",
    "merge_sha": "eead039e704b790f3bcc7b1421eba53605cb5d3b",
    "html": "<p>Ensure <code>ActiveSupport::Testing::Isolation::Forking</code> closes pipes</p>\n\n<p>Previously, <code>Forking.run_in_isolation</code> opened two ends of a pipe. The fork<br />\nprocess closed the read end, wrote to it, and then terminated (which<br />\npresumably closed the file descriptors on its end). The parent process<br />\nclosed the write end, read from it, and returned, never closing the read<br />\nend.</p>\n\n<p>This resulted in an accumulation of open file descriptors, which could<br />\ncause errors if the limit is reached.</p>\n\n<p><em>Sam Bostock</em></p>\n"
  },
  {
    "message": "*   Fix `Time#change` and `Time#advance` for times around the end of Daylight\n    Saving Time.\n\n    Previously, when `Time#change` or `Time#advance` constructed a time inside\n    the final stretch of Daylight Saving Time (DST), the non-DST offset would\n    always be chosen for local times:\n\n    ```ruby\n    # DST ended just before 2021-11-07 2:00:00 AM in US/Eastern.\n    ENV[\"TZ\"] = \"US/Eastern\"\n\n    time = Time.local(2021, 11, 07, 00, 59, 59) + 1\n    # => 2021-11-07 01:00:00 -0400\n    time.change(day: 07)\n    # => 2021-11-07 01:00:00 -0500\n    time.advance(seconds: 0)\n    # => 2021-11-07 01:00:00 -0500\n\n    time = Time.local(2021, 11, 06, 01, 00, 00)\n    # => 2021-11-06 01:00:00 -0400\n    time.change(day: 07)\n    # => 2021-11-07 01:00:00 -0500\n    time.advance(days: 1)\n    # => 2021-11-07 01:00:00 -0500\n    ```\n\n    And the DST offset would always be chosen for times with a `TimeZone`\n    object:\n\n    ```ruby\n    Time.zone = \"US/Eastern\"\n\n    time = Time.new(2021, 11, 07, 02, 00, 00, Time.zone) - 3600\n    # => 2021-11-07 01:00:00 -0500\n    time.change(day: 07)\n    # => 2021-11-07 01:00:00 -0400\n    time.advance(seconds: 0)\n    # => 2021-11-07 01:00:00 -0400\n\n    time = Time.new(2021, 11, 8, 01, 00, 00, Time.zone)\n    # => 2021-11-08 01:00:00 -0500\n    time.change(day: 07)\n    # => 2021-11-07 01:00:00 -0400\n    time.advance(days: -1)\n    # => 2021-11-07 01:00:00 -0400\n    ```\n\n    Now, `Time#change` and `Time#advance` will choose the offset that matches\n    the original time's offset when possible:\n\n    ```ruby\n    ENV[\"TZ\"] = \"US/Eastern\"\n\n    time = Time.local(2021, 11, 07, 00, 59, 59) + 1\n    # => 2021-11-07 01:00:00 -0400\n    time.change(day: 07)\n    # => 2021-11-07 01:00:00 -0400\n    time.advance(seconds: 0)\n    # => 2021-11-07 01:00:00 -0400\n\n    time = Time.local(2021, 11, 06, 01, 00, 00)\n    # => 2021-11-06 01:00:00 -0400\n    time.change(day: 07)\n    # => 2021-11-07 01:00:00 -0400\n    time.advance(days: 1)\n    # => 2021-11-07 01:00:00 -0400\n\n    Time.zone = \"US/Eastern\"\n\n    time = Time.new(2021, 11, 07, 02, 00, 00, Time.zone) - 3600\n    # => 2021-11-07 01:00:00 -0500\n    time.change(day: 07)\n    # => 2021-11-07 01:00:00 -0500\n    time.advance(seconds: 0)\n    # => 2021-11-07 01:00:00 -0500\n\n    time = Time.new(2021, 11, 8, 01, 00, 00, Time.zone)\n    # => 2021-11-08 01:00:00 -0500\n    time.change(day: 07)\n    # => 2021-11-07 01:00:00 -0500\n    time.advance(days: -1)\n    # => 2021-11-07 01:00:00 -0500\n    ```\n\n    *Kevin Hall*, *Takayoshi Nishida*, and *Jonathan Hefner*",
    "project": "activesupport",
    "date_merged": 1666645667000,
    "author": "Jonathan Hefner",
    "sha": "b191a65850691f5b2b77f11f937b27e149d2854c",
    "pr": "46251",
    "merge_sha": "3a3276c93c2aa33863b87387d505e6e5688200cb",
    "html": "<p>Fix <code>Time#change</code> and <code>Time#advance</code> for times around the end of Daylight<br />\nSaving Time.</p>\n\n<p>Previously, when <code>Time#change</code> or <code>Time#advance</code> constructed a time inside<br />\nthe final stretch of Daylight Saving Time (DST), the non-DST offset would<br />\nalways be chosen for local times:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># DST ended just before 2021-11-07 2:00:00 AM in US/Eastern.</span>\n<span class=\"no\">ENV</span><span class=\"p\">[</span><span class=\"s2\">\"TZ\"</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"s2\">\"US/Eastern\"</span>\n\n<span class=\"n\">time</span> <span class=\"o\">=</span> <span class=\"no\">Time</span><span class=\"p\">.</span><span class=\"nf\">local</span><span class=\"p\">(</span><span class=\"mi\">2021</span><span class=\"p\">,</span> <span class=\"mi\">11</span><span class=\"p\">,</span> <span class=\"mo\">07</span><span class=\"p\">,</span> <span class=\"mo\">00</span><span class=\"p\">,</span> <span class=\"mi\">59</span><span class=\"p\">,</span> <span class=\"mi\">59</span><span class=\"p\">)</span> <span class=\"o\">+</span> <span class=\"mi\">1</span>\n<span class=\"c1\"># =&gt; 2021-11-07 01:00:00 -0400</span>\n<span class=\"n\">time</span><span class=\"p\">.</span><span class=\"nf\">change</span><span class=\"p\">(</span><span class=\"ss\">day: </span><span class=\"mo\">07</span><span class=\"p\">)</span>\n<span class=\"c1\"># =&gt; 2021-11-07 01:00:00 -0500</span>\n<span class=\"n\">time</span><span class=\"p\">.</span><span class=\"nf\">advance</span><span class=\"p\">(</span><span class=\"ss\">seconds: </span><span class=\"mi\">0</span><span class=\"p\">)</span>\n<span class=\"c1\"># =&gt; 2021-11-07 01:00:00 -0500</span>\n\n<span class=\"n\">time</span> <span class=\"o\">=</span> <span class=\"no\">Time</span><span class=\"p\">.</span><span class=\"nf\">local</span><span class=\"p\">(</span><span class=\"mi\">2021</span><span class=\"p\">,</span> <span class=\"mi\">11</span><span class=\"p\">,</span> <span class=\"mo\">06</span><span class=\"p\">,</span> <span class=\"mo\">01</span><span class=\"p\">,</span> <span class=\"mo\">00</span><span class=\"p\">,</span> <span class=\"mo\">00</span><span class=\"p\">)</span>\n<span class=\"c1\"># =&gt; 2021-11-06 01:00:00 -0400</span>\n<span class=\"n\">time</span><span class=\"p\">.</span><span class=\"nf\">change</span><span class=\"p\">(</span><span class=\"ss\">day: </span><span class=\"mo\">07</span><span class=\"p\">)</span>\n<span class=\"c1\"># =&gt; 2021-11-07 01:00:00 -0500</span>\n<span class=\"n\">time</span><span class=\"p\">.</span><span class=\"nf\">advance</span><span class=\"p\">(</span><span class=\"ss\">days: </span><span class=\"mi\">1</span><span class=\"p\">)</span>\n<span class=\"c1\"># =&gt; 2021-11-07 01:00:00 -0500</span>\n</code></pre></div></div>\n\n<p>And the DST offset would always be chosen for times with a <code>TimeZone</code><br />\nobject:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">Time</span><span class=\"p\">.</span><span class=\"nf\">zone</span> <span class=\"o\">=</span> <span class=\"s2\">\"US/Eastern\"</span>\n\n<span class=\"n\">time</span> <span class=\"o\">=</span> <span class=\"no\">Time</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"mi\">2021</span><span class=\"p\">,</span> <span class=\"mi\">11</span><span class=\"p\">,</span> <span class=\"mo\">07</span><span class=\"p\">,</span> <span class=\"mo\">02</span><span class=\"p\">,</span> <span class=\"mo\">00</span><span class=\"p\">,</span> <span class=\"mo\">00</span><span class=\"p\">,</span> <span class=\"no\">Time</span><span class=\"p\">.</span><span class=\"nf\">zone</span><span class=\"p\">)</span> <span class=\"o\">-</span> <span class=\"mi\">3600</span>\n<span class=\"c1\"># =&gt; 2021-11-07 01:00:00 -0500</span>\n<span class=\"n\">time</span><span class=\"p\">.</span><span class=\"nf\">change</span><span class=\"p\">(</span><span class=\"ss\">day: </span><span class=\"mo\">07</span><span class=\"p\">)</span>\n<span class=\"c1\"># =&gt; 2021-11-07 01:00:00 -0400</span>\n<span class=\"n\">time</span><span class=\"p\">.</span><span class=\"nf\">advance</span><span class=\"p\">(</span><span class=\"ss\">seconds: </span><span class=\"mi\">0</span><span class=\"p\">)</span>\n<span class=\"c1\"># =&gt; 2021-11-07 01:00:00 -0400</span>\n\n<span class=\"n\">time</span> <span class=\"o\">=</span> <span class=\"no\">Time</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"mi\">2021</span><span class=\"p\">,</span> <span class=\"mi\">11</span><span class=\"p\">,</span> <span class=\"mi\">8</span><span class=\"p\">,</span> <span class=\"mo\">01</span><span class=\"p\">,</span> <span class=\"mo\">00</span><span class=\"p\">,</span> <span class=\"mo\">00</span><span class=\"p\">,</span> <span class=\"no\">Time</span><span class=\"p\">.</span><span class=\"nf\">zone</span><span class=\"p\">)</span>\n<span class=\"c1\"># =&gt; 2021-11-08 01:00:00 -0500</span>\n<span class=\"n\">time</span><span class=\"p\">.</span><span class=\"nf\">change</span><span class=\"p\">(</span><span class=\"ss\">day: </span><span class=\"mo\">07</span><span class=\"p\">)</span>\n<span class=\"c1\"># =&gt; 2021-11-07 01:00:00 -0400</span>\n<span class=\"n\">time</span><span class=\"p\">.</span><span class=\"nf\">advance</span><span class=\"p\">(</span><span class=\"ss\">days: </span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n<span class=\"c1\"># =&gt; 2021-11-07 01:00:00 -0400</span>\n</code></pre></div></div>\n\n<p>Now, <code>Time#change</code> and <code>Time#advance</code> will choose the offset that matches<br />\nthe original time’s offset when possible:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">ENV</span><span class=\"p\">[</span><span class=\"s2\">\"TZ\"</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"s2\">\"US/Eastern\"</span>\n\n<span class=\"n\">time</span> <span class=\"o\">=</span> <span class=\"no\">Time</span><span class=\"p\">.</span><span class=\"nf\">local</span><span class=\"p\">(</span><span class=\"mi\">2021</span><span class=\"p\">,</span> <span class=\"mi\">11</span><span class=\"p\">,</span> <span class=\"mo\">07</span><span class=\"p\">,</span> <span class=\"mo\">00</span><span class=\"p\">,</span> <span class=\"mi\">59</span><span class=\"p\">,</span> <span class=\"mi\">59</span><span class=\"p\">)</span> <span class=\"o\">+</span> <span class=\"mi\">1</span>\n<span class=\"c1\"># =&gt; 2021-11-07 01:00:00 -0400</span>\n<span class=\"n\">time</span><span class=\"p\">.</span><span class=\"nf\">change</span><span class=\"p\">(</span><span class=\"ss\">day: </span><span class=\"mo\">07</span><span class=\"p\">)</span>\n<span class=\"c1\"># =&gt; 2021-11-07 01:00:00 -0400</span>\n<span class=\"n\">time</span><span class=\"p\">.</span><span class=\"nf\">advance</span><span class=\"p\">(</span><span class=\"ss\">seconds: </span><span class=\"mi\">0</span><span class=\"p\">)</span>\n<span class=\"c1\"># =&gt; 2021-11-07 01:00:00 -0400</span>\n\n<span class=\"n\">time</span> <span class=\"o\">=</span> <span class=\"no\">Time</span><span class=\"p\">.</span><span class=\"nf\">local</span><span class=\"p\">(</span><span class=\"mi\">2021</span><span class=\"p\">,</span> <span class=\"mi\">11</span><span class=\"p\">,</span> <span class=\"mo\">06</span><span class=\"p\">,</span> <span class=\"mo\">01</span><span class=\"p\">,</span> <span class=\"mo\">00</span><span class=\"p\">,</span> <span class=\"mo\">00</span><span class=\"p\">)</span>\n<span class=\"c1\"># =&gt; 2021-11-06 01:00:00 -0400</span>\n<span class=\"n\">time</span><span class=\"p\">.</span><span class=\"nf\">change</span><span class=\"p\">(</span><span class=\"ss\">day: </span><span class=\"mo\">07</span><span class=\"p\">)</span>\n<span class=\"c1\"># =&gt; 2021-11-07 01:00:00 -0400</span>\n<span class=\"n\">time</span><span class=\"p\">.</span><span class=\"nf\">advance</span><span class=\"p\">(</span><span class=\"ss\">days: </span><span class=\"mi\">1</span><span class=\"p\">)</span>\n<span class=\"c1\"># =&gt; 2021-11-07 01:00:00 -0400</span>\n\n<span class=\"no\">Time</span><span class=\"p\">.</span><span class=\"nf\">zone</span> <span class=\"o\">=</span> <span class=\"s2\">\"US/Eastern\"</span>\n\n<span class=\"n\">time</span> <span class=\"o\">=</span> <span class=\"no\">Time</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"mi\">2021</span><span class=\"p\">,</span> <span class=\"mi\">11</span><span class=\"p\">,</span> <span class=\"mo\">07</span><span class=\"p\">,</span> <span class=\"mo\">02</span><span class=\"p\">,</span> <span class=\"mo\">00</span><span class=\"p\">,</span> <span class=\"mo\">00</span><span class=\"p\">,</span> <span class=\"no\">Time</span><span class=\"p\">.</span><span class=\"nf\">zone</span><span class=\"p\">)</span> <span class=\"o\">-</span> <span class=\"mi\">3600</span>\n<span class=\"c1\"># =&gt; 2021-11-07 01:00:00 -0500</span>\n<span class=\"n\">time</span><span class=\"p\">.</span><span class=\"nf\">change</span><span class=\"p\">(</span><span class=\"ss\">day: </span><span class=\"mo\">07</span><span class=\"p\">)</span>\n<span class=\"c1\"># =&gt; 2021-11-07 01:00:00 -0500</span>\n<span class=\"n\">time</span><span class=\"p\">.</span><span class=\"nf\">advance</span><span class=\"p\">(</span><span class=\"ss\">seconds: </span><span class=\"mi\">0</span><span class=\"p\">)</span>\n<span class=\"c1\"># =&gt; 2021-11-07 01:00:00 -0500</span>\n\n<span class=\"n\">time</span> <span class=\"o\">=</span> <span class=\"no\">Time</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"mi\">2021</span><span class=\"p\">,</span> <span class=\"mi\">11</span><span class=\"p\">,</span> <span class=\"mi\">8</span><span class=\"p\">,</span> <span class=\"mo\">01</span><span class=\"p\">,</span> <span class=\"mo\">00</span><span class=\"p\">,</span> <span class=\"mo\">00</span><span class=\"p\">,</span> <span class=\"no\">Time</span><span class=\"p\">.</span><span class=\"nf\">zone</span><span class=\"p\">)</span>\n<span class=\"c1\"># =&gt; 2021-11-08 01:00:00 -0500</span>\n<span class=\"n\">time</span><span class=\"p\">.</span><span class=\"nf\">change</span><span class=\"p\">(</span><span class=\"ss\">day: </span><span class=\"mo\">07</span><span class=\"p\">)</span>\n<span class=\"c1\"># =&gt; 2021-11-07 01:00:00 -0500</span>\n<span class=\"n\">time</span><span class=\"p\">.</span><span class=\"nf\">advance</span><span class=\"p\">(</span><span class=\"ss\">days: </span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n<span class=\"c1\"># =&gt; 2021-11-07 01:00:00 -0500</span>\n</code></pre></div></div>\n\n<p><em>Kevin Hall</em>, <em>Takayoshi Nishida</em>, and <em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Fix MemoryStore to preserve entries TTL when incrementing or decrementing\n\n    This is to be more consistent with how MemCachedStore and RedisCacheStore behaves.\n\n    *Jean Boussier*",
    "project": "activesupport",
    "date_merged": 1666435765000,
    "author": "Jean Boussier",
    "sha": "4af6d50d44fe25df304b7f682b43b7a29125a807",
    "pr": "46305",
    "merge_sha": "908f7bd01e7d3096de13a94acae883a540a94c9a",
    "html": "<p>Fix MemoryStore to preserve entries TTL when incrementing or decrementing</p>\n\n<p>This is to be more consistent with how MemCachedStore and RedisCacheStore behaves.</p>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   `Rails.error.handle` and `Rails.error.record` filter now by multiple error classes.\n\n    ```ruby\n    Rails.error.handle(IOError, ArgumentError) do\n      1 + '1' # raises TypeError\n    end\n    1 + 1 # TypeErrors are not IOErrors or ArgumentError, so this will *not* be handled\n    ```\n\n    *Martin Spickermann*",
    "project": "activesupport",
    "date_merged": 1666362996000,
    "author": "Martin Spickermann",
    "sha": "1a9b887c0c37321bdac76a036c2eec9da49edb5f",
    "pr": "46299",
    "merge_sha": "0c4d89c2b5421b7942ef421ed8461e9c93f9a0f0",
    "html": "<p><code>Rails.error.handle</code> and <code>Rails.error.record</code> filter now by multiple error classes.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">Rails</span><span class=\"p\">.</span><span class=\"nf\">error</span><span class=\"p\">.</span><span class=\"nf\">handle</span><span class=\"p\">(</span><span class=\"no\">IOError</span><span class=\"p\">,</span> <span class=\"no\">ArgumentError</span><span class=\"p\">)</span> <span class=\"k\">do</span>\n  <span class=\"mi\">1</span> <span class=\"o\">+</span> <span class=\"s1\">'1'</span> <span class=\"c1\"># raises TypeError</span>\n<span class=\"k\">end</span>\n<span class=\"mi\">1</span> <span class=\"o\">+</span> <span class=\"mi\">1</span> <span class=\"c1\"># TypeErrors are not IOErrors or ArgumentError, so this will *not* be handled</span>\n</code></pre></div></div>\n\n<p><em>Martin Spickermann</em></p>\n"
  },
  {
    "message": "*   `Class#subclasses` and `Class#descendants` now automatically filter reloaded classes.\n\n    Previously they could return old implementations of reloadable classes that have been\n    dereferenced but not yet garbage collected.\n\n    They now automatically filter such classes like `DescendantTracker#subclasses` and\n    `DescendantTracker#descendants`.\n\n    *Jean Boussier*",
    "project": "activesupport",
    "date_merged": 1664359792000,
    "author": "Jean Boussier",
    "sha": "1aa24639f788b06d54505f5aeb81a10f00f55e3d",
    "pr": "46144",
    "merge_sha": "c41e2f1bca65b51bccda7dd465d525071c66264f",
    "html": "<p><code>Class#subclasses</code> and <code>Class#descendants</code> now automatically filter reloaded classes.</p>\n\n<p>Previously they could return old implementations of reloadable classes that have been<br />\ndereferenced but not yet garbage collected.</p>\n\n<p>They now automatically filter such classes like <code>DescendantTracker#subclasses</code> and<br />\n<code>DescendantTracker#descendants</code>.</p>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   `Rails.error.report` now marks errors as reported to avoid reporting them twice.\n\n    In some cases, users might want to report errors explicitly with some extra context\n    before letting it bubble up.\n\n    This also allows to safely catch and report errors outside of the execution context.\n\n    *Jean Boussier*",
    "project": "activesupport",
    "date_merged": 1664271648000,
    "author": "Jean Boussier",
    "sha": "a6dbfcdc2391c9066987634f1680365e49a405ff",
    "pr": "46131",
    "merge_sha": "097d0b390e7844ffc54d57846adfd762030ffad2",
    "html": "<p><code>Rails.error.report</code> now marks errors as reported to avoid reporting them twice.</p>\n\n<p>In some cases, users might want to report errors explicitly with some extra context<br />\nbefore letting it bubble up.</p>\n\n<p>This also allows to safely catch and report errors outside of the execution context.</p>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   Add `assert_error_reported` and `assert_no_error_reported`\n\n    Allows to easily asserts an error happened but was handled\n\n    ```ruby\n    report = assert_error_reported(IOError) do\n      # ...\n    end\n    assert_equal \"Oops\", report.error.message\n    assert_equal \"admin\", report.context[:section]\n    assert_equal :warning, report.severity\n    assert_predicate report, :handled?\n    ```\n\n    *Jean Boussier*",
    "project": "activesupport",
    "date_merged": 1663315486000,
    "author": "Jean Boussier",
    "sha": "f33a1b902ddce0dd9530960e0870118bc88736e0",
    "pr": "46029",
    "merge_sha": "a5018cf149d47e1aed1e74dd35e4d519b507c364",
    "html": "<p>Add <code>assert_error_reported</code> and <code>assert_no_error_reported</code></p>\n\n<p>Allows to easily asserts an error happened but was handled</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">report</span> <span class=\"o\">=</span> <span class=\"n\">assert_error_reported</span><span class=\"p\">(</span><span class=\"no\">IOError</span><span class=\"p\">)</span> <span class=\"k\">do</span>\n  <span class=\"c1\"># ...</span>\n<span class=\"k\">end</span>\n<span class=\"n\">assert_equal</span> <span class=\"s2\">\"Oops\"</span><span class=\"p\">,</span> <span class=\"n\">report</span><span class=\"p\">.</span><span class=\"nf\">error</span><span class=\"p\">.</span><span class=\"nf\">message</span>\n<span class=\"n\">assert_equal</span> <span class=\"s2\">\"admin\"</span><span class=\"p\">,</span> <span class=\"n\">report</span><span class=\"p\">.</span><span class=\"nf\">context</span><span class=\"p\">[</span><span class=\"ss\">:section</span><span class=\"p\">]</span>\n<span class=\"n\">assert_equal</span> <span class=\"ss\">:warning</span><span class=\"p\">,</span> <span class=\"n\">report</span><span class=\"p\">.</span><span class=\"nf\">severity</span>\n<span class=\"n\">assert_predicate</span> <span class=\"n\">report</span><span class=\"p\">,</span> <span class=\"ss\">:handled?</span>\n</code></pre></div></div>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   `ActiveSupport::Deprecation` behavior callbacks can now receive the\n    deprecator instance as an argument.  This makes it easier for such callbacks\n    to change their behavior based on the deprecator's state.  For example,\n    based on the deprecator's `debug` flag.\n\n    3-arity and splat-args callbacks such as the following will now be passed\n    the deprecator instance as their third argument:\n\n    * `->(message, callstack, deprecator) { ... }`\n    * `->(*args) { ... }`\n    * `->(message, *other_args) { ... }`\n\n    2-arity and 4-arity callbacks such as the following will continue to behave\n    the same as before:\n\n    * `->(message, callstack) { ... }`\n    * `->(message, callstack, deprecation_horizon, gem_name) { ... }`\n    * `->(message, callstack, *deprecation_details) { ... }`\n\n    *Jonathan Hefner*",
    "project": "activesupport",
    "date_merged": 1663279134000,
    "author": "Jonathan Hefner",
    "sha": "ff57f6a1fce15a9a714884067065f9d4e3e134b7",
    "pr": "46037",
    "merge_sha": "723a22ddd3624b951744021d51810e3572408328",
    "html": "<p><code>ActiveSupport::Deprecation</code> behavior callbacks can now receive the<br />\ndeprecator instance as an argument.  This makes it easier for such callbacks<br />\nto change their behavior based on the deprecator’s state.  For example,<br />\nbased on the deprecator’s <code>debug</code> flag.</p>\n\n<p>3-arity and splat-args callbacks such as the following will now be passed<br />\nthe deprecator instance as their third argument:</p>\n\n<ul>\n  <li><code>-&gt;(message, callstack, deprecator) { ... }</code></li>\n  <li><code>-&gt;(*args) { ... }</code></li>\n  <li><code>-&gt;(message, *other_args) { ... }</code></li>\n</ul>\n\n<p>2-arity and 4-arity callbacks such as the following will continue to behave<br />\nthe same as before:</p>\n\n<ul>\n  <li><code>-&gt;(message, callstack) { ... }</code></li>\n  <li><code>-&gt;(message, callstack, deprecation_horizon, gem_name) { ... }</code></li>\n  <li><code>-&gt;(message, callstack, *deprecation_details) { ... }</code></li>\n</ul>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   `ActiveSupport::Deprecation#disallowed_warnings` now affects the instance on\n    which it is configured.\n\n    This means that individual `ActiveSupport::Deprecation` instances can be\n    configured with their own disallowed warnings, and the global\n    `ActiveSupport::Deprecation.disallowed_warnings` now only affects the global\n    `ActiveSupport::Deprecation.warn`.\n\n    **Before**\n\n    ```ruby\n    ActiveSupport::Deprecation.disallowed_warnings = [\"foo\"]\n    deprecator = ActiveSupport::Deprecation.new(\"2.0\", \"MyCoolGem\")\n    deprecator.disallowed_warnings = [\"bar\"]\n\n    ActiveSupport::Deprecation.warn(\"foo\") # => raise ActiveSupport::DeprecationException\n    ActiveSupport::Deprecation.warn(\"bar\") # => print \"DEPRECATION WARNING: bar\"\n    deprecator.warn(\"foo\")                 # => raise ActiveSupport::DeprecationException\n    deprecator.warn(\"bar\")                 # => print \"DEPRECATION WARNING: bar\"\n    ```\n\n    **After**\n\n    ```ruby\n    ActiveSupport::Deprecation.disallowed_warnings = [\"foo\"]\n    deprecator = ActiveSupport::Deprecation.new(\"2.0\", \"MyCoolGem\")\n    deprecator.disallowed_warnings = [\"bar\"]\n\n    ActiveSupport::Deprecation.warn(\"foo\") # => raise ActiveSupport::DeprecationException\n    ActiveSupport::Deprecation.warn(\"bar\") # => print \"DEPRECATION WARNING: bar\"\n    deprecator.warn(\"foo\")                 # => print \"DEPRECATION WARNING: foo\"\n    deprecator.warn(\"bar\")                 # => raise ActiveSupport::DeprecationException\n    ```\n\n    Note that global `ActiveSupport::Deprecation` methods such as `ActiveSupport::Deprecation.warn`\n    and `ActiveSupport::Deprecation.disallowed_warnings` have been deprecated.\n\n    *Jonathan Hefner*",
    "project": "activesupport",
    "date_merged": 1663182922000,
    "author": "Jonathan Hefner",
    "sha": "2540f94e82a4c5da5516f2c16829f5ca71824492",
    "pr": "46026",
    "merge_sha": "d0bdbc1827daa2c89d5aa28d07673bfdda3167ee",
    "html": "<p><code>ActiveSupport::Deprecation#disallowed_warnings</code> now affects the instance on<br />\nwhich it is configured.</p>\n\n<p>This means that individual <code>ActiveSupport::Deprecation</code> instances can be<br />\nconfigured with their own disallowed warnings, and the global<br />\n<code>ActiveSupport::Deprecation.disallowed_warnings</code> now only affects the global<br />\n<code>ActiveSupport::Deprecation.warn</code>.</p>\n\n<p><strong>Before</strong></p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">ActiveSupport</span><span class=\"o\">::</span><span class=\"no\">Deprecation</span><span class=\"p\">.</span><span class=\"nf\">disallowed_warnings</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s2\">\"foo\"</span><span class=\"p\">]</span>\n<span class=\"n\">deprecator</span> <span class=\"o\">=</span> <span class=\"no\">ActiveSupport</span><span class=\"o\">::</span><span class=\"no\">Deprecation</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"s2\">\"2.0\"</span><span class=\"p\">,</span> <span class=\"s2\">\"MyCoolGem\"</span><span class=\"p\">)</span>\n<span class=\"n\">deprecator</span><span class=\"p\">.</span><span class=\"nf\">disallowed_warnings</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s2\">\"bar\"</span><span class=\"p\">]</span>\n\n<span class=\"no\">ActiveSupport</span><span class=\"o\">::</span><span class=\"no\">Deprecation</span><span class=\"p\">.</span><span class=\"nf\">warn</span><span class=\"p\">(</span><span class=\"s2\">\"foo\"</span><span class=\"p\">)</span> <span class=\"c1\"># =&gt; raise ActiveSupport::DeprecationException</span>\n<span class=\"no\">ActiveSupport</span><span class=\"o\">::</span><span class=\"no\">Deprecation</span><span class=\"p\">.</span><span class=\"nf\">warn</span><span class=\"p\">(</span><span class=\"s2\">\"bar\"</span><span class=\"p\">)</span> <span class=\"c1\"># =&gt; print \"DEPRECATION WARNING: bar\"</span>\n<span class=\"n\">deprecator</span><span class=\"p\">.</span><span class=\"nf\">warn</span><span class=\"p\">(</span><span class=\"s2\">\"foo\"</span><span class=\"p\">)</span>                 <span class=\"c1\"># =&gt; raise ActiveSupport::DeprecationException</span>\n<span class=\"n\">deprecator</span><span class=\"p\">.</span><span class=\"nf\">warn</span><span class=\"p\">(</span><span class=\"s2\">\"bar\"</span><span class=\"p\">)</span>                 <span class=\"c1\"># =&gt; print \"DEPRECATION WARNING: bar\"</span>\n</code></pre></div></div>\n\n<p><strong>After</strong></p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">ActiveSupport</span><span class=\"o\">::</span><span class=\"no\">Deprecation</span><span class=\"p\">.</span><span class=\"nf\">disallowed_warnings</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s2\">\"foo\"</span><span class=\"p\">]</span>\n<span class=\"n\">deprecator</span> <span class=\"o\">=</span> <span class=\"no\">ActiveSupport</span><span class=\"o\">::</span><span class=\"no\">Deprecation</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"s2\">\"2.0\"</span><span class=\"p\">,</span> <span class=\"s2\">\"MyCoolGem\"</span><span class=\"p\">)</span>\n<span class=\"n\">deprecator</span><span class=\"p\">.</span><span class=\"nf\">disallowed_warnings</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s2\">\"bar\"</span><span class=\"p\">]</span>\n\n<span class=\"no\">ActiveSupport</span><span class=\"o\">::</span><span class=\"no\">Deprecation</span><span class=\"p\">.</span><span class=\"nf\">warn</span><span class=\"p\">(</span><span class=\"s2\">\"foo\"</span><span class=\"p\">)</span> <span class=\"c1\"># =&gt; raise ActiveSupport::DeprecationException</span>\n<span class=\"no\">ActiveSupport</span><span class=\"o\">::</span><span class=\"no\">Deprecation</span><span class=\"p\">.</span><span class=\"nf\">warn</span><span class=\"p\">(</span><span class=\"s2\">\"bar\"</span><span class=\"p\">)</span> <span class=\"c1\"># =&gt; print \"DEPRECATION WARNING: bar\"</span>\n<span class=\"n\">deprecator</span><span class=\"p\">.</span><span class=\"nf\">warn</span><span class=\"p\">(</span><span class=\"s2\">\"foo\"</span><span class=\"p\">)</span>                 <span class=\"c1\"># =&gt; print \"DEPRECATION WARNING: foo\"</span>\n<span class=\"n\">deprecator</span><span class=\"p\">.</span><span class=\"nf\">warn</span><span class=\"p\">(</span><span class=\"s2\">\"bar\"</span><span class=\"p\">)</span>                 <span class=\"c1\"># =&gt; raise ActiveSupport::DeprecationException</span>\n</code></pre></div></div>\n\n<p>Note that global <code>ActiveSupport::Deprecation</code> methods such as <code>ActiveSupport::Deprecation.warn</code><br />\nand <code>ActiveSupport::Deprecation.disallowed_warnings</code> have been deprecated.</p>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Add italic and underline support to `ActiveSupport::LogSubscriber#color`\n\n    Previously, only bold text was supported via a positional argument.\n    This allows for bold, italic, and underline options to be specified\n    for colored logs.\n\n    ```ruby\n    info color(\"Hello world!\", :red, bold: true, underline: true)\n    ```\n\n    *Gannon McGibbon*",
    "project": "activesupport",
    "date_merged": 1662785030000,
    "author": "Gannon McGibbon",
    "sha": "6016f9ef3190489d87c2249d6a150f5a4d1b0753",
    "pr": "45976",
    "merge_sha": "ee81a0ed3407aa9cae68733c2380a9a49e088deb",
    "html": "<p>Add italic and underline support to <code>ActiveSupport::LogSubscriber#color</code></p>\n\n<p>Previously, only bold text was supported via a positional argument.<br />\nThis allows for bold, italic, and underline options to be specified<br />\nfor colored logs.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">info</span> <span class=\"n\">color</span><span class=\"p\">(</span><span class=\"s2\">\"Hello world!\"</span><span class=\"p\">,</span> <span class=\"ss\">:red</span><span class=\"p\">,</span> <span class=\"ss\">bold: </span><span class=\"kp\">true</span><span class=\"p\">,</span> <span class=\"ss\">underline: </span><span class=\"kp\">true</span><span class=\"p\">)</span>\n</code></pre></div></div>\n\n<p><em>Gannon McGibbon</em></p>\n"
  },
  {
    "message": "*   Add `String#downcase_first` method.\n\n    This method is the corollary of `String#upcase_first`.\n\n    *Mark Schneider*",
    "project": "activesupport",
    "date_merged": 1662675356000,
    "author": "Mark Schneider",
    "sha": "69b550fc88f0e155ab997476e576142a2dbec324",
    "pr": "45827",
    "merge_sha": "fcac1c4c07ec0846e0c6c08a7a4d0021333f51d6",
    "html": "<p>Add <code>String#downcase_first</code> method.</p>\n\n<p>This method is the corollary of <code>String#upcase_first</code>.</p>\n\n<p><em>Mark Schneider</em></p>\n"
  },
  {
    "message": "*   `thread_mattr_accessor` will call `.dup.freeze` on non-frozen default values.\n\n    This provides a basic level of protection against different threads trying\n    to mutate a shared default object.\n\n    *Jonathan Hefner*",
    "project": "activesupport",
    "date_merged": 1662066198000,
    "author": "Jonathan Hefner",
    "sha": "38a2cfe9fe0638608c6b731904147751350f76f3",
    "pr": "45918",
    "merge_sha": "4ab4144d2613dcab12b33ba52bc6b9d757f84099",
    "html": "<p><code>thread_mattr_accessor</code> will call <code>.dup.freeze</code> on non-frozen default values.</p>\n\n<p>This provides a basic level of protection against different threads trying<br />\nto mutate a shared default object.</p>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Add `raise_on_invalid_cache_expiration_time` config to `ActiveSupport::Cache::Store`\n\n    Specifies if an `ArgumentError` should be raised if `Rails.cache` `fetch` or\n    `write` are given an invalid `expires_at` or `expires_in` time.\n\n    Options are `true`, and `false`. If `false`, the exception will be reported\n    as `handled` and logged instead. Defaults to `true` if `config.load_defaults >= 7.1`.\n\n     *Trevor Turk*",
    "project": "activesupport",
    "date_merged": 1661873494000,
    "author": "Trevor Turk",
    "sha": "0ae0ab7e3ff040e1b04c600944ba4f643954760a",
    "pr": "45892",
    "merge_sha": "466f334c123785b2b7467acc695b2376a4538b29",
    "html": "<p>Add <code>raise_on_invalid_cache_expiration_time</code> config to <code>ActiveSupport::Cache::Store</code></p>\n\n<p>Specifies if an <code>ArgumentError</code> should be raised if <code>Rails.cache</code> <code>fetch</code> or<br />\n<code>write</code> are given an invalid <code>expires_at</code> or <code>expires_in</code> time.</p>\n\n<p>Options are <code>true</code>, and <code>false</code>. If <code>false</code>, the exception will be reported<br />\nas <code>handled</code> and logged instead. Defaults to <code>true</code> if <code>config.load_defaults &gt;= 7.1</code>.</p>\n\n<p><em>Trevor Turk</em></p>\n"
  },
  {
    "message": "*   `ActiveSupport::Cache:Store#fetch` now passes an options accessor to the block.\n\n    It makes possible to override cache options:\n\n        Rails.cache.fetch(\"3rd-party-token\") do |name, options|\n          token = fetch_token_from_remote\n          # set cache's TTL to match token's TTL\n          options.expires_in = token.expires_in\n          token\n        end\n\n    *Andrii Gladkyi*, *Jean Boussier*",
    "project": "activesupport",
    "date_merged": 1661861996000,
    "author": "Jean Boussier",
    "sha": "b84b04b33fff38baf3602cba4aa2924876f8b307",
    "pr": "45905",
    "merge_sha": "992a898c899fcff676a65b6498e6e473645118ee",
    "html": "<p><code>ActiveSupport::Cache:Store#fetch</code> now passes an options accessor to the block.</p>\n\n<p>It makes possible to override cache options:</p>\n\n<pre><code>Rails.cache.fetch(\"3rd-party-token\") do |name, options|\n  token = fetch_token_from_remote\n  # set cache's TTL to match token's TTL\n  options.expires_in = token.expires_in\n  token\nend\n</code></pre>\n\n<p><em>Andrii Gladkyi</em>, <em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   `default` option of `thread_mattr_accessor` now applies through inheritance and\n    also across new threads.\n\n    Previously, the `default` value provided was set only at the moment of defining\n    the attribute writer, which would cause the attribute to be uninitialized in\n    descendants and in other threads.\n\n    Fixes #43312.\n\n    *Thierry Deo*",
    "project": "activesupport",
    "date_merged": 1661447360000,
    "author": "Thierry Deo",
    "sha": "25faa5466b0aaacec60ca6d258c75c1ce59eade6",
    "pr": "43337",
    "merge_sha": "d03e1d50abfcc96e66bb6903d4b12ca7bc357794",
    "html": "<p><code>default</code> option of <code>thread_mattr_accessor</code> now applies through inheritance and<br />\nalso across new threads.</p>\n\n<p>Previously, the <code>default</code> value provided was set only at the moment of defining<br />\nthe attribute writer, which would cause the attribute to be uninitialized in<br />\ndescendants and in other threads.</p>\n\n<p>Fixes #43312.</p>\n\n<p><em>Thierry Deo</em></p>\n"
  },
  {
    "message": "*   Redis cache store is now compatible with redis-rb 5.0.\n\n    *Jean Boussier*",
    "project": "activesupport",
    "date_merged": 1661156236000,
    "author": "Jean Boussier",
    "sha": "341d627a57844dceb195e847be958b5f865c3799",
    "pr": "45856",
    "merge_sha": "1aac6f3bf43521cb51b45e85a19fa5f87a90acdf",
    "html": "<p>Redis cache store is now compatible with redis-rb 5.0.</p>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   Add `skip_nil:` support to `ActiveSupport::Cache::Store#fetch_multi`.\n\n    *Daniel Alfaro*",
    "project": "activesupport",
    "date_merged": 1658417614000,
    "author": "Daniel Alfaro",
    "sha": "1344031d7ef9962051ead6712d83655926e5c9f6",
    "pr": "45619",
    "merge_sha": "789a3648f37220a8419b43bc67ef8d81c80bdb1a",
    "html": "<p>Add <code>skip_nil:</code> support to <code>ActiveSupport::Cache::Store#fetch_multi</code>.</p>\n\n<p><em>Daniel Alfaro</em></p>\n"
  },
  {
    "message": "*   Add `quarter` method to date/time\n\n    *Matt Swanson*",
    "project": "activesupport",
    "date_merged": 1657915589000,
    "author": "matt swanson",
    "sha": "959d46ef8794cd01090d1a041dfc2f901391e33d",
    "pr": "45009",
    "merge_sha": "9994d38bc6c1a8662e510d26c0e9ca8c24ab1189",
    "html": "<p>Add <code>quarter</code> method to date/time</p>\n\n<p><em>Matt Swanson</em></p>\n"
  },
  {
    "message": "*   Fix `NoMethodError` on custom `ActiveSupport::Deprecation` behavior.\n\n    `ActiveSupport::Deprecation.behavior=` was supposed to accept any object\n    that responds to `call`, but in fact its internal implementation assumed that\n    this object could respond to `arity`, so it was restricted to only `Proc` objects.\n\n    This change removes this `arity` restriction of custom behaviors.\n\n    *Ryo Nakamura*",
    "project": "activesupport",
    "date_merged": 1657123077000,
    "author": "Ryo Nakamura",
    "sha": "6f9bb2cc0fd0e1560085a44c05d763afb00ab0d2",
    "pr": "45521",
    "merge_sha": "54e3f8c381d00a79ac5ab57fa444709c3f3ee0c1",
    "html": "<p>Fix <code>NoMethodError</code> on custom <code>ActiveSupport::Deprecation</code> behavior.</p>\n\n<p><code>ActiveSupport::Deprecation.behavior=</code> was supposed to accept any object<br />\nthat responds to <code>call</code>, but in fact its internal implementation assumed that<br />\nthis object could respond to <code>arity</code>, so it was restricted to only <code>Proc</code> objects.</p>\n\n<p>This change removes this <code>arity</code> restriction of custom behaviors.</p>\n\n<p><em>Ryo Nakamura</em></p>\n"
  },
  {
    "message": "*   Support `:url_safe` option for `MessageEncryptor`.\n\n    The `MessageEncryptor` constructor now accepts a `:url_safe` option, similar\n    to the `MessageVerifier` constructor.  When enabled, this option ensures\n    that messages use a URL-safe encoding.\n\n    *Jonathan Hefner*",
    "project": "activesupport",
    "date_merged": 1657397921000,
    "author": "Jonathan Hefner",
    "sha": "7094d0fc4385a6e36e1e4f516c5d86c262ca2ac0",
    "pr": "45550",
    "merge_sha": "b495b4eea1ffb4005056d69624c88ce3970c704b",
    "html": "<p>Support <code>:url_safe</code> option for <code>MessageEncryptor</code>.</p>\n\n<p>The <code>MessageEncryptor</code> constructor now accepts a <code>:url_safe</code> option, similar<br />\nto the <code>MessageVerifier</code> constructor.  When enabled, this option ensures<br />\nthat messages use a URL-safe encoding.</p>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Add `url_safe` option to `ActiveSupport::MessageVerifier` initializer\n\n    `ActiveSupport::MessageVerifier.new` now takes optional `url_safe` argument.\n    It can generate URL-safe strings by passing `url_safe: true`.\n\n    ```ruby\n    verifier = ActiveSupport::MessageVerifier.new(url_safe: true)\n    message = verifier.generate(data) # => URL-safe string\n    ```\n\n    This option is `false` by default to be backwards compatible.\n\n    *Shouichi Kamiya*",
    "project": "activesupport",
    "date_merged": 1657397921000,
    "author": "Jonathan Hefner",
    "sha": "7094d0fc4385a6e36e1e4f516c5d86c262ca2ac0",
    "pr": "45550",
    "merge_sha": "b495b4eea1ffb4005056d69624c88ce3970c704b",
    "html": "<p>Add <code>url_safe</code> option to <code>ActiveSupport::MessageVerifier</code> initializer</p>\n\n<p><code>ActiveSupport::MessageVerifier.new</code> now takes optional <code>url_safe</code> argument.<br />\nIt can generate URL-safe strings by passing <code>url_safe: true</code>.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">verifier</span> <span class=\"o\">=</span> <span class=\"no\">ActiveSupport</span><span class=\"o\">::</span><span class=\"no\">MessageVerifier</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"ss\">url_safe: </span><span class=\"kp\">true</span><span class=\"p\">)</span>\n<span class=\"n\">message</span> <span class=\"o\">=</span> <span class=\"n\">verifier</span><span class=\"p\">.</span><span class=\"nf\">generate</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"p\">)</span> <span class=\"c1\"># =&gt; URL-safe string</span>\n</code></pre></div></div>\n\n<p>This option is <code>false</code> by default to be backwards compatible.</p>\n\n<p><em>Shouichi Kamiya</em></p>\n"
  },
  {
    "message": "*   Enable connection pooling by default for `MemCacheStore` and `RedisCacheStore`.\n\n    If you want to disable connection pooling, set `:pool` option to `false` when configuring the cache store:\n\n    ```ruby\n    config.cache_store = :mem_cache_store, \"cache.example.com\", pool: false\n    ```\n\n    *fatkodima*",
    "project": "activesupport",
    "date_merged": 1654592667000,
    "author": "fatkodima",
    "sha": "799b5c1df40e90f427567bf583c47893af082aed",
    "pr": "45235",
    "merge_sha": "d921f203c356a0d6902a3f75067f08993f4e33fa",
    "html": "<p>Enable connection pooling by default for <code>MemCacheStore</code> and <code>RedisCacheStore</code>.</p>\n\n<p>If you want to disable connection pooling, set <code>:pool</code> option to <code>false</code> when configuring the cache store:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">config</span><span class=\"p\">.</span><span class=\"nf\">cache_store</span> <span class=\"o\">=</span> <span class=\"ss\">:mem_cache_store</span><span class=\"p\">,</span> <span class=\"s2\">\"cache.example.com\"</span><span class=\"p\">,</span> <span class=\"ss\">pool: </span><span class=\"kp\">false</span>\n</code></pre></div></div>\n\n<p><em>fatkodima</em></p>\n"
  },
  {
    "message": "*   Add `force:` support to `ActiveSupport::Cache::Store#fetch_multi`.\n\n    *fatkodima*",
    "project": "activesupport",
    "date_merged": 1653487368000,
    "author": "fatkodima",
    "sha": "358556b971d1acd81021bd1dfaa4ea2660da72bf",
    "pr": "45174",
    "merge_sha": "d4a660f1cb7d023c9c9173dff9000fdb00788ab4",
    "html": "<p>Add <code>force:</code> support to <code>ActiveSupport::Cache::Store#fetch_multi</code>.</p>\n\n<p><em>fatkodima</em></p>\n"
  },
  {
    "message": "*   Deprecated `:pool_size` and `:pool_timeout` options for configuring connection pooling in cache stores.\n\n    Use `pool: true` to enable pooling with default settings:\n\n    ```ruby\n    config.cache_store = :redis_cache_store, pool: true\n    ```\n\n    Or pass individual options via `:pool` option:\n\n    ```ruby\n    config.cache_store = :redis_cache_store, pool: { size: 10, timeout: 2 }\n    ```\n\n    *fatkodima*",
    "project": "activesupport",
    "date_merged": 1652888379000,
    "author": "fatkodima",
    "sha": "059d1d16ab4c7311a9f048fa6e14c35c4a292d22",
    "pr": "45111",
    "merge_sha": "a680a684d1c7e4080e994e4c4fc1fa38d1fe73b0",
    "html": "<p>Deprecated <code>:pool_size</code> and <code>:pool_timeout</code> options for configuring connection pooling in cache stores.</p>\n\n<p>Use <code>pool: true</code> to enable pooling with default settings:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">config</span><span class=\"p\">.</span><span class=\"nf\">cache_store</span> <span class=\"o\">=</span> <span class=\"ss\">:redis_cache_store</span><span class=\"p\">,</span> <span class=\"ss\">pool: </span><span class=\"kp\">true</span>\n</code></pre></div></div>\n\n<p>Or pass individual options via <code>:pool</code> option:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">config</span><span class=\"p\">.</span><span class=\"nf\">cache_store</span> <span class=\"o\">=</span> <span class=\"ss\">:redis_cache_store</span><span class=\"p\">,</span> <span class=\"ss\">pool: </span><span class=\"p\">{</span> <span class=\"ss\">size: </span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"ss\">timeout: </span><span class=\"mi\">2</span> <span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p><em>fatkodima</em></p>\n"
  },
  {
    "message": "*   Allow #increment and #decrement methods of `ActiveSupport::Cache::Store`\n    subclasses to set new values.\n\n    Previously incrementing or decrementing an unset key would fail and return\n    nil. A default will now be assumed and the key will be created.\n\n    *Andrej Blagojević*, *Eugene Kenny*",
    "project": "activesupport",
    "date_merged": 1652818003000,
    "author": "Andrej Blagojević",
    "sha": "f48bf3975f62e875a1cf4264b18ce3735915684d",
    "pr": "45068",
    "merge_sha": "83c9bebf808a8e2654aa4e1921684698cb238692",
    "html": "<p>Allow #increment and #decrement methods of <code>ActiveSupport::Cache::Store</code><br />\nsubclasses to set new values.</p>\n\n<p>Previously incrementing or decrementing an unset key would fail and return<br />\nnil. A default will now be assumed and the key will be created.</p>\n\n<p><em>Andrej Blagojević</em>, <em>Eugene Kenny</em></p>\n"
  },
  {
    "message": "*   Add `skip_nil:` support to `RedisCacheStore`\n\n    *Joey Paris*",
    "project": "activesupport",
    "date_merged": 1652620151000,
    "author": "Joey Paris",
    "sha": "98244c1d4b82a441dfc214c78f3ffc8c38d36f31",
    "pr": "42909",
    "merge_sha": "06610c49fb79652e1485a8e4fb03bf10841d19e7",
    "html": "<p>Add <code>skip_nil:</code> support to <code>RedisCacheStore</code></p>\n\n<p><em>Joey Paris</em></p>\n"
  },
  {
    "message": "*   `ActiveSupport::Cache::MemoryStore#write(name, val, unless_exist:true)` now\n    correctly writes expired keys.\n\n    *Alan Savage*",
    "project": "activesupport",
    "date_merged": 1652315108000,
    "author": "Alan Savage",
    "sha": "ad7b40c4f7a90a24b826603a1924e257e062d188",
    "pr": "45073",
    "merge_sha": "8ec74553851bfafd1cc6944a1baad82c13fa76ff",
    "html": "<p><code>ActiveSupport::Cache::MemoryStore#write(name, val, unless_exist:true)</code> now<br />\ncorrectly writes expired keys.</p>\n\n<p><em>Alan Savage</em></p>\n"
  },
  {
    "message": "*   `ActiveSupport::ErrorReporter` now accepts and forward a `source:` parameter.\n\n    This allow libraries to signal the origin of the errors, and reporters\n    to easily ignore some sources.\n\n    *Jean Boussier*",
    "project": "activesupport",
    "date_merged": 1651741101000,
    "author": "Jean Boussier",
    "sha": "c9a2bc284c3c3ef11839fa0a0222339f0fd7c2c0",
    "pr": "44998",
    "merge_sha": "761e3aa3446eb9e4604bd74f356cddb90d4ad97a",
    "html": "<p><code>ActiveSupport::ErrorReporter</code> now accepts and forward a <code>source:</code> parameter.</p>\n\n<p>This allow libraries to signal the origin of the errors, and reporters<br />\nto easily ignore some sources.</p>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   Fix and add protections for XSS in `ActionView::Helpers` and `ERB::Util`.\n\n    Add the method `ERB::Util.xml_name_escape` to escape dangerous characters\n    in names of tags and names of attributes, following the specification of XML.\n\n    *Álvaro Martín Fraguas*",
    "project": "activesupport",
    "date_merged": 1651174760000,
    "author": "Alvaro Martin Fraguas",
    "sha": "649516ce0feb699ae06a8c5e81df75d460cc9a85",
    "pr": "44973",
    "merge_sha": "6ce8c03b53501ace1f0484dadcc245e830a0c840",
    "html": "<p>Fix and add protections for XSS in <code>ActionView::Helpers</code> and <code>ERB::Util</code>.</p>\n\n<p>Add the method <code>ERB::Util.xml_name_escape</code> to escape dangerous characters<br />\nin names of tags and names of attributes, following the specification of XML.</p>\n\n<p><em>Álvaro Martín Fraguas</em></p>\n"
  },
  {
    "message": "*   Respect `ActiveSupport::Logger.new`'s `:formatter` keyword argument\n\n    The stdlib `Logger::new` allows passing a `:formatter` keyword argument to\n    set the logger's formatter. Previously `ActiveSupport::Logger.new` ignored\n    that argument by always setting the formatter to an instance of\n    `ActiveSupport::Logger::SimpleFormatter`.\n\n    *Steven Harman*",
    "project": "activesupport",
    "date_merged": 1650875183000,
    "author": "Steven Harman",
    "sha": "3b012a52540f7e4564d70f1955785bde32269a3d",
    "pr": "44942",
    "merge_sha": "6fd5323080dcb6aec24412e25c8210d9e2cda7bc",
    "html": "<p>Respect <code>ActiveSupport::Logger.new</code>’s <code>:formatter</code> keyword argument</p>\n\n<p>The stdlib <code>Logger::new</code> allows passing a <code>:formatter</code> keyword argument to<br />\nset the logger’s formatter. Previously <code>ActiveSupport::Logger.new</code> ignored<br />\nthat argument by always setting the formatter to an instance of<br />\n<code>ActiveSupport::Logger::SimpleFormatter</code>.</p>\n\n<p><em>Steven Harman</em></p>\n"
  },
  {
    "message": "*   Deprecate preserving the pre-Ruby 2.4 behavior of `to_time`\n\n    With Ruby 2.4+ the default for +to_time+ changed from converting to the\n    local system time to preserving the offset of the receiver. At the time Rails\n    supported older versions of Ruby so a compatibility layer was added to assist\n    in the migration process. From Rails 5.0 new applications have defaulted to\n    the Ruby 2.4+ behavior and since Rails 7.0 now only supports Ruby 2.7+\n    this compatibility layer can be safely removed.\n\n    To minimize any noise generated the deprecation warning only appears when the\n    setting is configured to `false` as that is the only scenario where the\n    removal of the compatibility layer has any effect.\n\n    *Andrew White*",
    "project": "activesupport",
    "date_merged": 1647817004000,
    "author": "Andrew White",
    "sha": "1943962a10d79737ad9d5c56e20d9ac8a50d11c3",
    "pr": "44728",
    "merge_sha": "2797fc413a5486788cee387d695d6d1621608765",
    "html": "<p>Deprecate preserving the pre-Ruby 2.4 behavior of <code>to_time</code></p>\n\n<p>With Ruby 2.4+ the default for +to_time+ changed from converting to the<br />\nlocal system time to preserving the offset of the receiver. At the time Rails<br />\nsupported older versions of Ruby so a compatibility layer was added to assist<br />\nin the migration process. From Rails 5.0 new applications have defaulted to<br />\nthe Ruby 2.4+ behavior and since Rails 7.0 now only supports Ruby 2.7+<br />\nthis compatibility layer can be safely removed.</p>\n\n<p>To minimize any noise generated the deprecation warning only appears when the<br />\nsetting is configured to <code>false</code> as that is the only scenario where the<br />\nremoval of the compatibility layer has any effect.</p>\n\n<p><em>Andrew White</em></p>\n"
  },
  {
    "message": "*   `Pathname.blank?` only returns true for `Pathname.new(\"\")`\n\n    Previously it would end up calling `Pathname#empty?` which returned true\n    if the path existed and was an empty directory or file.\n\n    That behavior was unlikely to be expected.\n\n    *Jean Boussier*",
    "project": "activesupport",
    "date_merged": 1645345968000,
    "author": "Jean Boussier",
    "sha": "0ac4c04143e85756a661b07f4b09cf0b023ddb04",
    "pr": "44485",
    "merge_sha": "13d75c40fd477c189964429daca9b71045a49665",
    "html": "<p><code>Pathname.blank?</code> only returns true for <code>Pathname.new(\"\")</code></p>\n\n<p>Previously it would end up calling <code>Pathname#empty?</code> which returned true<br />\nif the path existed and was an empty directory or file.</p>\n\n<p>That behavior was unlikely to be expected.</p>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   Deprecate `Notification::Event`'s `#children` and `#parent_of?`\n\n    *John Hawthorn*",
    "project": "activesupport",
    "date_merged": 1645116348000,
    "author": "John Hawthorn",
    "sha": "9f0b8eb5843b8f8db19440fcb1962727f655eed1",
    "pr": "43390",
    "merge_sha": "3e2f9a66dbd52138cd1bb9db062ac564f7841867",
    "html": "<p>Deprecate <code>Notification::Event</code>’s <code>#children</code> and <code>#parent_of?</code></p>\n\n<p><em>John Hawthorn</em></p>\n"
  },
  {
    "message": "*   Change the default serializer of `ActiveSupport::MessageVerifier` from\n    `Marshal` to `ActiveSupport::JSON` when using `config.load_defaults 7.1`.\n\n    Messages serialized with `Marshal` can still be read, but new messages will\n    be serialized with `ActiveSupport::JSON`. For more information, see\n    https://guides.rubyonrails.org/v7.1/configuring.html#config-active-support-message-serializer.\n\n    *Saba Kiaei*, *David Buckley*, and *Jonathan Hefner*",
    "project": "activesupport",
    "date_merged": 1683567682000,
    "author": "Jonathan Hefner",
    "sha": "9fbfd8100bf0f141769d2ced42940b2d7b9b71f0",
    "pr": "47963",
    "merge_sha": "e49fcfa0dc4139edfb02c696666ec63eef29e422",
    "html": "<p>Change the default serializer of <code>ActiveSupport::MessageVerifier</code> from<br />\n<code>Marshal</code> to <code>ActiveSupport::JSON</code> when using <code>config.load_defaults 7.1</code>.</p>\n\n<p>Messages serialized with <code>Marshal</code> can still be read, but new messages will<br />\nbe serialized with <code>ActiveSupport::JSON</code>. For more information, see<br />\nhttps://guides.rubyonrails.org/v7.1/configuring.html#config-active-support-message-serializer.</p>\n\n<p><em>Saba Kiaei</em>, <em>David Buckley</em>, and <em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Change the default serializer of `ActiveSupport::MessageEncryptor` from\n    `Marshal` to `ActiveSupport::JSON` when using `config.load_defaults 7.1`.\n\n    Messages serialized with `Marshal` can still be read, but new messages will\n    be serialized with `ActiveSupport::JSON`. For more information, see\n    https://guides.rubyonrails.org/v7.1/configuring.html#config-active-support-message-serializer.\n\n    *Zack Deveau*, *Martin Gingras*, and *Jonathan Hefner*",
    "project": "activesupport",
    "date_merged": 1683567682000,
    "author": "Jonathan Hefner",
    "sha": "9fbfd8100bf0f141769d2ced42940b2d7b9b71f0",
    "pr": "47963",
    "merge_sha": "e49fcfa0dc4139edfb02c696666ec63eef29e422",
    "html": "<p>Change the default serializer of <code>ActiveSupport::MessageEncryptor</code> from<br />\n<code>Marshal</code> to <code>ActiveSupport::JSON</code> when using <code>config.load_defaults 7.1</code>.</p>\n\n<p>Messages serialized with <code>Marshal</code> can still be read, but new messages will<br />\nbe serialized with <code>ActiveSupport::JSON</code>. For more information, see<br />\nhttps://guides.rubyonrails.org/v7.1/configuring.html#config-active-support-message-serializer.</p>\n\n<p><em>Zack Deveau</em>, <em>Martin Gingras</em>, and <em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Add `ActiveSupport::TestCase#stub_const` to stub a constant for the duration of a yield.\n\n    *DHH*",
    "project": "activesupport",
    "date_merged": 1643738990000,
    "author": "David Heinemeier Hansson",
    "sha": "fdb98d218eadd31f7b513a08697677610921f878",
    "pr": "44294",
    "merge_sha": "8415d8ff797b0b4c3facb7449bb5315a6f8bd272",
    "html": "<p>Add <code>ActiveSupport::TestCase#stub_const</code> to stub a constant for the duration of a yield.</p>\n\n<p><em>DHH</em></p>\n"
  },
  {
    "message": "*   Fix `ActiveSupport::EncryptedConfiguration` to be compatible with Psych 4\n\n    *Stephen Sugden*",
    "project": "activesupport",
    "date_merged": 1643199285000,
    "author": "Stephen Sugden",
    "sha": "d5b65c082ef0c17241de26d5131e5b4d8a01b186",
    "pr": "44244",
    "merge_sha": "bd41655d17ff85c3118a4c69d19bad47b6a2890f",
    "html": "<p>Fix <code>ActiveSupport::EncryptedConfiguration</code> to be compatible with Psych 4</p>\n\n<p><em>Stephen Sugden</em></p>\n"
  },
  {
    "message": "*   Improve `File.atomic_write` error handling\n\n    *Daniel Pepper*",
    "project": "activesupport",
    "date_merged": 1642410859000,
    "author": "Daniel Pepper",
    "sha": "44a2971e5c7d474b9a5c57fdd916281cd93609ec",
    "pr": "44151",
    "merge_sha": "9fb6cdf8fafea8d23fae06586f0f3248f873d53c",
    "html": "<p>Improve <code>File.atomic_write</code> error handling</p>\n\n<p><em>Daniel Pepper</em></p>\n"
  },
  {
    "message": "*   Fix `Class#descendants` and `DescendantsTracker#descendants` compatibility with Ruby 3.1.\n\n    [The native `Class#descendants` was reverted prior to Ruby 3.1 release](https://bugs.ruby-lang.org/issues/14394#note-33),\n    but `Class#subclasses` was kept, breaking the feature detection.\n\n    *Jean Boussier*",
    "project": "activesupport",
    "date_merged": 1640084368000,
    "author": "Jean Boussier",
    "sha": "68e9df0257474cbd7aa3781322487a0defb06596",
    "pr": "43951",
    "merge_sha": "58c0b76982e3fbcb5642223effd9cce93947029e",
    "html": "<p>Fix <code>Class#descendants</code> and <code>DescendantsTracker#descendants</code> compatibility with Ruby 3.1.</p>\n\n<p><a href=\"https://bugs.ruby-lang.org/issues/14394#note-33\">The native <code>Class#descendants</code> was reverted prior to Ruby 3.1 release</a>,<br />\nbut <code>Class#subclasses</code> was kept, breaking the feature detection.</p>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   Mailers are listed in alphabetical order on the mailer preview page now.\n\n    *Martin Spickermann*",
    "project": "actionmailer",
    "date_merged": 1692637578000,
    "author": "Martin Spickermann",
    "sha": "dd8b0e4684b85b0f765081d8f6b911ffb0dfc0fc",
    "pr": "48989",
    "merge_sha": "3bfda4c66cdbc55ed066bb8287485342120b2507",
    "html": "<p>Mailers are listed in alphabetical order on the mailer preview page now.</p>\n\n<p><em>Martin Spickermann</em></p>\n"
  },
  {
    "message": "*   Deprecate passing params to `assert_enqueued_email_with` via the `:args`\n    kwarg. `assert_enqueued_email_with` now supports a `:params` kwarg, so use\n    that to pass params:\n\n    ```ruby\n    # BEFORE\n    assert_enqueued_email_with MyMailer, :my_method, args: { my_param: \"value\" }\n\n    # AFTER\n    assert_enqueued_email_with MyMailer, :my_method, params: { my_param: \"value\" }\n    ```\n\n    To specify named mailer args as a Hash, wrap the Hash in an array:\n\n    ```ruby\n    assert_enqueued_email_with MyMailer, :my_method, args: [{ my_arg: \"value\" }]\n    # OR\n    assert_enqueued_email_with MyMailer, :my_method, args: [my_arg: \"value\"]\n    ```\n\n    *Jonathan Hefner*",
    "project": "actionmailer",
    "date_merged": 1684535210000,
    "author": "Jonathan Hefner",
    "sha": "19df9465852267cda9db93f484cf31ec7bebce88",
    "pr": "48194",
    "merge_sha": "fc9470aa973a8b6f1a5693bae4edec4c2b4e61aa",
    "html": "<p>Deprecate passing params to <code>assert_enqueued_email_with</code> via the <code>:args</code><br />\nkwarg. <code>assert_enqueued_email_with</code> now supports a <code>:params</code> kwarg, so use<br />\nthat to pass params:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># BEFORE</span>\n<span class=\"n\">assert_enqueued_email_with</span> <span class=\"no\">MyMailer</span><span class=\"p\">,</span> <span class=\"ss\">:my_method</span><span class=\"p\">,</span> <span class=\"ss\">args: </span><span class=\"p\">{</span> <span class=\"ss\">my_param: </span><span class=\"s2\">\"value\"</span> <span class=\"p\">}</span>\n\n<span class=\"c1\"># AFTER</span>\n<span class=\"n\">assert_enqueued_email_with</span> <span class=\"no\">MyMailer</span><span class=\"p\">,</span> <span class=\"ss\">:my_method</span><span class=\"p\">,</span> <span class=\"ss\">params: </span><span class=\"p\">{</span> <span class=\"ss\">my_param: </span><span class=\"s2\">\"value\"</span> <span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>To specify named mailer args as a Hash, wrap the Hash in an array:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">assert_enqueued_email_with</span> <span class=\"no\">MyMailer</span><span class=\"p\">,</span> <span class=\"ss\">:my_method</span><span class=\"p\">,</span> <span class=\"ss\">args: </span><span class=\"p\">[{</span> <span class=\"ss\">my_arg: </span><span class=\"s2\">\"value\"</span> <span class=\"p\">}]</span>\n<span class=\"c1\"># OR</span>\n<span class=\"n\">assert_enqueued_email_with</span> <span class=\"no\">MyMailer</span><span class=\"p\">,</span> <span class=\"ss\">:my_method</span><span class=\"p\">,</span> <span class=\"ss\">args: </span><span class=\"p\">[</span><span class=\"ss\">my_arg: </span><span class=\"s2\">\"value\"</span><span class=\"p\">]</span>\n</code></pre></div></div>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Accept procs for args and params in `assert_enqueued_email_with`\n\n    ```ruby\n    assert_enqueued_email_with DeliveryJob, params: -> p { p[:token] =~ /\\w+/ } do\n      UserMailer.with(token: user.generate_token).email_verification.deliver_later\n    end\n    ```\n\n    *Max Chernyak*",
    "project": "actionmailer",
    "date_merged": 1683828395000,
    "author": "Max Chernyak",
    "sha": "96f19e965b0ce4d50e958e02a66f6c005496fdcd",
    "pr": "46626",
    "merge_sha": "cb1073e664c41c3c4c87dee4788cc2a326247b4f",
    "html": "<p>Accept procs for args and params in <code>assert_enqueued_email_with</code></p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">assert_enqueued_email_with</span> <span class=\"no\">DeliveryJob</span><span class=\"p\">,</span> <span class=\"ss\">params: </span><span class=\"o\">-&gt;</span> <span class=\"nb\">p</span> <span class=\"p\">{</span> <span class=\"nb\">p</span><span class=\"p\">[</span><span class=\"ss\">:token</span><span class=\"p\">]</span> <span class=\"o\">=~</span> <span class=\"sr\">/\\w+/</span> <span class=\"p\">}</span> <span class=\"k\">do</span>\n  <span class=\"no\">UserMailer</span><span class=\"p\">.</span><span class=\"nf\">with</span><span class=\"p\">(</span><span class=\"ss\">token: </span><span class=\"n\">user</span><span class=\"p\">.</span><span class=\"nf\">generate_token</span><span class=\"p\">).</span><span class=\"nf\">email_verification</span><span class=\"p\">.</span><span class=\"nf\">deliver_later</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p><em>Max Chernyak</em></p>\n"
  },
  {
    "message": "*   Added `*_deliver` callbacks to `ActionMailer::Base` that wrap mail message delivery.\n\n    Example:\n\n    ```ruby\n    class EventsMailer < ApplicationMailer\n      after_deliver do\n        User.find_by(email: message.to.first).update(email_provider_id: message.message_id, emailed_at: Time.current)\n      end\n    end\n    ```\n\n    *Ben Sheldon*",
    "project": "actionmailer",
    "date_merged": 1680645495000,
    "author": "Ben Sheldon",
    "sha": "468d80640613a3817ea2e53b24b5f39ef92a57ac",
    "pr": "47630",
    "merge_sha": "6cd8dddb92f41b8b0732557dc7a85f5bebf40308",
    "html": "<p>Added <code>*_deliver</code> callbacks to <code>ActionMailer::Base</code> that wrap mail message delivery.</p>\n\n<p>Example:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">class</span> <span class=\"nc\">EventsMailer</span> <span class=\"o\">&lt;</span> <span class=\"no\">ApplicationMailer</span>\n  <span class=\"n\">after_deliver</span> <span class=\"k\">do</span>\n    <span class=\"no\">User</span><span class=\"p\">.</span><span class=\"nf\">find_by</span><span class=\"p\">(</span><span class=\"ss\">email: </span><span class=\"n\">message</span><span class=\"p\">.</span><span class=\"nf\">to</span><span class=\"p\">.</span><span class=\"nf\">first</span><span class=\"p\">).</span><span class=\"nf\">update</span><span class=\"p\">(</span><span class=\"ss\">email_provider_id: </span><span class=\"n\">message</span><span class=\"p\">.</span><span class=\"nf\">message_id</span><span class=\"p\">,</span> <span class=\"ss\">emailed_at: </span><span class=\"no\">Time</span><span class=\"p\">.</span><span class=\"nf\">current</span><span class=\"p\">)</span>\n  <span class=\"k\">end</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p><em>Ben Sheldon</em></p>\n"
  },
  {
    "message": "*   Added `deliver_enqueued_emails` to `ActionMailer::TestHelper`. This method\n    delivers all enqueued email jobs.\n\n    Example:\n\n    ```ruby\n    def test_deliver_enqueued_emails\n      deliver_enqueued_emails do\n        ContactMailer.welcome.deliver_later\n      end\n      assert_emails 1\n    end\n    ```\n\n    *Andrew Novoselac*",
    "project": "actionmailer",
    "date_merged": 1677611625000,
    "author": "Andrew Novoselac",
    "sha": "f2cacd5d11061c64c30d0fbc8741cb42d58fd01f",
    "pr": "47520",
    "merge_sha": "0b95524ac8e0729c04cbd080a1ad57c6dd7c9c07",
    "html": "<p>Added <code>deliver_enqueued_emails</code> to <code>ActionMailer::TestHelper</code>. This method<br />\ndelivers all enqueued email jobs.</p>\n\n<p>Example:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">def</span> <span class=\"nf\">test_deliver_enqueued_emails</span>\n  <span class=\"n\">deliver_enqueued_emails</span> <span class=\"k\">do</span>\n    <span class=\"no\">ContactMailer</span><span class=\"p\">.</span><span class=\"nf\">welcome</span><span class=\"p\">.</span><span class=\"nf\">deliver_later</span>\n  <span class=\"k\">end</span>\n  <span class=\"n\">assert_emails</span> <span class=\"mi\">1</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p><em>Andrew Novoselac</em></p>\n"
  },
  {
    "message": "*   The `deliver_later_queue_name` used by the default mailer job can now be\n    configured on a per-mailer basis. Previously this was only configurable\n    for all mailers via `ActionMailer::Base`.\n\n    Example:\n\n    ```ruby\n    class EventsMailer < ApplicationMailer\n      self.deliver_later_queue_name = :throttled_mailer\n    end\n    ```\n\n    *Jeffrey Hardy*",
    "project": "actionmailer",
    "date_merged": 1676682401000,
    "author": "Jeffrey Hardy",
    "sha": "fa17c9ac99a68759e3d4d79e64f0dd836470bf87",
    "pr": "47408",
    "merge_sha": "9192027f0b8e06cd86f94bf6337823c88d6f7bfa",
    "html": "<p>The <code>deliver_later_queue_name</code> used by the default mailer job can now be<br />\nconfigured on a per-mailer basis. Previously this was only configurable<br />\nfor all mailers via <code>ActionMailer::Base</code>.</p>\n\n<p>Example:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">class</span> <span class=\"nc\">EventsMailer</span> <span class=\"o\">&lt;</span> <span class=\"no\">ApplicationMailer</span>\n  <span class=\"nb\">self</span><span class=\"p\">.</span><span class=\"nf\">deliver_later_queue_name</span> <span class=\"o\">=</span> <span class=\"ss\">:throttled_mailer</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p><em>Jeffrey Hardy</em></p>\n"
  },
  {
    "message": "*   Email previews now include an expandable section to show all headers.\n\n    Headers like `Message-ID` for threading or email service provider specific\n    features like analytics tags or account metadata can now be viewed directly\n    in the mailer preview.\n\n    *Matt Swanson*",
    "project": "actionmailer",
    "date_merged": 1675922021000,
    "author": "zzak",
    "sha": "b3d64e01122cdb50eeb1813e598d89886ab68a3d",
    "pr": "47331",
    "merge_sha": "5315d8d04d5c9eb6f31ae61f9956bf514e7c79ec",
    "html": "<p>Email previews now include an expandable section to show all headers.</p>\n\n<p>Headers like <code>Message-ID</code> for threading or email service provider specific<br />\nfeatures like analytics tags or account metadata can now be viewed directly<br />\nin the mailer preview.</p>\n\n<p><em>Matt Swanson</em></p>\n"
  },
  {
    "message": "*   Default `ActionMailer::Parameterized#params` to an empty `Hash`\n\n    *Sean Doyle*",
    "project": "actionmailer",
    "date_merged": 1674501752000,
    "author": "Sean Doyle",
    "sha": "6fea9a09f255fb0e20b7e8a096de688721c3cbe3",
    "pr": "47101",
    "merge_sha": "b308a9946dc728cbad80310c11c25bc6f86e6d6f",
    "html": "<p>Default <code>ActionMailer::Parameterized#params</code> to an empty <code>Hash</code></p>\n\n<p><em>Sean Doyle</em></p>\n"
  },
  {
    "message": "*   Introduce the `capture_emails` test helper.\n\n    Returns all emails that are sent in a block.\n\n    ```ruby\n    def test_emails\n      emails = capture_emails do\n        ContactMailer.welcome.deliver_now\n        ContactMailer.welcome.deliver_later\n      end\n      assert_email \"Hi there\", emails.first.subject\n    end\n    ```\n\n    *Alex Ghiculescu*",
    "project": "actionmailer",
    "date_merged": 1690296673000,
    "author": "Alex Ghiculescu",
    "sha": "455e922b49c5de92882d10783c3014f6bf34a146",
    "pr": "48798",
    "merge_sha": "06e8bb5b4cc52fc26b72073c2a5c2b29ff569610",
    "html": "<p>Introduce the <code>capture_emails</code> test helper.</p>\n\n<p>Returns all emails that are sent in a block.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">def</span> <span class=\"nf\">test_emails</span>\n  <span class=\"n\">emails</span> <span class=\"o\">=</span> <span class=\"n\">capture_emails</span> <span class=\"k\">do</span>\n    <span class=\"no\">ContactMailer</span><span class=\"p\">.</span><span class=\"nf\">welcome</span><span class=\"p\">.</span><span class=\"nf\">deliver_now</span>\n    <span class=\"no\">ContactMailer</span><span class=\"p\">.</span><span class=\"nf\">welcome</span><span class=\"p\">.</span><span class=\"nf\">deliver_later</span>\n  <span class=\"k\">end</span>\n  <span class=\"n\">assert_email</span> <span class=\"s2\">\"Hi there\"</span><span class=\"p\">,</span> <span class=\"n\">emails</span><span class=\"p\">.</span><span class=\"nf\">first</span><span class=\"p\">.</span><span class=\"nf\">subject</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p><em>Alex Ghiculescu</em></p>\n"
  },
  {
    "message": "*   Added ability to download `.eml` file for the email preview.\n\n    *Igor Kasyanchuk*",
    "project": "actionmailer",
    "date_merged": 1662759599000,
    "author": "Igor Kasyanchuk",
    "sha": "9f0a064fde3c053c1436fe6c88279b287fe01cad",
    "pr": "45987",
    "merge_sha": "cbf4290f0e94579e7dcfaf02df0dcd327b2951c3",
    "html": "<p>Added ability to download <code>.eml</code> file for the email preview.</p>\n\n<p><em>Igor Kasyanchuk</em></p>\n"
  },
  {
    "message": "*   Support multiple preview paths for mailers.\n\n    Option `config.action_mailer.preview_path` is deprecated in favor of\n    `config.action_mailer.preview_paths`. Appending paths to this configuration option\n    will cause those paths to be used in the search for mailer previews.\n\n    *fatkodima*",
    "project": "actionmailer",
    "date_merged": 1660072818000,
    "author": "fatkodima",
    "sha": "64ad045e472a60872e5547a381c3af896a546dfd",
    "pr": "31595",
    "merge_sha": "95066e5fbd617edeaa6b1d28a50f295145aee52d",
    "html": "<p>Support multiple preview paths for mailers.</p>\n\n<p>Option <code>config.action_mailer.preview_path</code> is deprecated in favor of<br />\n<code>config.action_mailer.preview_paths</code>. Appending paths to this configuration option<br />\nwill cause those paths to be used in the search for mailer previews.</p>\n\n<p><em>fatkodima</em></p>\n"
  },
  {
    "message": "*   Support composite identifiers in `to_key`\n\n    `to_key` avoids wrapping `#id` value into an `Array` if `#id` already an array\n\n    *Nikita Vasilevsky*",
    "project": "activemodel",
    "date_merged": 1693584579000,
    "author": "Nikita Vasilevsky",
    "sha": "0df4df4d15860425529a9eb2e73d26885d8e9678",
    "pr": "49110",
    "merge_sha": "b1fca671554a9de9929823dd873670e2f6f3cdaf",
    "html": "<p>Support composite identifiers in <code>to_key</code></p>\n\n<p><code>to_key</code> avoids wrapping <code>#id</code> value into an <code>Array</code> if <code>#id</code> already an array</p>\n\n<p><em>Nikita Vasilevsky</em></p>\n"
  },
  {
    "message": "*   Add `ActiveModel::Conversion.param_delimiter` to configure delimiter being used in `to_param`\n\n    *Nikita Vasilevsky*",
    "project": "activemodel",
    "date_merged": 1692828674000,
    "author": "Nikita Vasilevsky",
    "sha": "37342a37fd1031e1ec9fc0ba87ad00aca1fa0f3e",
    "pr": "49020",
    "merge_sha": "d70707d9af15587e8debf669e81547bc4258b6c8",
    "html": "<p>Add <code>ActiveModel::Conversion.param_delimiter</code> to configure delimiter being used in <code>to_param</code></p>\n\n<p><em>Nikita Vasilevsky</em></p>\n"
  },
  {
    "message": "*   `undefine_attribute_methods` undefines alias attribute methods along with attribute methods.\n\n    *Nikita Vasilevsky*",
    "project": "activemodel",
    "date_merged": 1692815919000,
    "author": "Nikita Vasilevsky",
    "sha": "e50fce0fa9729fbf836e14854b9c84956e493ca1",
    "pr": "49015",
    "merge_sha": "3a680cd64739a47052ee75db986fb1ca22486a1c",
    "html": "<p><code>undefine_attribute_methods</code> undefines alias attribute methods along with attribute methods.</p>\n\n<p><em>Nikita Vasilevsky</em></p>\n"
  },
  {
    "message": "*   Error.full_message now strips \":base\" from the message.\n\n    *zzak*",
    "project": "activemodel",
    "date_merged": 1691008271000,
    "author": "Rafael Mendonça França",
    "sha": "6793dd9396f7aab7bd4aec1d1fbed76ae5e4efe1",
    "pr": "48871",
    "merge_sha": "ff470edccc746fe3cf466a0fa54fb08383e8de66",
    "html": "<p>Error.full_message now strips “:base” from the message.</p>\n\n<p><em>zzak</em></p>\n"
  },
  {
    "message": "*   Add a load hook for `ActiveModel::Model` (named `active_model`) to match the load hook for\n    `ActiveRecord::Base` and allow for overriding aspects of the `ActiveModel::Model` class.\n\n    *Lewis Buckley*",
    "project": "activemodel",
    "date_merged": 1691008271000,
    "author": "Rafael Mendonça França",
    "sha": "6793dd9396f7aab7bd4aec1d1fbed76ae5e4efe1",
    "pr": "48871",
    "merge_sha": "ff470edccc746fe3cf466a0fa54fb08383e8de66",
    "html": "<p>Add a load hook for <code>ActiveModel::Model</code> (named <code>active_model</code>) to match the load hook for<br />\n<code>ActiveRecord::Base</code> and allow for overriding aspects of the <code>ActiveModel::Model</code> class.</p>\n\n<p><em>Lewis Buckley</em></p>\n"
  },
  {
    "message": "*   Improve password length validation in ActiveModel::SecurePassword to consider byte size for BCrypt\n    compatibility.\n\n    The previous password length validation only considered the character count, which may not\n    accurately reflect the 72-byte size limit imposed by BCrypt. This change updates the validation\n    to consider both character count and byte size while keeping the character length validation in place.\n\n    ```ruby\n      user = User.new(password: \"a\" * 73)  # 73 characters\n      user.valid? # => false\n      user.errors[:password] # => [\"is too long\"]\n\n\n      user = User.new(password: \"あ\" * 25)  # 25 characters, 75 bytes\n      user.valid? # => false\n      user.errors[:password] # => [\"is too long\"]\n    ```\n\n    *ChatGPT*, *Guillermo Iguaran*",
    "project": "activemodel",
    "date_merged": 1691008271000,
    "author": "Rafael Mendonça França",
    "sha": "6793dd9396f7aab7bd4aec1d1fbed76ae5e4efe1",
    "pr": "48871",
    "merge_sha": "ff470edccc746fe3cf466a0fa54fb08383e8de66",
    "html": "<p>Improve password length validation in ActiveModel::SecurePassword to consider byte size for BCrypt<br />\ncompatibility.</p>\n\n<p>The previous password length validation only considered the character count, which may not<br />\naccurately reflect the 72-byte size limit imposed by BCrypt. This change updates the validation<br />\nto consider both character count and byte size while keeping the character length validation in place.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>  <span class=\"n\">user</span> <span class=\"o\">=</span> <span class=\"no\">User</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"ss\">password: </span><span class=\"s2\">\"a\"</span> <span class=\"o\">*</span> <span class=\"mi\">73</span><span class=\"p\">)</span>  <span class=\"c1\"># 73 characters</span>\n  <span class=\"n\">user</span><span class=\"p\">.</span><span class=\"nf\">valid?</span> <span class=\"c1\"># =&gt; false</span>\n  <span class=\"n\">user</span><span class=\"p\">.</span><span class=\"nf\">errors</span><span class=\"p\">[</span><span class=\"ss\">:password</span><span class=\"p\">]</span> <span class=\"c1\"># =&gt; [\"is too long\"]</span>\n\n\n  <span class=\"n\">user</span> <span class=\"o\">=</span> <span class=\"no\">User</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"ss\">password: </span><span class=\"s2\">\"あ\"</span> <span class=\"o\">*</span> <span class=\"mi\">25</span><span class=\"p\">)</span>  <span class=\"c1\"># 25 characters, 75 bytes</span>\n  <span class=\"n\">user</span><span class=\"p\">.</span><span class=\"nf\">valid?</span> <span class=\"c1\"># =&gt; false</span>\n  <span class=\"n\">user</span><span class=\"p\">.</span><span class=\"nf\">errors</span><span class=\"p\">[</span><span class=\"ss\">:password</span><span class=\"p\">]</span> <span class=\"c1\"># =&gt; [\"is too long\"]</span>\n</code></pre></div></div>\n\n<p><em>ChatGPT</em>, <em>Guillermo Iguaran</em></p>\n"
  },
  {
    "message": "*   `has_secure_password` now generates an `#{attribute}_salt` method that returns the salt\n    used to compute the password digest. The salt will change whenever the password is changed,\n    so it can be used to create single-use password reset tokens with `generates_token_for`:\n\n    ```ruby\n    class User < ActiveRecord::Base\n      has_secure_password\n\n      generates_token_for :password_reset, expires_in: 15.minutes do\n        password_salt&.last(10)\n      end\n    end\n    ```\n\n    *Lázaro Nixon*",
    "project": "activemodel",
    "date_merged": 1678395190000,
    "author": "Nixon",
    "sha": "ebe9e575b7691c6a04abfadfedfb55516eb63e47",
    "pr": "47490",
    "merge_sha": "db8f664b509b362400200d4ea5da261ccd74f7b3",
    "html": "<p><code>has_secure_password</code> now generates an <code>#{attribute}_salt</code> method that returns the salt<br />\nused to compute the password digest. The salt will change whenever the password is changed,<br />\nso it can be used to create single-use password reset tokens with <code>generates_token_for</code>:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">class</span> <span class=\"nc\">User</span> <span class=\"o\">&lt;</span> <span class=\"no\">ActiveRecord</span><span class=\"o\">::</span><span class=\"no\">Base</span>\n  <span class=\"n\">has_secure_password</span>\n\n  <span class=\"n\">generates_token_for</span> <span class=\"ss\">:password_reset</span><span class=\"p\">,</span> <span class=\"ss\">expires_in: </span><span class=\"mi\">15</span><span class=\"p\">.</span><span class=\"nf\">minutes</span> <span class=\"k\">do</span>\n    <span class=\"n\">password_salt</span><span class=\"o\">&amp;</span><span class=\"p\">.</span><span class=\"nf\">last</span><span class=\"p\">(</span><span class=\"mi\">10</span><span class=\"p\">)</span>\n  <span class=\"k\">end</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p><em>Lázaro Nixon</em></p>\n"
  },
  {
    "message": "*   Improve typography of user facing error messages. In English contractions,\n    the Unicode APOSTROPHE (`U+0027`) is now RIGHT SINGLE QUOTATION MARK\n    (`U+2019`). For example, \"can't be blank\" is now \"can’t be blank\".\n\n    *Jon Dufresne*",
    "project": "activemodel",
    "date_merged": 1677884281000,
    "author": "Jon Dufresne",
    "sha": "da82e587f2a3fdc7625e23ccc5ef2814bad74d8f",
    "pr": "45463",
    "merge_sha": "9f60cd8dc7d963b1843b66d9639715b4a04c9c65",
    "html": "<p>Improve typography of user facing error messages. In English contractions,<br />\nthe Unicode APOSTROPHE (<code>U+0027</code>) is now RIGHT SINGLE QUOTATION MARK<br />\n(<code>U+2019</code>). For example, “can’t be blank” is now “can’t be blank”.</p>\n\n<p><em>Jon Dufresne</em></p>\n"
  },
  {
    "message": "*   Add class to `ActiveModel::MissingAttributeError` error message.\n\n    Show which class is missing the attribute in the error message:\n\n    ```ruby\n    user = User.first\n    user.pets.select(:id).first.user_id\n    # => ActiveModel::MissingAttributeError: missing attribute 'user_id' for Pet\n    ```\n\n    *Petrik de Heus*",
    "project": "activemodel",
    "date_merged": 1677943647000,
    "author": "zzak",
    "sha": "aa2052ec4ceb64682828154e8669ac0327c678db",
    "pr": "45463",
    "merge_sha": "c8780e2895ed7ced6c7bb8b2357a030f354e48cc",
    "html": "<p>Add class to <code>ActiveModel::MissingAttributeError</code> error message.</p>\n\n<p>Show which class is missing the attribute in the error message:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">user</span> <span class=\"o\">=</span> <span class=\"no\">User</span><span class=\"p\">.</span><span class=\"nf\">first</span>\n<span class=\"n\">user</span><span class=\"p\">.</span><span class=\"nf\">pets</span><span class=\"p\">.</span><span class=\"nf\">select</span><span class=\"p\">(</span><span class=\"ss\">:id</span><span class=\"p\">).</span><span class=\"nf\">first</span><span class=\"p\">.</span><span class=\"nf\">user_id</span>\n<span class=\"c1\"># =&gt; ActiveModel::MissingAttributeError: missing attribute 'user_id' for Pet</span>\n</code></pre></div></div>\n\n<p><em>Petrik de Heus</em></p>\n"
  },
  {
    "message": "*   Raise `NoMethodError` in `ActiveModel::Type::Value#as_json` to avoid unpredictable\n    results.\n\n    *Vasiliy Ermolovich*",
    "project": "activemodel",
    "date_merged": 1669665262000,
    "author": "Vasiliy Ermolovich",
    "sha": "433bd5995db00156fa2942a6043944ae7510ca1c",
    "pr": "46535",
    "merge_sha": "5df0f0da7cd682e491933337dcfee937fa34dc3c",
    "html": "<p>Raise <code>NoMethodError</code> in <code>ActiveModel::Type::Value#as_json</code> to avoid unpredictable<br />\nresults.</p>\n\n<p><em>Vasiliy Ermolovich</em></p>\n"
  },
  {
    "message": "*   Custom attribute types that inherit from Active Model built-in types and do\n    not override the `serialize` method will now benefit from an optimization\n    when serializing attribute values for the database.\n\n    For example, with a custom type like the following:\n\n    ```ruby\n    class DowncasedString < ActiveModel::Type::String\n      def cast(value)\n        super&.downcase\n      end\n    end\n\n    ActiveRecord::Type.register(:downcased_string, DowncasedString)\n\n    class User < ActiveRecord::Base\n      attribute :email, :downcased_string\n    end\n\n    user = User.new(email: \"FooBar@example.com\")\n    ```\n\n    Serializing the `email` attribute for the database will be roughly twice as\n    fast.  More expensive `cast` operations will likely see greater improvements.\n\n    *Jonathan Hefner*",
    "project": "activemodel",
    "date_merged": 1665956420000,
    "author": "Jonathan Hefner",
    "sha": "28ebf3c81c1cf083cc920822157d63e7b480ee93",
    "pr": "46219",
    "merge_sha": "c2c778152c047e45693b38fe5e0be3fe8ad0573e",
    "html": "<p>Custom attribute types that inherit from Active Model built-in types and do<br />\nnot override the <code>serialize</code> method will now benefit from an optimization<br />\nwhen serializing attribute values for the database.</p>\n\n<p>For example, with a custom type like the following:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">class</span> <span class=\"nc\">DowncasedString</span> <span class=\"o\">&lt;</span> <span class=\"no\">ActiveModel</span><span class=\"o\">::</span><span class=\"no\">Type</span><span class=\"o\">::</span><span class=\"no\">String</span>\n  <span class=\"k\">def</span> <span class=\"nf\">cast</span><span class=\"p\">(</span><span class=\"n\">value</span><span class=\"p\">)</span>\n    <span class=\"k\">super</span><span class=\"o\">&amp;</span><span class=\"p\">.</span><span class=\"nf\">downcase</span>\n  <span class=\"k\">end</span>\n<span class=\"k\">end</span>\n\n<span class=\"no\">ActiveRecord</span><span class=\"o\">::</span><span class=\"no\">Type</span><span class=\"p\">.</span><span class=\"nf\">register</span><span class=\"p\">(</span><span class=\"ss\">:downcased_string</span><span class=\"p\">,</span> <span class=\"no\">DowncasedString</span><span class=\"p\">)</span>\n\n<span class=\"k\">class</span> <span class=\"nc\">User</span> <span class=\"o\">&lt;</span> <span class=\"no\">ActiveRecord</span><span class=\"o\">::</span><span class=\"no\">Base</span>\n  <span class=\"n\">attribute</span> <span class=\"ss\">:email</span><span class=\"p\">,</span> <span class=\"ss\">:downcased_string</span>\n<span class=\"k\">end</span>\n\n<span class=\"n\">user</span> <span class=\"o\">=</span> <span class=\"no\">User</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"ss\">email: </span><span class=\"s2\">\"FooBar@example.com\"</span><span class=\"p\">)</span>\n</code></pre></div></div>\n\n<p>Serializing the <code>email</code> attribute for the database will be roughly twice as<br />\nfast.  More expensive <code>cast</code> operations will likely see greater improvements.</p>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   `has_secure_password` now supports password challenges via a\n    `password_challenge` accessor and validation.\n\n    A password challenge is a safeguard to verify that the current user is\n    actually the password owner.  It can be used when changing sensitive model\n    fields, such as the password itself.  It is different than a password\n    confirmation, which is used to prevent password typos.\n\n    When `password_challenge` is set, the validation checks that the value's\n    digest matches the *currently persisted* `password_digest` (i.e.\n    `password_digest_was`).\n\n    This allows a password challenge to be done as part of a typical `update`\n    call, just like a password confirmation.  It also allows a password\n    challenge error to be handled in the same way as other validation errors.\n\n    For example, in the controller, instead of:\n\n    ```ruby\n    password_params = params.require(:password).permit(\n      :password_challenge,\n      :password,\n      :password_confirmation,\n    )\n\n    password_challenge = password_params.delete(:password_challenge)\n    @password_challenge_failed = !current_user.authenticate(password_challenge)\n\n    if !@password_challenge_failed && current_user.update(password_params)\n      # ...\n    end\n    ```\n\n    You can now write:\n\n    ```ruby\n    password_params = params.require(:password).permit(\n      :password_challenge,\n      :password,\n      :password_confirmation,\n    ).with_defaults(password_challenge: \"\")\n\n    if current_user.update(password_params)\n      # ...\n    end\n    ```\n\n    And, in the view, instead of checking `@password_challenge_failed`, you can\n    render an error for the `password_challenge` field just as you would for\n    other form fields, including utilizing `config.action_view.field_error_proc`.\n\n    *Jonathan Hefner*",
    "project": "activemodel",
    "date_merged": 1658812482000,
    "author": "Jonathan Hefner",
    "sha": "71c0c81b479db885d00f01b95824f01801296815",
    "pr": "43688",
    "merge_sha": "f34fbadc104b6a65c10a8c4e5eef18ffa339d6cb",
    "html": "<p><code>has_secure_password</code> now supports password challenges via a<br />\n<code>password_challenge</code> accessor and validation.</p>\n\n<p>A password challenge is a safeguard to verify that the current user is<br />\nactually the password owner.  It can be used when changing sensitive model<br />\nfields, such as the password itself.  It is different than a password<br />\nconfirmation, which is used to prevent password typos.</p>\n\n<p>When <code>password_challenge</code> is set, the validation checks that the value’s<br />\ndigest matches the <em>currently persisted</em> <code>password_digest</code> (i.e.<br />\n<code>password_digest_was</code>).</p>\n\n<p>This allows a password challenge to be done as part of a typical <code>update</code><br />\ncall, just like a password confirmation.  It also allows a password<br />\nchallenge error to be handled in the same way as other validation errors.</p>\n\n<p>For example, in the controller, instead of:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">password_params</span> <span class=\"o\">=</span> <span class=\"n\">params</span><span class=\"p\">.</span><span class=\"nf\">require</span><span class=\"p\">(</span><span class=\"ss\">:password</span><span class=\"p\">).</span><span class=\"nf\">permit</span><span class=\"p\">(</span>\n  <span class=\"ss\">:password_challenge</span><span class=\"p\">,</span>\n  <span class=\"ss\">:password</span><span class=\"p\">,</span>\n  <span class=\"ss\">:password_confirmation</span><span class=\"p\">,</span>\n<span class=\"p\">)</span>\n\n<span class=\"n\">password_challenge</span> <span class=\"o\">=</span> <span class=\"n\">password_params</span><span class=\"p\">.</span><span class=\"nf\">delete</span><span class=\"p\">(</span><span class=\"ss\">:password_challenge</span><span class=\"p\">)</span>\n<span class=\"vi\">@password_challenge_failed</span> <span class=\"o\">=</span> <span class=\"o\">!</span><span class=\"n\">current_user</span><span class=\"p\">.</span><span class=\"nf\">authenticate</span><span class=\"p\">(</span><span class=\"n\">password_challenge</span><span class=\"p\">)</span>\n\n<span class=\"k\">if</span> <span class=\"o\">!</span><span class=\"vi\">@password_challenge_failed</span> <span class=\"o\">&amp;&amp;</span> <span class=\"n\">current_user</span><span class=\"p\">.</span><span class=\"nf\">update</span><span class=\"p\">(</span><span class=\"n\">password_params</span><span class=\"p\">)</span>\n  <span class=\"c1\"># ...</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p>You can now write:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">password_params</span> <span class=\"o\">=</span> <span class=\"n\">params</span><span class=\"p\">.</span><span class=\"nf\">require</span><span class=\"p\">(</span><span class=\"ss\">:password</span><span class=\"p\">).</span><span class=\"nf\">permit</span><span class=\"p\">(</span>\n  <span class=\"ss\">:password_challenge</span><span class=\"p\">,</span>\n  <span class=\"ss\">:password</span><span class=\"p\">,</span>\n  <span class=\"ss\">:password_confirmation</span><span class=\"p\">,</span>\n<span class=\"p\">).</span><span class=\"nf\">with_defaults</span><span class=\"p\">(</span><span class=\"ss\">password_challenge: </span><span class=\"s2\">\"\"</span><span class=\"p\">)</span>\n\n<span class=\"k\">if</span> <span class=\"n\">current_user</span><span class=\"p\">.</span><span class=\"nf\">update</span><span class=\"p\">(</span><span class=\"n\">password_params</span><span class=\"p\">)</span>\n  <span class=\"c1\"># ...</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p>And, in the view, instead of checking <code>@password_challenge_failed</code>, you can<br />\nrender an error for the <code>password_challenge</code> field just as you would for<br />\nother form fields, including utilizing <code>config.action_view.field_error_proc</code>.</p>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Support infinite ranges for `LengthValidator`s `:in`/`:within` options\n\n    ```ruby\n    validates_length_of :first_name, in: ..30\n    ```\n\n    *fatkodima*",
    "project": "activemodel",
    "date_merged": 1653069920000,
    "author": "fatkodima",
    "sha": "91cd5cbc9316ecf558551da6b7dc5326b8a7a3ec",
    "pr": "45138",
    "merge_sha": "aa5e958f658f2a73c97bfbfe2ab988c8dd331433",
    "html": "<p>Support infinite ranges for <code>LengthValidator</code>s <code>:in</code>/<code>:within</code> options</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">validates_length_of</span> <span class=\"ss\">:first_name</span><span class=\"p\">,</span> <span class=\"ss\">in: </span><span class=\"o\">..</span><span class=\"mi\">30</span>\n</code></pre></div></div>\n\n<p><em>fatkodima</em></p>\n"
  },
  {
    "message": "*   Add support for beginless ranges to inclusivity/exclusivity validators:\n\n    ```ruby\n    validates_inclusion_of :birth_date, in: -> { (..Date.today) }\n    ```\n\n    *Bo Jeanes*",
    "project": "activemodel",
    "date_merged": 1653058494000,
    "author": "Bo Jeanes",
    "sha": "28e40a64059a0e134b20297d9b38499cfe24fccc",
    "pr": "45123",
    "merge_sha": "9868a26de4bc72d2ea593c2d97d4adfb2fd73ccd",
    "html": "<p>Add support for beginless ranges to inclusivity/exclusivity validators:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">validates_inclusion_of</span> <span class=\"ss\">:birth_date</span><span class=\"p\">,</span> <span class=\"ss\">in: </span><span class=\"o\">-&gt;</span> <span class=\"p\">{</span> <span class=\"p\">(</span><span class=\"o\">..</span><span class=\"no\">Date</span><span class=\"p\">.</span><span class=\"nf\">today</span><span class=\"p\">)</span> <span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p><em>Bo Jeanes</em></p>\n"
  },
  {
    "message": "*   Make validators accept lambdas without record argument\n\n    ```ruby\n    # Before\n    validates_comparison_of :birth_date, less_than_or_equal_to: ->(_record) { Date.today }\n\n    # After\n    validates_comparison_of :birth_date, less_than_or_equal_to: -> { Date.today }\n    ```\n\n    *fatkodima*",
    "project": "activemodel",
    "date_merged": 1652897327000,
    "author": "fatkodima",
    "sha": "00b269ec8d3f1bd80c36437e684e8c010a91a4d3",
    "pr": "45118",
    "merge_sha": "08555b9bd5f6e40dbecd75df2099a5f827c49fc0",
    "html": "<p>Make validators accept lambdas without record argument</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># Before</span>\n<span class=\"n\">validates_comparison_of</span> <span class=\"ss\">:birth_date</span><span class=\"p\">,</span> <span class=\"ss\">less_than_or_equal_to: </span><span class=\"o\">-&gt;</span><span class=\"p\">(</span><span class=\"n\">_record</span><span class=\"p\">)</span> <span class=\"p\">{</span> <span class=\"no\">Date</span><span class=\"p\">.</span><span class=\"nf\">today</span> <span class=\"p\">}</span>\n\n<span class=\"c1\"># After</span>\n<span class=\"n\">validates_comparison_of</span> <span class=\"ss\">:birth_date</span><span class=\"p\">,</span> <span class=\"ss\">less_than_or_equal_to: </span><span class=\"o\">-&gt;</span> <span class=\"p\">{</span> <span class=\"no\">Date</span><span class=\"p\">.</span><span class=\"nf\">today</span> <span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p><em>fatkodima</em></p>\n"
  },
  {
    "message": "*   Fix casting long strings to `Date`, `Time` or `DateTime`\n\n    *fatkodima*",
    "project": "activemodel",
    "date_merged": 1652281410000,
    "author": "fatkodima",
    "sha": "0f4b030c44effaea67d6a3d3de5b8a1ae7429088",
    "pr": "45005",
    "merge_sha": "e1a9b3d861cd6d893541a4e6e14fb68f6891e846",
    "html": "<p>Fix casting long strings to <code>Date</code>, <code>Time</code> or <code>DateTime</code></p>\n\n<p><em>fatkodima</em></p>\n"
  },
  {
    "message": "*   Use different cache namespace for proxy calls\n\n    Models can currently have different attribute bodies for the same method\n    names, leading to conflicts. Adding a new namespace `:active_model_proxy`\n    fixes the issue.\n\n    *Chris Salzberg*",
    "project": "activemodel",
    "date_merged": 1643879431000,
    "author": "Chris Salzberg",
    "sha": "81519dec1add5ee5d93cc24239283ca56379eb9a",
    "pr": "44322",
    "merge_sha": "61cf029f8269fe4214c54dd911f62c335371e6e8",
    "html": "<p>Use different cache namespace for proxy calls</p>\n\n<p>Models can currently have different attribute bodies for the same method<br />\nnames, leading to conflicts. Adding a new namespace <code>:active_model_proxy</code><br />\nfixes the issue.</p>\n\n<p><em>Chris Salzberg</em></p>\n"
  },
  {
    "message": "*   Add \"back to top\" button to guides\n\n    *Alysson Rosa*",
    "project": "guides",
    "date_merged": 1685605121000,
    "author": "Alysson Rosa",
    "sha": "22397bec6ff332fad45be75cc81f8e037563073e",
    "pr": "48354",
    "merge_sha": "d026af43c35c25814b4d16511f1b8fc6d70a4569",
    "html": "<p>Add “back to top” button to guides</p>\n\n<p><em>Alysson Rosa</em></p>\n"
  },
  {
    "message": "*   Add `ActionController::Parameters#extract_value` method to allow extracting serialized values from params\n\n    ```ruby\n    params = ActionController::Parameters.new(id: \"1_123\", tags: \"ruby,rails\")\n    params.extract_value(:id) # => [\"1\", \"123\"]\n    params.extract_value(:tags, delimiter: \",\") # => [\"ruby\", \"rails\"]\n    ```\n\n    *Nikita Vasilevsky*",
    "project": "actionpack",
    "date_merged": 1693235395000,
    "author": "Nikita Vasilevsky",
    "sha": "da7a6da4e7f5caf227420c550a8a13550dd9c682",
    "pr": "49042",
    "merge_sha": "743d1fc71cfaf87adaf1cc32f66565d475e2b8da",
    "html": "<p>Add <code>ActionController::Parameters#extract_value</code> method to allow extracting serialized values from params</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">params</span> <span class=\"o\">=</span> <span class=\"no\">ActionController</span><span class=\"o\">::</span><span class=\"no\">Parameters</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"ss\">id: </span><span class=\"s2\">\"1_123\"</span><span class=\"p\">,</span> <span class=\"ss\">tags: </span><span class=\"s2\">\"ruby,rails\"</span><span class=\"p\">)</span>\n<span class=\"n\">params</span><span class=\"p\">.</span><span class=\"nf\">extract_value</span><span class=\"p\">(</span><span class=\"ss\">:id</span><span class=\"p\">)</span> <span class=\"c1\"># =&gt; [\"1\", \"123\"]</span>\n<span class=\"n\">params</span><span class=\"p\">.</span><span class=\"nf\">extract_value</span><span class=\"p\">(</span><span class=\"ss\">:tags</span><span class=\"p\">,</span> <span class=\"ss\">delimiter: </span><span class=\"s2\">\",\"</span><span class=\"p\">)</span> <span class=\"c1\"># =&gt; [\"ruby\", \"rails\"]</span>\n</code></pre></div></div>\n\n<p><em>Nikita Vasilevsky</em></p>\n"
  },
  {
    "message": "*   Parse JSON `response.parsed_body` with `ActiveSupport::HashWithIndifferentAccess`\n\n    Integrate with Minitest's new `assert_pattern` by parsing the JSON contents\n    of `response.parsed_body` with `ActiveSupport::HashWithIndifferentAccess`, so\n    that it's pattern-matching compatible.\n\n    *Sean Doyle*",
    "project": "actionpack",
    "date_merged": 1692813760000,
    "author": "Sean Doyle",
    "sha": "0f4ab82082c87f22b6733d46b4251009cbbb1dd4",
    "pr": "49003",
    "merge_sha": "a7a1217cd4b9f300cb7038e6933dd40c6e812cc8",
    "html": "<p>Parse JSON <code>response.parsed_body</code> with <code>ActiveSupport::HashWithIndifferentAccess</code></p>\n\n<p>Integrate with Minitest’s new <code>assert_pattern</code> by parsing the JSON contents<br />\nof <code>response.parsed_body</code> with <code>ActiveSupport::HashWithIndifferentAccess</code>, so<br />\nthat it’s pattern-matching compatible.</p>\n\n<p><em>Sean Doyle</em></p>\n"
  },
  {
    "message": "*   Add support for Playwright as a driver for system tests.\n\n    *Yuki Nishijima*",
    "project": "actionpack",
    "date_merged": 1692646073000,
    "author": "Yuki Nishijima",
    "sha": "72c5270e45b982957b134372def3f7079a037465",
    "pr": "48950",
    "merge_sha": "24876e6a7982569aa421b2aa95ba095126dfd532",
    "html": "<p>Add support for Playwright as a driver for system tests.</p>\n\n<p><em>Yuki Nishijima</em></p>\n"
  },
  {
    "message": "*   Fix `HostAuthorization` potentially displaying the value of the\n    X_FORWARDED_HOST header when the HTTP_HOST header is being blocked.\n\n    *Hartley McGuire*, *Daniel Schlosser*",
    "project": "actionpack",
    "date_merged": 1692644744000,
    "author": "Hartley McGuire",
    "sha": "11ef3cecf098979bf152ff7a3633721969fc233d",
    "pr": "48941",
    "merge_sha": "364266893573622d42c521d830a265a873ab75f6",
    "html": "<p>Fix <code>HostAuthorization</code> potentially displaying the value of the<br />\nX_FORWARDED_HOST header when the HTTP_HOST header is being blocked.</p>\n\n<p><em>Hartley McGuire</em>, <em>Daniel Schlosser</em></p>\n"
  },
  {
    "message": "*   Rename `fixture_file_upload` method to `file_fixture_upload`\n\n    Declare an alias to preserve the backwards compatibility of `fixture_file_upload`\n\n    *Sean Doyle*",
    "project": "actionpack",
    "date_merged": 1691183320000,
    "author": "Sean Doyle",
    "sha": "6cafc49d2c3c9a1c429cf70048eaa16b1ed6ba0a",
    "pr": "48857",
    "merge_sha": "2df0e5fa0ca6e4a06891b2dbaacbb0d556e505ae",
    "html": "<p>Rename <code>fixture_file_upload</code> method to <code>file_fixture_upload</code></p>\n\n<p>Declare an alias to preserve the backwards compatibility of <code>fixture_file_upload</code></p>\n\n<p><em>Sean Doyle</em></p>\n"
  },
  {
    "message": "*   `ActionDispatch::SystemTesting::TestHelpers::ScreenshotHelper` saves the screenshot path in test metadata on failure.\n\n    *Matija Čupić*",
    "project": "actionpack",
    "date_merged": 1691073329000,
    "author": "Matija Čupić",
    "sha": "a962fc3c9cfbc1729efc031c025d06c1a198a918",
    "pr": "48863",
    "merge_sha": "ee3117ba8ae8f46593945dd825751d3713b6cdaa",
    "html": "<p><code>ActionDispatch::SystemTesting::TestHelpers::ScreenshotHelper</code> saves the screenshot path in test metadata on failure.</p>\n\n<p><em>Matija Čupić</em></p>\n"
  },
  {
    "message": "*   `config.dom_testing_default_html_version` controls the HTML parser used by\n    `ActionDispatch::Assertions#html_document`.\n\n    The Rails 7.1 default configuration opts into the HTML5 parser when it is supported, to better\n    represent what the DOM would be in a browser user agent. Previously this test helper always used\n    Nokogiri's HTML4 parser.\n\n    *Mike Dalessio*",
    "project": "actionpack",
    "date_merged": 1691084878000,
    "author": "Mike Dalessio",
    "sha": "8a57ba8c0ef7e041714f4c3b49444d81459b5a79",
    "pr": "48682",
    "merge_sha": "94070e04bf4c4296c74bf7fc98567cc46b5bd63c",
    "html": "<p><code>config.dom_testing_default_html_version</code> controls the HTML parser used by<br />\n<code>ActionDispatch::Assertions#html_document</code>.</p>\n\n<p>The Rails 7.1 default configuration opts into the HTML5 parser when it is supported, to better<br />\nrepresent what the DOM would be in a browser user agent. Previously this test helper always used<br />\nNokogiri’s HTML4 parser.</p>\n\n<p><em>Mike Dalessio</em></p>\n"
  },
  {
    "message": "*   The `with_routing` helper can now be called at the class level. When called at the class level, the routes will\n    be setup before each test, and reset after every test. For example:\n\n    ```ruby\n    class RoutingTest < ActionController::TestCase\n      with_routing do |routes|\n        routes.draw do\n          resources :articles\n          resources :authors\n        end\n      end\n\n      def test_articles_route\n        assert_routing(\"/articles\", controller: \"articles\", action: \"index\")\n      end\n\n       def test_authors_route\n        assert_routing(\"/authors\", controller: \"authors\", action: \"index\")\n      end\n    end\n    ```\n\n    *Andrew Novoselac*",
    "project": "actionpack",
    "date_merged": 1686089845000,
    "author": "Andrew Novoselac",
    "sha": "37f3ce9930c5894d4e90e6c1ba6000a6d569dc30",
    "pr": "48407",
    "merge_sha": "e5daafb87f159842427673366623c07e64f2e84d",
    "html": "<p>The <code>with_routing</code> helper can now be called at the class level. When called at the class level, the routes will<br />\nbe setup before each test, and reset after every test. For example:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">class</span> <span class=\"nc\">RoutingTest</span> <span class=\"o\">&lt;</span> <span class=\"no\">ActionController</span><span class=\"o\">::</span><span class=\"no\">TestCase</span>\n  <span class=\"n\">with_routing</span> <span class=\"k\">do</span> <span class=\"o\">|</span><span class=\"n\">routes</span><span class=\"o\">|</span>\n    <span class=\"n\">routes</span><span class=\"p\">.</span><span class=\"nf\">draw</span> <span class=\"k\">do</span>\n      <span class=\"n\">resources</span> <span class=\"ss\">:articles</span>\n      <span class=\"n\">resources</span> <span class=\"ss\">:authors</span>\n    <span class=\"k\">end</span>\n  <span class=\"k\">end</span>\n\n  <span class=\"k\">def</span> <span class=\"nf\">test_articles_route</span>\n    <span class=\"n\">assert_routing</span><span class=\"p\">(</span><span class=\"s2\">\"/articles\"</span><span class=\"p\">,</span> <span class=\"ss\">controller: </span><span class=\"s2\">\"articles\"</span><span class=\"p\">,</span> <span class=\"ss\">action: </span><span class=\"s2\">\"index\"</span><span class=\"p\">)</span>\n  <span class=\"k\">end</span>\n\n   <span class=\"k\">def</span> <span class=\"nf\">test_authors_route</span>\n    <span class=\"n\">assert_routing</span><span class=\"p\">(</span><span class=\"s2\">\"/authors\"</span><span class=\"p\">,</span> <span class=\"ss\">controller: </span><span class=\"s2\">\"authors\"</span><span class=\"p\">,</span> <span class=\"ss\">action: </span><span class=\"s2\">\"index\"</span><span class=\"p\">)</span>\n  <span class=\"k\">end</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p><em>Andrew Novoselac</em></p>\n"
  },
  {
    "message": "*   The `Mime::Type` now supports handling types with parameters and correctly handles quotes.\n    When parsing the accept header, the parameters before the q-parameter are kept and if a matching mime-type exists it is used.\n    To keep the current functionality, a fallback is created to look for the media-type without the parameters.\n\n    This change allows for custom MIME-types that are more complex like `application/vnd.api+json; profile=\"https://jsonapi.org/profiles/ethanresnick/cursor-pagination/\" ext=\"https://jsonapi.org/ext/atomic\"` for the [JSON API](https://jsonapi.org/).\n\n    *Nicolas Erni*",
    "project": "actionpack",
    "date_merged": 1685984177000,
    "author": "Nicolas Erni",
    "sha": "1071a39020564e1f7ebfb618e3e855b52450e015",
    "pr": "48397",
    "merge_sha": "0e1800396d4f89643d3872cb88a56ded1bae68f0",
    "html": "<p>The <code>Mime::Type</code> now supports handling types with parameters and correctly handles quotes.<br />\nWhen parsing the accept header, the parameters before the q-parameter are kept and if a matching mime-type exists it is used.<br />\nTo keep the current functionality, a fallback is created to look for the media-type without the parameters.</p>\n\n<p>This change allows for custom MIME-types that are more complex like <code>application/vnd.api+json; profile=\"https://jsonapi.org/profiles/ethanresnick/cursor-pagination/\" ext=\"https://jsonapi.org/ext/atomic\"</code> for the <a href=\"https://jsonapi.org/\">JSON API</a>.</p>\n\n<p><em>Nicolas Erni</em></p>\n"
  },
  {
    "message": "*   The url_for helpers now support a new option called `path_params`.\n    This is very useful in situations where you only want to add a required param that is part of the route's URL but for other route not append an extraneous query param.\n\n    Given the following router...\n    ```ruby\n    Rails.application.routes.draw do\n      scope \":account_id\" do\n        get \"dashboard\" => \"pages#dashboard\", as: :dashboard\n        get \"search/:term\" => \"search#search\", as: :search\n      end\n      delete \"signout\" => \"sessions#destroy\", as: :signout\n    end\n    ```\n\n    And given the following `ApplicationController`\n    ```ruby\n      class ApplicationController < ActionController::Base\n        def default_url_options\n          { path_params: { account_id: \"foo\" } }\n        end\n      end\n    ```\n\n    The standard url_for helper and friends will now behave as follows:\n\n    ```ruby\n    dashboard_path # => /foo/dashboard\n    dashboard_path(account_id: \"bar\") # => /bar/dashboard\n\n    signout_path # => /signout\n    signout_path(account_id: \"bar\") # => /signout?account_id=bar\n    signout_path(account_id: \"bar\", path_params: { account_id: \"baz\" }) # => /signout?account_id=bar\n    search_path(\"quin\") # => /foo/search/quin\n    ```\n\n    *Jason Meller, Jeremy Beker*",
    "project": "actionpack",
    "date_merged": 1685511395000,
    "author": "Jason Meller",
    "sha": "1bca0dc586affafae492e4e4db02617a2b783be9",
    "pr": "43770",
    "merge_sha": "b2876a986486f244406e50dd5dd715738e405d11",
    "html": "<p>The url_for helpers now support a new option called <code>path_params</code>.<br />\nThis is very useful in situations where you only want to add a required param that is part of the route’s URL but for other route not append an extraneous query param.</p>\n\n<p>Given the following router…</p>\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">Rails</span><span class=\"p\">.</span><span class=\"nf\">application</span><span class=\"p\">.</span><span class=\"nf\">routes</span><span class=\"p\">.</span><span class=\"nf\">draw</span> <span class=\"k\">do</span>\n  <span class=\"n\">scope</span> <span class=\"s2\">\":account_id\"</span> <span class=\"k\">do</span>\n    <span class=\"n\">get</span> <span class=\"s2\">\"dashboard\"</span> <span class=\"o\">=&gt;</span> <span class=\"s2\">\"pages#dashboard\"</span><span class=\"p\">,</span> <span class=\"ss\">as: :dashboard</span>\n    <span class=\"n\">get</span> <span class=\"s2\">\"search/:term\"</span> <span class=\"o\">=&gt;</span> <span class=\"s2\">\"search#search\"</span><span class=\"p\">,</span> <span class=\"ss\">as: :search</span>\n  <span class=\"k\">end</span>\n  <span class=\"n\">delete</span> <span class=\"s2\">\"signout\"</span> <span class=\"o\">=&gt;</span> <span class=\"s2\">\"sessions#destroy\"</span><span class=\"p\">,</span> <span class=\"ss\">as: :signout</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p>And given the following <code>ApplicationController</code></p>\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>  <span class=\"k\">class</span> <span class=\"nc\">ApplicationController</span> <span class=\"o\">&lt;</span> <span class=\"no\">ActionController</span><span class=\"o\">::</span><span class=\"no\">Base</span>\n    <span class=\"k\">def</span> <span class=\"nf\">default_url_options</span>\n      <span class=\"p\">{</span> <span class=\"ss\">path_params: </span><span class=\"p\">{</span> <span class=\"ss\">account_id: </span><span class=\"s2\">\"foo\"</span> <span class=\"p\">}</span> <span class=\"p\">}</span>\n    <span class=\"k\">end</span>\n  <span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p>The standard url_for helper and friends will now behave as follows:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">dashboard_path</span> <span class=\"c1\"># =&gt; /foo/dashboard</span>\n<span class=\"n\">dashboard_path</span><span class=\"p\">(</span><span class=\"ss\">account_id: </span><span class=\"s2\">\"bar\"</span><span class=\"p\">)</span> <span class=\"c1\"># =&gt; /bar/dashboard</span>\n\n<span class=\"n\">signout_path</span> <span class=\"c1\"># =&gt; /signout</span>\n<span class=\"n\">signout_path</span><span class=\"p\">(</span><span class=\"ss\">account_id: </span><span class=\"s2\">\"bar\"</span><span class=\"p\">)</span> <span class=\"c1\"># =&gt; /signout?account_id=bar</span>\n<span class=\"n\">signout_path</span><span class=\"p\">(</span><span class=\"ss\">account_id: </span><span class=\"s2\">\"bar\"</span><span class=\"p\">,</span> <span class=\"ss\">path_params: </span><span class=\"p\">{</span> <span class=\"ss\">account_id: </span><span class=\"s2\">\"baz\"</span> <span class=\"p\">})</span> <span class=\"c1\"># =&gt; /signout?account_id=bar</span>\n<span class=\"n\">search_path</span><span class=\"p\">(</span><span class=\"s2\">\"quin\"</span><span class=\"p\">)</span> <span class=\"c1\"># =&gt; /foo/search/quin</span>\n</code></pre></div></div>\n\n<p><em>Jason Meller, Jeremy Beker</em></p>\n"
  },
  {
    "message": "*   Change `action_dispatch.show_exceptions` to one of `:all`, `:rescuable`, or\n    `:none`. `:all` and `:none` behave the same as the previous `true` and\n    `false` respectively. The new `:rescuable` option will only show exceptions\n    that can be rescued (e.g. `ActiveRecord::RecordNotFound`). `:rescuable` is\n    now the default for the test environment.\n\n    *Jon Dufresne*",
    "project": "actionpack",
    "date_merged": 1684950345000,
    "author": "Jon Dufresne",
    "sha": "e28f147329330e7ae55606e62ecc3de328431f0b",
    "pr": "45867",
    "merge_sha": "61accb7dea3539316bce941c4e2be2047688734f",
    "html": "<p>Change <code>action_dispatch.show_exceptions</code> to one of <code>:all</code>, <code>:rescuable</code>, or<br />\n<code>:none</code>. <code>:all</code> and <code>:none</code> behave the same as the previous <code>true</code> and<br />\n<code>false</code> respectively. The new <code>:rescuable</code> option will only show exceptions<br />\nthat can be rescued (e.g. <code>ActiveRecord::RecordNotFound</code>). <code>:rescuable</code> is<br />\nnow the default for the test environment.</p>\n\n<p><em>Jon Dufresne</em></p>\n"
  },
  {
    "message": "*   `config.action_dispatch.cookies_serializer` now accepts `:message_pack` and\n    `:message_pack_allow_marshal` as serializers. These serializers require the\n    [`msgpack` gem](https://rubygems.org/gems/msgpack) (>= 1.7.0).\n\n    The Message Pack format can provide improved performance and smaller payload\n    sizes. It also supports roundtripping some Ruby types that are not supported\n    by JSON. For example:\n\n      ```ruby\n      cookies.encrypted[:foo] = [{ a: 1 }, { b: 2 }.with_indifferent_access, 1.to_d, Time.at(0, 123)]\n\n      # BEFORE with config.action_dispatch.cookies_serializer = :json\n      cookies.encrypted[:foo]\n      # => [{\"a\"=>1}, {\"b\"=>2}, \"1.0\", \"1969-12-31T18:00:00.000-06:00\"]\n      cookies.encrypted[:foo].map(&:class)\n      # => [Hash, Hash, String, String]\n\n      # AFTER with config.action_dispatch.cookies_serializer = :message_pack\n      cookies.encrypted[:foo]\n      # => [{:a=>1}, {\"b\"=>2}, 0.1e1, 1969-12-31 18:00:00.000123 -0600]\n      cookies.encrypted[:foo].map(&:class)\n      # => [Hash, ActiveSupport::HashWithIndifferentAccess, BigDecimal, Time]\n      ```\n\n    The `:message_pack` serializer can fall back to deserializing with\n    `ActiveSupport::JSON` when necessary, and the `:message_pack_allow_marshal`\n    serializer can fall back to deserializing with `Marshal` as well as\n    `ActiveSupport::JSON`. Additionally, the `:marshal`, `:json`, and\n    `:json_allow_marshal` (AKA `:hybrid`) serializers can now fall back to\n    deserializing with `ActiveSupport::MessagePack` when necessary. These\n    behaviors ensure old cookies can still be read so that migration is easier.\n\n    *Jonathan Hefner*",
    "project": "actionpack",
    "date_merged": 1683578331000,
    "author": "Jonathan Hefner",
    "sha": "c924ba0df922bde003a606ed145a06658033bfa6",
    "pr": "48103",
    "merge_sha": "8226bba57f2dea0b97c02b4df4d0e9638644de03",
    "html": "<p><code>config.action_dispatch.cookies_serializer</code> now accepts <code>:message_pack</code> and<br />\n<code>:message_pack_allow_marshal</code> as serializers. These serializers require the<br />\n<a href=\"https://rubygems.org/gems/msgpack\"><code>msgpack</code> gem</a> (&gt;= 1.7.0).</p>\n\n<p>The Message Pack format can provide improved performance and smaller payload<br />\nsizes. It also supports roundtripping some Ruby types that are not supported<br />\nby JSON. For example:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>  <span class=\"n\">cookies</span><span class=\"p\">.</span><span class=\"nf\">encrypted</span><span class=\"p\">[</span><span class=\"ss\">:foo</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"p\">[{</span> <span class=\"ss\">a: </span><span class=\"mi\">1</span> <span class=\"p\">},</span> <span class=\"p\">{</span> <span class=\"ss\">b: </span><span class=\"mi\">2</span> <span class=\"p\">}.</span><span class=\"nf\">with_indifferent_access</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">.</span><span class=\"nf\">to_d</span><span class=\"p\">,</span> <span class=\"no\">Time</span><span class=\"p\">.</span><span class=\"nf\">at</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">123</span><span class=\"p\">)]</span>\n\n  <span class=\"c1\"># BEFORE with config.action_dispatch.cookies_serializer = :json</span>\n  <span class=\"n\">cookies</span><span class=\"p\">.</span><span class=\"nf\">encrypted</span><span class=\"p\">[</span><span class=\"ss\">:foo</span><span class=\"p\">]</span>\n  <span class=\"c1\"># =&gt; [{\"a\"=&gt;1}, {\"b\"=&gt;2}, \"1.0\", \"1969-12-31T18:00:00.000-06:00\"]</span>\n  <span class=\"n\">cookies</span><span class=\"p\">.</span><span class=\"nf\">encrypted</span><span class=\"p\">[</span><span class=\"ss\">:foo</span><span class=\"p\">].</span><span class=\"nf\">map</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"ss\">:class</span><span class=\"p\">)</span>\n  <span class=\"c1\"># =&gt; [Hash, Hash, String, String]</span>\n\n  <span class=\"c1\"># AFTER with config.action_dispatch.cookies_serializer = :message_pack</span>\n  <span class=\"n\">cookies</span><span class=\"p\">.</span><span class=\"nf\">encrypted</span><span class=\"p\">[</span><span class=\"ss\">:foo</span><span class=\"p\">]</span>\n  <span class=\"c1\"># =&gt; [{:a=&gt;1}, {\"b\"=&gt;2}, 0.1e1, 1969-12-31 18:00:00.000123 -0600]</span>\n  <span class=\"n\">cookies</span><span class=\"p\">.</span><span class=\"nf\">encrypted</span><span class=\"p\">[</span><span class=\"ss\">:foo</span><span class=\"p\">].</span><span class=\"nf\">map</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"ss\">:class</span><span class=\"p\">)</span>\n  <span class=\"c1\"># =&gt; [Hash, ActiveSupport::HashWithIndifferentAccess, BigDecimal, Time]</span>\n</code></pre></div></div>\n\n<p>The <code>:message_pack</code> serializer can fall back to deserializing with<br />\n<code>ActiveSupport::JSON</code> when necessary, and the <code>:message_pack_allow_marshal</code><br />\nserializer can fall back to deserializing with <code>Marshal</code> as well as<br />\n<code>ActiveSupport::JSON</code>. Additionally, the <code>:marshal</code>, <code>:json</code>, and<br />\n<code>:json_allow_marshal</code> (AKA <code>:hybrid</code>) serializers can now fall back to<br />\ndeserializing with <code>ActiveSupport::MessagePack</code> when necessary. These<br />\nbehaviors ensure old cookies can still be read so that migration is easier.</p>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Remove leading dot from domains on cookies set with `domain: :all`, to meet RFC6265 requirements\n\n    *Gareth Adams*",
    "project": "actionpack",
    "date_merged": 1682301111000,
    "author": "Gareth Adams",
    "sha": "8f3c6a1005a9dd3f4584c2bc30c1a63e7db15aa8",
    "pr": "48036",
    "merge_sha": "3c08d359a44ff8f32e83745c86eeae554e9b9306",
    "html": "<p>Remove leading dot from domains on cookies set with <code>domain: :all</code>, to meet RFC6265 requirements</p>\n\n<p><em>Gareth Adams</em></p>\n"
  },
  {
    "message": "*   Include source location in routes extended view.\n\n    ```bash\n    $ bin/rails routes --expanded\n\n    ...\n    --[ Route 14 ]----------\n    Prefix            | new_gist\n    Verb              | GET\n    URI               | /gist(.:format)\n    Controller#Action | gists/gists#new\n    Source Location   | config/routes/gist.rb:3\n    ```\n\n    *Luan Vieira, John Hawthorn and Daniel Colson*",
    "project": "actionpack",
    "date_merged": 1681312521000,
    "author": "Luan Vieira",
    "sha": "a154a08f2b6c57670b2bf34042814f4efd28b8dd",
    "pr": "47921",
    "merge_sha": "bcc2e0c4e4c5eb2d706a7b9515ecd52265845c29",
    "html": "<p>Include source location in routes extended view.</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nv\">$ </span>bin/rails routes <span class=\"nt\">--expanded</span>\n\n...\n<span class=\"nt\">--</span><span class=\"o\">[</span> Route 14 <span class=\"o\">]</span><span class=\"nt\">----------</span>\nPrefix            | new_gist\nVerb              | GET\nURI               | /gist<span class=\"o\">(</span>.:format<span class=\"o\">)</span>\nController#Action | gists/gists#new\nSource Location   | config/routes/gist.rb:3\n</code></pre></div></div>\n\n<p><em>Luan Vieira, John Hawthorn and Daniel Colson</em></p>\n"
  },
  {
    "message": "*   Add `without` as an alias of `except` on `ActiveController::Parameters`.\n\n    *Hidde-Jan Jongsma*",
    "project": "actionpack",
    "date_merged": 1680081411000,
    "author": "Hidde-Jan Jongsma",
    "sha": "603b5cdde539a07e98a533be8b54394a6e1f9655",
    "pr": "47687",
    "merge_sha": "33e1a898a9a3cf9f6849b5f28c7f259262af3c1b",
    "html": "<p>Add <code>without</code> as an alias of <code>except</code> on <code>ActiveController::Parameters</code>.</p>\n\n<p><em>Hidde-Jan Jongsma</em></p>\n"
  },
  {
    "message": "*   Expand search field on `rails/info/routes` to also search **route name**, **http verb** and **controller#action**.\n\n    *Jason Kotchoff*",
    "project": "actionpack",
    "date_merged": 1679701883000,
    "author": "zzak",
    "sha": "57b01b4633f43339957ed691d0fef7017c0bfe9c",
    "pr": "47766",
    "merge_sha": "9f49959fee522f2f38a07eb07a23830b99db30f6",
    "html": "<p>Expand search field on <code>rails/info/routes</code> to also search <strong>route name</strong>, <strong>http verb</strong> and <strong>controller#action</strong>.</p>\n\n<p><em>Jason Kotchoff</em></p>\n"
  },
  {
    "message": "*   Remove deprecated `poltergeist` and `webkit` (capybara-webkit) driver registration for system testing.\n\n    *Rafael Mendonça França*",
    "project": "actionpack",
    "date_merged": 1677805729000,
    "author": "Rafael Mendonça França",
    "sha": "696ccbc26568fb98af4695ad4dd445b593bbc43e",
    "pr": "47556",
    "merge_sha": "dd7ecb073c67fee00e409049f02d72accece94a2",
    "html": "<p>Remove deprecated <code>poltergeist</code> and <code>webkit</code> (capybara-webkit) driver registration for system testing.</p>\n\n<p><em>Rafael Mendonça França</em></p>\n"
  },
  {
    "message": "*   Remove deprecated ability to assign a single value to `config.action_dispatch.trusted_proxies`.\n\n    *Rafael Mendonça França*",
    "project": "actionpack",
    "date_merged": 1677805729000,
    "author": "Rafael Mendonça França",
    "sha": "1e70d0f5d3695bd9f18f909e953e84ca04d25e17",
    "pr": "47556",
    "merge_sha": "dd7ecb073c67fee00e409049f02d72accece94a2",
    "html": "<p>Remove deprecated ability to assign a single value to <code>config.action_dispatch.trusted_proxies</code>.</p>\n\n<p><em>Rafael Mendonça França</em></p>\n"
  },
  {
    "message": "*   Deprecate `config.action_dispatch.return_only_request_media_type_on_content_type`.\n\n    *Rafael Mendonça França*",
    "project": "actionpack",
    "date_merged": 1677805729000,
    "author": "Rafael Mendonça França",
    "sha": "689b27773396c06b49333de9f6e9d0127f16d6ea",
    "pr": "47556",
    "merge_sha": "dd7ecb073c67fee00e409049f02d72accece94a2",
    "html": "<p>Deprecate <code>config.action_dispatch.return_only_request_media_type_on_content_type</code>.</p>\n\n<p><em>Rafael Mendonça França</em></p>\n"
  },
  {
    "message": "*   Remove deprecated behavior on `Request#content_type`.\n\n    *Rafael Mendonça França*",
    "project": "actionpack",
    "date_merged": 1677805729000,
    "author": "Rafael Mendonça França",
    "sha": "689b27773396c06b49333de9f6e9d0127f16d6ea",
    "pr": "47556",
    "merge_sha": "dd7ecb073c67fee00e409049f02d72accece94a2",
    "html": "<p>Remove deprecated behavior on <code>Request#content_type</code>.</p>\n\n<p><em>Rafael Mendonça França</em></p>\n"
  },
  {
    "message": "*   Change `ActionController::Instrumentation` to pass `filtered_path` instead of `fullpath` in the event payload to filter sensitive query params\n\n    ```ruby\n    get \"/posts?password=test\"\n    request.fullpath         # => \"/posts?password=test\"\n    request.filtered_path    # => \"/posts?password=[FILTERED]\"\n    ```\n\n    *Ritikesh G*",
    "project": "actionpack",
    "date_merged": 1675880950000,
    "author": "Ritikesh G",
    "sha": "c59ce2cf71f4350df50fdf4491b2d85ea305c947",
    "pr": "47296",
    "merge_sha": "aa3fc0fca25780797d6706f294c220a2ada0edb8",
    "html": "<p>Change <code>ActionController::Instrumentation</code> to pass <code>filtered_path</code> instead of <code>fullpath</code> in the event payload to filter sensitive query params</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">get</span> <span class=\"s2\">\"/posts?password=test\"</span>\n<span class=\"n\">request</span><span class=\"p\">.</span><span class=\"nf\">fullpath</span>         <span class=\"c1\"># =&gt; \"/posts?password=test\"</span>\n<span class=\"n\">request</span><span class=\"p\">.</span><span class=\"nf\">filtered_path</span>    <span class=\"c1\"># =&gt; \"/posts?password=[FILTERED]\"</span>\n</code></pre></div></div>\n\n<p><em>Ritikesh G</em></p>\n"
  },
  {
    "message": "*   Deprecate `AbstractController::Helpers::MissingHelperError`\n\n    *Hartley McGuire*",
    "project": "actionpack",
    "date_merged": 1675172909000,
    "author": "Hartley McGuire",
    "sha": "ada584bcb893ff8eb0c704a5bd0e611e0efd4554",
    "pr": "47199",
    "merge_sha": "77d4ce0ade195f756db9ff925a68afddbf582ec5",
    "html": "<p>Deprecate <code>AbstractController::Helpers::MissingHelperError</code></p>\n\n<p><em>Hartley McGuire</em></p>\n"
  },
  {
    "message": "*   Change `ActionDispatch::Testing::TestResponse#parsed_body` to parse HTML as\n    a Nokogiri document\n\n    ```ruby\n    get \"/posts\"\n    response.content_type         # => \"text/html; charset=utf-8\"\n    response.parsed_body.class    # => Nokogiri::HTML5::Document\n    response.parsed_body.to_html  # => \"<!DOCTYPE html>\\n<html>\\n...\"\n    ```\n\n    *Sean Doyle*",
    "project": "actionpack",
    "date_merged": 1675119189000,
    "author": "Sean Doyle",
    "sha": "ad79ed0e6b8cf07e59d52e54b39ae8fbb042b850",
    "pr": "47144",
    "merge_sha": "c8190750f9d28b831f9b38b4ded8a3ee5b41fd9d",
    "html": "<p>Change <code>ActionDispatch::Testing::TestResponse#parsed_body</code> to parse HTML as<br />\na Nokogiri document</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">get</span> <span class=\"s2\">\"/posts\"</span>\n<span class=\"n\">response</span><span class=\"p\">.</span><span class=\"nf\">content_type</span>         <span class=\"c1\"># =&gt; \"text/html; charset=utf-8\"</span>\n<span class=\"n\">response</span><span class=\"p\">.</span><span class=\"nf\">parsed_body</span><span class=\"p\">.</span><span class=\"nf\">class</span>    <span class=\"c1\"># =&gt; Nokogiri::HTML5::Document</span>\n<span class=\"n\">response</span><span class=\"p\">.</span><span class=\"nf\">parsed_body</span><span class=\"p\">.</span><span class=\"nf\">to_html</span>  <span class=\"c1\"># =&gt; \"&lt;!DOCTYPE html&gt;\\n&lt;html&gt;\\n...\"</span>\n</code></pre></div></div>\n\n<p><em>Sean Doyle</em></p>\n"
  },
  {
    "message": "*   Deprecate `ActionDispatch::IllegalStateError`.\n\n    *Samuel Williams*",
    "project": "actionpack",
    "date_merged": 1675119189000,
    "author": "Rafael Mendonça França",
    "sha": "fee14347348ad99ff6260225aaebc8809a983fa9",
    "pr": "47144",
    "merge_sha": "c8190750f9d28b831f9b38b4ded8a3ee5b41fd9d",
    "html": "<p>Deprecate <code>ActionDispatch::IllegalStateError</code>.</p>\n\n<p><em>Samuel Williams</em></p>\n"
  },
  {
    "message": "*   Add HTTP::Request#route_uri_pattern that returns URI pattern of matched route.\n\n    *Joel Hawksley*, *Kate Higa*",
    "project": "actionpack",
    "date_merged": 1674685367000,
    "author": "Joel Hawksley",
    "sha": "2fc46f95a5fcc6e80c080cc2a6fd6e48bc75115f",
    "pr": "47129",
    "merge_sha": "2cf8740e156ec8619f751d8c24bc1f12667d5958",
    "html": "<p>Add HTTP::Request#route_uri_pattern that returns URI pattern of matched route.</p>\n\n<p><em>Joel Hawksley</em>, <em>Kate Higa</em></p>\n"
  },
  {
    "message": "*   Add `ActionDispatch::AssumeSSL` middleware that can be turned on via `config.assume_ssl`.\n    It makes the application believe that all requests are arriving over SSL. This is useful\n    when proxying through a load balancer that terminates SSL, the forwarded request will appear\n    as though its HTTP instead of HTTPS to the application. This makes redirects and cookie\n    security target HTTP instead of HTTPS. This middleware makes the server assume that the\n    proxy already terminated SSL, and that the request really is HTTPS.\n\n    *DHH*",
    "project": "actionpack",
    "date_merged": 1674677598000,
    "author": "David Heinemeier Hansson",
    "sha": "1da6f8c68eacf280a36b23cae99b7c3d1e548078",
    "pr": "47139",
    "merge_sha": "1b44989521fe0ef274d85f24af6c5d6e69ac8463",
    "html": "<p>Add <code>ActionDispatch::AssumeSSL</code> middleware that can be turned on via <code>config.assume_ssl</code>.<br />\nIt makes the application believe that all requests are arriving over SSL. This is useful<br />\nwhen proxying through a load balancer that terminates SSL, the forwarded request will appear<br />\nas though its HTTP instead of HTTPS to the application. This makes redirects and cookie<br />\nsecurity target HTTP instead of HTTPS. This middleware makes the server assume that the<br />\nproxy already terminated SSL, and that the request really is HTTPS.</p>\n\n<p><em>DHH</em></p>\n"
  },
  {
    "message": "*   Only use HostAuthorization middleware if `config.hosts` is not empty\n\n    *Hartley McGuire*",
    "project": "actionpack",
    "date_merged": 1672959074000,
    "author": "Hartley McGuire",
    "sha": "eef4e755e095f8985c0534726bdfd080faaae969",
    "pr": "46903",
    "merge_sha": "ec782106553202e7cf2aeff7cbbce94d85b75635",
    "html": "<p>Only use HostAuthorization middleware if <code>config.hosts</code> is not empty</p>\n\n<p><em>Hartley McGuire</em></p>\n"
  },
  {
    "message": "*   Allow raising an error when a callback's only/unless symbols aren't existing methods.\n\n    When `before_action :callback, only: :action_name` is declared on a controller that doesn't respond to `action_name`, raise an exception at request time. This is a safety measure to ensure that typos or forgetfulness don't prevent a crucial callback from being run when it should.\n\n    For new applications, raising an error for undefined actions is turned on by default. If you do not want to opt-in to this behavior set `config.action_pack.raise_on_missing_callback_actions` to `false` in your application configuration. See #43487 for more details.\n\n    *Jess Bees*",
    "project": "actionpack",
    "date_merged": 1672773000000,
    "author": "eileencodes",
    "sha": "04e1a0d2e195d8cd5831c6ca953393b784bbfee9",
    "pr": "43487",
    "merge_sha": "60163900a99dc47694f469eef6dc8bdd5349c402",
    "html": "<p>Allow raising an error when a callback’s only/unless symbols aren’t existing methods.</p>\n\n<p>When <code>before_action :callback, only: :action_name</code> is declared on a controller that doesn’t respond to <code>action_name</code>, raise an exception at request time. This is a safety measure to ensure that typos or forgetfulness don’t prevent a crucial callback from being run when it should.</p>\n\n<p>For new applications, raising an error for undefined actions is turned on by default. If you do not want to opt-in to this behavior set <code>config.action_pack.raise_on_missing_callback_actions</code> to <code>false</code> in your application configuration. See #43487 for more details.</p>\n\n<p><em>Jess Bees</em></p>\n"
  },
  {
    "message": "*   Allow cookie options[:domain] to accept a proc to set the cookie domain on a more flexible per-request basis\n\n    *RobL*",
    "project": "actionpack",
    "date_merged": 1671742373000,
    "author": "RobL",
    "sha": "83da2e93839a6a67e0daf18c62acf11e2691abb0",
    "pr": "46726",
    "merge_sha": "9589ef330ceacf660da318fe5fcbd44f3e5f507e",
    "html": "<p>Allow cookie options[:domain] to accept a proc to set the cookie domain on a more flexible per-request basis</p>\n\n<p><em>RobL</em></p>\n"
  },
  {
    "message": "*   When a host is not specified for an `ActionController::Renderer`'s env,\n    the host and related options will now be derived from the routes'\n    `default_url_options` and `ActionDispatch::Http::URL.secure_protocol`.\n\n    This means that for an application with a configuration like:\n\n      ```ruby\n      Rails.application.default_url_options = { host: \"rubyonrails.org\" }\n      Rails.application.config.force_ssl = true\n      ```\n\n    rendering a URL like:\n\n      ```ruby\n      ApplicationController.renderer.render inline: \"<%= blog_url %>\"\n      ```\n\n    will now return `\"https://rubyonrails.org/blog\"` instead of\n    `\"http://example.org/blog\"`.\n\n    *Jonathan Hefner*",
    "project": "actionpack",
    "date_merged": 1671144302000,
    "author": "Jonathan Hefner",
    "sha": "93038baad70d477f6cbb06fa9d48c8e429fb192f",
    "pr": "46649",
    "merge_sha": "12c0c0a4c17249c24eb0c1892f5d2093fe6ca073",
    "html": "<p>When a host is not specified for an <code>ActionController::Renderer</code>’s env,<br />\nthe host and related options will now be derived from the routes’<br />\n<code>default_url_options</code> and <code>ActionDispatch::Http::URL.secure_protocol</code>.</p>\n\n<p>This means that for an application with a configuration like:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>  <span class=\"no\">Rails</span><span class=\"p\">.</span><span class=\"nf\">application</span><span class=\"p\">.</span><span class=\"nf\">default_url_options</span> <span class=\"o\">=</span> <span class=\"p\">{</span> <span class=\"ss\">host: </span><span class=\"s2\">\"rubyonrails.org\"</span> <span class=\"p\">}</span>\n  <span class=\"no\">Rails</span><span class=\"p\">.</span><span class=\"nf\">application</span><span class=\"p\">.</span><span class=\"nf\">config</span><span class=\"p\">.</span><span class=\"nf\">force_ssl</span> <span class=\"o\">=</span> <span class=\"kp\">true</span>\n</code></pre></div></div>\n\n<p>rendering a URL like:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>  <span class=\"no\">ApplicationController</span><span class=\"p\">.</span><span class=\"nf\">renderer</span><span class=\"p\">.</span><span class=\"nf\">render</span> <span class=\"ss\">inline: </span><span class=\"s2\">\"&lt;%= blog_url %&gt;\"</span>\n</code></pre></div></div>\n\n<p>will now return <code>\"https://rubyonrails.org/blog\"</code> instead of<br />\n<code>\"http://example.org/blog\"</code>.</p>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Add details of cookie name and size to `CookieOverflow` exception.\n\n    *Andy Waite*",
    "project": "actionpack",
    "date_merged": 1669452962000,
    "author": "Andy Waite",
    "sha": "0ec8f21bb6ba02a9045738b1d7ebfb49eb5b5ed2",
    "pr": "46570",
    "merge_sha": "32e8aa62542d849fafe4012f98e0176438e39030",
    "html": "<p>Add details of cookie name and size to <code>CookieOverflow</code> exception.</p>\n\n<p><em>Andy Waite</em></p>\n"
  },
  {
    "message": "*   Don't double log the `controller`, `action`, or `namespaced_controller` when using `ActiveRecord::QueryLog`\n\n    Previously if you set `config.active_record.query_log_tags` to an array that included\n    `:controller`, `:namespaced_controller`, or `:action`, that item would get logged twice.\n    This bug has been fixed.\n\n    *Alex Ghiculescu*",
    "project": "actionpack",
    "date_merged": 1670237938000,
    "author": "Alex Ghiculescu",
    "sha": "03394484a6869a4fe7a0add5f8e4507d3fda3e05",
    "pr": "46642",
    "merge_sha": "9361b70ca7efc1846b5ef99dea65a0605d0d54ab",
    "html": "<p>Don’t double log the <code>controller</code>, <code>action</code>, or <code>namespaced_controller</code> when using <code>ActiveRecord::QueryLog</code></p>\n\n<p>Previously if you set <code>config.active_record.query_log_tags</code> to an array that included<br />\n<code>:controller</code>, <code>:namespaced_controller</code>, or <code>:action</code>, that item would get logged twice.<br />\nThis bug has been fixed.</p>\n\n<p><em>Alex Ghiculescu</em></p>\n"
  },
  {
    "message": "*   Add the following permissions policy directives: `hid`, `idle-detection`, `screen-wake-lock`,\n    `serial`, `sync-xhr`, `web-share`.\n\n    *Guillaume Cabanel*",
    "project": "actionpack",
    "date_merged": 1665475354000,
    "author": "Guillaume CABANEL",
    "sha": "ca114316475326962493c294df3e9a1b3922474e",
    "pr": "45427",
    "merge_sha": "556bf2e520620b15db8714c1b8c6bf82249a6547",
    "html": "<p>Add the following permissions policy directives: <code>hid</code>, <code>idle-detection</code>, <code>screen-wake-lock</code>,<br />\n<code>serial</code>, <code>sync-xhr</code>, <code>web-share</code>.</p>\n\n<p><em>Guillaume Cabanel</em></p>\n"
  },
  {
    "message": "*   The `speaker`, `vibrate`, and `vr` permissions policy directives are now\n    deprecated.\n\n    There is no browser support for these directives, and no plan for browser\n    support in the future. You can just remove these directives from your\n    application.\n\n    *Jonathan Hefner*",
    "project": "actionpack",
    "date_merged": 1664997890000,
    "author": "Jonathan Hefner",
    "sha": "1466b4429945df3b3d87d8e3d8eae58bf3169332",
    "pr": "46199",
    "merge_sha": "cc0806abf0e380e5d74a8f8f55f9f9fdab6d3562",
    "html": "<p>The <code>speaker</code>, <code>vibrate</code>, and <code>vr</code> permissions policy directives are now<br />\ndeprecated.</p>\n\n<p>There is no browser support for these directives, and no plan for browser<br />\nsupport in the future. You can just remove these directives from your<br />\napplication.</p>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Added the `:status` option to `assert_redirected_to` to specify the precise\n    HTTP status of the redirect. Defaults to `:redirect` for backwards\n    compatibility.\n\n    *Jon Dufresne*",
    "project": "actionpack",
    "date_merged": 1663890836000,
    "author": "Jon Dufresne",
    "sha": "021113927a5b6a119fda9ea15fd4d126d7e2163b",
    "pr": "46057",
    "merge_sha": "0b1b5129767f94526dbe19461fee210648bb9738",
    "html": "<p>Added the <code>:status</code> option to <code>assert_redirected_to</code> to specify the precise<br />\nHTTP status of the redirect. Defaults to <code>:redirect</code> for backwards<br />\ncompatibility.</p>\n\n<p><em>Jon Dufresne</em></p>\n"
  },
  {
    "message": "*   Rescue `JSON::ParserError` in Cookies JSON deserializer to discards marshal dumps:\n\n    Without this change, if `action_dispatch.cookies_serializer` is set to `:json` and\n    the app tries to read a `:marshal` serialized cookie, it would error out which wouldn't\n    clear the cookie and force app users to manually clear it in their browser.\n\n    (See #45127 for original bug discussion)\n\n    *Nathan Bardoux*",
    "project": "actionpack",
    "date_merged": 1663358562000,
    "author": "John Bampton",
    "sha": "3a32915bbcfea4e0d8acde257ab9254ff2392de6",
    "pr": "46051",
    "merge_sha": "fbc4dff57866ac35e000b86a51afe28ec1606a8f",
    "html": "<p>Rescue <code>JSON::ParserError</code> in Cookies JSON deserializer to discards marshal dumps:</p>\n\n<p>Without this change, if <code>action_dispatch.cookies_serializer</code> is set to <code>:json</code> and<br />\nthe app tries to read a <code>:marshal</code> serialized cookie, it would error out which wouldn’t<br />\nclear the cookie and force app users to manually clear it in their browser.</p>\n\n<p>(See #45127 for original bug discussion)</p>\n\n<p><em>Nathan Bardoux</em></p>\n"
  },
  {
    "message": "*   Add `HTTP_REFERER` when following redirects on integration tests\n\n    This makes `follow_redirect!` a closer simulation of what happens in a real browser\n\n    *Felipe Sateler*",
    "project": "actionpack",
    "date_merged": 1662758048000,
    "author": "Rafael Mendonça França",
    "sha": "e3b9671e6795996f4adaf5a68b9c444a0c553aa3",
    "pr": "44438",
    "merge_sha": "9f372c94eaba780307f5bb91eb52a9dd16b8b2ba",
    "html": "<p>Add <code>HTTP_REFERER</code> when following redirects on integration tests</p>\n\n<p>This makes <code>follow_redirect!</code> a closer simulation of what happens in a real browser</p>\n\n<p><em>Felipe Sateler</em></p>\n"
  },
  {
    "message": "*   Added `exclude?` method to `ActionController::Parameters`.\n\n    *Ian Neubert*",
    "project": "actionpack",
    "date_merged": 1662756363000,
    "author": "Ian Neubert",
    "sha": "ca29fca4c860f89c57a145b6259943ac8abc3a63",
    "pr": "45887",
    "merge_sha": "37492e25692885cf3ac082f479798244f7aa088d",
    "html": "<p>Added <code>exclude?</code> method to <code>ActionController::Parameters</code>.</p>\n\n<p><em>Ian Neubert</em></p>\n"
  },
  {
    "message": "*   Rescue `EOFError` exception from `rack` on a multipart request.\n\n    *Nikita Vasilevsky*",
    "project": "actionpack",
    "date_merged": 1660660417000,
    "author": "Nikita Vasilevsky",
    "sha": "3b0d8c1ff020e7f6ecab59031cf2c45aa03bab27",
    "pr": "45833",
    "merge_sha": "893e5e25e5d83416c8f270dd1b1e32d9e5da76f5",
    "html": "<p>Rescue <code>EOFError</code> exception from <code>rack</code> on a multipart request.</p>\n\n<p><em>Nikita Vasilevsky</em></p>\n"
  },
  {
    "message": "*   Log redirects from routes the same way as redirects from controllers.\n\n    *Dennis Paagman*",
    "project": "actionpack",
    "date_merged": 1660132498000,
    "author": "Dennis Paagman",
    "sha": "ee4700241ec2765521d01071a8d3f8e18d1e153a",
    "pr": "43755",
    "merge_sha": "a393e0de0968f5c3a527d0606702eded1d158a51",
    "html": "<p>Log redirects from routes the same way as redirects from controllers.</p>\n\n<p><em>Dennis Paagman</em></p>\n"
  },
  {
    "message": "*   Prevent `ActionDispatch::ServerTiming` from overwriting existing values in `Server-Timing`.\n    Previously, if another middleware down the chain set `Server-Timing` header,\n    it would overwritten by `ActionDispatch::ServerTiming`.\n\n    *Jakub Malinowski*",
    "project": "actionpack",
    "date_merged": 1660132498000,
    "author": "Dennis Paagman",
    "sha": "ee4700241ec2765521d01071a8d3f8e18d1e153a",
    "pr": "43755",
    "merge_sha": "a393e0de0968f5c3a527d0606702eded1d158a51",
    "html": "<p>Prevent <code>ActionDispatch::ServerTiming</code> from overwriting existing values in <code>Server-Timing</code>.<br />\nPreviously, if another middleware down the chain set <code>Server-Timing</code> header,<br />\nit would overwritten by <code>ActionDispatch::ServerTiming</code>.</p>\n\n<p><em>Jakub Malinowski</em></p>\n"
  },
  {
    "message": "*   Allow opting out of the `SameSite` cookie attribute when setting a cookie.\n\n    You can opt out of `SameSite` by passing `same_site: nil`.\n\n    `cookies[:foo] = { value: \"bar\", same_site: nil }`\n\n    Previously, this incorrectly set the `SameSite` attribute to the value of the `cookies_same_site_protection` setting.\n\n    *Alex Ghiculescu*",
    "project": "actionpack",
    "date_merged": 1657037205000,
    "author": "Alex Ghiculescu",
    "sha": "d29e755aea0cd01d3bb27f5a9db14b9a1a346bb0",
    "pr": "45501",
    "merge_sha": "c0f71dac701883a92ec528cc7720c55885ade3f7",
    "html": "<p>Allow opting out of the <code>SameSite</code> cookie attribute when setting a cookie.</p>\n\n<p>You can opt out of <code>SameSite</code> by passing <code>same_site: nil</code>.</p>\n\n<p><code>cookies[:foo] = { value: \"bar\", same_site: nil }</code></p>\n\n<p>Previously, this incorrectly set the <code>SameSite</code> attribute to the value of the <code>cookies_same_site_protection</code> setting.</p>\n\n<p><em>Alex Ghiculescu</em></p>\n"
  },
  {
    "message": "*   Allow using `helper_method`s in `content_security_policy` and `permissions_policy`\n\n    Previously you could access basic helpers (defined in helper modules), but not\n    helper methods defined using `helper_method`. Now you can use either.\n\n    ```ruby\n    content_security_policy do |p|\n      p.default_src \"https://example.com\"\n      p.script_src \"https://example.com\" if helpers.script_csp?\n    end\n    ```\n\n    *Alex Ghiculescu*",
    "project": "actionpack",
    "date_merged": 1652907096000,
    "author": "Alex Ghiculescu",
    "sha": "0ddad32af53a241692ab5715bf4bd1ee119e4fc4",
    "pr": "45115",
    "merge_sha": "6731fa82034fdeac129b546aeee8df1b02c5119d",
    "html": "<p>Allow using <code>helper_method</code>s in <code>content_security_policy</code> and <code>permissions_policy</code></p>\n\n<p>Previously you could access basic helpers (defined in helper modules), but not<br />\nhelper methods defined using <code>helper_method</code>. Now you can use either.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">content_security_policy</span> <span class=\"k\">do</span> <span class=\"o\">|</span><span class=\"nb\">p</span><span class=\"o\">|</span>\n  <span class=\"nb\">p</span><span class=\"p\">.</span><span class=\"nf\">default_src</span> <span class=\"s2\">\"https://example.com\"</span>\n  <span class=\"nb\">p</span><span class=\"p\">.</span><span class=\"nf\">script_src</span> <span class=\"s2\">\"https://example.com\"</span> <span class=\"k\">if</span> <span class=\"n\">helpers</span><span class=\"p\">.</span><span class=\"nf\">script_csp?</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p><em>Alex Ghiculescu</em></p>\n"
  },
  {
    "message": "*   Reimplement `ActionController::Parameters#has_value?` and `#value?` to avoid parameters and hashes comparison.\n\n    Deprecated equality between parameters and hashes is going to be removed in Rails 7.2.\n    The new implementation takes care of conversions.\n\n    *Seva Stefkin*",
    "project": "actionpack",
    "date_merged": 1651846475000,
    "author": "Seva Stefkin",
    "sha": "743ab4368630e799740f108b3288b2afe0ed2501",
    "pr": "44866",
    "merge_sha": "377ae3cee66f94d51cc7478a89eeee663173f441",
    "html": "<p>Reimplement <code>ActionController::Parameters#has_value?</code> and <code>#value?</code> to avoid parameters and hashes comparison.</p>\n\n<p>Deprecated equality between parameters and hashes is going to be removed in Rails 7.2.<br />\nThe new implementation takes care of conversions.</p>\n\n<p><em>Seva Stefkin</em></p>\n"
  },
  {
    "message": "*   Allow only String and Symbol keys in `ActionController::Parameters`.\n    Raise `ActionController::InvalidParameterKey` when initializing Parameters\n    with keys that aren't strings or symbols.\n\n    *Seva Stefkin*",
    "project": "actionpack",
    "date_merged": 1649276388000,
    "author": "Seva Stefkin",
    "sha": "86980d1a9d6978cffc4282747d7c9906ead55ff7",
    "pr": "44844",
    "merge_sha": "39b7bf7a00fd7abc339573a9f5b62cf0db7a8a9b",
    "html": "<p>Allow only String and Symbol keys in <code>ActionController::Parameters</code>.<br />\nRaise <code>ActionController::InvalidParameterKey</code> when initializing Parameters<br />\nwith keys that aren’t strings or symbols.</p>\n\n<p><em>Seva Stefkin</em></p>\n"
  },
  {
    "message": "*   Add the ability to use custom logic for storing and retrieving CSRF tokens.\n\n    By default, the token will be stored in the session.  Custom classes can be\n    defined to specify arbitrary behavior, but the ability to store them in\n    encrypted cookies is built in.\n\n    *Andrew Kowpak*",
    "project": "actionpack",
    "date_merged": 1649229296000,
    "author": "Andrew Kowpak",
    "sha": "f2c66ce392016efd49816cd6fdc9f174271a0321",
    "pr": "44283",
    "merge_sha": "a2e201fc6d4ef14ff9a8b79e4dc663c463cef029",
    "html": "<p>Add the ability to use custom logic for storing and retrieving CSRF tokens.</p>\n\n<p>By default, the token will be stored in the session.  Custom classes can be<br />\ndefined to specify arbitrary behavior, but the ability to store them in<br />\nencrypted cookies is built in.</p>\n\n<p><em>Andrew Kowpak</em></p>\n"
  },
  {
    "message": "*   Make ActionController::Parameters#values cast nested hashes into parameters.\n\n    *Gannon McGibbon*",
    "project": "actionpack",
    "date_merged": 1648817306000,
    "author": "Gannon McGibbon",
    "sha": "aba600885088ed4922c4ddb538ea3c003de2cef5",
    "pr": "44816",
    "merge_sha": "c32514bb3973b1a167dcb22f568f3aec16d1abbe",
    "html": "<p>Make ActionController::Parameters#values cast nested hashes into parameters.</p>\n\n<p><em>Gannon McGibbon</em></p>\n"
  },
  {
    "message": "*   Introduce `html:` and `screenshot:` kwargs for system test screenshot helper\n\n    Use these as an alternative to the already-available environment variables.\n\n    For example, this will display a screenshot in iTerm, save the HTML, and output\n    its path.\n\n    ```ruby\n    take_screenshot(html: true, screenshot: \"inline\")\n    ```\n\n    *Alex Ghiculescu*",
    "project": "actionpack",
    "date_merged": 1648148267000,
    "author": "Alex Ghiculescu",
    "sha": "70122d334b31e649aaa6345dae20b1b9e1cbd787",
    "pr": "44720",
    "merge_sha": "9ec791d9e944279b50e1e83ab346fa66a05eb980",
    "html": "<p>Introduce <code>html:</code> and <code>screenshot:</code> kwargs for system test screenshot helper</p>\n\n<p>Use these as an alternative to the already-available environment variables.</p>\n\n<p>For example, this will display a screenshot in iTerm, save the HTML, and output<br />\nits path.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">take_screenshot</span><span class=\"p\">(</span><span class=\"ss\">html: </span><span class=\"kp\">true</span><span class=\"p\">,</span> <span class=\"ss\">screenshot: </span><span class=\"s2\">\"inline\"</span><span class=\"p\">)</span>\n</code></pre></div></div>\n\n<p><em>Alex Ghiculescu</em></p>\n"
  },
  {
    "message": "*   Allow `ActionController::Parameters#to_h` to receive a block.\n\n    *Bob Farrell*",
    "project": "actionpack",
    "date_merged": 1648075203000,
    "author": "Bob Farrell",
    "sha": "0e1188b563cd105d1b7167233c47d614c7902f81",
    "pr": "44756",
    "merge_sha": "f557a166475cdc08415bca7d7b7ef1285fa84a90",
    "html": "<p>Allow <code>ActionController::Parameters#to_h</code> to receive a block.</p>\n\n<p><em>Bob Farrell</em></p>\n"
  },
  {
    "message": "*   Allow relative redirects when `raise_on_open_redirects` is enabled\n\n    *Tom Hughes*",
    "project": "actionpack",
    "date_merged": 1646932255000,
    "author": "Tom Hughes",
    "sha": "24ebaa4e83b8809be5145bc31d68f267daadfe20",
    "pr": "44650",
    "merge_sha": "1bca3cc406c0c7aa06e48a9f060096cf95ced721",
    "html": "<p>Allow relative redirects when <code>raise_on_open_redirects</code> is enabled</p>\n\n<p><em>Tom Hughes</em></p>\n"
  },
  {
    "message": "*   Allow Content Security Policy DSL to generate for API responses.\n\n    *Tim Wade*",
    "project": "actionpack",
    "date_merged": 1646774595000,
    "author": "Tim Wade",
    "sha": "803f87567f0cd11295f4155189417225747e115c",
    "pr": "44635",
    "merge_sha": "8516bb68049c998cfd4eafcb317e1b4f9ffc64cb",
    "html": "<p>Allow Content Security Policy DSL to generate for API responses.</p>\n\n<p><em>Tim Wade</em></p>\n"
  },
  {
    "message": "*   Fix `authenticate_with_http_basic` to allow for missing password.\n\n    Before Rails 7.0 it was possible to handle basic authentication with only a username.\n\n    ```ruby\n    authenticate_with_http_basic do |token, _|\n      ApiClient.authenticate(token)\n    end\n    ```\n\n    This ability is restored.\n\n    *Jean Boussier*",
    "project": "actionpack",
    "date_merged": 1646402157000,
    "author": "Jean Boussier",
    "sha": "9ebfb149ed362697c042bb030bddcb3ba2fceb97",
    "pr": "44610",
    "merge_sha": "9ae05215dc551fdfea6bdfea0f8414270482633f",
    "html": "<p>Fix <code>authenticate_with_http_basic</code> to allow for missing password.</p>\n\n<p>Before Rails 7.0 it was possible to handle basic authentication with only a username.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">authenticate_with_http_basic</span> <span class=\"k\">do</span> <span class=\"o\">|</span><span class=\"n\">token</span><span class=\"p\">,</span> <span class=\"n\">_</span><span class=\"o\">|</span>\n  <span class=\"no\">ApiClient</span><span class=\"p\">.</span><span class=\"nf\">authenticate</span><span class=\"p\">(</span><span class=\"n\">token</span><span class=\"p\">)</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p>This ability is restored.</p>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   Fix `content_security_policy` returning invalid directives.\n\n    Directives such as `self`, `unsafe-eval` and few others were not\n    single quoted when the directive was the result of calling a lambda\n    returning an array.\n\n    ```ruby\n    content_security_policy do |policy|\n      policy.frame_ancestors lambda { [:self, \"https://example.com\"] }\n    end\n    ```\n\n    With this fix the policy generated from above will now be valid.\n\n    *Edouard Chin*",
    "project": "actionpack",
    "date_merged": 1646160662000,
    "author": "Edouard CHIN",
    "sha": "cdccbb4818b7a9e511d3222c0681e7a517285b6c",
    "pr": "44578",
    "merge_sha": "ad2529be4b5942b6f38ab83b9796e1976685edca",
    "html": "<p>Fix <code>content_security_policy</code> returning invalid directives.</p>\n\n<p>Directives such as <code>self</code>, <code>unsafe-eval</code> and few others were not<br />\nsingle quoted when the directive was the result of calling a lambda<br />\nreturning an array.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">content_security_policy</span> <span class=\"k\">do</span> <span class=\"o\">|</span><span class=\"n\">policy</span><span class=\"o\">|</span>\n  <span class=\"n\">policy</span><span class=\"p\">.</span><span class=\"nf\">frame_ancestors</span> <span class=\"nb\">lambda</span> <span class=\"p\">{</span> <span class=\"p\">[</span><span class=\"ss\">:self</span><span class=\"p\">,</span> <span class=\"s2\">\"https://example.com\"</span><span class=\"p\">]</span> <span class=\"p\">}</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p>With this fix the policy generated from above will now be valid.</p>\n\n<p><em>Edouard Chin</em></p>\n"
  },
  {
    "message": "*   Fix `skip_forgery_protection` to run without raising an error if forgery\n    protection has not been enabled / `verify_authenticity_token` is not a\n    defined callback.\n\n    This fix prevents the Rails 7.0 Welcome Page (`/`) from raising an\n    `ArgumentError` if `default_protect_from_forgery` is false.\n\n    *Brad Trick*",
    "project": "actionpack",
    "date_merged": 1646024099000,
    "author": "Brad Trick",
    "sha": "880a1bedb925571eb265e16337b8464800cdb15d",
    "pr": "44537",
    "merge_sha": "1cf3fde2d9634c6af6dbdf0ed701a24f7f47cef5",
    "html": "<p>Fix <code>skip_forgery_protection</code> to run without raising an error if forgery<br />\nprotection has not been enabled / <code>verify_authenticity_token</code> is not a<br />\ndefined callback.</p>\n\n<p>This fix prevents the Rails 7.0 Welcome Page (<code>/</code>) from raising an<br />\n<code>ArgumentError</code> if <code>default_protect_from_forgery</code> is false.</p>\n\n<p><em>Brad Trick</em></p>\n"
  },
  {
    "message": "*   Make `redirect_to` return an empty response body.\n\n    Application controllers that wish to add a response body after calling\n    `redirect_to` can continue to do so.\n\n    *Jon Dufresne*",
    "project": "actionpack",
    "date_merged": 1645816687000,
    "author": "Jon Dufresne",
    "sha": "c2e756a944fd3ca2efa58bd285c0e75e0b4794ab",
    "pr": "44554",
    "merge_sha": "9d65858d7daa9e2310fa68476ff78550cf1fb714",
    "html": "<p>Make <code>redirect_to</code> return an empty response body.</p>\n\n<p>Application controllers that wish to add a response body after calling<br />\n<code>redirect_to</code> can continue to do so.</p>\n\n<p><em>Jon Dufresne</em></p>\n"
  },
  {
    "message": "*   Use non-capturing group for subdomain matching in `ActionDispatch::HostAuthorization`\n\n    Since we do nothing with the captured subdomain group, we can use a non-capturing group instead.\n\n    *Sam Bostock*",
    "project": "actionpack",
    "date_merged": 1645563383000,
    "author": "Sam Bostock",
    "sha": "c56abcd6a9f4b2e06274e293a3f5a5e69123f5d6",
    "pr": "44520",
    "merge_sha": "ab8128e7c8f5529808bc0ccc70331501c82c480e",
    "html": "<p>Use non-capturing group for subdomain matching in <code>ActionDispatch::HostAuthorization</code></p>\n\n<p>Since we do nothing with the captured subdomain group, we can use a non-capturing group instead.</p>\n\n<p><em>Sam Bostock</em></p>\n"
  },
  {
    "message": "*   Fix `ActionController::Live` to copy the IsolatedExecutionState in the ephemeral thread.\n\n    Since its inception `ActionController::Live` has been copying thread local variables\n    to keep things such as `CurrentAttributes` set from middlewares working in the controller action.\n\n    With the introduction of `IsolatedExecutionState` in 7.0, some of that global state was lost in\n    `ActionController::Live` controllers.\n\n    *Jean Boussier*",
    "project": "actionpack",
    "date_merged": 1645563383000,
    "author": "Jean Boussier",
    "sha": "ce1517ea5290c1190d94c3168cfc4dc5fcdb36ed",
    "pr": "44520",
    "merge_sha": "ab8128e7c8f5529808bc0ccc70331501c82c480e",
    "html": "<p>Fix <code>ActionController::Live</code> to copy the IsolatedExecutionState in the ephemeral thread.</p>\n\n<p>Since its inception <code>ActionController::Live</code> has been copying thread local variables<br />\nto keep things such as <code>CurrentAttributes</code> set from middlewares working in the controller action.</p>\n\n<p>With the introduction of <code>IsolatedExecutionState</code> in 7.0, some of that global state was lost in<br />\n<code>ActionController::Live</code> controllers.</p>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   Fix setting `trailing_slash: true` in route definition.\n\n    ```ruby\n    get '/test' => \"test#index\", as: :test, trailing_slash: true\n\n    test_path() # => \"/test/\"\n    ```\n\n    *Jean Boussier*",
    "project": "actionpack",
    "date_merged": 1644923509000,
    "author": "Jean Boussier",
    "sha": "2d63d60fa44b48e1382451590b7a6a6952e87f67",
    "pr": "44434",
    "merge_sha": "efd066c740bc8e9e81b06051021615efd552b4a0",
    "html": "<p>Fix setting <code>trailing_slash: true</code> in route definition.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">get</span> <span class=\"s1\">'/test'</span> <span class=\"o\">=&gt;</span> <span class=\"s2\">\"test#index\"</span><span class=\"p\">,</span> <span class=\"ss\">as: :test</span><span class=\"p\">,</span> <span class=\"ss\">trailing_slash: </span><span class=\"kp\">true</span>\n\n<span class=\"n\">test_path</span><span class=\"p\">()</span> <span class=\"c1\"># =&gt; \"/test/\"</span>\n</code></pre></div></div>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   Make `Session#merge!` stringify keys.\n\n    Previously `Session#update` would, but `merge!` wouldn't.\n\n    *Drew Bragg*",
    "project": "actionpack",
    "date_merged": 1644056995000,
    "author": "Drew Bragg",
    "sha": "2bdd29a6e48fe04c6fb6b7c73471a03ecae0ab7c",
    "pr": "44261",
    "merge_sha": "6a55aff4a9fc5021066146f2c4abebb98a8d9894",
    "html": "<p>Make <code>Session#merge!</code> stringify keys.</p>\n\n<p>Previously <code>Session#update</code> would, but <code>merge!</code> wouldn’t.</p>\n\n<p><em>Drew Bragg</em></p>\n"
  },
  {
    "message": "*   Add `:unsafe_hashes` mapping for `content_security_policy`\n\n    ```ruby\n    # Before\n    policy.script_src  :strict_dynamic, \"'unsafe-hashes'\", \"'sha256-rRMdkshZyJlCmDX27XnL7g3zXaxv7ei6Sg+yt4R3svU='\"\n\n    # After\n    policy.script_src  :strict_dynamic, :unsafe_hashes, \"'sha256-rRMdkshZyJlCmDX27XnL7g3zXaxv7ei6Sg+yt4R3svU='\"\n    ```\n\n    *Igor Morozov*",
    "project": "actionpack",
    "date_merged": 1684177087000,
    "author": "Igor S. Morozov",
    "sha": "300b8e32c28e57f78663977767603080ebe29ac2",
    "pr": "48212",
    "merge_sha": "bdbcbc179df93b18e2ce6e1deef631eb2eea1624",
    "html": "<p>Add <code>:unsafe_hashes</code> mapping for <code>content_security_policy</code></p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># Before</span>\n<span class=\"n\">policy</span><span class=\"p\">.</span><span class=\"nf\">script_src</span>  <span class=\"ss\">:strict_dynamic</span><span class=\"p\">,</span> <span class=\"s2\">\"'unsafe-hashes'\"</span><span class=\"p\">,</span> <span class=\"s2\">\"'sha256-rRMdkshZyJlCmDX27XnL7g3zXaxv7ei6Sg+yt4R3svU='\"</span>\n\n<span class=\"c1\"># After</span>\n<span class=\"n\">policy</span><span class=\"p\">.</span><span class=\"nf\">script_src</span>  <span class=\"ss\">:strict_dynamic</span><span class=\"p\">,</span> <span class=\"ss\">:unsafe_hashes</span><span class=\"p\">,</span> <span class=\"s2\">\"'sha256-rRMdkshZyJlCmDX27XnL7g3zXaxv7ei6Sg+yt4R3svU='\"</span>\n</code></pre></div></div>\n\n<p><em>Igor Morozov</em></p>\n"
  },
  {
    "message": "*   `config/application.rb` now includes\n\n    ```ruby\n    config.autoload_lib(ignore: %w(assets tasks))\n    ```\n\n    In practice, this means that new 7.1 applications autoload from `lib` out of the box.\n\n    *Xavier Noria*",
    "project": "railties",
    "date_merged": 1692949004000,
    "author": "Xavier Noria",
    "sha": "b16adcd4e49fae25e937b42d0473c7a872218857",
    "pr": "49032",
    "merge_sha": "153eae8995c2de3d1bafc0fb13ae5a3250703a3d",
    "html": "<p><code>config/application.rb</code> now includes</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">config</span><span class=\"p\">.</span><span class=\"nf\">autoload_lib</span><span class=\"p\">(</span><span class=\"ss\">ignore: </span><span class=\"sx\">%w(assets tasks)</span><span class=\"p\">)</span>\n</code></pre></div></div>\n\n<p>In practice, this means that new 7.1 applications autoload from <code>lib</code> out of the box.</p>\n\n<p><em>Xavier Noria</em></p>\n"
  },
  {
    "message": "*   Add an option to start rails console in sandbox mode by default\n\n    `sandbox_by_default` option is added to start rails console in sandbox\n    mode by default. With this option turned on, `--no-sandbox` must be\n    specified to start rails in non-sandbox mode.\n\n    Note that this option is ignored when rails environment is development\n    or test.\n\n    *Shouichi Kamiya*",
    "project": "railties",
    "date_merged": 1692667322000,
    "author": "Shouichi Kamiya",
    "sha": "b8decf79d80a33d5a2d504d0305175f1f1849bfa",
    "pr": "48984",
    "merge_sha": "9b6dee054df33a23c6997c900045b2a41bc2a2ce",
    "html": "<p>Add an option to start rails console in sandbox mode by default</p>\n\n<p><code>sandbox_by_default</code> option is added to start rails console in sandbox<br />\nmode by default. With this option turned on, <code>--no-sandbox</code> must be<br />\nspecified to start rails in non-sandbox mode.</p>\n\n<p>Note that this option is ignored when rails environment is development<br />\nor test.</p>\n\n<p><em>Shouichi Kamiya</em></p>\n"
  },
  {
    "message": "*   Omit `webdrivers` gem dependency from `Gemfile` template\n\n    *Sean Doyle*",
    "project": "railties",
    "date_merged": 1690998568000,
    "author": "Sean Doyle",
    "sha": "9a532346950c74c6c745a2f22cbbb6b471a4297f",
    "pr": "48847",
    "merge_sha": "e980f158a4d48c712024b50cf61f20ce1a0265ed",
    "html": "<p>Omit <code>webdrivers</code> gem dependency from <code>Gemfile</code> template</p>\n\n<p><em>Sean Doyle</em></p>\n"
  },
  {
    "message": "*   Support filtering tests by line ranges\n\n    The new syntax allows you to filter tests by line ranges. For example, the\n    following command runs tests from line 10 to 20.\n\n    ```bash\n    $ rails test test/models/user_test.rb:10-20\n    ```\n\n    *Shouichi Kamiya*, *Seonggi Yang*, *oljfte*, *Ryohei UEDA*",
    "project": "railties",
    "date_merged": 1690872050000,
    "author": "Shouichi Kamiya",
    "sha": "5931a681582d0120908744bfd662d20d6df48630",
    "pr": "48807",
    "merge_sha": "741cd18c45f96e0e88a76fe9a2267d8cf135dc3f",
    "html": "<p>Support filtering tests by line ranges</p>\n\n<p>The new syntax allows you to filter tests by line ranges. For example, the<br />\nfollowing command runs tests from line 10 to 20.</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nv\">$ </span>rails <span class=\"nb\">test test</span>/models/user_test.rb:10-20\n</code></pre></div></div>\n\n<p><em>Shouichi Kamiya</em>, <em>Seonggi Yang</em>, <em>oljfte</em>, <em>Ryohei UEDA</em></p>\n"
  },
  {
    "message": "*   Update default scaffold templates to set 303 (See Other) as status code\n    on redirect for the update action for XHR requests other than GET or POST\n    to avoid issues (e.g browsers trying to follow the redirect using the\n    original request method resulting in double PATCH/PUT)\n\n    *Guillermo Iguaran*",
    "project": "railties",
    "date_merged": 1688274648000,
    "author": "Guillermo Iguaran",
    "sha": "5ed37b35d666b833aeccb14a4cacd2926251232d",
    "pr": "48622",
    "merge_sha": "f46d3452ae30c46d3e213c687decbbca0cee9119",
    "html": "<p>Update default scaffold templates to set 303 (See Other) as status code<br />\non redirect for the update action for XHR requests other than GET or POST<br />\nto avoid issues (e.g browsers trying to follow the redirect using the<br />\noriginal request method resulting in double PATCH/PUT)</p>\n\n<p><em>Guillermo Iguaran</em></p>\n"
  },
  {
    "message": "*   The new `config.autoload_lib_once` is similar to `config.autoload_lib`,\n    except that it adds `lib` to `config.autoload_once_paths` instead.\n\n    By calling `config.autoload_lib_once`, classes and modules in `lib` can be\n    autoloaded, even from application initializers, but won't be reloaded.\n\n    Please, see further details in the [autoloading\n    guide](https://guides.rubyonrails.org/v7.1/autoloading_and_reloading_constants.html).\n\n    *Xavier Noria*",
    "project": "railties",
    "date_merged": 1688023706000,
    "author": "Xavier Noria",
    "sha": "0568bc9a90de846ec3823b14ebc10905bb670424",
    "pr": "48610",
    "merge_sha": "914130a9f54fb45fa9d56cfdd0b838e403946e8c",
    "html": "<p>The new <code>config.autoload_lib_once</code> is similar to <code>config.autoload_lib</code>,<br />\nexcept that it adds <code>lib</code> to <code>config.autoload_once_paths</code> instead.</p>\n\n<p>By calling <code>config.autoload_lib_once</code>, classes and modules in <code>lib</code> can be<br />\nautoloaded, even from application initializers, but won’t be reloaded.</p>\n\n<p>Please, see further details in the <a href=\"https://guides.rubyonrails.org/v7.1/autoloading_and_reloading_constants.html\">autoloading<br />\nguide</a>.</p>\n\n<p><em>Xavier Noria</em></p>\n"
  },
  {
    "message": "*   Add `config.action_dispatch.debug_exception_log_level` to configure the log\n    level used by `ActionDispatch::DebugExceptions`.\n\n    The default is `:fatal`, but with `load_defaults \"7.1\"` the default will be\n    `:error`.\n\n    *Hartley McGuire*",
    "project": "railties",
    "date_merged": 1687886265000,
    "author": "Hartley McGuire",
    "sha": "519577ecc3662fa4645c222f08e5d5c9812218b7",
    "pr": "48575",
    "merge_sha": "1c0aeed2fb41d9adcfca6f523c168ce1f1d9e4a0",
    "html": "<p>Add <code>config.action_dispatch.debug_exception_log_level</code> to configure the log<br />\nlevel used by <code>ActionDispatch::DebugExceptions</code>.</p>\n\n<p>The default is <code>:fatal</code>, but with <code>load_defaults \"7.1\"</code> the default will be<br />\n<code>:error</code>.</p>\n\n<p><em>Hartley McGuire</em></p>\n"
  },
  {
    "message": "*   Add `DATABASE` option to `railties:install:migrations`\n\n    This allows you to specify which database the migrations should be copied to\n    when running `rails railties:install:migrations`.\n\n    ```bash\n    $ rails railties:install:migrations DATABASE=animals\n    ```\n\n    *Matthew Hirst*",
    "project": "railties",
    "date_merged": 1687801548000,
    "author": "Matthew Hirst",
    "sha": "00ebbbd7464a802cf08e2ea238637736cb691ea9",
    "pr": "48579",
    "merge_sha": "37a56aadc6638e749eb30bee86d9a41df18456c1",
    "html": "<p>Add <code>DATABASE</code> option to <code>railties:install:migrations</code></p>\n\n<p>This allows you to specify which database the migrations should be copied to<br />\nwhen running <code>rails railties:install:migrations</code>.</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nv\">$ </span>rails railties:install:migrations <span class=\"nv\">DATABASE</span><span class=\"o\">=</span>animals\n</code></pre></div></div>\n\n<p><em>Matthew Hirst</em></p>\n"
  },
  {
    "message": "*   The new method `config.autoload_lib(ignore:)` provides a simple way to\n    autoload from `lib`:\n\n    ```ruby\n    # config/application.rb\n    config.autoload_lib(ignore: %w(assets tasks))\n    ```\n\n    Please, see further details in the [autoloading\n    guide](https://guides.rubyonrails.org/v7.1/autoloading_and_reloading_constants.html).\n\n    *Xavier Noria*",
    "project": "railties",
    "date_merged": 1687682590000,
    "author": "Xavier Noria",
    "sha": "e1321a291ff059de5001e33c84fb00ee8bcdbc20",
    "pr": "48572",
    "merge_sha": "a35689a53391fb32224a4ceb738673cbc9365e79",
    "html": "<p>The new method <code>config.autoload_lib(ignore:)</code> provides a simple way to<br />\nautoload from <code>lib</code>:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># config/application.rb</span>\n<span class=\"n\">config</span><span class=\"p\">.</span><span class=\"nf\">autoload_lib</span><span class=\"p\">(</span><span class=\"ss\">ignore: </span><span class=\"sx\">%w(assets tasks)</span><span class=\"p\">)</span>\n</code></pre></div></div>\n\n<p>Please, see further details in the <a href=\"https://guides.rubyonrails.org/v7.1/autoloading_and_reloading_constants.html\">autoloading<br />\nguide</a>.</p>\n\n<p><em>Xavier Noria</em></p>\n"
  },
  {
    "message": "*   Don't show secret_key_base for `Rails.application.config#inspect`.\n\n    Before:\n\n    ```ruby\n    Rails.application.config.inspect\n    \"#<Rails::Application::Configuration:0x00000001132b02a0 @root=... @secret_key_base=\\\"b3c631c314c0bbca50c1b2843150fe33\\\" ... >\"\n    ```\n\n    After:\n\n    ```ruby\n    Rails.application.config.inspect\n    \"#<Rails::Application::Configuration:0x00000001132b02a0>\"\n    ```\n\n    *Petrik de Heus*",
    "project": "railties",
    "date_merged": 1686939580000,
    "author": "Petrik",
    "sha": "eaa190169f1efc8893e4375c5ddfda6329f2e18d",
    "pr": "48500",
    "merge_sha": "047213a4bc2071c9a1e882d749a0cd46482c706a",
    "html": "<p>Don’t show secret_key_base for <code>Rails.application.config#inspect</code>.</p>\n\n<p>Before:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">Rails</span><span class=\"p\">.</span><span class=\"nf\">application</span><span class=\"p\">.</span><span class=\"nf\">config</span><span class=\"p\">.</span><span class=\"nf\">inspect</span>\n<span class=\"s2\">\"#&lt;Rails::Application::Configuration:0x00000001132b02a0 @root=... @secret_key_base=</span><span class=\"se\">\\\"</span><span class=\"s2\">b3c631c314c0bbca50c1b2843150fe33</span><span class=\"se\">\\\"</span><span class=\"s2\"> ... &gt;\"</span>\n</code></pre></div></div>\n\n<p>After:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">Rails</span><span class=\"p\">.</span><span class=\"nf\">application</span><span class=\"p\">.</span><span class=\"nf\">config</span><span class=\"p\">.</span><span class=\"nf\">inspect</span>\n<span class=\"s2\">\"#&lt;Rails::Application::Configuration:0x00000001132b02a0&gt;\"</span>\n</code></pre></div></div>\n\n<p><em>Petrik de Heus</em></p>\n"
  },
  {
    "message": "*   Deprecate calling `Rails.application.secrets`.\n\n    Rails `secrets` have been deprecated in favor of `credentials`.\n    Calling `Rails.application.secrets` should show a deprecation warning.\n\n    *Petrik de Heus*",
    "project": "railties",
    "date_merged": 1686812948000,
    "author": "Petrik",
    "sha": "9f9b540cb514a06341604122788ccf5a86cbe80d",
    "pr": "48472",
    "merge_sha": "e10e35dd32aff48457a76b83e244e8baad34a9ec",
    "html": "<p>Deprecate calling <code>Rails.application.secrets</code>.</p>\n\n<p>Rails <code>secrets</code> have been deprecated in favor of <code>credentials</code>.<br />\nCalling <code>Rails.application.secrets</code> should show a deprecation warning.</p>\n\n<p><em>Petrik de Heus</em></p>\n"
  },
  {
    "message": "*   Store `secret_key_base` in `Rails.config` for local environments.\n\n    Rails `secrets` have been deprecated in favor of `credentials`.\n    For the local environments the `secret_key_base` is now stored in\n    `Rails.config.secret_key_base` instead of the soft deprecated\n    `Rails.application.secrets.secret_key_base`.\n\n    *Petrik de Heus*",
    "project": "railties",
    "date_merged": 1686779537000,
    "author": "Petrik",
    "sha": "21c34550549ed90f79565b333e06c7cee79c546e",
    "pr": "48470",
    "merge_sha": "23ccb336f384bb7bf60923608834227bee062f57",
    "html": "<p>Store <code>secret_key_base</code> in <code>Rails.config</code> for local environments.</p>\n\n<p>Rails <code>secrets</code> have been deprecated in favor of <code>credentials</code>.<br />\nFor the local environments the <code>secret_key_base</code> is now stored in<br />\n<code>Rails.config.secret_key_base</code> instead of the soft deprecated<br />\n<code>Rails.application.secrets.secret_key_base</code>.</p>\n\n<p><em>Petrik de Heus</em></p>\n"
  },
  {
    "message": "*   Enable force_ssl=true in production by default: Force all access to the app over SSL,\n    use Strict-Transport-Security, and use secure cookies\n\n    *Justin Searls*, *Aaron Patterson*, *Guillermo Iguaran*, *Vinícius Bispo*",
    "project": "railties",
    "date_merged": 1686408119000,
    "author": "Justin Searls",
    "sha": "3b8375868064ef5adc3e768523425bd5edd1a08f",
    "pr": "47852",
    "merge_sha": "18acbe8948e04088a3116ed3eb5df05ce72f0b20",
    "html": "<p>Enable force_ssl=true in production by default: Force all access to the app over SSL,<br />\nuse Strict-Transport-Security, and use secure cookies</p>\n\n<p><em>Justin Searls</em>, <em>Aaron Patterson</em>, <em>Guillermo Iguaran</em>, <em>Vinícius Bispo</em></p>\n"
  },
  {
    "message": "*   Add engine's draw paths to application route set, so that the application\n    can draw route files defined in engine paths.\n\n    *Gannon McGibbon*",
    "project": "railties",
    "date_merged": 1686023644000,
    "author": "Gannon McGibbon",
    "sha": "f9eea790a5b089f320b120593d80425aae5dd1ca",
    "pr": "48388",
    "merge_sha": "54ce634a9e297a609925d2904168c6a4166f1927",
    "html": "<p>Add engine’s draw paths to application route set, so that the application<br />\ncan draw route files defined in engine paths.</p>\n\n<p><em>Gannon McGibbon</em></p>\n"
  },
  {
    "message": "*   Support `VISUAL` environment variable for commands which open an editor,\n    and prefer it over `EDITOR`.\n\n    *Summer ☀️*",
    "project": "railties",
    "date_merged": 1685678117000,
    "author": "Summer ☀️",
    "sha": "a062d182c38cf3c0dc850c151b74a90dc7179880",
    "pr": "48374",
    "merge_sha": "48e4d99c75b7fded3d54c42883e49eddac879b39",
    "html": "<p>Support <code>VISUAL</code> environment variable for commands which open an editor,<br />\nand prefer it over <code>EDITOR</code>.</p>\n\n<p><em>Summer ☀️</em></p>\n"
  },
  {
    "message": "*   Add engine's `test/fixtures` path to `fixture_paths` in `on_load` hook if\n    path exists and is under the Rails application root.\n\n    *Chris Salzberg*",
    "project": "railties",
    "date_merged": 1684939219000,
    "author": "Chris Salzberg",
    "sha": "908f1c9bbc426368dbce91d3c740ac7bddefd7ab",
    "pr": "48287",
    "merge_sha": "a19b13b61f7af612569943ec7d536185cbec875c",
    "html": "<p>Add engine’s <code>test/fixtures</code> path to <code>fixture_paths</code> in <code>on_load</code> hook if<br />\npath exists and is under the Rails application root.</p>\n\n<p><em>Chris Salzberg</em></p>\n"
  },
  {
    "message": "*   `bin/rails app:template` now runs `bundle install` and any `after_bundle`\n    blocks after the template is executed.\n\n    *Jonathan Hefner* and *Gerry Caulfield*",
    "project": "railties",
    "date_merged": 1684699003000,
    "author": "Jonathan Hefner",
    "sha": "83e69c22e9ebfb3585c0fb6d536353f4f43fd483",
    "pr": "48269",
    "merge_sha": "844adad2c0dd0767b78c26c03372f9c60eda6791",
    "html": "<p><code>bin/rails app:template</code> now runs <code>bundle install</code> and any <code>after_bundle</code><br />\nblocks after the template is executed.</p>\n\n<p><em>Jonathan Hefner</em> and <em>Gerry Caulfield</em></p>\n"
  },
  {
    "message": "*   Enable passing column size to migration generator\n\n    Previously you could pass a limit to the migration generator:\n\n    `rails generate migration CreateAuthor name:text{65535}`\n\n    Now, a size attribute can be passed to the migration generator:\n\n    `rails generate migration CreateAuthor name:text{medium}`\n\n    This generates a migration which includes the size attribute:\n\n    ```ruby\n    class CreateAuthor < ActiveRecord::Migration[7.1]\n      def change\n        create_table :authors do |t|\n          t.text :name, size: :medium\n        end\n      end\n    end\n    ```\n\n    *Josh Broughton*, *Hartley McGuire*",
    "project": "railties",
    "date_merged": 1684179607000,
    "author": "Josh Broughton",
    "sha": "f5e4410d7e71c4c5acd961106e6c1fd13e6dd18d",
    "pr": "48210",
    "merge_sha": "ae92a8a30e01e3328d357769f2d7bfa9db2d9b22",
    "html": "<p>Enable passing column size to migration generator</p>\n\n<p>Previously you could pass a limit to the migration generator:</p>\n\n<p><code>rails generate migration CreateAuthor name:text{65535}</code></p>\n\n<p>Now, a size attribute can be passed to the migration generator:</p>\n\n<p><code>rails generate migration CreateAuthor name:text{medium}</code></p>\n\n<p>This generates a migration which includes the size attribute:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">class</span> <span class=\"nc\">CreateAuthor</span> <span class=\"o\">&lt;</span> <span class=\"no\">ActiveRecord</span><span class=\"o\">::</span><span class=\"no\">Migration</span><span class=\"p\">[</span><span class=\"mf\">7.1</span><span class=\"p\">]</span>\n  <span class=\"k\">def</span> <span class=\"nf\">change</span>\n    <span class=\"n\">create_table</span> <span class=\"ss\">:authors</span> <span class=\"k\">do</span> <span class=\"o\">|</span><span class=\"n\">t</span><span class=\"o\">|</span>\n      <span class=\"n\">t</span><span class=\"p\">.</span><span class=\"nf\">text</span> <span class=\"ss\">:name</span><span class=\"p\">,</span> <span class=\"ss\">size: :medium</span>\n    <span class=\"k\">end</span>\n  <span class=\"k\">end</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p><em>Josh Broughton</em>, <em>Hartley McGuire</em></p>\n"
  },
  {
    "message": "*   Trying to set a config key with the same name of a method now raises:\n\n    ```ruby\n    config.load_defaults = 7.0\n    # NoMethodError: Cannot assign to `load_defaults`, it is a configuration method\n    ```\n\n    *Xavier Noria*",
    "project": "railties",
    "date_merged": 1682239114000,
    "author": "Xavier Noria",
    "sha": "265bfad5fb7f875dfb3ddfafd895cb2ec80458f7",
    "pr": "48030",
    "merge_sha": "ea7ac1594b4e10b0d8814338209e5358fbd6a668",
    "html": "<p>Trying to set a config key with the same name of a method now raises:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">config</span><span class=\"p\">.</span><span class=\"nf\">load_defaults</span> <span class=\"o\">=</span> <span class=\"mf\">7.0</span>\n<span class=\"c1\"># NoMethodError: Cannot assign to `load_defaults`, it is a configuration method</span>\n</code></pre></div></div>\n\n<p><em>Xavier Noria</em></p>\n"
  },
  {
    "message": "*   Deprecate `secrets:edit/show` and remove `secrets:setup`\n\n    `bin/rails secrets:setup` has been deprecated since Rails 5.2 in favor of\n    credentials. This command has been removed.\n\n    `bin/rails secrets:show` and `bin/rails secrets:edit` have been deprecated\n    in favor of credentials.\n\n    Run `bin/rails credentials:help` for more information\n\n    *Petrik de Heus*",
    "project": "railties",
    "date_merged": 1681249966000,
    "author": "Petrik",
    "sha": "333bb6ba87278979cb7a0cc6969baf99642e14fc",
    "pr": "47801",
    "merge_sha": "1d22ea8f84f02afc7e53cbbd981c357ec895e84a",
    "html": "<p>Deprecate <code>secrets:edit/show</code> and remove <code>secrets:setup</code></p>\n\n<p><code>bin/rails secrets:setup</code> has been deprecated since Rails 5.2 in favor of<br />\ncredentials. This command has been removed.</p>\n\n<p><code>bin/rails secrets:show</code> and <code>bin/rails secrets:edit</code> have been deprecated<br />\nin favor of credentials.</p>\n\n<p>Run <code>bin/rails credentials:help</code> for more information</p>\n\n<p><em>Petrik de Heus</em></p>\n"
  },
  {
    "message": "*   `bin/rails --help` will now list only framework and plugin commands. Rake\n    tasks defined in `lib/tasks/*.rake` files will no longer be included. For a\n    list of those tasks, use `rake -T`.\n\n    *Jonathan Hefner*",
    "project": "railties",
    "date_merged": 1680039148000,
    "author": "Jonathan Hefner",
    "sha": "a32ff0e1d0d63713a6757205a081f95f998d9bdc",
    "pr": "47718",
    "merge_sha": "cf80ede0366283c5853df12b8312492edb67c8d9",
    "html": "<p><code>bin/rails --help</code> will now list only framework and plugin commands. Rake<br />\ntasks defined in <code>lib/tasks/*.rake</code> files will no longer be included. For a<br />\nlist of those tasks, use <code>rake -T</code>.</p>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Allow calling `bin/rails restart` outside of app directory.\n\n    The following would previously fail with a \"No Rakefile found\" error.\n\n    ```bash\n    $ blog/bin/rails restart\n    ```\n\n    *Petrik de Heus*",
    "project": "railties",
    "date_merged": 1678898287000,
    "author": "Petrik",
    "sha": "51c965c43174a45fed8e5d052f0d7d91ba632dc6",
    "pr": "47619",
    "merge_sha": "a51364dcf1dab34bc6cfc9aeca56a3b0ecf823ad",
    "html": "<p>Allow calling <code>bin/rails restart</code> outside of app directory.</p>\n\n<p>The following would previously fail with a “No Rakefile found” error.</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nv\">$ </span>blog/bin/rails restart\n</code></pre></div></div>\n\n<p><em>Petrik de Heus</em></p>\n"
  },
  {
    "message": "*   Support prerelease rubies in Gemfile template if RubyGems version is 3.3.13 or higher.\n\n    *Yasuo Honda*, *David Rodríguez*",
    "project": "railties",
    "date_merged": 1678854988000,
    "author": "Hartley McGuire",
    "sha": "b40c5f2512998b172511490543280080deb87b08",
    "pr": "47681",
    "merge_sha": "7d88419227ea7fca5d1e0506f7d3c9e6ba350173",
    "html": "<p>Support prerelease rubies in Gemfile template if RubyGems version is 3.3.13 or higher.</p>\n\n<p><em>Yasuo Honda</em>, <em>David Rodríguez</em></p>\n"
  },
  {
    "message": "*   Autoloading setup honors root directories manually set by the user.\n\n    This is relevant for custom namespaces. For example, if you'd like classes\n    and modules under `app/services` to be defined in the `Services` namespace\n    without an extra `app/services/services` directory, this is now enough:\n\n    ```ruby\n    # config/initializers/autoloading.rb\n\n    # The namespace has to exist.\n    #\n    # In this example we define the module on the spot. Could also be created\n    # elsewhere and its definition loaded here with an ordinary `require`. In\n    # any case, `push_dir` expects a class or module object.\n    module Services; end\n\n    Rails.autoloaders.main.push_dir(\"#{Rails.root}/app/services\", namespace: Services)\n    ```\n\n    Check the autoloading guide for further details.\n\n    *Xavier Noria*",
    "project": "railties",
    "date_merged": 1678049958000,
    "author": "Xavier Noria",
    "sha": "87f3f811a7320dc8cb79695a1f965189357421b9",
    "pr": "47583",
    "merge_sha": "c06e61f3e77e23c38e220b4f9721a25cffadb3b5",
    "html": "<p>Autoloading setup honors root directories manually set by the user.</p>\n\n<p>This is relevant for custom namespaces. For example, if you’d like classes<br />\nand modules under <code>app/services</code> to be defined in the <code>Services</code> namespace<br />\nwithout an extra <code>app/services/services</code> directory, this is now enough:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># config/initializers/autoloading.rb</span>\n\n<span class=\"c1\"># The namespace has to exist.</span>\n<span class=\"c1\">#</span>\n<span class=\"c1\"># In this example we define the module on the spot. Could also be created</span>\n<span class=\"c1\"># elsewhere and its definition loaded here with an ordinary `require`. In</span>\n<span class=\"c1\"># any case, `push_dir` expects a class or module object.</span>\n<span class=\"k\">module</span> <span class=\"nn\">Services</span><span class=\"p\">;</span> <span class=\"k\">end</span>\n\n<span class=\"no\">Rails</span><span class=\"p\">.</span><span class=\"nf\">autoloaders</span><span class=\"p\">.</span><span class=\"nf\">main</span><span class=\"p\">.</span><span class=\"nf\">push_dir</span><span class=\"p\">(</span><span class=\"s2\">\"</span><span class=\"si\">#{</span><span class=\"no\">Rails</span><span class=\"p\">.</span><span class=\"nf\">root</span><span class=\"si\">}</span><span class=\"s2\">/app/services\"</span><span class=\"p\">,</span> <span class=\"ss\">namespace: </span><span class=\"no\">Services</span><span class=\"p\">)</span>\n</code></pre></div></div>\n\n<p>Check the autoloading guide for further details.</p>\n\n<p><em>Xavier Noria</em></p>\n"
  },
  {
    "message": "*   Railties now requires the irb gem as a dependency, which means when you install Rails, irb will also\n    be installed as a gem. Rails will then use the installed version of irb for its console instead of\n    relying on Ruby's built-in version.\n    This ensures that Rails has access to the most up-to-date and reliable version of irb for its console.\n\n    *Stan Lo*",
    "project": "railties",
    "date_merged": 1678140712000,
    "author": "Stan Lo",
    "sha": "4fefed42398867e4a103d48267395481b2845cb3",
    "pr": "47442",
    "merge_sha": "bf560f6bfac8a89b612e46179b837f669b10fb02",
    "html": "<p>Railties now requires the irb gem as a dependency, which means when you install Rails, irb will also<br />\nbe installed as a gem. Rails will then use the installed version of irb for its console instead of<br />\nrelying on Ruby’s built-in version.<br />\nThis ensures that Rails has access to the most up-to-date and reliable version of irb for its console.</p>\n\n<p><em>Stan Lo</em></p>\n"
  },
  {
    "message": "*   Use infinitive form for all rails command descriptions verbs.\n\n    *Petrik de Heus*",
    "project": "railties",
    "date_merged": 1675290656000,
    "author": "Petrik",
    "sha": "6e89ae2d2eb72d951ec20aa7f7474aee64e29574",
    "pr": "47215",
    "merge_sha": "41b5306ad63751960caeb52dc39a82e07f1144db",
    "html": "<p>Use infinitive form for all rails command descriptions verbs.</p>\n\n<p><em>Petrik de Heus</em></p>\n"
  },
  {
    "message": "*   Credentials commands (e.g. `bin/rails credentials:edit`) now respect\n    `config.credentials.content_path` and `config.credentials.key_path` when set\n    in `config/application.rb` or `config/environments/#{Rails.env}.rb`.\n\n    Before:\n\n      * `bin/rails credentials:edit` ignored `RAILS_ENV`, and would always edit\n        `config/credentials.yml.enc`.\n\n      * `bin/rails credentials:edit --environment foo` would create and edit\n        `config/credentials/foo.yml.enc`.\n\n      * If `config.credentials.content_path` or `config.credentials.key_path`\n        was set, `bin/rails credentials:edit` could not be used to edit the\n        credentials.  Editing credentials required using `bin/rails\n        encrypted:edit path/to/credentials --key path/to/key`.\n\n    After:\n\n      * `bin/rails credentials:edit` will edit the credentials file that the app\n        would load for the current `RAILS_ENV`.\n\n      * `bin/rails credentials:edit` respects `config.credentials.content_path`\n        and `config.credentials.key_path` when set in `config/application.rb`\n        or `config/environments/#{Rails.env}.rb`.\n\n      * `bin/rails credentials:edit --environment foo` will create and edit\n        `config/credentials/foo.yml.enc` _if_ `config.credentials.content_path`\n        has not been set for the `foo` environment.  Ultimately, it will edit\n        the credentials file that the app would load for the `foo` environment.\n\n    *Jonathan Hefner*",
    "project": "railties",
    "date_merged": 1674685671000,
    "author": "Jonathan Hefner",
    "sha": "1068945b8fc9324c795224ca8e16c45d9ff15f10",
    "pr": "47107",
    "merge_sha": "bcc1eb727b368aab7b83077643e7681ef63619ea",
    "html": "<p>Credentials commands (e.g. <code>bin/rails credentials:edit</code>) now respect<br />\n<code>config.credentials.content_path</code> and <code>config.credentials.key_path</code> when set<br />\nin <code>config/application.rb</code> or <code>config/environments/#{Rails.env}.rb</code>.</p>\n\n<p>Before:</p>\n\n<ul>\n  <li>\n    <p><code>bin/rails credentials:edit</code> ignored <code>RAILS_ENV</code>, and would always edit<br />\n<code>config/credentials.yml.enc</code>.</p>\n  </li>\n  <li>\n    <p><code>bin/rails credentials:edit --environment foo</code> would create and edit<br />\n<code>config/credentials/foo.yml.enc</code>.</p>\n  </li>\n  <li>\n    <p>If <code>config.credentials.content_path</code> or <code>config.credentials.key_path</code><br />\nwas set, <code>bin/rails credentials:edit</code> could not be used to edit the<br />\ncredentials.  Editing credentials required using <code>bin/rails\nencrypted:edit path/to/credentials --key path/to/key</code>.</p>\n  </li>\n</ul>\n\n<p>After:</p>\n\n<ul>\n  <li>\n    <p><code>bin/rails credentials:edit</code> will edit the credentials file that the app<br />\nwould load for the current <code>RAILS_ENV</code>.</p>\n  </li>\n  <li>\n    <p><code>bin/rails credentials:edit</code> respects <code>config.credentials.content_path</code><br />\nand <code>config.credentials.key_path</code> when set in <code>config/application.rb</code><br />\nor <code>config/environments/#{Rails.env}.rb</code>.</p>\n  </li>\n  <li>\n    <p><code>bin/rails credentials:edit --environment foo</code> will create and edit<br />\n<code>config/credentials/foo.yml.enc</code> <em>if</em> <code>config.credentials.content_path</code><br />\nhas not been set for the <code>foo</code> environment.  Ultimately, it will edit<br />\nthe credentials file that the app would load for the <code>foo</code> environment.</p>\n  </li>\n</ul>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Add descriptions for non-Rake commands when running `rails -h`.\n\n    *Petrik de Heus*",
    "project": "railties",
    "date_merged": 1673891603000,
    "author": "Petrik",
    "sha": "9d06541ae0bfb5434ad67517bf0f7caa05b460f7",
    "pr": "46997",
    "merge_sha": "20cd6a824d13db7cc6fa231210e124a180c1a770",
    "html": "<p>Add descriptions for non-Rake commands when running <code>rails -h</code>.</p>\n\n<p><em>Petrik de Heus</em></p>\n"
  },
  {
    "message": "*   Show relevant commands when calling help\n\n    When running `rails -h` or just `rails` outside a Rails application,\n    Rails outputs all options for running the `rails new` command. This can be\n    confusing to users when they probably want to see the common Rails commands.\n\n    Instead, we should always show the common commands when running `rails -h`\n    inside or outside a Rails application.\n\n    As the relevant commands inside a Rails application differ from the\n    commands outside an application, the help USAGE file has been split to\n    show the most relevant commands for the context.\n\n    *Petrik de Heus*",
    "project": "railties",
    "date_merged": 1673558694000,
    "author": "Petrik",
    "sha": "9a6d380cf263acd21aecd7931486f9a3afadda4e",
    "pr": "46164",
    "merge_sha": "6aaf185884275de67b4cbd852def955108bb3fd3",
    "html": "<p>Show relevant commands when calling help</p>\n\n<p>When running <code>rails -h</code> or just <code>rails</code> outside a Rails application,<br />\nRails outputs all options for running the <code>rails new</code> command. This can be<br />\nconfusing to users when they probably want to see the common Rails commands.</p>\n\n<p>Instead, we should always show the common commands when running <code>rails -h</code><br />\ninside or outside a Rails application.</p>\n\n<p>As the relevant commands inside a Rails application differ from the<br />\ncommands outside an application, the help USAGE file has been split to<br />\nshow the most relevant commands for the context.</p>\n\n<p><em>Petrik de Heus</em></p>\n"
  },
  {
    "message": "*   Add Rails::HealthController#show and map it to /up for newly generated applications.\n    Load balancers and uptime monitors all need a basic endpoint to tell whether the app is up.\n    This is a good starting point that'll work in many situations.\n\n    *DHH*",
    "project": "railties",
    "date_merged": 1673349732000,
    "author": "David Heinemeier Hansson",
    "sha": "5c830a8a5ccd7e5fda8205c37c04ca12529e2a42",
    "pr": "46936",
    "merge_sha": "19a6979cfc134951755a6b6fc311276ce0b98f3c",
    "html": "<p>Add Rails::HealthController#show and map it to /up for newly generated applications.<br />\nLoad balancers and uptime monitors all need a basic endpoint to tell whether the app is up.<br />\nThis is a good starting point that’ll work in many situations.</p>\n\n<p><em>DHH</em></p>\n"
  },
  {
    "message": "*   Only use HostAuthorization middleware if `config.hosts` is not empty\n\n    *Hartley McGuire*",
    "project": "railties",
    "date_merged": 1673244705000,
    "author": "zzak",
    "sha": "ed65dfffc109034364ea5f504bc2f74b30f91b7d",
    "pr": "46858",
    "merge_sha": "b8e09fc54ec369574ff34734514600428dbd8a2a",
    "html": "<p>Only use HostAuthorization middleware if <code>config.hosts</code> is not empty</p>\n\n<p><em>Hartley McGuire</em></p>\n"
  },
  {
    "message": "*   Raise an exception when a `before_action`'s \"only\" or \"except\" filter\n    options reference an action that doesn't exist. This will be enabled by\n    default but can be overridden via config.\n\n    ```ruby\n    # config/environments/production.rb\n    config.action_controller.raise_on_missing_callback_actions = false\n    ```\n\n    *Jess Bees*",
    "project": "railties",
    "date_merged": 1673080715000,
    "author": "zzak",
    "sha": "78507d8352487361b574489b57d7ad62a4f44b46",
    "pr": "43487",
    "merge_sha": "6494c8707fbb61ad8d7b42d1fdc08372f5a26234",
    "html": "<p>Raise an exception when a <code>before_action</code>’s “only” or “except” filter<br />\noptions reference an action that doesn’t exist. This will be enabled by<br />\ndefault but can be overridden via config.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># config/environments/production.rb</span>\n<span class=\"n\">config</span><span class=\"p\">.</span><span class=\"nf\">action_controller</span><span class=\"p\">.</span><span class=\"nf\">raise_on_missing_callback_actions</span> <span class=\"o\">=</span> <span class=\"kp\">false</span>\n</code></pre></div></div>\n\n<p><em>Jess Bees</em></p>\n"
  },
  {
    "message": "*   Use physical processor count as the default Puma worker count in production.\n    This can be overridden by setting `ENV[\"WEB_CONCURRENCY\"]` or editing the\n    generated \"config/puma.rb\" directly.\n\n    *DHH*",
    "project": "railties",
    "date_merged": 1673080715000,
    "author": "zzak",
    "sha": "911b3a468c80cd8fc1c623dfab8e910b9f0e152e",
    "pr": "46838",
    "merge_sha": "6494c8707fbb61ad8d7b42d1fdc08372f5a26234",
    "html": "<p>Use physical processor count as the default Puma worker count in production.<br />\nThis can be overridden by setting <code>ENV[\"WEB_CONCURRENCY\"]</code> or editing the<br />\ngenerated “config/puma.rb” directly.</p>\n\n<p><em>DHH</em></p>\n"
  },
  {
    "message": "*   Add Docker files by default to new apps: Dockerfile, .dockerignore, bin/docker-entrypoint.\n    These files can be skipped with `--skip-docker`. They're intended as a starting point for\n    a production deploy of the application. Not intended for development (see Docked Rails for that).\n\n    Example:\n\n    ```bash\n    $ docker build -t app .\n    $ docker volume create app-storage\n    $ docker run --rm -it -v app-storage:/rails/storage -p 3000:3000 --env RAILS_MASTER_KEY=<see config/master.key> app\n    ```\n\n    You can also start a console or a runner from this image:\n\n    ```bash\n    $ docker run --rm -it -v app-storage:/rails/storage --env RAILS_MASTER_KEY=<see config/master.key> app console\n    ```\n\n    To create a multi-platform image on Apple Silicon to deploy on AMD or Intel and push to Docker Hub for user/app:\n\n    ```bash\n    $ docker login -u <user>\n    $ docker buildx create --use\n    $ docker buildx build --push --platform=linux/amd64,linux/arm64 -t <user/image> .\n    ```\n\n    *DHH, Sam Ruby*",
    "project": "railties",
    "date_merged": 1671474721000,
    "author": "David Heinemeier Hansson",
    "sha": "4f3af4a67f227ed7998fed570b9aa671e1b74117",
    "pr": "46762",
    "merge_sha": "ebbf66de3e5dac965760dc7a28fa0e2befc7ead3",
    "html": "<p>Add Docker files by default to new apps: Dockerfile, .dockerignore, bin/docker-entrypoint.<br />\nThese files can be skipped with <code>--skip-docker</code>. They’re intended as a starting point for<br />\na production deploy of the application. Not intended for development (see Docked Rails for that).</p>\n\n<p>Example:</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nv\">$ </span>docker build <span class=\"nt\">-t</span> app <span class=\"nb\">.</span>\n<span class=\"nv\">$ </span>docker volume create app-storage\n<span class=\"nv\">$ </span>docker run <span class=\"nt\">--rm</span> <span class=\"nt\">-it</span> <span class=\"nt\">-v</span> app-storage:/rails/storage <span class=\"nt\">-p</span> 3000:3000 <span class=\"nt\">--env</span> <span class=\"nv\">RAILS_MASTER_KEY</span><span class=\"o\">=</span>&lt;see config/master.key&gt; app\n</code></pre></div></div>\n\n<p>You can also start a console or a runner from this image:</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nv\">$ </span>docker run <span class=\"nt\">--rm</span> <span class=\"nt\">-it</span> <span class=\"nt\">-v</span> app-storage:/rails/storage <span class=\"nt\">--env</span> <span class=\"nv\">RAILS_MASTER_KEY</span><span class=\"o\">=</span>&lt;see config/master.key&gt; app console\n</code></pre></div></div>\n\n<p>To create a multi-platform image on Apple Silicon to deploy on AMD or Intel and push to Docker Hub for user/app:</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nv\">$ </span>docker login <span class=\"nt\">-u</span> &lt;user&gt;\n<span class=\"nv\">$ </span>docker buildx create <span class=\"nt\">--use</span>\n<span class=\"nv\">$ </span>docker buildx build <span class=\"nt\">--push</span> <span class=\"nt\">--platform</span><span class=\"o\">=</span>linux/amd64,linux/arm64 <span class=\"nt\">-t</span> &lt;user/image&gt; <span class=\"nb\">.</span>\n</code></pre></div></div>\n\n<p><em>DHH, Sam Ruby</em></p>\n"
  },
  {
    "message": "*   Add ENV[\"SECRET_KEY_BASE_DUMMY\"] for starting production environment with a generated secret base key,\n    which can be used to run tasks like `assets:precompile` without making the RAILS_MASTER_KEY available\n    to the build process.\n\n    Dockerfile layer example:\n\n    ```\n    RUN SECRET_KEY_BASE_DUMMY=1 bundle exec rails assets:precompile\n    ```\n\n    *DHH*",
    "project": "railties",
    "date_merged": 1671333770000,
    "author": "David Heinemeier Hansson",
    "sha": "a3e392f65614a744ca0f2b509301538e2a28bb95",
    "pr": "46760",
    "merge_sha": "974de71036e2154e026d081f5bcd815734ca5bc7",
    "html": "<p>Add ENV[“SECRET_KEY_BASE_DUMMY”] for starting production environment with a generated secret base key,<br />\nwhich can be used to run tasks like <code>assets:precompile</code> without making the RAILS_MASTER_KEY available<br />\nto the build process.</p>\n\n<p>Dockerfile layer example:</p>\n\n<pre><code>RUN SECRET_KEY_BASE_DUMMY=1 bundle exec rails assets:precompile\n</code></pre>\n\n<p><em>DHH</em></p>\n"
  },
  {
    "message": "*   Show descriptions for all commands in Rails help\n\n    When calling `rails help` most commands missed their description. We now\n    show the same descriptions as shown in `rails -T`.\n\n    *Petrik de Heus*",
    "project": "railties",
    "date_merged": 1671183306000,
    "author": "Petrik",
    "sha": "f52b1ccd0d637cfb9911ddf3b118b7e2c5ad5b49",
    "pr": "46163",
    "merge_sha": "768a2c69c678c689407072e6638e74819e490f87",
    "html": "<p>Show descriptions for all commands in Rails help</p>\n\n<p>When calling <code>rails help</code> most commands missed their description. We now<br />\nshow the same descriptions as shown in <code>rails -T</code>.</p>\n\n<p><em>Petrik de Heus</em></p>\n"
  },
  {
    "message": "*   Always generate the storage/ directory with rails new to ensure there's a stable place to\n    put permanent files, and a single mount point for containers to map. Then default sqlite3 databases\n    to live there instead of db/, which is only meant for configuration, not data.\n\n    *DHH*",
    "project": "railties",
    "date_merged": 1670863751000,
    "author": "Alex Ghiculescu",
    "sha": "28ecaf6dbaabfc852ddf6cbf1749c631c7a4f294",
    "pr": "46701",
    "merge_sha": "8f777e32259928694b4a2422851f6990491874d2",
    "html": "<p>Always generate the storage/ directory with rails new to ensure there’s a stable place to<br />\nput permanent files, and a single mount point for containers to map. Then default sqlite3 databases<br />\nto live there instead of db/, which is only meant for configuration, not data.</p>\n\n<p><em>DHH</em></p>\n"
  },
  {
    "message": "*   Rails console now disables `IRB`'s autocompletion feature in production by default.\n\n    Setting `IRB_USE_AUTOCOMPLETE=true` can override this default.\n\n    *Stan Lo*",
    "project": "railties",
    "date_merged": 1670341475000,
    "author": "Stan Lo",
    "sha": "de716b0adb4b6a059129386d54b804858d2fb108",
    "pr": "46656",
    "merge_sha": "ba2a660584ebbec8b21ad5e5c4c1fc0da77867bd",
    "html": "<p>Rails console now disables <code>IRB</code>’s autocompletion feature in production by default.</p>\n\n<p>Setting <code>IRB_USE_AUTOCOMPLETE=true</code> can override this default.</p>\n\n<p><em>Stan Lo</em></p>\n"
  },
  {
    "message": "*   Add `config.precompile_filter_parameters`, which enables precompilation of\n    `config.filter_parameters` using `ActiveSupport::ParameterFilter.precompile_filters`.\n    Precompilation can improve filtering performance, depending on the quantity\n    and types of filters.\n\n    `config.precompile_filter_parameters` defaults to `true` for\n    `config.load_defaults 7.1` and above.\n\n    *Jonathan Hefner*",
    "project": "railties",
    "date_merged": 1669314627000,
    "author": "Jonathan Hefner",
    "sha": "e5693c56c6b96b6605cdc55e97dc06b7f7959af1",
    "pr": "46452",
    "merge_sha": "324880c393a82c5212f2402def66af1c14d6b02a",
    "html": "<p>Add <code>config.precompile_filter_parameters</code>, which enables precompilation of<br />\n<code>config.filter_parameters</code> using <code>ActiveSupport::ParameterFilter.precompile_filters</code>.<br />\nPrecompilation can improve filtering performance, depending on the quantity<br />\nand types of filters.</p>\n\n<p><code>config.precompile_filter_parameters</code> defaults to <code>true</code> for<br />\n<code>config.load_defaults 7.1</code> and above.</p>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Add `after_routes_loaded` hook to `Rails::Railtie::Configuration` for\n    engines to add a hook to be called after application routes have been\n    loaded.\n\n    ```ruby\n    MyEngine.config.after_routes_loaded do\n      # code that must happen after routes have been loaded\n    end\n    ```\n\n    *Chris Salzberg*",
    "project": "railties",
    "date_merged": 1669148664000,
    "author": "Chris Salzberg",
    "sha": "64962266e38817e025de53234accc1e54ed2b32e",
    "pr": "46539",
    "merge_sha": "dbd9311c95f6384ff9a602904c603b64bf6ea79d",
    "html": "<p>Add <code>after_routes_loaded</code> hook to <code>Rails::Railtie::Configuration</code> for<br />\nengines to add a hook to be called after application routes have been<br />\nloaded.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">MyEngine</span><span class=\"p\">.</span><span class=\"nf\">config</span><span class=\"p\">.</span><span class=\"nf\">after_routes_loaded</span> <span class=\"k\">do</span>\n  <span class=\"c1\"># code that must happen after routes have been loaded</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p><em>Chris Salzberg</em></p>\n"
  },
  {
    "message": "*   Send 303 See Other status code back for the destroy action on newly generated\n    scaffold controllers.\n\n    *Tony Drake*",
    "project": "railties",
    "date_merged": 1665767593000,
    "author": "Tony Drake",
    "sha": "d6715c72c50255ccc2106ddbe10e453c636c3e4a",
    "pr": "45383",
    "merge_sha": "56ee229bb574d9c2e28c1e485c4b10cae1165460",
    "html": "<p>Send 303 See Other status code back for the destroy action on newly generated<br />\nscaffold controllers.</p>\n\n<p><em>Tony Drake</em></p>\n"
  },
  {
    "message": "*   Add `Rails.application.deprecators` as a central point to manage deprecators\n    for an application.\n\n    Individual deprecators can be added and retrieved from the collection:\n\n    ```ruby\n    Rails.application.deprecators[:my_gem] = ActiveSupport::Deprecation.new(\"2.0\", \"MyGem\")\n    Rails.application.deprecators[:other_gem] = ActiveSupport::Deprecation.new(\"3.0\", \"OtherGem\")\n    ```\n\n    And the collection's configuration methods affect all deprecators in the\n    collection:\n\n    ```ruby\n    Rails.application.deprecators.debug = true\n\n    Rails.application.deprecators[:my_gem].debug\n    # => true\n    Rails.application.deprecators[:other_gem].debug\n    # => true\n    ```\n\n    Additionally, all deprecators in the collection can be silenced for the\n    duration of a given block:\n\n    ```ruby\n    Rails.application.deprecators.silence do\n      Rails.application.deprecators[:my_gem].warn    # => silenced (no warning)\n      Rails.application.deprecators[:other_gem].warn # => silenced (no warning)\n    end\n    ```\n\n    *Jonathan Hefner*",
    "project": "railties",
    "date_merged": 1665000610000,
    "author": "Jonathan Hefner",
    "sha": "d240e8a9860ac707d1c5e13af04dd7f272ed39c8",
    "pr": "46049",
    "merge_sha": "32aaf11a09b536e2c3bbc9abbb58e29b505c2811",
    "html": "<p>Add <code>Rails.application.deprecators</code> as a central point to manage deprecators<br />\nfor an application.</p>\n\n<p>Individual deprecators can be added and retrieved from the collection:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">Rails</span><span class=\"p\">.</span><span class=\"nf\">application</span><span class=\"p\">.</span><span class=\"nf\">deprecators</span><span class=\"p\">[</span><span class=\"ss\">:my_gem</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"no\">ActiveSupport</span><span class=\"o\">::</span><span class=\"no\">Deprecation</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"s2\">\"2.0\"</span><span class=\"p\">,</span> <span class=\"s2\">\"MyGem\"</span><span class=\"p\">)</span>\n<span class=\"no\">Rails</span><span class=\"p\">.</span><span class=\"nf\">application</span><span class=\"p\">.</span><span class=\"nf\">deprecators</span><span class=\"p\">[</span><span class=\"ss\">:other_gem</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"no\">ActiveSupport</span><span class=\"o\">::</span><span class=\"no\">Deprecation</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"s2\">\"3.0\"</span><span class=\"p\">,</span> <span class=\"s2\">\"OtherGem\"</span><span class=\"p\">)</span>\n</code></pre></div></div>\n\n<p>And the collection’s configuration methods affect all deprecators in the<br />\ncollection:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">Rails</span><span class=\"p\">.</span><span class=\"nf\">application</span><span class=\"p\">.</span><span class=\"nf\">deprecators</span><span class=\"p\">.</span><span class=\"nf\">debug</span> <span class=\"o\">=</span> <span class=\"kp\">true</span>\n\n<span class=\"no\">Rails</span><span class=\"p\">.</span><span class=\"nf\">application</span><span class=\"p\">.</span><span class=\"nf\">deprecators</span><span class=\"p\">[</span><span class=\"ss\">:my_gem</span><span class=\"p\">].</span><span class=\"nf\">debug</span>\n<span class=\"c1\"># =&gt; true</span>\n<span class=\"no\">Rails</span><span class=\"p\">.</span><span class=\"nf\">application</span><span class=\"p\">.</span><span class=\"nf\">deprecators</span><span class=\"p\">[</span><span class=\"ss\">:other_gem</span><span class=\"p\">].</span><span class=\"nf\">debug</span>\n<span class=\"c1\"># =&gt; true</span>\n</code></pre></div></div>\n\n<p>Additionally, all deprecators in the collection can be silenced for the<br />\nduration of a given block:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">Rails</span><span class=\"p\">.</span><span class=\"nf\">application</span><span class=\"p\">.</span><span class=\"nf\">deprecators</span><span class=\"p\">.</span><span class=\"nf\">silence</span> <span class=\"k\">do</span>\n  <span class=\"no\">Rails</span><span class=\"p\">.</span><span class=\"nf\">application</span><span class=\"p\">.</span><span class=\"nf\">deprecators</span><span class=\"p\">[</span><span class=\"ss\">:my_gem</span><span class=\"p\">].</span><span class=\"nf\">warn</span>    <span class=\"c1\"># =&gt; silenced (no warning)</span>\n  <span class=\"no\">Rails</span><span class=\"p\">.</span><span class=\"nf\">application</span><span class=\"p\">.</span><span class=\"nf\">deprecators</span><span class=\"p\">[</span><span class=\"ss\">:other_gem</span><span class=\"p\">].</span><span class=\"nf\">warn</span> <span class=\"c1\"># =&gt; silenced (no warning)</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Move dbconsole logic to Active Record connection adapter.\n\n    Instead of hosting the connection logic in the command object, the\n    database adapter should be responsible for connecting to a console session.\n    This patch moves #find_cmd_and_exec to the adapter and exposes a new API to\n    lookup the adapter class without instantiating it.\n\n    *Gannon McGibbon*, *Paarth Madan*",
    "project": "railties",
    "date_merged": 1664488047000,
    "author": "Gannon McGibbon",
    "sha": "4bcb8e4afbf4176a5d66054796eb7e9333ea9cd1",
    "pr": "46093",
    "merge_sha": "a4eeb2bcd40bb6f2f964cc2abc95d3f2d5920244",
    "html": "<p>Move dbconsole logic to Active Record connection adapter.</p>\n\n<p>Instead of hosting the connection logic in the command object, the<br />\ndatabase adapter should be responsible for connecting to a console session.<br />\nThis patch moves #find_cmd_and_exec to the adapter and exposes a new API to<br />\nlookup the adapter class without instantiating it.</p>\n\n<p><em>Gannon McGibbon</em>, <em>Paarth Madan</em></p>\n"
  },
  {
    "message": "*   Add `Rails.application.message_verifiers` as a central point to configure\n    and create message verifiers for an application.\n\n    This allows applications to, for example, rotate old `secret_key_base`\n    values:\n\n    ```ruby\n    config.before_initialize do |app|\n      app.message_verifiers.rotate(secret_key_base: \"old secret_key_base\")\n    end\n    ```\n\n    And for libraries to create preconfigured message verifiers:\n\n    ```ruby\n    ActiveStorage.verifier = Rails.application.message_verifiers[\"ActiveStorage\"]\n    ```\n\n    *Jonathan Hefner*",
    "project": "railties",
    "date_merged": 1664488047000,
    "author": "Jonathan Hefner",
    "sha": "c267be43d36d3b443b797a5555deadd29857ac58",
    "pr": "44179",
    "merge_sha": "a4eeb2bcd40bb6f2f964cc2abc95d3f2d5920244",
    "html": "<p>Add <code>Rails.application.message_verifiers</code> as a central point to configure<br />\nand create message verifiers for an application.</p>\n\n<p>This allows applications to, for example, rotate old <code>secret_key_base</code><br />\nvalues:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">config</span><span class=\"p\">.</span><span class=\"nf\">before_initialize</span> <span class=\"k\">do</span> <span class=\"o\">|</span><span class=\"n\">app</span><span class=\"o\">|</span>\n  <span class=\"n\">app</span><span class=\"p\">.</span><span class=\"nf\">message_verifiers</span><span class=\"p\">.</span><span class=\"nf\">rotate</span><span class=\"p\">(</span><span class=\"ss\">secret_key_base: </span><span class=\"s2\">\"old secret_key_base\"</span><span class=\"p\">)</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p>And for libraries to create preconfigured message verifiers:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">ActiveStorage</span><span class=\"p\">.</span><span class=\"nf\">verifier</span> <span class=\"o\">=</span> <span class=\"no\">Rails</span><span class=\"p\">.</span><span class=\"nf\">application</span><span class=\"p\">.</span><span class=\"nf\">message_verifiers</span><span class=\"p\">[</span><span class=\"s2\">\"ActiveStorage\"</span><span class=\"p\">]</span>\n</code></pre></div></div>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Support MySQL's ssl-mode option for the dbconsole command.\n\n    Verifying the identity of the database server requires setting the ssl-mode\n    option to VERIFY_CA or VERIFY_IDENTITY. This option was previously ignored\n    for the dbconsole command.\n\n    *Petrik de Heus*",
    "project": "railties",
    "date_merged": 1663314711000,
    "author": "Petrik",
    "sha": "ed3b92b38f6db2a487b10b68d5320ab6b118521f",
    "pr": "46008",
    "merge_sha": "8c619c30967564e9e3fe01dd1e37b03f32d65933",
    "html": "<p>Support MySQL’s ssl-mode option for the dbconsole command.</p>\n\n<p>Verifying the identity of the database server requires setting the ssl-mode<br />\noption to VERIFY_CA or VERIFY_IDENTITY. This option was previously ignored<br />\nfor the dbconsole command.</p>\n\n<p><em>Petrik de Heus</em></p>\n"
  },
  {
    "message": "*   Delegate application record generator description to orm hooked generator.\n\n    *Gannon McGibbon*",
    "project": "railties",
    "date_merged": 1662741151000,
    "author": "Gannon McGibbon",
    "sha": "f54cbe1f4acab2c34a94b9f8bf9f3305ce51ec0a",
    "pr": "45975",
    "merge_sha": "2b42bbc8a2a89e5daf1b69eac926211c762bf161",
    "html": "<p>Delegate application record generator description to orm hooked generator.</p>\n\n<p><em>Gannon McGibbon</em></p>\n"
  },
  {
    "message": "*   Show BCC recipients when present in Action Mailer previews.\n\n    *Akshay Birajdar*",
    "project": "railties",
    "date_merged": 1662656426000,
    "author": "Akshay Birajdar",
    "sha": "f44362b1400f4ce38887c0b72e334ea145b4a365",
    "pr": "45935",
    "merge_sha": "bee6167977e601e6b690703de3be643bbdd88b38",
    "html": "<p>Show BCC recipients when present in Action Mailer previews.</p>\n\n<p><em>Akshay Birajdar</em></p>\n"
  },
  {
    "message": "*   Extend `routes --grep` to also filter routes by matching against path.\n\n    Example:\n\n    ```bash\n    $ bin/rails routes --grep /cats/1\n    Prefix Verb   URI Pattern         Controller#Action\n       cat GET    /cats/:id(.:format) cats#show\n           PATCH  /cats/:id(.:format) cats#update\n           PUT    /cats/:id(.:format) cats#update\n           DELETE /cats/:id(.:format) cats#destroy\n    ```\n\n    *Orhan Toy*",
    "project": "railties",
    "date_merged": 1661439380000,
    "author": "Orhan Toy",
    "sha": "930e36f10b4ef5a8d46de0fc88429eb10af4d4ea",
    "pr": "45874",
    "merge_sha": "a6bf6d55804850b390d840b87a679b784c0a3db4",
    "html": "<p>Extend <code>routes --grep</code> to also filter routes by matching against path.</p>\n\n<p>Example:</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nv\">$ </span>bin/rails routes <span class=\"nt\">--grep</span> /cats/1\nPrefix Verb   URI Pattern         Controller#Action\n   <span class=\"nb\">cat </span>GET    /cats/:id<span class=\"o\">(</span>.:format<span class=\"o\">)</span> cats#show\n       PATCH  /cats/:id<span class=\"o\">(</span>.:format<span class=\"o\">)</span> cats#update\n       PUT    /cats/:id<span class=\"o\">(</span>.:format<span class=\"o\">)</span> cats#update\n       DELETE /cats/:id<span class=\"o\">(</span>.:format<span class=\"o\">)</span> cats#destroy\n</code></pre></div></div>\n\n<p><em>Orhan Toy</em></p>\n"
  },
  {
    "message": "*   Improve `rails runner` output when given a file path that doesn't exist.\n\n    *Tekin Suleyman*",
    "project": "railties",
    "date_merged": 1661348323000,
    "author": "Tekin Süleyman",
    "sha": "7088003d1928870aec5a76a5f8bafb55b89db6f4",
    "pr": "45875",
    "merge_sha": "61733bde03befdb77468a79949ddb76d5fbc326c",
    "html": "<p>Improve <code>rails runner</code> output when given a file path that doesn’t exist.</p>\n\n<p><em>Tekin Suleyman</em></p>\n"
  },
  {
    "message": "*   `config.allow_concurrency = false` now use a `Monitor` instead of a `Mutex`\n\n    This allows to enable `config.active_support.executor_around_test_case` even\n    when `config.allow_concurrency` is disabled.\n\n    *Jean Boussier*",
    "project": "railties",
    "date_merged": 1660943055000,
    "author": "Jean Boussier",
    "sha": "bc4c3ef9695ac40addb9a99fd2c5941b03834f87",
    "pr": "45857",
    "merge_sha": "da2a0a5070dac2ecd18ec23209644ba37df1a865",
    "html": "<p><code>config.allow_concurrency = false</code> now use a <code>Monitor</code> instead of a <code>Mutex</code></p>\n\n<p>This allows to enable <code>config.active_support.executor_around_test_case</code> even<br />\nwhen <code>config.allow_concurrency</code> is disabled.</p>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   Add `routes --unused` option to detect extraneous routes.\n\n    Example:\n\n    ```bash\n    $ bin/rails routes --unused\n\n    Found 2 unused routes:\n\n    Prefix Verb URI Pattern    Controller#Action\n       one GET  /one(.:format) action#one\n       two GET  /two(.:format) action#two\n    ```\n\n    *Gannon McGibbon*",
    "project": "railties",
    "date_merged": 1659668229000,
    "author": "Gannon McGibbon",
    "sha": "5613b1240a363bf6ee3945f30341e52f5500a498",
    "pr": "45701",
    "merge_sha": "9414a8b79fdd0a1f8496c01ede98edd6c919c768",
    "html": "<p>Add <code>routes --unused</code> option to detect extraneous routes.</p>\n\n<p>Example:</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nv\">$ </span>bin/rails routes <span class=\"nt\">--unused</span>\n\nFound 2 unused routes:\n\nPrefix Verb URI Pattern    Controller#Action\n   one GET  /one<span class=\"o\">(</span>.:format<span class=\"o\">)</span> action#one\n   two GET  /two<span class=\"o\">(</span>.:format<span class=\"o\">)</span> action#two\n</code></pre></div></div>\n\n<p><em>Gannon McGibbon</em></p>\n"
  },
  {
    "message": "*   Add `--parent` option to controller generator to specify parent class of job.\n\n    Example:\n\n    `bin/rails g controller admin/users --parent=admin_controller` generates:\n\n    ```ruby\n    class Admin::UsersController < AdminController\n      # ...\n    end\n    ```\n\n    *Gannon McGibbon*",
    "project": "railties",
    "date_merged": 1658517780000,
    "author": "Gannon McGibbon",
    "sha": "aaeffb2a5647b550d049d3609974063989178446",
    "pr": "45627",
    "merge_sha": "97f13c2b820466f62ea8f12f49a373ac6eb2d9cb",
    "html": "<p>Add <code>--parent</code> option to controller generator to specify parent class of job.</p>\n\n<p>Example:</p>\n\n<p><code>bin/rails g controller admin/users --parent=admin_controller</code> generates:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">class</span> <span class=\"nc\">Admin::UsersController</span> <span class=\"o\">&lt;</span> <span class=\"no\">AdminController</span>\n  <span class=\"c1\"># ...</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p><em>Gannon McGibbon</em></p>\n"
  },
  {
    "message": "*   In-app custom credentials templates are now supported.  When a credentials\n    file does not exist, `rails credentials:edit` will now try to use\n    `lib/templates/rails/credentials/credentials.yml.tt` to generate the\n    credentials file, before falling back to the default template.\n\n    This allows e.g. an open-source Rails app (which would not include encrypted\n    credentials files in its repo) to include a credentials template, so that\n    users who install the app will get a custom pre-filled credentials file when\n    they run `rails credentials:edit`.\n\n    *Jonathan Hefner*",
    "project": "railties",
    "date_merged": 1657575768000,
    "author": "Jonathan Hefner",
    "sha": "d7a4c913ec2dff3ad03347e10a3ca76b128e1a56",
    "pr": "45544",
    "merge_sha": "ce9d2a1160af8b726f2e8c8156dad2578d24886d",
    "html": "<p>In-app custom credentials templates are now supported.  When a credentials<br />\nfile does not exist, <code>rails credentials:edit</code> will now try to use<br />\n<code>lib/templates/rails/credentials/credentials.yml.tt</code> to generate the<br />\ncredentials file, before falling back to the default template.</p>\n\n<p>This allows e.g. an open-source Rails app (which would not include encrypted<br />\ncredentials files in its repo) to include a credentials template, so that<br />\nusers who install the app will get a custom pre-filled credentials file when<br />\nthey run <code>rails credentials:edit</code>.</p>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Except for `dev` and `test` environments, newly generated per-environment\n    credentials files (e.g. `config/credentials/production.yml.enc`) now include\n    a `secret_key_base` for convenience, just as `config/credentials.yml.enc`\n    does.\n\n    *Jonathan Hefner*",
    "project": "railties",
    "date_merged": 1658249292000,
    "author": "Jonathan Hefner",
    "sha": "52c680c4dc5aaa5122317291e8b1f5f2bee1d683",
    "pr": "45574",
    "merge_sha": "166db2f2f65c8c2bba0a977ebfa687c84972e63b",
    "html": "<p>Except for <code>dev</code> and <code>test</code> environments, newly generated per-environment<br />\ncredentials files (e.g. <code>config/credentials/production.yml.enc</code>) now include<br />\na <code>secret_key_base</code> for convenience, just as <code>config/credentials.yml.enc</code><br />\ndoes.</p>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   `--no-*` options now work with the app generator's `--minimal` option, and\n    are both comprehensive and precise.  For example:\n\n    ```bash\n    $ rails new my_cool_app --minimal\n    Based on the specified options, the following options will also be activated:\n\n      --skip-active-job [due to --minimal]\n      --skip-action-mailer [due to --skip-active-job, --minimal]\n      --skip-active-storage [due to --skip-active-job, --minimal]\n      --skip-action-mailbox [due to --skip-active-storage, --minimal]\n      --skip-action-text [due to --skip-active-storage, --minimal]\n      --skip-javascript [due to --minimal]\n      --skip-hotwire [due to --skip-javascript, --minimal]\n      --skip-action-cable [due to --minimal]\n      --skip-bootsnap [due to --minimal]\n      --skip-dev-gems [due to --minimal]\n      --skip-system-test [due to --minimal]\n\n    ...\n\n    $ rails new my_cool_app --minimal --no-skip-active-storage\n    Based on the specified options, the following options will also be activated:\n\n      --skip-action-mailer [due to --minimal]\n      --skip-action-mailbox [due to --minimal]\n      --skip-action-text [due to --minimal]\n      --skip-javascript [due to --minimal]\n      --skip-hotwire [due to --skip-javascript, --minimal]\n      --skip-action-cable [due to --minimal]\n      --skip-bootsnap [due to --minimal]\n      --skip-dev-gems [due to --minimal]\n      --skip-system-test [due to --minimal]\n\n    ...\n    ```\n\n    *Brad Trick* and *Jonathan Hefner*",
    "project": "railties",
    "date_merged": 1657124781000,
    "author": "Jonathan Hefner",
    "sha": "4c67975c9c955d0af286d0237eed3ed243676762",
    "pr": "45520",
    "merge_sha": "a6cb4531d50b1b83b768b75dd64829521531afda",
    "html": "<p><code>--no-*</code> options now work with the app generator’s <code>--minimal</code> option, and<br />\nare both comprehensive and precise.  For example:</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nv\">$ </span>rails new my_cool_app <span class=\"nt\">--minimal</span>\nBased on the specified options, the following options will also be activated:\n\n  <span class=\"nt\">--skip-active-job</span> <span class=\"o\">[</span>due to <span class=\"nt\">--minimal</span><span class=\"o\">]</span>\n  <span class=\"nt\">--skip-action-mailer</span> <span class=\"o\">[</span>due to <span class=\"nt\">--skip-active-job</span>, <span class=\"nt\">--minimal</span><span class=\"o\">]</span>\n  <span class=\"nt\">--skip-active-storage</span> <span class=\"o\">[</span>due to <span class=\"nt\">--skip-active-job</span>, <span class=\"nt\">--minimal</span><span class=\"o\">]</span>\n  <span class=\"nt\">--skip-action-mailbox</span> <span class=\"o\">[</span>due to <span class=\"nt\">--skip-active-storage</span>, <span class=\"nt\">--minimal</span><span class=\"o\">]</span>\n  <span class=\"nt\">--skip-action-text</span> <span class=\"o\">[</span>due to <span class=\"nt\">--skip-active-storage</span>, <span class=\"nt\">--minimal</span><span class=\"o\">]</span>\n  <span class=\"nt\">--skip-javascript</span> <span class=\"o\">[</span>due to <span class=\"nt\">--minimal</span><span class=\"o\">]</span>\n  <span class=\"nt\">--skip-hotwire</span> <span class=\"o\">[</span>due to <span class=\"nt\">--skip-javascript</span>, <span class=\"nt\">--minimal</span><span class=\"o\">]</span>\n  <span class=\"nt\">--skip-action-cable</span> <span class=\"o\">[</span>due to <span class=\"nt\">--minimal</span><span class=\"o\">]</span>\n  <span class=\"nt\">--skip-bootsnap</span> <span class=\"o\">[</span>due to <span class=\"nt\">--minimal</span><span class=\"o\">]</span>\n  <span class=\"nt\">--skip-dev-gems</span> <span class=\"o\">[</span>due to <span class=\"nt\">--minimal</span><span class=\"o\">]</span>\n  <span class=\"nt\">--skip-system-test</span> <span class=\"o\">[</span>due to <span class=\"nt\">--minimal</span><span class=\"o\">]</span>\n\n...\n\n<span class=\"nv\">$ </span>rails new my_cool_app <span class=\"nt\">--minimal</span> <span class=\"nt\">--no-skip-active-storage</span>\nBased on the specified options, the following options will also be activated:\n\n  <span class=\"nt\">--skip-action-mailer</span> <span class=\"o\">[</span>due to <span class=\"nt\">--minimal</span><span class=\"o\">]</span>\n  <span class=\"nt\">--skip-action-mailbox</span> <span class=\"o\">[</span>due to <span class=\"nt\">--minimal</span><span class=\"o\">]</span>\n  <span class=\"nt\">--skip-action-text</span> <span class=\"o\">[</span>due to <span class=\"nt\">--minimal</span><span class=\"o\">]</span>\n  <span class=\"nt\">--skip-javascript</span> <span class=\"o\">[</span>due to <span class=\"nt\">--minimal</span><span class=\"o\">]</span>\n  <span class=\"nt\">--skip-hotwire</span> <span class=\"o\">[</span>due to <span class=\"nt\">--skip-javascript</span>, <span class=\"nt\">--minimal</span><span class=\"o\">]</span>\n  <span class=\"nt\">--skip-action-cable</span> <span class=\"o\">[</span>due to <span class=\"nt\">--minimal</span><span class=\"o\">]</span>\n  <span class=\"nt\">--skip-bootsnap</span> <span class=\"o\">[</span>due to <span class=\"nt\">--minimal</span><span class=\"o\">]</span>\n  <span class=\"nt\">--skip-dev-gems</span> <span class=\"o\">[</span>due to <span class=\"nt\">--minimal</span><span class=\"o\">]</span>\n  <span class=\"nt\">--skip-system-test</span> <span class=\"o\">[</span>due to <span class=\"nt\">--minimal</span><span class=\"o\">]</span>\n\n...\n</code></pre></div></div>\n\n<p><em>Brad Trick</em> and <em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Add `--skip-dev-gems` option to app generator to skip adding development\n    gems (like `web-console`) to the Gemfile.\n\n    *Brad Trick*",
    "project": "railties",
    "date_merged": 1655752828000,
    "author": "Brad Trick",
    "sha": "52222b6d293a6abf451c9d6b1ca3e5eb25bfb260",
    "pr": "45402",
    "merge_sha": "5a5440ba727b5b9882ee49763f8d44ed4ffde017",
    "html": "<p>Add <code>--skip-dev-gems</code> option to app generator to skip adding development<br />\ngems (like <code>web-console</code>) to the Gemfile.</p>\n\n<p><em>Brad Trick</em></p>\n"
  },
  {
    "message": "*   Skip Active Storage and Action Mailer if Active Job is skipped.\n\n    *Étienne Barrié*",
    "project": "railties",
    "date_merged": 1655229181000,
    "author": "Étienne Barrié",
    "sha": "957886532956020319673eb066d2737d768d0e44",
    "pr": "45354",
    "merge_sha": "d6a41ee4191a7031444152231778f38b4089597e",
    "html": "<p>Skip Active Storage and Action Mailer if Active Job is skipped.</p>\n\n<p><em>Étienne Barrié</em></p>\n"
  },
  {
    "message": "*   Correctly check if frameworks are disabled when running app:update.\n\n    *Étienne Barrié* and *Paulo Barros*",
    "project": "railties",
    "date_merged": 1655214549000,
    "author": "Étienne Barrié",
    "sha": "85a31f4cdc8ced83606ddddeeb1402cf8ab2f964",
    "pr": "45351",
    "merge_sha": "6ee37a3917e8af6be73974e78cbfb2538ac740ad",
    "html": "<p>Correctly check if frameworks are disabled when running app:update.</p>\n\n<p><em>Étienne Barrié</em> and <em>Paulo Barros</em></p>\n"
  },
  {
    "message": "*   Delegate model generator description to orm hooked generator.\n\n    *Gannon McGibbon*",
    "project": "railties",
    "date_merged": 1655138969000,
    "author": "Gannon McGibbon",
    "sha": "fff53e4455e05e623dd82651a2bc0b69f8bfdc0b",
    "pr": "45315",
    "merge_sha": "a39cd44dcf1fe05ad7fc09914586888c76dc3cf8",
    "html": "<p>Delegate model generator description to orm hooked generator.</p>\n\n<p><em>Gannon McGibbon</em></p>\n"
  },
  {
    "message": "*   Execute `rails runner` scripts inside the executor.\n\n    Enables error reporting, query cache, etc.\n\n    *Jean Boussier*",
    "project": "railties",
    "date_merged": 1654864502000,
    "author": "Jean Boussier",
    "sha": "115be62709cef94414b7ecaaecad56a760359719",
    "pr": "44999",
    "merge_sha": "10093b155c7eb64091bd1ce875ea372ba39c7a9a",
    "html": "<p>Execute <code>rails runner</code> scripts inside the executor.</p>\n\n<p>Enables error reporting, query cache, etc.</p>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   Avoid booting in development then test for test tasks.\n\n    Running one of the rails test subtasks (e.g. test:system, test:models) would\n    go through Rake and cause the app to be booted twice. Now all the test:*\n    subtasks are defined as Thor tasks and directly load the test environment.\n\n    *Étienne Barrié*",
    "project": "railties",
    "date_merged": 1654083130000,
    "author": "Étienne Barrié",
    "sha": "3d52212a0c944380be77d215919c81548130a23e",
    "pr": "44106",
    "merge_sha": "44dd3d7bd71a3b59c708e6561cfcd01506081e00",
    "html": "<p>Avoid booting in development then test for test tasks.</p>\n\n<p>Running one of the rails test subtasks (e.g. test:system, test:models) would<br />\ngo through Rake and cause the app to be booted twice. Now all the test:*<br />\nsubtasks are defined as Thor tasks and directly load the test environment.</p>\n\n<p><em>Étienne Barrié</em></p>\n"
  },
  {
    "message": "*   Deprecate `Rails::Generators::Testing::Behaviour` in favor of `Rails::Generators::Testing::Behavior`.\n\n    *Gannon McGibbon*",
    "project": "railties",
    "date_merged": 1653656814000,
    "author": "Gannon McGibbon",
    "sha": "52989bf7cc881de7f30672572c2fefd95f39f9f7",
    "pr": "45180",
    "merge_sha": "01f58d62c2f31f42d0184e0add2b6aa710513695",
    "html": "<p>Deprecate <code>Rails::Generators::Testing::Behaviour</code> in favor of <code>Rails::Generators::Testing::Behavior</code>.</p>\n\n<p><em>Gannon McGibbon</em></p>\n"
  },
  {
    "message": "*   Allow configuration of logger size for local and test environments\n\n    `config.log_file_size`\n\n    Defaults to `100` megabytes.\n\n    *Bernie Chiu*",
    "project": "railties",
    "date_merged": 1653072725000,
    "author": "Bernie Chiu",
    "sha": "cdce275f70f364567e34fa01c82c1193e7b1913c",
    "pr": "44888",
    "merge_sha": "ad409d5c3a7dbc1c16b5583d7fa9248099bf5360",
    "html": "<p>Allow configuration of logger size for local and test environments</p>\n\n<p><code>config.log_file_size</code></p>\n\n<p>Defaults to <code>100</code> megabytes.</p>\n\n<p><em>Bernie Chiu</em></p>\n"
  },
  {
    "message": "*   Enroll new apps in decrypted diffs of credentials by default.  This behavior\n    can be opted out of with the app generator's `--skip-decrypted-diffs` flag.\n\n    *Jonathan Hefner*",
    "project": "railties",
    "date_merged": 1652993719000,
    "author": "Jonathan Hefner",
    "sha": "702551d86fa3dbdfac8fbfc28b845df4cb8f4e19",
    "pr": "39686",
    "merge_sha": "77e6bfaa23fe5c1d585c1817d1e5c2722a3f7c87",
    "html": "<p>Enroll new apps in decrypted diffs of credentials by default.  This behavior<br />\ncan be opted out of with the app generator’s <code>--skip-decrypted-diffs</code> flag.</p>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Support declarative-style test name filters with `bin/rails test`.\n\n    This makes it possible to run a declarative-style test such as:\n\n    ```ruby\n    class MyTest < ActiveSupport::TestCase\n      test \"does something\" do\n        # ...\n      end\n    end\n    ```\n\n    Using its declared name:\n\n    ```bash\n    $ bin/rails test test/my_test.rb -n \"does something\"\n    ```\n\n    Instead of having to specify its expanded method name:\n\n    ```bash\n    $ bin/rails test test/my_test.rb -n test_does_something\n    ```\n\n    *Jonathan Hefner*",
    "project": "railties",
    "date_merged": 1652972152000,
    "author": "Jonathan Hefner",
    "sha": "da651a21e13fbd41cb646de6bdb85364fa340755",
    "pr": "44290",
    "merge_sha": "0564e9b8c03aeb9332845e14a530f088849e0546",
    "html": "<p>Support declarative-style test name filters with <code>bin/rails test</code>.</p>\n\n<p>This makes it possible to run a declarative-style test such as:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">class</span> <span class=\"nc\">MyTest</span> <span class=\"o\">&lt;</span> <span class=\"no\">ActiveSupport</span><span class=\"o\">::</span><span class=\"no\">TestCase</span>\n  <span class=\"nb\">test</span> <span class=\"s2\">\"does something\"</span> <span class=\"k\">do</span>\n    <span class=\"c1\"># ...</span>\n  <span class=\"k\">end</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p>Using its declared name:</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nv\">$ </span>bin/rails <span class=\"nb\">test test</span>/my_test.rb <span class=\"nt\">-n</span> <span class=\"s2\">\"does something\"</span>\n</code></pre></div></div>\n\n<p>Instead of having to specify its expanded method name:</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nv\">$ </span>bin/rails <span class=\"nb\">test test</span>/my_test.rb <span class=\"nt\">-n</span> test_does_something\n</code></pre></div></div>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Add `--js` and `--skip-javascript` options to `rails new`\n\n    `--js` alias to `rails new --javascript ...`\n\n    Same as `-j`, e.g. `rails new --js esbuild ...`\n\n    `--skip-js` alias to `rails new --skip-javascript ...`\n\n    Same as `-J`, e.g. `rails new --skip-js ...`\n\n    *Dorian Marié*",
    "project": "railties",
    "date_merged": 1652476304000,
    "author": "Dorian Marié",
    "sha": "7b244c99f6e61325613ed5948367afd2bd834f05",
    "pr": "43754",
    "merge_sha": "a4fb045e0d23c978b3fbb245f4327e200bf22308",
    "html": "<p>Add <code>--js</code> and <code>--skip-javascript</code> options to <code>rails new</code></p>\n\n<p><code>--js</code> alias to <code>rails new --javascript ...</code></p>\n\n<p>Same as <code>-j</code>, e.g. <code>rails new --js esbuild ...</code></p>\n\n<p><code>--skip-js</code> alias to <code>rails new --skip-javascript ...</code></p>\n\n<p>Same as <code>-J</code>, e.g. <code>rails new --skip-js ...</code></p>\n\n<p><em>Dorian Marié</em></p>\n"
  },
  {
    "message": "*   Allow relative paths with leading dot slash to be passed to `rails test`.\n\n    Fix `rails test ./test/model/post_test.rb` to run a single test file.\n\n    *Shouichi Kamiya* and *oljfte*",
    "project": "railties",
    "date_merged": 1652439764000,
    "author": "Shouichi Kamiya",
    "sha": "44b56fba2070764f1f478532ef03dfa816d2c7fa",
    "pr": "45085",
    "merge_sha": "b5630e232b95859c4171a285cd8f130e37d3c501",
    "html": "<p>Allow relative paths with leading dot slash to be passed to <code>rails test</code>.</p>\n\n<p>Fix <code>rails test ./test/model/post_test.rb</code> to run a single test file.</p>\n\n<p><em>Shouichi Kamiya</em> and <em>oljfte</em></p>\n"
  },
  {
    "message": "*   Deprecate `config.enable_dependency_loading`. This flag addressed a limitation of the `classic` autoloader and has no effect nowadays. To fix this deprecation, please just delete the reference.\n\n    *Xavier Noria*",
    "project": "railties",
    "date_merged": 1649979194000,
    "author": "Xavier Noria",
    "sha": "cbfe735c69a37446d0c5a9d448ad6d181abd1736",
    "pr": "44900",
    "merge_sha": "c9e5057de4be7e0f4365ff9c2d411cffc39c3746",
    "html": "<p>Deprecate <code>config.enable_dependency_loading</code>. This flag addressed a limitation of the <code>classic</code> autoloader and has no effect nowadays. To fix this deprecation, please just delete the reference.</p>\n\n<p><em>Xavier Noria</em></p>\n"
  },
  {
    "message": "*   Define `config.enable_reloading` to be `!config.cache_classes` for a more intuitive name. While `config.enable_reloading` and `config.reloading_enabled?` are preferred from now on, `config.cache_classes` is supported for backwards compatibility.\n\n    *Xavier Noria*",
    "project": "railties",
    "date_merged": 1649954208000,
    "author": "Xavier Noria",
    "sha": "2953ae5c8a06f2d794350f1e1278253531b65d2e",
    "pr": "44870",
    "merge_sha": "c05fcc74ff3d4b82e27ff5468327af46f45e031c",
    "html": "<p>Define <code>config.enable_reloading</code> to be <code>!config.cache_classes</code> for a more intuitive name. While <code>config.enable_reloading</code> and <code>config.reloading_enabled?</code> are preferred from now on, <code>config.cache_classes</code> is supported for backwards compatibility.</p>\n\n<p><em>Xavier Noria</em></p>\n"
  },
  {
    "message": "*   Add JavaScript dependencies installation on bin/setup\n\n    Add  `yarn install` to bin/setup when using esbuild, webpack, or rollout.\n\n    *Carlos Ribeiro*",
    "project": "railties",
    "date_merged": 1648496057000,
    "author": "Cadu Ribeiro",
    "sha": "155b7570fa63e40c1d134d4038cfbb58dea1d260",
    "pr": "44717",
    "merge_sha": "dfd0c9e5bd7614e7b8a7ac1c636857efecf8e4e4",
    "html": "<p>Add JavaScript dependencies installation on bin/setup</p>\n\n<p>Add  <code>yarn install</code> to bin/setup when using esbuild, webpack, or rollout.</p>\n\n<p><em>Carlos Ribeiro</em></p>\n"
  },
  {
    "message": "*   Use `controller_class_path` in `Rails::Generators::NamedBase#route_url`\n\n    The `route_url` method now returns the correct path when generating\n    a namespaced controller with a top-level model using `--model-name`.\n\n    Previously, when running this command:\n\n    ```bash\n    $ bin/rails generate scaffold_controller Admin/Post --model-name Post\n    ```\n\n    the comments above the controller action would look like:\n\n    ``` ruby\n    # GET /posts\n    def index\n      @posts = Post.all\n    end\n    ```\n\n    afterwards, they now look like this:\n\n    ``` ruby\n    # GET /admin/posts\n    def index\n      @posts = Post.all\n    end\n    ```\n\n    Fixes #44662.\n\n    *Andrew White*",
    "project": "railties",
    "date_merged": 1647276051000,
    "author": "Andrew White",
    "sha": "7f5b3e04c88da22c6d07553f206b695fc926bd39",
    "pr": "44670",
    "merge_sha": "9daee413698985831df67f5df28391f29dbbd7ff",
    "html": "<p>Use <code>controller_class_path</code> in <code>Rails::Generators::NamedBase#route_url</code></p>\n\n<p>The <code>route_url</code> method now returns the correct path when generating<br />\na namespaced controller with a top-level model using <code>--model-name</code>.</p>\n\n<p>Previously, when running this command:</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nv\">$ </span>bin/rails generate scaffold_controller Admin/Post <span class=\"nt\">--model-name</span> Post\n</code></pre></div></div>\n\n<p>the comments above the controller action would look like:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># GET /posts</span>\n<span class=\"k\">def</span> <span class=\"nf\">index</span>\n  <span class=\"vi\">@posts</span> <span class=\"o\">=</span> <span class=\"no\">Post</span><span class=\"p\">.</span><span class=\"nf\">all</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p>afterwards, they now look like this:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># GET /admin/posts</span>\n<span class=\"k\">def</span> <span class=\"nf\">index</span>\n  <span class=\"vi\">@posts</span> <span class=\"o\">=</span> <span class=\"no\">Post</span><span class=\"p\">.</span><span class=\"nf\">all</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p>Fixes #44662.</p>\n\n<p><em>Andrew White</em></p>\n"
  },
  {
    "message": "*   No longer add autoloaded paths to `$LOAD_PATH`.\n\n    This means it won't be possible to load them with a manual `require` call, the class or module can be referenced instead.\n\n    Reducing the size of `$LOAD_PATH` speed-up `require` calls for apps not using `bootsnap`, and reduce the\n    size of the `bootsnap` cache for the others.\n\n    *Jean Boussier*",
    "project": "railties",
    "date_merged": 1641899528000,
    "author": "Jean Boussier",
    "sha": "a191321f7bdc152a887d42e794cd1df64a5bfe76",
    "pr": "44133",
    "merge_sha": "b6987d6e14070d4d0bce85d0b3fa0008b024d5dc",
    "html": "<p>No longer add autoloaded paths to <code>$LOAD_PATH</code>.</p>\n\n<p>This means it won’t be possible to load them with a manual <code>require</code> call, the class or module can be referenced instead.</p>\n\n<p>Reducing the size of <code>$LOAD_PATH</code> speed-up <code>require</code> calls for apps not using <code>bootsnap</code>, and reduce the<br />\nsize of the <code>bootsnap</code> cache for the others.</p>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   Remove default `X-Download-Options` header\n\n    This header is currently only used by Internet Explorer which\n    will be discontinued in 2022 and since Rails 7 does not fully\n    support Internet Explorer this header should not be a default one.\n\n    *Harun Sabljaković*",
    "project": "railties",
    "date_merged": 1641483554000,
    "author": "Harun Sabljaković",
    "sha": "486be06ccbec8b66e6d674f57fc957eb7ba7e011",
    "pr": "43968",
    "merge_sha": "9188b49883d8931d576964879aed32b34012cf8c",
    "html": "<p>Remove default <code>X-Download-Options</code> header</p>\n\n<p>This header is currently only used by Internet Explorer which<br />\nwill be discontinued in 2022 and since Rails 7 does not fully<br />\nsupport Internet Explorer this header should not be a default one.</p>\n\n<p><em>Harun Sabljaković</em></p>\n"
  },
  {
    "message": "*   Add .node-version files for Rails apps that use Node.js\n\n    Node version managers that make use of this file:\n      https://github.com/shadowspawn/node-version-usage#node-version-file-usage\n\n    The generated Dockerfile will use the same node version.\n\n    *Sam Ruby*",
    "project": "railties",
    "date_merged": 1673282613000,
    "author": "Sam Ruby",
    "sha": "ecc7491bc567a0a9484756855b686c3a68b9d9c6",
    "pr": "46794",
    "merge_sha": "bf8e426cf86eee0d11140532fa94169621a8b2ea",
    "html": "<p>Add .node-version files for Rails apps that use Node.js</p>\n\n<p>Node version managers that make use of this file:<br />\n  https://github.com/shadowspawn/node-version-usage#node-version-file-usage</p>\n\n<p>The generated Dockerfile will use the same node version.</p>\n\n<p><em>Sam Ruby</em></p>\n"
  },
  {
    "message": "*   Added `bounce_now_with` to send the bounce email without going through a mailer queue.\n\n    *Ronan Limon Duparcmeur*",
    "project": "actionmailbox",
    "date_merged": 1687988395000,
    "author": "Ronan Limon Duparcmeur",
    "sha": "3bac56e11f8e30f3848a90c2709f938a7bf2112a",
    "pr": "48446",
    "merge_sha": "f936b93d076a9f63d2defbcc72e2130b8e8a1d6b",
    "html": "<p>Added <code>bounce_now_with</code> to send the bounce email without going through a mailer queue.</p>\n\n<p><em>Ronan Limon Duparcmeur</em></p>\n"
  },
  {
    "message": "*   Support configured primary key types in generated migrations.\n\n    *Nishiki Liu*",
    "project": "actionmailbox",
    "date_merged": 1683215189000,
    "author": "Nishiki Liu",
    "sha": "1df5ece43bd74cd3c234be4c7e173c3ff532825f",
    "pr": "48126",
    "merge_sha": "7e735451a71ca8c9e7509096f13d00a82adba4f9",
    "html": "<p>Support configured primary key types in generated migrations.</p>\n\n<p><em>Nishiki Liu</em></p>\n"
  },
  {
    "message": "*   Fixed ingress controllers' ability to accept emails that contain no UTF-8 encoded parts.\n\n    Fixes #46297.\n\n    *Jan Honza Sterba*",
    "project": "actionmailbox",
    "date_merged": 1674395639000,
    "author": "Petrik de Heus",
    "sha": "c20998c00d0240cdc3eed8525eeb68409692b130",
    "pr": "46300",
    "merge_sha": "d75fdd1c2f6002d62e5ecf65dda2942065f071f0",
    "html": "<p>Fixed ingress controllers’ ability to accept emails that contain no UTF-8 encoded parts.</p>\n\n<p>Fixes #46297.</p>\n\n<p><em>Jan Honza Sterba</em></p>\n"
  },
  {
    "message": "*   Add X-Forwarded-To addresses to recipients.\n\n    *Andrew Stewart*",
    "project": "actionmailbox",
    "date_merged": 1669161405000,
    "author": "Andy Stewart",
    "sha": "12867b1f325aa762e9823e2c549542ec62b3e59d",
    "pr": "46552",
    "merge_sha": "d42defd8c9f8d1c04fd3548c200dbd4f8ecb10a6",
    "html": "<p>Add X-Forwarded-To addresses to recipients.</p>\n\n<p><em>Andrew Stewart</em></p>\n"
  },
  {
    "message": "*   Don't double-encode nested `field_id` and `field_name` index values\n\n    Pass `index: @options` as a default keyword argument to `field_id` and\n    `field_name` view helper methods.\n\n    *Sean Doyle*",
    "project": "actionview",
    "date_merged": 1688333664000,
    "author": "Sean Doyle",
    "sha": "5cb8678dd6423186e9e4f91ab703f09bea2438a3",
    "pr": "47436",
    "merge_sha": "f8c06f95dfa5380e9ef12ccf7c75db36659020c1",
    "html": "<p>Don’t double-encode nested <code>field_id</code> and <code>field_name</code> index values</p>\n\n<p>Pass <code>index: @options</code> as a default keyword argument to <code>field_id</code> and<br />\n<code>field_name</code> view helper methods.</p>\n\n<p><em>Sean Doyle</em></p>\n"
  },
  {
    "message": "*   Allow opting in/out of `Link preload` headers when calling `stylesheet_link_tag` or `javascript_include_tag`\n\n    ```ruby\n    # will exclude header, even if setting is enabled:\n    javascript_include_tag(\"http://example.com/all.js\", preload_links_header: false)\n\n    # will include header, even if setting is disabled:\n    stylesheet_link_tag(\"http://example.com/all.js\", preload_links_header: true)\n    ```\n\n    *Alex Ghiculescu*",
    "project": "actionview",
    "date_merged": 1688157603000,
    "author": "Alex",
    "sha": "5b116c5216528c39e12861a6774078221122a536",
    "pr": "48553",
    "merge_sha": "8a158ed5e3f870566dc96709b4202187f9aba410",
    "html": "<p>Allow opting in/out of <code>Link preload</code> headers when calling <code>stylesheet_link_tag</code> or <code>javascript_include_tag</code></p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># will exclude header, even if setting is enabled:</span>\n<span class=\"n\">javascript_include_tag</span><span class=\"p\">(</span><span class=\"s2\">\"http://example.com/all.js\"</span><span class=\"p\">,</span> <span class=\"ss\">preload_links_header: </span><span class=\"kp\">false</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># will include header, even if setting is disabled:</span>\n<span class=\"n\">stylesheet_link_tag</span><span class=\"p\">(</span><span class=\"s2\">\"http://example.com/all.js\"</span><span class=\"p\">,</span> <span class=\"ss\">preload_links_header: </span><span class=\"kp\">true</span><span class=\"p\">)</span>\n</code></pre></div></div>\n\n<p><em>Alex Ghiculescu</em></p>\n"
  },
  {
    "message": "*   Stop generating `Link preload` headers once it has reached 1KB.\n\n    Some proxies have trouble handling large headers, but more importantly preload links\n    have diminishing returns so it's preferable not to go overboard with them.\n\n    If tighter control is needed, it's recommended to disable automatic generation of preloads\n    and to generate them manually from the controller or from a middleware.\n\n    *Jean Boussier*",
    "project": "actionview",
    "date_merged": 1686129575000,
    "author": "Jean Boussier",
    "sha": "facc260fbb8a414dd66851bf3d0ce83ea35119b8",
    "pr": "48405",
    "merge_sha": "0c09ae546fae39333068177b28767abbc6c8726e",
    "html": "<p>Stop generating <code>Link preload</code> headers once it has reached 1KB.</p>\n\n<p>Some proxies have trouble handling large headers, but more importantly preload links<br />\nhave diminishing returns so it’s preferable not to go overboard with them.</p>\n\n<p>If tighter control is needed, it’s recommended to disable automatic generation of preloads<br />\nand to generate them manually from the controller or from a middleware.</p>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   `simple_format` helper now handles a `:sanitize_options` - any extra options you want appending to the sanitize.\n\n    Before:\n    ```ruby\n      simple_format(\"<a target=\\\"_blank\\\" href=\\\"http://example.com\\\">Continue</a>\")\n      # => \"<p><a href=\\\"http://example.com\\\">Continue</a></p>\"\n    ```\n\n    After:\n    ```ruby\n      simple_format(\"<a target=\\\"_blank\\\" href=\\\"http://example.com\\\">Continue</a>\", {}, { sanitize_options: { attributes: %w[target href] } })\n      # => \"<p><a target=\\\"_blank\\\" href=\\\"http://example.com\\\">Continue</a></p>\"\n    ```\n\n    *Andrei Andriichuk*",
    "project": "actionview",
    "date_merged": 1685577881000,
    "author": "Andriichuk",
    "sha": "ef7449c9fea0cd18fcc0dc20f791233dbdec4626",
    "pr": "48355",
    "merge_sha": "23a6576fc9ecb9d245c6a9ba14995d08128590ee",
    "html": "<p><code>simple_format</code> helper now handles a <code>:sanitize_options</code> - any extra options you want appending to the sanitize.</p>\n\n<p>Before:</p>\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>  <span class=\"n\">simple_format</span><span class=\"p\">(</span><span class=\"s2\">\"&lt;a target=</span><span class=\"se\">\\\"</span><span class=\"s2\">_blank</span><span class=\"se\">\\\"</span><span class=\"s2\"> href=</span><span class=\"se\">\\\"</span><span class=\"s2\">http://example.com</span><span class=\"se\">\\\"</span><span class=\"s2\">&gt;Continue&lt;/a&gt;\"</span><span class=\"p\">)</span>\n  <span class=\"c1\"># =&gt; \"&lt;p&gt;&lt;a href=\\\"http://example.com\\\"&gt;Continue&lt;/a&gt;&lt;/p&gt;\"</span>\n</code></pre></div></div>\n\n<p>After:</p>\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>  <span class=\"n\">simple_format</span><span class=\"p\">(</span><span class=\"s2\">\"&lt;a target=</span><span class=\"se\">\\\"</span><span class=\"s2\">_blank</span><span class=\"se\">\\\"</span><span class=\"s2\"> href=</span><span class=\"se\">\\\"</span><span class=\"s2\">http://example.com</span><span class=\"se\">\\\"</span><span class=\"s2\">&gt;Continue&lt;/a&gt;\"</span><span class=\"p\">,</span> <span class=\"p\">{},</span> <span class=\"p\">{</span> <span class=\"ss\">sanitize_options: </span><span class=\"p\">{</span> <span class=\"ss\">attributes: </span><span class=\"sx\">%w[target href]</span> <span class=\"p\">}</span> <span class=\"p\">})</span>\n  <span class=\"c1\"># =&gt; \"&lt;p&gt;&lt;a target=\\\"_blank\\\" href=\\\"http://example.com\\\"&gt;Continue&lt;/a&gt;&lt;/p&gt;\"</span>\n</code></pre></div></div>\n\n<p><em>Andrei Andriichuk</em></p>\n"
  },
  {
    "message": "*   Add support for HTML5 standards-compliant sanitizers, and default to `Rails::HTML5::Sanitizer`\n    in the Rails 7.1 configuration if it is supported.\n\n    Action View's HTML sanitizers can be configured by setting\n    `config.action_view.sanitizer_vendor`. Supported values are `Rails::HTML4::Sanitizer` or\n    `Rails::HTML5::Sanitizer`.\n\n    The Rails 7.1 configuration will set this to `Rails::HTML5::Sanitizer` when it is supported, and\n    fall back to `Rails::HTML4::Sanitizer`. Previous configurations default to\n    `Rails::HTML4::Sanitizer`.\n\n    *Mike Dalessio*",
    "project": "actionview",
    "date_merged": 1685476813000,
    "author": "Mike Dalessio",
    "sha": "ce43ac6088ccda0799636a2488625c8230ed3f49",
    "pr": "48293",
    "merge_sha": "54de0cb2ee063feb3a2f485330e3aacf3cf47fd4",
    "html": "<p>Add support for HTML5 standards-compliant sanitizers, and default to <code>Rails::HTML5::Sanitizer</code><br />\nin the Rails 7.1 configuration if it is supported.</p>\n\n<p>Action View’s HTML sanitizers can be configured by setting<br />\n<code>config.action_view.sanitizer_vendor</code>. Supported values are <code>Rails::HTML4::Sanitizer</code> or<br />\n<code>Rails::HTML5::Sanitizer</code>.</p>\n\n<p>The Rails 7.1 configuration will set this to <code>Rails::HTML5::Sanitizer</code> when it is supported, and<br />\nfall back to <code>Rails::HTML4::Sanitizer</code>. Previous configurations default to<br />\n<code>Rails::HTML4::Sanitizer</code>.</p>\n\n<p><em>Mike Dalessio</em></p>\n"
  },
  {
    "message": "*   `config.dom_testing_default_html_version` controls the HTML parser used by\n    `ActionView::TestCase#document_root_element`, which creates the DOM used by the assertions in\n    Rails::Dom::Testing.\n\n    The Rails 7.1 default configuration opts into the HTML5 parser when it is supported, to better\n    represent what the DOM would be in a browser user agent. Previously this test helper always used\n    Nokogiri's HTML4 parser.\n\n    *Mike Dalessio*",
    "project": "actionview",
    "date_merged": 1691084878000,
    "author": "Mike Dalessio",
    "sha": "8a57ba8c0ef7e041714f4c3b49444d81459b5a79",
    "pr": "48682",
    "merge_sha": "94070e04bf4c4296c74bf7fc98567cc46b5bd63c",
    "html": "<p><code>config.dom_testing_default_html_version</code> controls the HTML parser used by<br />\n<code>ActionView::TestCase#document_root_element</code>, which creates the DOM used by the assertions in<br />\nRails::Dom::Testing.</p>\n\n<p>The Rails 7.1 default configuration opts into the HTML5 parser when it is supported, to better<br />\nrepresent what the DOM would be in a browser user agent. Previously this test helper always used<br />\nNokogiri’s HTML4 parser.</p>\n\n<p><em>Mike Dalessio</em></p>\n"
  },
  {
    "message": "*   Add support for the HTML picture tag. It supports passing a String, an Array or a Block.\n    Supports passing properties directly to the img tag via the `:image` key.\n    Since the picture tag requires an img tag, the last element you provide will be used for the img tag.\n    For complete control over the picture tag, a block can be passed, which will populate the contents of the tag accordingly.\n\n    Can be used like this for a single source:\n    ```erb\n    <%= picture_tag(\"picture.webp\") %>\n    ```\n    which will generate the following:\n    ```html\n    <picture>\n        <img src=\"/images/picture.webp\" />\n    </picture>\n    ```\n\n    For multiple sources:\n    ```erb\n    <%= picture_tag(\"picture.webp\", \"picture.png\", :class => \"mt-2\", :image => { alt: \"Image\", class: \"responsive-img\" }) %>\n    ```\n    will generate:\n    ```html\n    <picture class=\"mt-2\">\n        <source srcset=\"/images/picture.webp\" />\n        <source srcset=\"/images/picture.png\" />\n        <img alt=\"Image\" class=\"responsive-img\" src=\"/images/picture.png\" />\n    </picture>\n    ```\n\n    Full control via a block:\n    ```erb\n    <%= picture_tag(:class => \"my-class\") do %>\n        <%= tag(:source, :srcset => image_path(\"picture.webp\")) %>\n        <%= tag(:source, :srcset => image_path(\"picture.png\")) %>\n        <%= image_tag(\"picture.png\", :alt => \"Image\") %>\n    <% end %>\n    ```\n    will generate:\n    ```html\n    <picture class=\"my-class\">\n        <source srcset=\"/images/picture.webp\" />\n        <source srcset=\"/images/picture.png\" />\n        <img alt=\"Image\" src=\"/images/picture.png\" />\n    </picture>\n    ```\n\n    *Juan Pablo Balarini*",
    "project": "actionview",
    "date_merged": 1683858455000,
    "author": "Juan Pablo Balarini",
    "sha": "fac9218f785414a1167e7a8007fba880d9af4362",
    "pr": "48100",
    "merge_sha": "a3adc6ce18c35e028725a79fd4271617ddf82e52",
    "html": "<p>Add support for the HTML picture tag. It supports passing a String, an Array or a Block.<br />\nSupports passing properties directly to the img tag via the <code>:image</code> key.<br />\nSince the picture tag requires an img tag, the last element you provide will be used for the img tag.<br />\nFor complete control over the picture tag, a block can be passed, which will populate the contents of the tag accordingly.</p>\n\n<p>Can be used like this for a single source:</p>\n<div class=\"language-erb highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"cp\">&lt;%=</span> <span class=\"n\">picture_tag</span><span class=\"p\">(</span><span class=\"s2\">\"picture.webp\"</span><span class=\"p\">)</span> <span class=\"cp\">%&gt;</span>\n</code></pre></div></div>\n<p>which will generate the following:</p>\n<div class=\"language-html highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nt\">&lt;picture&gt;</span>\n    <span class=\"nt\">&lt;img</span> <span class=\"na\">src=</span><span class=\"s\">\"/images/picture.webp\"</span> <span class=\"nt\">/&gt;</span>\n<span class=\"nt\">&lt;/picture&gt;</span>\n</code></pre></div></div>\n\n<p>For multiple sources:</p>\n<div class=\"language-erb highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"cp\">&lt;%=</span> <span class=\"n\">picture_tag</span><span class=\"p\">(</span><span class=\"s2\">\"picture.webp\"</span><span class=\"p\">,</span> <span class=\"s2\">\"picture.png\"</span><span class=\"p\">,</span> <span class=\"ss\">:class</span> <span class=\"o\">=&gt;</span> <span class=\"s2\">\"mt-2\"</span><span class=\"p\">,</span> <span class=\"ss\">:image</span> <span class=\"o\">=&gt;</span> <span class=\"p\">{</span> <span class=\"ss\">alt: </span><span class=\"s2\">\"Image\"</span><span class=\"p\">,</span> <span class=\"ss\">class: </span><span class=\"s2\">\"responsive-img\"</span> <span class=\"p\">})</span> <span class=\"cp\">%&gt;</span>\n</code></pre></div></div>\n<p>will generate:</p>\n<div class=\"language-html highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nt\">&lt;picture</span> <span class=\"na\">class=</span><span class=\"s\">\"mt-2\"</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;source</span> <span class=\"na\">srcset=</span><span class=\"s\">\"/images/picture.webp\"</span> <span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;source</span> <span class=\"na\">srcset=</span><span class=\"s\">\"/images/picture.png\"</span> <span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;img</span> <span class=\"na\">alt=</span><span class=\"s\">\"Image\"</span> <span class=\"na\">class=</span><span class=\"s\">\"responsive-img\"</span> <span class=\"na\">src=</span><span class=\"s\">\"/images/picture.png\"</span> <span class=\"nt\">/&gt;</span>\n<span class=\"nt\">&lt;/picture&gt;</span>\n</code></pre></div></div>\n\n<p>Full control via a block:</p>\n<div class=\"language-erb highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"cp\">&lt;%=</span> <span class=\"n\">picture_tag</span><span class=\"p\">(</span><span class=\"ss\">:class</span> <span class=\"o\">=&gt;</span> <span class=\"s2\">\"my-class\"</span><span class=\"p\">)</span> <span class=\"k\">do</span> <span class=\"cp\">%&gt;</span>\n    <span class=\"cp\">&lt;%=</span> <span class=\"n\">tag</span><span class=\"p\">(</span><span class=\"ss\">:source</span><span class=\"p\">,</span> <span class=\"ss\">:srcset</span> <span class=\"o\">=&gt;</span> <span class=\"n\">image_path</span><span class=\"p\">(</span><span class=\"s2\">\"picture.webp\"</span><span class=\"p\">))</span> <span class=\"cp\">%&gt;</span>\n    <span class=\"cp\">&lt;%=</span> <span class=\"n\">tag</span><span class=\"p\">(</span><span class=\"ss\">:source</span><span class=\"p\">,</span> <span class=\"ss\">:srcset</span> <span class=\"o\">=&gt;</span> <span class=\"n\">image_path</span><span class=\"p\">(</span><span class=\"s2\">\"picture.png\"</span><span class=\"p\">))</span> <span class=\"cp\">%&gt;</span>\n    <span class=\"cp\">&lt;%=</span> <span class=\"n\">image_tag</span><span class=\"p\">(</span><span class=\"s2\">\"picture.png\"</span><span class=\"p\">,</span> <span class=\"ss\">:alt</span> <span class=\"o\">=&gt;</span> <span class=\"s2\">\"Image\"</span><span class=\"p\">)</span> <span class=\"cp\">%&gt;</span>\n<span class=\"cp\">&lt;%</span> <span class=\"k\">end</span> <span class=\"cp\">%&gt;</span>\n</code></pre></div></div>\n<p>will generate:</p>\n<div class=\"language-html highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nt\">&lt;picture</span> <span class=\"na\">class=</span><span class=\"s\">\"my-class\"</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;source</span> <span class=\"na\">srcset=</span><span class=\"s\">\"/images/picture.webp\"</span> <span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;source</span> <span class=\"na\">srcset=</span><span class=\"s\">\"/images/picture.png\"</span> <span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;img</span> <span class=\"na\">alt=</span><span class=\"s\">\"Image\"</span> <span class=\"na\">src=</span><span class=\"s\">\"/images/picture.png\"</span> <span class=\"nt\">/&gt;</span>\n<span class=\"nt\">&lt;/picture&gt;</span>\n</code></pre></div></div>\n\n<p><em>Juan Pablo Balarini</em></p>\n"
  },
  {
    "message": "*   Remove deprecated support to passing instance variables as locals to partials.\n\n    *Rafael Mendonça França*",
    "project": "actionview",
    "date_merged": 1677805729000,
    "author": "Rafael Mendonça França",
    "sha": "8241178723d02123734a1efd01c12b9fda2f4fea",
    "pr": "47556",
    "merge_sha": "dd7ecb073c67fee00e409049f02d72accece94a2",
    "html": "<p>Remove deprecated support to passing instance variables as locals to partials.</p>\n\n<p><em>Rafael Mendonça França</em></p>\n"
  },
  {
    "message": "*   Remove deprecated constant `ActionView::Path`.\n\n    *Rafael Mendonça França*",
    "project": "actionview",
    "date_merged": 1677805729000,
    "author": "Rafael Mendonça França",
    "sha": "23344d4b8cc36bb8ae3db209e0365b70469118d2",
    "pr": "47556",
    "merge_sha": "dd7ecb073c67fee00e409049f02d72accece94a2",
    "html": "<p>Remove deprecated constant <code>ActionView::Path</code>.</p>\n\n<p><em>Rafael Mendonça França</em></p>\n"
  },
  {
    "message": "*   Guard `token_list` calls from escaping HTML too often\n\n    *Sean Doyle*",
    "project": "actionview",
    "date_merged": 1675883507000,
    "author": "Sean Doyle",
    "sha": "812e50b00a3ced69c3eb1cd9ad5c8f68b105bfdb",
    "pr": "47318",
    "merge_sha": "fad9050d80cb4d2d7c482311832724558bbfbbc2",
    "html": "<p>Guard <code>token_list</code> calls from escaping HTML too often</p>\n\n<p><em>Sean Doyle</em></p>\n"
  },
  {
    "message": "*   `select` can now be called with a single hash containing options and some HTML options\n\n    Previously this would not work as expected:\n\n    ```erb\n    <%= select :post, :author, authors, required: true %>\n    ```\n\n    Instead you needed to do this:\n\n    ```erb\n    <%= select :post, :author, authors, {}, required: true %>\n    ```\n\n    Now, either form is accepted, for the following HTML attributes: `required`, `multiple`, `size`.\n\n    *Alex Ghiculescu*",
    "project": "actionview",
    "date_merged": 1670953527000,
    "author": "Alex Ghiculescu",
    "sha": "49c2e51808aaa89f3a0e833b6c42d97732f7d039",
    "pr": "46629",
    "merge_sha": "f4f954faa256151fdb8c13b011016d60a77de6cf",
    "html": "<p><code>select</code> can now be called with a single hash containing options and some HTML options</p>\n\n<p>Previously this would not work as expected:</p>\n\n<div class=\"language-erb highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"cp\">&lt;%=</span> <span class=\"nb\">select</span> <span class=\"ss\">:post</span><span class=\"p\">,</span> <span class=\"ss\">:author</span><span class=\"p\">,</span> <span class=\"n\">authors</span><span class=\"p\">,</span> <span class=\"ss\">required: </span><span class=\"kp\">true</span> <span class=\"cp\">%&gt;</span>\n</code></pre></div></div>\n\n<p>Instead you needed to do this:</p>\n\n<div class=\"language-erb highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"cp\">&lt;%=</span> <span class=\"nb\">select</span> <span class=\"ss\">:post</span><span class=\"p\">,</span> <span class=\"ss\">:author</span><span class=\"p\">,</span> <span class=\"n\">authors</span><span class=\"p\">,</span> <span class=\"p\">{},</span> <span class=\"ss\">required: </span><span class=\"kp\">true</span> <span class=\"cp\">%&gt;</span>\n</code></pre></div></div>\n\n<p>Now, either form is accepted, for the following HTML attributes: <code>required</code>, <code>multiple</code>, <code>size</code>.</p>\n\n<p><em>Alex Ghiculescu</em></p>\n"
  },
  {
    "message": "*   Datetime form helpers (`time_field`, `date_field`, `datetime_field`, `week_field`, `month_field`) now accept an instance of Time/Date/DateTime as `:value` option.\n\n    Before:\n    ```erb\n    <%= form.datetime_field :written_at, value: Time.current.strftime(\"%Y-%m-%dT%T\") %>\n    ```\n\n    After:\n    ```erb\n    <%= form.datetime_field :written_at, value: Time.current %>\n    ```\n\n    *Andrey Samsonov*",
    "project": "actionview",
    "date_merged": 1670953527000,
    "author": "Alex Ghiculescu",
    "sha": "49c2e51808aaa89f3a0e833b6c42d97732f7d039",
    "pr": "46629",
    "merge_sha": "f4f954faa256151fdb8c13b011016d60a77de6cf",
    "html": "<p>Datetime form helpers (<code>time_field</code>, <code>date_field</code>, <code>datetime_field</code>, <code>week_field</code>, <code>month_field</code>) now accept an instance of Time/Date/DateTime as <code>:value</code> option.</p>\n\n<p>Before:</p>\n<div class=\"language-erb highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"cp\">&lt;%=</span> <span class=\"n\">form</span><span class=\"p\">.</span><span class=\"nf\">datetime_field</span> <span class=\"ss\">:written_at</span><span class=\"p\">,</span> <span class=\"ss\">value: </span><span class=\"no\">Time</span><span class=\"p\">.</span><span class=\"nf\">current</span><span class=\"p\">.</span><span class=\"nf\">strftime</span><span class=\"p\">(</span><span class=\"s2\">\"%Y-%m-%dT%T\"</span><span class=\"p\">)</span> <span class=\"cp\">%&gt;</span>\n</code></pre></div></div>\n\n<p>After:</p>\n<div class=\"language-erb highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"cp\">&lt;%=</span> <span class=\"n\">form</span><span class=\"p\">.</span><span class=\"nf\">datetime_field</span> <span class=\"ss\">:written_at</span><span class=\"p\">,</span> <span class=\"ss\">value: </span><span class=\"no\">Time</span><span class=\"p\">.</span><span class=\"nf\">current</span> <span class=\"cp\">%&gt;</span>\n</code></pre></div></div>\n\n<p><em>Andrey Samsonov</em></p>\n"
  },
  {
    "message": "*   Choices of `select` can optionally contain html attributes as the last element\n    of the child arrays when using grouped/nested collections\n\n    ```erb\n    <%= form.select :foo, [[\"North America\", [[\"United States\",\"US\"],[\"Canada\",\"CA\"]], { disabled: \"disabled\" }]] %>\n    # => <select><optgroup label=\"North America\" disabled=\"disabled\"><option value=\"US\">United States</option><option value=\"CA\">Canada</option></optgroup></select>\n    ```\n\n    *Chris Gunther*",
    "project": "actionview",
    "date_merged": 1669233560000,
    "author": "Rafael Mendonça França",
    "sha": "db5a6ef624cc0dca6af6c53eb8b892c2005b4f4d",
    "pr": "43019",
    "merge_sha": "fba4a024ef63448d9549fcad83108bba03079e35",
    "html": "<p>Choices of <code>select</code> can optionally contain html attributes as the last element<br />\nof the child arrays when using grouped/nested collections</p>\n\n<div class=\"language-erb highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"cp\">&lt;%=</span> <span class=\"n\">form</span><span class=\"p\">.</span><span class=\"nf\">select</span> <span class=\"ss\">:foo</span><span class=\"p\">,</span> <span class=\"p\">[[</span><span class=\"s2\">\"North America\"</span><span class=\"p\">,</span> <span class=\"p\">[[</span><span class=\"s2\">\"United States\"</span><span class=\"p\">,</span><span class=\"s2\">\"US\"</span><span class=\"p\">],[</span><span class=\"s2\">\"Canada\"</span><span class=\"p\">,</span><span class=\"s2\">\"CA\"</span><span class=\"p\">]],</span> <span class=\"p\">{</span> <span class=\"ss\">disabled: </span><span class=\"s2\">\"disabled\"</span> <span class=\"p\">}]]</span> <span class=\"cp\">%&gt;</span>\n# =&gt; <span class=\"nt\">&lt;select&gt;&lt;optgroup</span> <span class=\"na\">label=</span><span class=\"s\">\"North America\"</span> <span class=\"na\">disabled=</span><span class=\"s\">\"disabled\"</span><span class=\"nt\">&gt;&lt;option</span> <span class=\"na\">value=</span><span class=\"s\">\"US\"</span><span class=\"nt\">&gt;</span>United States<span class=\"nt\">&lt;/option&gt;&lt;option</span> <span class=\"na\">value=</span><span class=\"s\">\"CA\"</span><span class=\"nt\">&gt;</span>Canada<span class=\"nt\">&lt;/option&gt;&lt;/optgroup&gt;&lt;/select&gt;</span>\n</code></pre></div></div>\n\n<p><em>Chris Gunther</em></p>\n"
  },
  {
    "message": "*   `check_box_tag` and `radio_button_tag` now accept `checked` as a keyword argument\n\n    This is to make the API more consistent with the `FormHelper` variants. You can now\n    provide `checked` as a positional or keyword argument:\n\n    ```erb\n    = check_box_tag \"admin\", \"1\", false\n    = check_box_tag \"admin\", \"1\", checked: false\n\n    = radio_button_tag 'favorite_color', 'maroon', false\n    = radio_button_tag 'favorite_color', 'maroon', checked: false\n    ```\n\n    *Alex Ghiculescu*",
    "project": "actionview",
    "date_merged": 1666469985000,
    "author": "Alex Ghiculescu",
    "sha": "4fcac154f44eac36aaea48ae4ae2cf9d2b210d5e",
    "pr": "45527",
    "merge_sha": "cdb51080b1dabb5f0ecf5c9754d2b22842f366c7",
    "html": "<p><code>check_box_tag</code> and <code>radio_button_tag</code> now accept <code>checked</code> as a keyword argument</p>\n\n<p>This is to make the API more consistent with the <code>FormHelper</code> variants. You can now<br />\nprovide <code>checked</code> as a positional or keyword argument:</p>\n\n<div class=\"language-erb highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>= check_box_tag \"admin\", \"1\", false\n= check_box_tag \"admin\", \"1\", checked: false\n\n= radio_button_tag 'favorite_color', 'maroon', false\n= radio_button_tag 'favorite_color', 'maroon', checked: false\n</code></pre></div></div>\n\n<p><em>Alex Ghiculescu</em></p>\n"
  },
  {
    "message": "*   Allow passing a class to `dom_id`.\n    You no longer need to call `new` when passing a class to `dom_id`.\n    This makes `dom_id` behave like `dom_class` in this regard.\n    Apart from saving a few keystrokes, it prevents Ruby from needing\n    to instantiate a whole new object just to generate a string.\n\n    Before:\n    ```ruby\n    dom_id(Post) # => NoMethodError: undefined method `to_key' for Post:Class\n    ```\n\n    After:\n    ```ruby\n    dom_id(Post) # => \"new_post\"\n    ```\n\n    *Goulven Champenois*",
    "project": "actionview",
    "date_merged": 1663700736000,
    "author": "Goulven Champenois",
    "sha": "f4f15c86a2702aaaa4dc63c775d1273384371dd1",
    "pr": "46068",
    "merge_sha": "d845a2464648f687e45dac7ce5f7f0cdd39d2e1e",
    "html": "<p>Allow passing a class to <code>dom_id</code>.<br />\nYou no longer need to call <code>new</code> when passing a class to <code>dom_id</code>.<br />\nThis makes <code>dom_id</code> behave like <code>dom_class</code> in this regard.<br />\nApart from saving a few keystrokes, it prevents Ruby from needing<br />\nto instantiate a whole new object just to generate a string.</p>\n\n<p>Before:</p>\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">dom_id</span><span class=\"p\">(</span><span class=\"no\">Post</span><span class=\"p\">)</span> <span class=\"c1\"># =&gt; NoMethodError: undefined method `to_key' for Post:Class</span>\n</code></pre></div></div>\n\n<p>After:</p>\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">dom_id</span><span class=\"p\">(</span><span class=\"no\">Post</span><span class=\"p\">)</span> <span class=\"c1\"># =&gt; \"new_post\"</span>\n</code></pre></div></div>\n\n<p><em>Goulven Champenois</em></p>\n"
  },
  {
    "message": "*   Report `:locals` as part of the data returned by ActionView render instrumentation.\n\n    Before:\n    ```ruby\n    {\n    identifier: \"/Users/adam/projects/notifications/app/views/posts/index.html.erb\",\n    layout: \"layouts/application\"\n    }\n    ```\n\n    After:\n    ```ruby\n    {\n    identifier: \"/Users/adam/projects/notifications/app/views/posts/index.html.erb\",\n    layout: \"layouts/application\",\n    locals: {foo: \"bar\"}\n    }\n    ```\n\n    *Aaron Gough*",
    "project": "actionview",
    "date_merged": 1662752742000,
    "author": "Aaron Gough",
    "sha": "b451ff098de2b6505a3eeecd3f39c25ec8336904",
    "pr": "45977",
    "merge_sha": "e29ca73db43ab9b1c8e49c20975fea127c638ed1",
    "html": "<p>Report <code>:locals</code> as part of the data returned by ActionView render instrumentation.</p>\n\n<p>Before:</p>\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"p\">{</span>\n<span class=\"ss\">identifier: </span><span class=\"s2\">\"/Users/adam/projects/notifications/app/views/posts/index.html.erb\"</span><span class=\"p\">,</span>\n<span class=\"ss\">layout: </span><span class=\"s2\">\"layouts/application\"</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>After:</p>\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"p\">{</span>\n<span class=\"ss\">identifier: </span><span class=\"s2\">\"/Users/adam/projects/notifications/app/views/posts/index.html.erb\"</span><span class=\"p\">,</span>\n<span class=\"ss\">layout: </span><span class=\"s2\">\"layouts/application\"</span><span class=\"p\">,</span>\n<span class=\"ss\">locals: </span><span class=\"p\">{</span><span class=\"ss\">foo: </span><span class=\"s2\">\"bar\"</span><span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p><em>Aaron Gough</em></p>\n"
  },
  {
    "message": "*   Strip `break_sequence` at the end of `word_wrap`.\n\n    This fixes a bug where `word_wrap` didn't properly strip off break sequences that had printable characters.\n\n    For example, compare the outputs of this template:\n\n    ```erb\n    # <%= word_wrap(\"11 22\\n33 44\", line_width: 2, break_sequence: \"\\n# \") %>\n    ```\n\n    Before:\n\n    ```\n    # 11\n    # 22\n    #\n    # 33\n    # 44\n    #\n    ```\n\n    After:\n\n    ```\n    # 11\n    # 22\n    # 33\n    # 44\n    ```\n\n    *Max Chernyak*",
    "project": "actionview",
    "date_merged": 1662411769000,
    "author": "Max Chernyak",
    "sha": "fe554a3daf74d52f4b3f3d2cdb352ad0495049cc",
    "pr": "45942",
    "merge_sha": "23c3202de1c73b2b1fb43e917032f2471e8e5633",
    "html": "<p>Strip <code>break_sequence</code> at the end of <code>word_wrap</code>.</p>\n\n<p>This fixes a bug where <code>word_wrap</code> didn’t properly strip off break sequences that had printable characters.</p>\n\n<p>For example, compare the outputs of this template:</p>\n\n<div class=\"language-erb highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code># <span class=\"cp\">&lt;%=</span> <span class=\"n\">word_wrap</span><span class=\"p\">(</span><span class=\"s2\">\"11 22</span><span class=\"se\">\\n</span><span class=\"s2\">33 44\"</span><span class=\"p\">,</span> <span class=\"ss\">line_width: </span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"ss\">break_sequence: </span><span class=\"s2\">\"</span><span class=\"se\">\\n</span><span class=\"s2\"># \"</span><span class=\"p\">)</span> <span class=\"cp\">%&gt;</span>\n</code></pre></div></div>\n\n<p>Before:</p>\n\n<pre><code># 11\n# 22\n#\n# 33\n# 44\n#\n</code></pre>\n\n<p>After:</p>\n\n<pre><code># 11\n# 22\n# 33\n# 44\n</code></pre>\n\n<p><em>Max Chernyak</em></p>\n"
  },
  {
    "message": "*   Allow templates to set strict `locals`.\n\n    By default, templates will accept any `locals` as keyword arguments. To define what `locals` a template accepts, add a `locals` magic comment:\n\n    ```erb\n    <%# locals: (message:) -%>\n    <%= message %>\n    ```\n\n    Default values can also be provided:\n\n    ```erb\n    <%# locals: (message: \"Hello, world!\") -%>\n    <%= message %>\n    ```\n\n    Or `locals` can be disabled entirely:\n\n    ```erb\n    <%# locals: () %>\n    ```\n\n    *Joel Hawksley*",
    "project": "actionview",
    "date_merged": 1659422124000,
    "author": "Joel Hawksley",
    "sha": "b7908a62f9a640a004b71fb9d8c9d56549f09ccb",
    "pr": "45727",
    "merge_sha": "91b51e31cdc16a6aed9418f957660fcdac9eada6",
    "html": "<p>Allow templates to set strict <code>locals</code>.</p>\n\n<p>By default, templates will accept any <code>locals</code> as keyword arguments. To define what <code>locals</code> a template accepts, add a <code>locals</code> magic comment:</p>\n\n<div class=\"language-erb highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c\">&lt;%# locals: (message:) -%&gt;</span>\n<span class=\"cp\">&lt;%=</span> <span class=\"n\">message</span> <span class=\"cp\">%&gt;</span>\n</code></pre></div></div>\n\n<p>Default values can also be provided:</p>\n\n<div class=\"language-erb highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c\">&lt;%# locals: (message: \"Hello, world!\") -%&gt;</span>\n<span class=\"cp\">&lt;%=</span> <span class=\"n\">message</span> <span class=\"cp\">%&gt;</span>\n</code></pre></div></div>\n\n<p>Or <code>locals</code> can be disabled entirely:</p>\n\n<div class=\"language-erb highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c\">&lt;%# locals: () %&gt;</span>\n</code></pre></div></div>\n\n<p><em>Joel Hawksley</em></p>\n"
  },
  {
    "message": "*   Add `include_seconds` option for `datetime_local_field`\n\n    This allows to omit seconds part in the input field, by passing `include_seconds: false`\n\n    *Wojciech Wnętrzak*",
    "project": "actionview",
    "date_merged": 1657217784000,
    "author": "Wojciech Wnętrzak",
    "sha": "2dea9aebf2ce2e0f37c821a8d88f3caef549de7a",
    "pr": "45188",
    "merge_sha": "d525b7848b94ce6da35ff44d3e2d1f36fb2fe309",
    "html": "<p>Add <code>include_seconds</code> option for <code>datetime_local_field</code></p>\n\n<p>This allows to omit seconds part in the input field, by passing <code>include_seconds: false</code></p>\n\n<p><em>Wojciech Wnętrzak</em></p>\n"
  },
  {
    "message": "*   Guard against `ActionView::Helpers::FormTagHelper#field_name` calls with nil\n    `object_name` arguments. For example:\n\n    ```erb\n    <%= fields do |f| %>\n      <%= f.field_name :body %>\n    <% end %>\n    ```\n\n    *Sean Doyle*",
    "project": "actionview",
    "date_merged": 1655321007000,
    "author": "Sean Doyle",
    "sha": "8a0bc4aa902e36817abb48f28210b5f1b10c7618",
    "pr": "45366",
    "merge_sha": "bdc3e192bb9b7223963d79cf7a15967a88f4bf6f",
    "html": "<p>Guard against <code>ActionView::Helpers::FormTagHelper#field_name</code> calls with nil<br />\n<code>object_name</code> arguments. For example:</p>\n\n<div class=\"language-erb highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"cp\">&lt;%=</span> <span class=\"n\">fields</span> <span class=\"k\">do</span> <span class=\"o\">|</span><span class=\"n\">f</span><span class=\"o\">|</span> <span class=\"cp\">%&gt;</span>\n  <span class=\"cp\">&lt;%=</span> <span class=\"n\">f</span><span class=\"p\">.</span><span class=\"nf\">field_name</span> <span class=\"ss\">:body</span> <span class=\"cp\">%&gt;</span>\n<span class=\"cp\">&lt;%</span> <span class=\"k\">end</span> <span class=\"cp\">%&gt;</span>\n</code></pre></div></div>\n\n<p><em>Sean Doyle</em></p>\n"
  },
  {
    "message": "*   Strings returned from `strip_tags` are correctly tagged `html_safe?`\n\n    Because these strings contain no HTML elements and the basic entities are escaped, they are safe\n    to be included as-is as PCDATA in HTML content. Tagging them as html-safe avoids double-escaping\n    entities when being concatenated to a SafeBuffer during rendering.\n\n    Fixes [rails/rails-html-sanitizer#124](https://github.com/rails/rails-html-sanitizer/issues/124)\n\n    *Mike Dalessio*",
    "project": "actionview",
    "date_merged": 1654007157000,
    "author": "Mike Dalessio",
    "sha": "5f8f6764d8632c5b63635e6520278c3e80716fc7",
    "pr": "45218",
    "merge_sha": "55e143a398247387d734386716016928fca841a4",
    "html": "<p>Strings returned from <code>strip_tags</code> are correctly tagged <code>html_safe?</code></p>\n\n<p>Because these strings contain no HTML elements and the basic entities are escaped, they are safe<br />\nto be included as-is as PCDATA in HTML content. Tagging them as html-safe avoids double-escaping<br />\nentities when being concatenated to a SafeBuffer during rendering.</p>\n\n<p>Fixes <a href=\"https://github.com/rails/rails-html-sanitizer/issues/124\">rails/rails-html-sanitizer#124</a></p>\n\n<p><em>Mike Dalessio</em></p>\n"
  },
  {
    "message": "*   Move `convert_to_model` call from `form_for` into `form_with`\n\n    Now that `form_for` is implemented in terms of `form_with`, remove the\n    `convert_to_model` call from `form_for`.\n\n    *Sean Doyle*",
    "project": "actionview",
    "date_merged": 1653488685000,
    "author": "Sean Doyle",
    "sha": "980de46f543ab2c2b1a1a7caf494f3bf7885c82f",
    "pr": "44468",
    "merge_sha": "3404606378dd93344007d954ab326cc1e973c22a",
    "html": "<p>Move <code>convert_to_model</code> call from <code>form_for</code> into <code>form_with</code></p>\n\n<p>Now that <code>form_for</code> is implemented in terms of <code>form_with</code>, remove the<br />\n<code>convert_to_model</code> call from <code>form_for</code>.</p>\n\n<p><em>Sean Doyle</em></p>\n"
  },
  {
    "message": "*   Fix and add protections for XSS in `ActionView::Helpers` and `ERB::Util`.\n\n    Escape dangerous characters in names of tags and names of attributes in the\n    tag helpers, following the XML specification. Rename the option\n    `:escape_attributes` to `:escape`, to simplify by applying the option to the\n    whole tag.\n\n    *Álvaro Martín Fraguas*",
    "project": "actionview",
    "date_merged": 1651174760000,
    "author": "Alvaro Martin Fraguas",
    "sha": "649516ce0feb699ae06a8c5e81df75d460cc9a85",
    "pr": "44973",
    "merge_sha": "6ce8c03b53501ace1f0484dadcc245e830a0c840",
    "html": "<p>Fix and add protections for XSS in <code>ActionView::Helpers</code> and <code>ERB::Util</code>.</p>\n\n<p>Escape dangerous characters in names of tags and names of attributes in the<br />\ntag helpers, following the XML specification. Rename the option<br />\n<code>:escape_attributes</code> to <code>:escape</code>, to simplify by applying the option to the<br />\nwhole tag.</p>\n\n<p><em>Álvaro Martín Fraguas</em></p>\n"
  },
  {
    "message": "*   Extend audio_tag and video_tag to accept Active Storage attachments.\n\n    Now it's possible to write\n\n    ```ruby\n    audio_tag(user.audio_file)\n    video_tag(user.video_file)\n    ```\n\n    Instead of\n\n    ```ruby\n    audio_tag(polymorphic_path(user.audio_file))\n    video_tag(polymorphic_path(user.video_file))\n    ```\n\n    `image_tag` already supported that, so this follows the same pattern.\n\n    *Matheus Richard*",
    "project": "actionview",
    "date_merged": 1647244014000,
    "author": "Matheus Richard",
    "sha": "414394206a9637272a37d30a64dbf31ea6b477ac",
    "pr": "44085",
    "merge_sha": "c48d846518e77fbdcc3d411bc24cbeb2d90fd04e",
    "html": "<p>Extend audio_tag and video_tag to accept Active Storage attachments.</p>\n\n<p>Now it’s possible to write</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">audio_tag</span><span class=\"p\">(</span><span class=\"n\">user</span><span class=\"p\">.</span><span class=\"nf\">audio_file</span><span class=\"p\">)</span>\n<span class=\"n\">video_tag</span><span class=\"p\">(</span><span class=\"n\">user</span><span class=\"p\">.</span><span class=\"nf\">video_file</span><span class=\"p\">)</span>\n</code></pre></div></div>\n\n<p>Instead of</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">audio_tag</span><span class=\"p\">(</span><span class=\"n\">polymorphic_path</span><span class=\"p\">(</span><span class=\"n\">user</span><span class=\"p\">.</span><span class=\"nf\">audio_file</span><span class=\"p\">))</span>\n<span class=\"n\">video_tag</span><span class=\"p\">(</span><span class=\"n\">polymorphic_path</span><span class=\"p\">(</span><span class=\"n\">user</span><span class=\"p\">.</span><span class=\"nf\">video_file</span><span class=\"p\">))</span>\n</code></pre></div></div>\n\n<p><code>image_tag</code> already supported that, so this follows the same pattern.</p>\n\n<p><em>Matheus Richard</em></p>\n"
  },
  {
    "message": "*   Ensure models passed to `form_for` attempt to call `to_model`.\n\n    *Sean Doyle*",
    "project": "actionview",
    "date_merged": 1645132869000,
    "author": "Sean Doyle",
    "sha": "9dc083f95d15a883d0d51d24ce1eab7158db6a82",
    "pr": "44328",
    "merge_sha": "159ce6921550f363b46625c243faa6ddad995579",
    "html": "<p>Ensure models passed to <code>form_for</code> attempt to call <code>to_model</code>.</p>\n\n<p><em>Sean Doyle</em></p>\n"
  },
  {
    "message": "*   Fix unscope is not working in specific case\n\n    Before:\n    ```ruby\n    Post.where(id: 1...3).unscope(where: :id).to_sql # \"SELECT `posts`.* FROM `posts` WHERE `posts`.`id` >= 1 AND `posts`.`id` < 3\"\n\n    ```\n\n    After:\n    ```ruby\n    Post.where(id: 1...3).unscope(where: :id).to_sql # \"SELECT `posts`.* FROM `posts`\"\n    ```\n\n    Fixes #48094.\n\n    *Kazuya Hatanaka*",
    "project": "activerecord",
    "date_merged": 1693815385000,
    "author": "ippachi",
    "sha": "ed680483db389c47b2294fc66a77d0f03a8082b1",
    "pr": "48095",
    "merge_sha": "8271186d012c5e9ca11e0a38d8acd4b2e9623270",
    "html": "<p>Fix unscope is not working in specific case</p>\n\n<p>Before:</p>\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">Post</span><span class=\"p\">.</span><span class=\"nf\">where</span><span class=\"p\">(</span><span class=\"ss\">id: </span><span class=\"mi\">1</span><span class=\"o\">...</span><span class=\"mi\">3</span><span class=\"p\">).</span><span class=\"nf\">unscope</span><span class=\"p\">(</span><span class=\"ss\">where: :id</span><span class=\"p\">).</span><span class=\"nf\">to_sql</span> <span class=\"c1\"># \"SELECT `posts`.* FROM `posts` WHERE `posts`.`id` &gt;= 1 AND `posts`.`id` &lt; 3\"</span>\n\n</code></pre></div></div>\n\n<p>After:</p>\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">Post</span><span class=\"p\">.</span><span class=\"nf\">where</span><span class=\"p\">(</span><span class=\"ss\">id: </span><span class=\"mi\">1</span><span class=\"o\">...</span><span class=\"mi\">3</span><span class=\"p\">).</span><span class=\"nf\">unscope</span><span class=\"p\">(</span><span class=\"ss\">where: :id</span><span class=\"p\">).</span><span class=\"nf\">to_sql</span> <span class=\"c1\"># \"SELECT `posts`.* FROM `posts`\"</span>\n</code></pre></div></div>\n\n<p>Fixes #48094.</p>\n\n<p><em>Kazuya Hatanaka</em></p>\n"
  },
  {
    "message": "*   Change `has_secure_token` default to `on: :initialize`\n\n    Change the new default value from `on: :create` to `on: :initialize`\n\n    Can be controlled by the `config.active_record.generate_secure_token_on`\n    configuration:\n\n    ```ruby\n    config.active_record.generate_secure_token_on = :create\n    ```\n\n    *Sean Doyle*",
    "project": "activerecord",
    "date_merged": 1693600197000,
    "author": "Sean Doyle",
    "sha": "e85a3ec624074e7cbaf7d5f448e1973b79ac8913",
    "pr": "48912",
    "merge_sha": "a21c40bb703001cb6353fdaf751e9e1c77cd30f0",
    "html": "<p>Change <code>has_secure_token</code> default to <code>on: :initialize</code></p>\n\n<p>Change the new default value from <code>on: :create</code> to <code>on: :initialize</code></p>\n\n<p>Can be controlled by the <code>config.active_record.generate_secure_token_on</code><br />\nconfiguration:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">config</span><span class=\"p\">.</span><span class=\"nf\">active_record</span><span class=\"p\">.</span><span class=\"nf\">generate_secure_token_on</span> <span class=\"o\">=</span> <span class=\"ss\">:create</span>\n</code></pre></div></div>\n\n<p><em>Sean Doyle</em></p>\n"
  },
  {
    "message": "*   Fix `change_column` not setting `precision: 6` on `datetime` columns when\n    using 7.0+ Migrations and SQLite.\n\n    *Hartley McGuire*",
    "project": "activerecord",
    "date_merged": 1693592513000,
    "author": "Hartley McGuire",
    "sha": "57a9e25f8e96eb28f4f3704db4be55bdb88c22f0",
    "pr": "49090",
    "merge_sha": "cdbc9b78cb2fd9ac0b70d5c4ee04453e530140fd",
    "html": "<p>Fix <code>change_column</code> not setting <code>precision: 6</code> on <code>datetime</code> columns when<br />\nusing 7.0+ Migrations and SQLite.</p>\n\n<p><em>Hartley McGuire</em></p>\n"
  },
  {
    "message": "*   Support composite identifiers in `to_key`\n\n    `to_key` avoids wrapping `#id` value into an `Array` if `#id` already an array\n\n    *Nikita Vasilevsky*",
    "project": "activerecord",
    "date_merged": 1693584579000,
    "author": "Nikita Vasilevsky",
    "sha": "0df4df4d15860425529a9eb2e73d26885d8e9678",
    "pr": "49110",
    "merge_sha": "b1fca671554a9de9929823dd873670e2f6f3cdaf",
    "html": "<p>Support composite identifiers in <code>to_key</code></p>\n\n<p><code>to_key</code> avoids wrapping <code>#id</code> value into an <code>Array</code> if <code>#id</code> already an array</p>\n\n<p><em>Nikita Vasilevsky</em></p>\n"
  },
  {
    "message": "*   Add validation option for `enum`\n\n    ```ruby\n    class Contract < ApplicationRecord\n      enum :status, %w[in_progress completed], validate: true\n    end\n    Contract.new(status: \"unknown\").valid? # => false\n    Contract.new(status: nil).valid? # => false\n    Contract.new(status: \"completed\").valid? # => true\n\n    class Contract < ApplicationRecord\n      enum :status, %w[in_progress completed], validate: { allow_nil: true }\n    end\n    Contract.new(status: \"unknown\").valid? # => false\n    Contract.new(status: nil).valid? # => true\n    Contract.new(status: \"completed\").valid? # => true\n    ```\n\n    *Edem Topuzov*, *Ryuta Kamizono*",
    "project": "activerecord",
    "date_merged": 1693598334000,
    "author": "Эдем",
    "sha": "7c65a4b83b583f4f27f3f20a9fb078b35823d2fe",
    "pr": "49100",
    "merge_sha": "3bc64016afedf56504b0d1393772563255738147",
    "html": "<p>Add validation option for <code>enum</code></p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">class</span> <span class=\"nc\">Contract</span> <span class=\"o\">&lt;</span> <span class=\"no\">ApplicationRecord</span>\n  <span class=\"n\">enum</span> <span class=\"ss\">:status</span><span class=\"p\">,</span> <span class=\"sx\">%w[in_progress completed]</span><span class=\"p\">,</span> <span class=\"ss\">validate: </span><span class=\"kp\">true</span>\n<span class=\"k\">end</span>\n<span class=\"no\">Contract</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"ss\">status: </span><span class=\"s2\">\"unknown\"</span><span class=\"p\">).</span><span class=\"nf\">valid?</span> <span class=\"c1\"># =&gt; false</span>\n<span class=\"no\">Contract</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"ss\">status: </span><span class=\"kp\">nil</span><span class=\"p\">).</span><span class=\"nf\">valid?</span> <span class=\"c1\"># =&gt; false</span>\n<span class=\"no\">Contract</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"ss\">status: </span><span class=\"s2\">\"completed\"</span><span class=\"p\">).</span><span class=\"nf\">valid?</span> <span class=\"c1\"># =&gt; true</span>\n\n<span class=\"k\">class</span> <span class=\"nc\">Contract</span> <span class=\"o\">&lt;</span> <span class=\"no\">ApplicationRecord</span>\n  <span class=\"n\">enum</span> <span class=\"ss\">:status</span><span class=\"p\">,</span> <span class=\"sx\">%w[in_progress completed]</span><span class=\"p\">,</span> <span class=\"ss\">validate: </span><span class=\"p\">{</span> <span class=\"ss\">allow_nil: </span><span class=\"kp\">true</span> <span class=\"p\">}</span>\n<span class=\"k\">end</span>\n<span class=\"no\">Contract</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"ss\">status: </span><span class=\"s2\">\"unknown\"</span><span class=\"p\">).</span><span class=\"nf\">valid?</span> <span class=\"c1\"># =&gt; false</span>\n<span class=\"no\">Contract</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"ss\">status: </span><span class=\"kp\">nil</span><span class=\"p\">).</span><span class=\"nf\">valid?</span> <span class=\"c1\"># =&gt; true</span>\n<span class=\"no\">Contract</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"ss\">status: </span><span class=\"s2\">\"completed\"</span><span class=\"p\">).</span><span class=\"nf\">valid?</span> <span class=\"c1\"># =&gt; true</span>\n</code></pre></div></div>\n\n<p><em>Edem Topuzov</em>, <em>Ryuta Kamizono</em></p>\n"
  },
  {
    "message": "*   Allow batching methods to use already loaded relation if available\n\n    Calling batch methods on already loaded relations will use the records previously loaded instead of retrieving\n    them from the database again.\n\n    *Adam Hess*",
    "project": "activerecord",
    "date_merged": 1693297351000,
    "author": "HParker",
    "sha": "451053eca5637f33ac9987a103ae8766f668fe2f",
    "pr": "49071",
    "merge_sha": "4f33e65fc57ca45153f6c05e38dc067e6c519065",
    "html": "<p>Allow batching methods to use already loaded relation if available</p>\n\n<p>Calling batch methods on already loaded relations will use the records previously loaded instead of retrieving<br />\nthem from the database again.</p>\n\n<p><em>Adam Hess</em></p>\n"
  },
  {
    "message": "*   Deprecate `read_attribute(:id)` returning the primary key if the primary key is not `:id`.\n\n    Starting in Rails 7.2, `read_attribute(:id)` will return the value of the id column, regardless of the model's\n    primary key. To retrieve the value of the primary key, use `#id` instead. `read_attribute(:id)` for composite\n    primary key models will now return the value of the id column.\n\n    *Adrianna Chang*",
    "project": "activerecord",
    "date_merged": 1692828156000,
    "author": "Adrianna Chang",
    "sha": "ac83311baef339bdd9a30b4ba7ad55a390f087cd",
    "pr": "49019",
    "merge_sha": "59542e86c43f73ddc4dca097112df14ba2bf40c9",
    "html": "<p>Deprecate <code>read_attribute(:id)</code> returning the primary key if the primary key is not <code>:id</code>.</p>\n\n<p>Starting in Rails 7.2, <code>read_attribute(:id)</code> will return the value of the id column, regardless of the model’s<br />\nprimary key. To retrieve the value of the primary key, use <code>#id</code> instead. <code>read_attribute(:id)</code> for composite<br />\nprimary key models will now return the value of the id column.</p>\n\n<p><em>Adrianna Chang</em></p>\n"
  },
  {
    "message": "*   Fix `change_table` setting datetime precision for 6.1 Migrations\n\n    *Hartley McGuire*",
    "project": "activerecord",
    "date_merged": 1692754144000,
    "author": "Hartley McGuire",
    "sha": "9b07b2d6ca2ee9854cd986da0bf914b9ace9d547",
    "pr": "48974",
    "merge_sha": "2c5bfbd397e39a906e84ee6be3f30b7d240b272c",
    "html": "<p>Fix <code>change_table</code> setting datetime precision for 6.1 Migrations</p>\n\n<p><em>Hartley McGuire</em></p>\n"
  },
  {
    "message": "*   Fix change_column setting datetime precision for 6.1 Migrations\n\n    *Hartley McGuire*",
    "project": "activerecord",
    "date_merged": 1692692921000,
    "author": "Hartley McGuire",
    "sha": "c2f838e80c76c9a3407e1e7af1ecbd738511fd72",
    "pr": "48969",
    "merge_sha": "e98a6bda0934ab4773de20889df883dd598d6f04",
    "html": "<p>Fix change_column setting datetime precision for 6.1 Migrations</p>\n\n<p><em>Hartley McGuire</em></p>\n"
  },
  {
    "message": "*   Add `ActiveRecord::Base#id_value` alias to access the raw value of a record's id column.\n\n    This alias is only provided for models that declare an `:id` column.\n\n    *Adrianna Chang*",
    "project": "activerecord",
    "date_merged": 1692642819000,
    "author": "Adrianna Chang",
    "sha": "e90b11e77eb32686dd38ebe46232b72621ace1c9",
    "pr": "48930",
    "merge_sha": "ccee593fed07cad128a54443b13af140b264c7c5",
    "html": "<p>Add <code>ActiveRecord::Base#id_value</code> alias to access the raw value of a record’s id column.</p>\n\n<p>This alias is only provided for models that declare an <code>:id</code> column.</p>\n\n<p><em>Adrianna Chang</em></p>\n"
  },
  {
    "message": "*   Fix previous change tracking for `ActiveRecord::Store` when using a column with JSON structured database type\n\n    Before, the methods to access the changes made during the last save `#saved_change_to_key?`, `#saved_change_to_key`, and `#key_before_last_save` did not work if the store was defined as a `store_accessor` on a column with a JSON structured database type\n\n    *Robert DiMartino*",
    "project": "activerecord",
    "date_merged": 1691598736000,
    "author": "Robert DiMartino",
    "sha": "eceaa38e060e6cb00d9dd25eb1df98cd83d978f6",
    "pr": "43386",
    "merge_sha": "8ec27a4529e37cff77abe54573bb8923d9fe8e9a",
    "html": "<p>Fix previous change tracking for <code>ActiveRecord::Store</code> when using a column with JSON structured database type</p>\n\n<p>Before, the methods to access the changes made during the last save <code>#saved_change_to_key?</code>, <code>#saved_change_to_key</code>, and <code>#key_before_last_save</code> did not work if the store was defined as a <code>store_accessor</code> on a column with a JSON structured database type</p>\n\n<p><em>Robert DiMartino</em></p>\n"
  },
  {
    "message": "*   Fully support `NULLS [NOT] DISTINCT` for PostgreSQL 15+ indexes.\n\n    Previous work was done to allow the index to be created in a migration, but it was not\n    supported in schema.rb. Additionally, the matching for `NULLS [NOT] DISTINCT` was not\n    in the correct order, which could have resulted in inconsistent schema detection.\n\n    *Gregory Jones*",
    "project": "activerecord",
    "date_merged": 1691092834000,
    "author": "Rafael Mendonça França",
    "sha": "fbaba19e2dee7efc628a68e85e81e04d191902b6",
    "pr": "48608",
    "merge_sha": "83e59883e990704fd57572708b7d61f776113345",
    "html": "<p>Fully support <code>NULLS [NOT] DISTINCT</code> for PostgreSQL 15+ indexes.</p>\n\n<p>Previous work was done to allow the index to be created in a migration, but it was not<br />\nsupported in schema.rb. Additionally, the matching for <code>NULLS [NOT] DISTINCT</code> was not<br />\nin the correct order, which could have resulted in inconsistent schema detection.</p>\n\n<p><em>Gregory Jones</em></p>\n"
  },
  {
    "message": "*   Allow escaping of literal colon characters in `sanitize_sql_*` methods when named bind variables are used\n\n    *Justin Bull*",
    "project": "activerecord",
    "date_merged": 1690900684000,
    "author": "Justin Bull",
    "sha": "694376f15eecc6a2387697044370938ffc8af157",
    "pr": "48852",
    "merge_sha": "98e12fc6d6bff11200d579543109219031ff1bfd",
    "html": "<p>Allow escaping of literal colon characters in <code>sanitize_sql_*</code> methods when named bind variables are used</p>\n\n<p><em>Justin Bull</em></p>\n"
  },
  {
    "message": "*   Fix `#previously_new_record?` to return true for destroyed records.\n\n    Before, if a record was created and then destroyed, `#previously_new_record?` would return true.\n    Now, any UPDATE or DELETE to a record is considered a change, and will result in `#previously_new_record?`\n    returning false.\n\n    *Adrianna Chang*",
    "project": "activerecord",
    "date_merged": 1690318534000,
    "author": "Adrianna Chang",
    "sha": "7981988fa0e28b520042c11909caf3792aade9c4",
    "pr": "48796",
    "merge_sha": "0c78ab2cc7f8ea14db26e2e779994022f2ef9d8a",
    "html": "<p>Fix <code>#previously_new_record?</code> to return true for destroyed records.</p>\n\n<p>Before, if a record was created and then destroyed, <code>#previously_new_record?</code> would return true.<br />\nNow, any UPDATE or DELETE to a record is considered a change, and will result in <code>#previously_new_record?</code><br />\nreturning false.</p>\n\n<p><em>Adrianna Chang</em></p>\n"
  },
  {
    "message": "*   Specify callback in `has_secure_token`\n\n    ```ruby\n    class User < ApplicationRecord\n      has_secure_token on: :initialize\n    end\n\n    User.new.token # => \"abc123....\"\n    ```\n\n    *Sean Doyle*",
    "project": "activerecord",
    "date_merged": 1689715176000,
    "author": "Sean Doyle",
    "sha": "7d63864486d048c1c99b561248ca5fb63c320eaf",
    "pr": "47420",
    "merge_sha": "2884d00f0c982711aa9ddef477b1898fbbda4c58",
    "html": "<p>Specify callback in <code>has_secure_token</code></p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">class</span> <span class=\"nc\">User</span> <span class=\"o\">&lt;</span> <span class=\"no\">ApplicationRecord</span>\n  <span class=\"n\">has_secure_token</span> <span class=\"ss\">on: :initialize</span>\n<span class=\"k\">end</span>\n\n<span class=\"no\">User</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">.</span><span class=\"nf\">token</span> <span class=\"c1\"># =&gt; \"abc123....\"</span>\n</code></pre></div></div>\n\n<p><em>Sean Doyle</em></p>\n"
  },
  {
    "message": "*   Fix incrementation of in memory counter caches when associations overlap\n\n    When two associations had a similarly named counter cache column, Active Record\n    could sometime increment the wrong one.\n\n    *Jacopo Beschi*, *Jean Boussier*",
    "project": "activerecord",
    "date_merged": 1689249465000,
    "author": "Jacopo",
    "sha": "186474f2730639a32320434607a248e93ae5dde9",
    "pr": "48665",
    "merge_sha": "b22439ed6412fef74afc86ff3f87ca57eafa94e7",
    "html": "<p>Fix incrementation of in memory counter caches when associations overlap</p>\n\n<p>When two associations had a similarly named counter cache column, Active Record<br />\ncould sometime increment the wrong one.</p>\n\n<p><em>Jacopo Beschi</em>, <em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   Don't show secrets for Active Record's `Cipher::Aes256Gcm#inspect`.\n\n    Before:\n\n    ```ruby\n    ActiveRecord::Encryption::Cipher::Aes256Gcm.new(secret).inspect\n    \"#<ActiveRecord::Encryption::Cipher::Aes256Gcm:0x0000000104888038 ... @secret=\\\"\\\\xAF\\\\bFh]LV}q\\\\nl\\\\xB2U\\\\xB3 ... >\"\n    ```\n\n    After:\n\n    ```ruby\n    ActiveRecord::Encryption::Cipher::Aes256Gcm(secret).inspect\n    \"#<ActiveRecord::Encryption::Cipher::Aes256Gcm:0x0000000104888038>\"\n    ```\n\n    *Petrik de Heus*",
    "project": "activerecord",
    "date_merged": 1689108948000,
    "author": "Petrik",
    "sha": "7dd38cfa16a3f2b435eb2b4967ea9cb0e2756d89",
    "pr": "48679",
    "merge_sha": "a7ef1250aa1e809932adf8c68a243be3d95961b1",
    "html": "<p>Don’t show secrets for Active Record’s <code>Cipher::Aes256Gcm#inspect</code>.</p>\n\n<p>Before:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">ActiveRecord</span><span class=\"o\">::</span><span class=\"no\">Encryption</span><span class=\"o\">::</span><span class=\"no\">Cipher</span><span class=\"o\">::</span><span class=\"no\">Aes256Gcm</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"n\">secret</span><span class=\"p\">).</span><span class=\"nf\">inspect</span>\n<span class=\"s2\">\"#&lt;ActiveRecord::Encryption::Cipher::Aes256Gcm:0x0000000104888038 ... @secret=</span><span class=\"se\">\\\"\\\\</span><span class=\"s2\">xAF</span><span class=\"se\">\\\\</span><span class=\"s2\">bFh]LV}q</span><span class=\"se\">\\\\</span><span class=\"s2\">nl</span><span class=\"se\">\\\\</span><span class=\"s2\">xB2U</span><span class=\"se\">\\\\</span><span class=\"s2\">xB3 ... &gt;\"</span>\n</code></pre></div></div>\n\n<p>After:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">ActiveRecord</span><span class=\"o\">::</span><span class=\"no\">Encryption</span><span class=\"o\">::</span><span class=\"no\">Cipher</span><span class=\"o\">::</span><span class=\"no\">Aes256Gcm</span><span class=\"p\">(</span><span class=\"n\">secret</span><span class=\"p\">).</span><span class=\"nf\">inspect</span>\n<span class=\"s2\">\"#&lt;ActiveRecord::Encryption::Cipher::Aes256Gcm:0x0000000104888038&gt;\"</span>\n</code></pre></div></div>\n\n<p><em>Petrik de Heus</em></p>\n"
  },
  {
    "message": "*   Bring back the historical behavior of committing transaction on non-local return.\n\n    ```ruby\n    Model.transaction do\n      model.save\n      return\n      other_model.save # not executed\n    end\n    ```\n\n    Historically only raised errors would trigger a rollback, but in Ruby `2.3`, the `timeout` library\n    started using `throw` to interrupt execution which had the adverse effect of committing open transactions.\n\n    To solve this, in Active Record 6.1 the behavior was changed to instead rollback the transaction as it was safer\n    than to potentially commit an incomplete transaction.\n\n    Using `return`, `break` or `throw` inside a `transaction` block was essentially deprecated from Rails 6.1 onwards.\n\n    However with the release of `timeout 0.4.0`, `Timeout.timeout` now raises an error again, and Active Record is able\n    to return to its original, less surprising, behavior.\n\n    This historical behavior can now be opt-ed in via:\n\n    ```\n    Rails.application.config.active_record.commit_transaction_on_non_local_return = true\n    ```\n\n    And is the default for new applications created in Rails 7.1.\n\n    *Jean Boussier*",
    "project": "activerecord",
    "date_merged": 1688979341000,
    "author": "Jean Boussier",
    "sha": "5fbaa524b9921714e73c978336e5167f9d521613",
    "pr": "48600",
    "merge_sha": "7b52f569c1a05d3c988540a2fc1ccef40165a59c",
    "html": "<p>Bring back the historical behavior of committing transaction on non-local return.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">Model</span><span class=\"p\">.</span><span class=\"nf\">transaction</span> <span class=\"k\">do</span>\n  <span class=\"n\">model</span><span class=\"p\">.</span><span class=\"nf\">save</span>\n  <span class=\"k\">return</span>\n  <span class=\"n\">other_model</span><span class=\"p\">.</span><span class=\"nf\">save</span> <span class=\"c1\"># not executed</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p>Historically only raised errors would trigger a rollback, but in Ruby <code>2.3</code>, the <code>timeout</code> library<br />\nstarted using <code>throw</code> to interrupt execution which had the adverse effect of committing open transactions.</p>\n\n<p>To solve this, in Active Record 6.1 the behavior was changed to instead rollback the transaction as it was safer<br />\nthan to potentially commit an incomplete transaction.</p>\n\n<p>Using <code>return</code>, <code>break</code> or <code>throw</code> inside a <code>transaction</code> block was essentially deprecated from Rails 6.1 onwards.</p>\n\n<p>However with the release of <code>timeout 0.4.0</code>, <code>Timeout.timeout</code> now raises an error again, and Active Record is able<br />\nto return to its original, less surprising, behavior.</p>\n\n<p>This historical behavior can now be opt-ed in via:</p>\n\n<pre><code>Rails.application.config.active_record.commit_transaction_on_non_local_return = true\n</code></pre>\n\n<p>And is the default for new applications created in Rails 7.1.</p>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   Deprecate `name` argument on `#remove_connection`.\n\n    The `name` argument is deprecated on `#remove_connection` without replacement. `#remove_connection` should be called directly on the class that established the connection.\n\n    *Eileen M. Uchitelle*",
    "project": "activerecord",
    "date_merged": 1688674520000,
    "author": "eileencodes",
    "sha": "b69fa80b66d19f1c571b799240b251607fab6afc",
    "pr": "48681",
    "merge_sha": "e79250cb2691da099387e00d334250bec43ced5d",
    "html": "<p>Deprecate <code>name</code> argument on <code>#remove_connection</code>.</p>\n\n<p>The <code>name</code> argument is deprecated on <code>#remove_connection</code> without replacement. <code>#remove_connection</code> should be called directly on the class that established the connection.</p>\n\n<p><em>Eileen M. Uchitelle</em></p>\n"
  },
  {
    "message": "*   Fix has_one through singular building with inverse.\n\n    Allows building of records from an association with a has_one through a\n    singular association with inverse. For belongs_to through associations,\n    linking the foreign key to the primary key model isn't needed.\n    For has_one, we cannot build records due to the association not being mutable.\n\n    *Gannon McGibbon*",
    "project": "activerecord",
    "date_merged": 1688648968000,
    "author": "Gannon McGibbon",
    "sha": "68e0dd2c83cbed90c10b2dbcbebcc60b29b00fd4",
    "pr": "48674",
    "merge_sha": "fc1886757d832db1216f19dde954b66ddc3b3bed",
    "html": "<p>Fix has_one through singular building with inverse.</p>\n\n<p>Allows building of records from an association with a has_one through a<br />\nsingular association with inverse. For belongs_to through associations,<br />\nlinking the foreign key to the primary key model isn’t needed.<br />\nFor has_one, we cannot build records due to the association not being mutable.</p>\n\n<p><em>Gannon McGibbon</em></p>\n"
  },
  {
    "message": "*   Disable database prepared statements when query logs are enabled\n\n    Prepared Statements and Query Logs are incompatible features due to query logs making every query unique.\n\n    *zzak, Jean Boussier*",
    "project": "activerecord",
    "date_merged": 1688380773000,
    "author": "zzak",
    "sha": "a234669d63d8d1fc8ab5b872712dfa8ceab4257a",
    "pr": "48631",
    "merge_sha": "d08669292ca7b9058663ee77cbfa510aaacba21c",
    "html": "<p>Disable database prepared statements when query logs are enabled</p>\n\n<p>Prepared Statements and Query Logs are incompatible features due to query logs making every query unique.</p>\n\n<p><em>zzak, Jean Boussier</em></p>\n"
  },
  {
    "message": "*   Support decrypting data encrypted non-deterministically with a SHA1 hash digest.\n\n    This adds a new Active Record encryption option to support decrypting data encrypted\n    non-deterministically with a SHA1 hash digest:\n\n    ```\n    Rails.application.config.active_record.encryption.support_sha1_for_non_deterministic_encryption = true\n    ```\n\n    The new option addresses a problem when upgrading from 7.0 to 7.1. Due to a bug in how Active Record\n    Encryption was getting initialized, the key provider used for non-deterministic encryption were using\n    SHA-1 as its digest class, instead of the one configured globally by Rails via\n    `Rails.application.config.active_support.key_generator_hash_digest_class`.\n\n    *Cadu Ribeiro and Jorge Manrubia*",
    "project": "activerecord",
    "date_merged": 1687682590000,
    "author": "Jorge Manrubia",
    "sha": "c8d26bb647be3199907fca8e945ac7e1e82b0479",
    "pr": "48530",
    "merge_sha": "a35689a53391fb32224a4ceb738673cbc9365e79",
    "html": "<p>Support decrypting data encrypted non-deterministically with a SHA1 hash digest.</p>\n\n<p>This adds a new Active Record encryption option to support decrypting data encrypted<br />\nnon-deterministically with a SHA1 hash digest:</p>\n\n<pre><code>Rails.application.config.active_record.encryption.support_sha1_for_non_deterministic_encryption = true\n</code></pre>\n\n<p>The new option addresses a problem when upgrading from 7.0 to 7.1. Due to a bug in how Active Record<br />\nEncryption was getting initialized, the key provider used for non-deterministic encryption were using<br />\nSHA-1 as its digest class, instead of the one configured globally by Rails via<br />\n<code>Rails.application.config.active_support.key_generator_hash_digest_class</code>.</p>\n\n<p><em>Cadu Ribeiro and Jorge Manrubia</em></p>\n"
  },
  {
    "message": "*   Added PostgreSQL migration commands for enum rename, add value, and rename value.\n\n    `rename_enum` and `rename_enum_value` are reversible. Due to Postgres\n    limitation, `add_enum_value` is not reversible since you cannot delete enum\n    values. As an alternative you should drop and recreate the enum entirely.\n\n    ```ruby\n    rename_enum :article_status, to: :article_state\n    ```\n\n    ```ruby\n    add_enum_value :article_state, \"archived\" # will be at the end of existing values\n    add_enum_value :article_state, \"in review\", before: \"published\"\n    add_enum_value :article_state, \"approved\", after: \"in review\"\n    ```\n\n    ```ruby\n    rename_enum_value :article_state, from: \"archived\", to: \"deleted\"\n    ```\n\n    *Ray Faddis*",
    "project": "activerecord",
    "date_merged": 1686840343000,
    "author": "Ray Faddis",
    "sha": "ce6047f84f1b88a91074505f9363842f81ce31a6",
    "pr": "44898",
    "merge_sha": "dfc365949b1b18f8a25eb4eec696982442ed28f7",
    "html": "<p>Added PostgreSQL migration commands for enum rename, add value, and rename value.</p>\n\n<p><code>rename_enum</code> and <code>rename_enum_value</code> are reversible. Due to Postgres<br />\nlimitation, <code>add_enum_value</code> is not reversible since you cannot delete enum<br />\nvalues. As an alternative you should drop and recreate the enum entirely.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">rename_enum</span> <span class=\"ss\">:article_status</span><span class=\"p\">,</span> <span class=\"ss\">to: :article_state</span>\n</code></pre></div></div>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">add_enum_value</span> <span class=\"ss\">:article_state</span><span class=\"p\">,</span> <span class=\"s2\">\"archived\"</span> <span class=\"c1\"># will be at the end of existing values</span>\n<span class=\"n\">add_enum_value</span> <span class=\"ss\">:article_state</span><span class=\"p\">,</span> <span class=\"s2\">\"in review\"</span><span class=\"p\">,</span> <span class=\"ss\">before: </span><span class=\"s2\">\"published\"</span>\n<span class=\"n\">add_enum_value</span> <span class=\"ss\">:article_state</span><span class=\"p\">,</span> <span class=\"s2\">\"approved\"</span><span class=\"p\">,</span> <span class=\"ss\">after: </span><span class=\"s2\">\"in review\"</span>\n</code></pre></div></div>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">rename_enum_value</span> <span class=\"ss\">:article_state</span><span class=\"p\">,</span> <span class=\"ss\">from: </span><span class=\"s2\">\"archived\"</span><span class=\"p\">,</span> <span class=\"ss\">to: </span><span class=\"s2\">\"deleted\"</span>\n</code></pre></div></div>\n\n<p><em>Ray Faddis</em></p>\n"
  },
  {
    "message": "*   Allow composite primary key to be derived from schema\n\n    Booting an application with a schema that contains composite primary keys\n    will not issue warning and won't `nil`ify the `ActiveRecord::Base#primary_key` value anymore.\n\n    Given a `travel_routes` table definition and a `TravelRoute` model like:\n    ```ruby\n    create_table :travel_routes, primary_key: [:origin, :destination], force: true do |t|\n      t.string :origin\n      t.string :destination\n    end\n\n    class TravelRoute < ActiveRecord::Base; end\n    ```\n    The `TravelRoute.primary_key` value will be automatically derived to `[\"origin\", \"destination\"]`\n\n    *Nikita Vasilevsky*",
    "project": "activerecord",
    "date_merged": 1686063687000,
    "author": "Nikita Vasilevsky",
    "sha": "257f0124fc52b0ed9d3bcd51d55c55dd7bb4a194",
    "pr": "47633",
    "merge_sha": "791f109d97a38f8b9fe8a8c3d6d0a7acd70f1edb",
    "html": "<p>Allow composite primary key to be derived from schema</p>\n\n<p>Booting an application with a schema that contains composite primary keys<br />\nwill not issue warning and won’t <code>nil</code>ify the <code>ActiveRecord::Base#primary_key</code> value anymore.</p>\n\n<p>Given a <code>travel_routes</code> table definition and a <code>TravelRoute</code> model like:</p>\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">create_table</span> <span class=\"ss\">:travel_routes</span><span class=\"p\">,</span> <span class=\"ss\">primary_key: </span><span class=\"p\">[</span><span class=\"ss\">:origin</span><span class=\"p\">,</span> <span class=\"ss\">:destination</span><span class=\"p\">],</span> <span class=\"ss\">force: </span><span class=\"kp\">true</span> <span class=\"k\">do</span> <span class=\"o\">|</span><span class=\"n\">t</span><span class=\"o\">|</span>\n  <span class=\"n\">t</span><span class=\"p\">.</span><span class=\"nf\">string</span> <span class=\"ss\">:origin</span>\n  <span class=\"n\">t</span><span class=\"p\">.</span><span class=\"nf\">string</span> <span class=\"ss\">:destination</span>\n<span class=\"k\">end</span>\n\n<span class=\"k\">class</span> <span class=\"nc\">TravelRoute</span> <span class=\"o\">&lt;</span> <span class=\"no\">ActiveRecord</span><span class=\"o\">::</span><span class=\"no\">Base</span><span class=\"p\">;</span> <span class=\"k\">end</span>\n</code></pre></div></div>\n<p>The <code>TravelRoute.primary_key</code> value will be automatically derived to <code>[\"origin\", \"destination\"]</code></p>\n\n<p><em>Nikita Vasilevsky</em></p>\n"
  },
  {
    "message": "*   Include the `connection_pool` with exceptions raised from an adapter.\n\n    The `connection_pool` provides added context such as the connection used\n    that led to the exception as well as which role and shard.\n\n    *Luan Vieira*",
    "project": "activerecord",
    "date_merged": 1686049435000,
    "author": "Luan Vieira",
    "sha": "7d4c88dde305bd6f7d14b68c43bdaedf06812f8d",
    "pr": "48295",
    "merge_sha": "3e01b26a16857c83ba0507e1533f02bda4a5d516",
    "html": "<p>Include the <code>connection_pool</code> with exceptions raised from an adapter.</p>\n\n<p>The <code>connection_pool</code> provides added context such as the connection used<br />\nthat led to the exception as well as which role and shard.</p>\n\n<p><em>Luan Vieira</em></p>\n"
  },
  {
    "message": "*   Support multiple column ordering for `find_each`, `find_in_batches` and `in_batches`.\n\n    When find_each/find_in_batches/in_batches are performed on a table with composite primary keys, ascending or descending order can be selected for each key.\n\n    ```ruby\n    Person.find_each(order: [:desc, :asc]) do |person|\n      person.party_all_night!\n    end\n    ```\n\n    *Takuya Kurimoto*",
    "project": "activerecord",
    "date_merged": 1685986367000,
    "author": "takuyaK",
    "sha": "9452b59506663255d2ce04f1cc46ea7e22bacf67",
    "pr": "48268",
    "merge_sha": "acd02a22f43e3c73d1de92aed34d6b74af3cfcbf",
    "html": "<p>Support multiple column ordering for <code>find_each</code>, <code>find_in_batches</code> and <code>in_batches</code>.</p>\n\n<p>When find_each/find_in_batches/in_batches are performed on a table with composite primary keys, ascending or descending order can be selected for each key.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">Person</span><span class=\"p\">.</span><span class=\"nf\">find_each</span><span class=\"p\">(</span><span class=\"ss\">order: </span><span class=\"p\">[</span><span class=\"ss\">:desc</span><span class=\"p\">,</span> <span class=\"ss\">:asc</span><span class=\"p\">])</span> <span class=\"k\">do</span> <span class=\"o\">|</span><span class=\"n\">person</span><span class=\"o\">|</span>\n  <span class=\"n\">person</span><span class=\"p\">.</span><span class=\"nf\">party_all_night!</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p><em>Takuya Kurimoto</em></p>\n"
  },
  {
    "message": "*   Fix where on association with has_one/has_many polymorphic relations.\n\n    Before:\n    ```ruby\n    Treasure.where(price_estimates: PriceEstimate.all)\n    #=> SELECT (...) WHERE \"treasures\".\"id\" IN (SELECT \"price_estimates\".\"estimate_of_id\" FROM \"price_estimates\")\n    ```\n\n    Later:\n    ```ruby\n    Treasure.where(price_estimates: PriceEstimate.all)\n    #=> SELECT (...) WHERE \"treasures\".\"id\" IN (SELECT \"price_estimates\".\"estimate_of_id\" FROM \"price_estimates\" WHERE \"price_estimates\".\"estimate_of_type\" = 'Treasure')\n    ```\n\n    *Lázaro Nixon*",
    "project": "activerecord",
    "date_merged": 1685689618000,
    "author": "Nixon",
    "sha": "aa41938e3a01a5a163d532d170caf5e132e75c66",
    "pr": "48362",
    "merge_sha": "5dd4dcbae3647cb4b37000bfe6273d6865bd6dc8",
    "html": "<p>Fix where on association with has_one/has_many polymorphic relations.</p>\n\n<p>Before:</p>\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">Treasure</span><span class=\"p\">.</span><span class=\"nf\">where</span><span class=\"p\">(</span><span class=\"ss\">price_estimates: </span><span class=\"no\">PriceEstimate</span><span class=\"p\">.</span><span class=\"nf\">all</span><span class=\"p\">)</span>\n<span class=\"c1\">#=&gt; SELECT (...) WHERE \"treasures\".\"id\" IN (SELECT \"price_estimates\".\"estimate_of_id\" FROM \"price_estimates\")</span>\n</code></pre></div></div>\n\n<p>Later:</p>\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">Treasure</span><span class=\"p\">.</span><span class=\"nf\">where</span><span class=\"p\">(</span><span class=\"ss\">price_estimates: </span><span class=\"no\">PriceEstimate</span><span class=\"p\">.</span><span class=\"nf\">all</span><span class=\"p\">)</span>\n<span class=\"c1\">#=&gt; SELECT (...) WHERE \"treasures\".\"id\" IN (SELECT \"price_estimates\".\"estimate_of_id\" FROM \"price_estimates\" WHERE \"price_estimates\".\"estimate_of_type\" = 'Treasure')</span>\n</code></pre></div></div>\n\n<p><em>Lázaro Nixon</em></p>\n"
  },
  {
    "message": "*   Assign auto populated columns on Active Record record creation.\n\n    Changes record creation logic to allow for the `auto_increment` column to be assigned\n    immediately after creation regardless of it's relation to the model's primary key.\n\n    The PostgreSQL adapter benefits the most from the change allowing for any number of auto-populated\n    columns to be assigned on the object immediately after row insertion utilizing the `RETURNING` statement.\n\n    *Nikita Vasilevsky*",
    "project": "activerecord",
    "date_merged": 1685661422000,
    "author": "eileencodes",
    "sha": "a6efde6cf648a5c4125c6677b775357cdc1c92f0",
    "pr": "48339",
    "merge_sha": "e94999fab862c2a22087c4bc6cd0a6f7dc4e4c98",
    "html": "<p>Assign auto populated columns on Active Record record creation.</p>\n\n<p>Changes record creation logic to allow for the <code>auto_increment</code> column to be assigned<br />\nimmediately after creation regardless of it’s relation to the model’s primary key.</p>\n\n<p>The PostgreSQL adapter benefits the most from the change allowing for any number of auto-populated<br />\ncolumns to be assigned on the object immediately after row insertion utilizing the <code>RETURNING</code> statement.</p>\n\n<p><em>Nikita Vasilevsky</em></p>\n"
  },
  {
    "message": "*   Use the first key in the `shards` hash from `connected_to` for the `default_shard`.\n\n    Some applications may not want to use `:default` as a shard name in their connection model. Unfortunately Active Record expects there to be a `:default` shard because it must assume a shard to get the right connection from the pool manager. Rather than force applications to manually set this, `connects_to` can infer the default shard name from the hash of shards and will now assume that the first shard is your default.\n\n    For example if your model looked like this:\n\n    ```ruby\n    class ShardRecord < ApplicationRecord\n      self.abstract_class = true\n\n      connects_to shards: {\n        shard_one: { writing: :shard_one },\n        shard_two: { writing: :shard_two }\n      }\n    ```\n\n    Then the `default_shard` for this class would be set to `shard_one`.\n\n    Fixes: #45390\n\n    *Eileen M. Uchitelle*",
    "project": "activerecord",
    "date_merged": 1685561397000,
    "author": "eileencodes",
    "sha": "0d41bfd3cc080dfff0c5af8fe40418f25e1c00c4",
    "pr": "48353",
    "merge_sha": "ced5e77936292cd557d71dadaf85c4cb0cf83df2",
    "html": "<p>Use the first key in the <code>shards</code> hash from <code>connected_to</code> for the <code>default_shard</code>.</p>\n\n<p>Some applications may not want to use <code>:default</code> as a shard name in their connection model. Unfortunately Active Record expects there to be a <code>:default</code> shard because it must assume a shard to get the right connection from the pool manager. Rather than force applications to manually set this, <code>connects_to</code> can infer the default shard name from the hash of shards and will now assume that the first shard is your default.</p>\n\n<p>For example if your model looked like this:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">class</span> <span class=\"nc\">ShardRecord</span> <span class=\"o\">&lt;</span> <span class=\"no\">ApplicationRecord</span>\n  <span class=\"nb\">self</span><span class=\"p\">.</span><span class=\"nf\">abstract_class</span> <span class=\"o\">=</span> <span class=\"kp\">true</span>\n\n  <span class=\"n\">connects_to</span> <span class=\"ss\">shards: </span><span class=\"p\">{</span>\n    <span class=\"ss\">shard_one: </span><span class=\"p\">{</span> <span class=\"ss\">writing: :shard_one</span> <span class=\"p\">},</span>\n    <span class=\"ss\">shard_two: </span><span class=\"p\">{</span> <span class=\"ss\">writing: :shard_two</span> <span class=\"p\">}</span>\n  <span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>Then the <code>default_shard</code> for this class would be set to <code>shard_one</code>.</p>\n\n<p>Fixes: #45390</p>\n\n<p><em>Eileen M. Uchitelle</em></p>\n"
  },
  {
    "message": "*   Fix mutation detection for serialized attributes backed by binary columns.\n\n    *Jean Boussier*",
    "project": "activerecord",
    "date_merged": 1684759459000,
    "author": "Jean Boussier",
    "sha": "108617eb74bde0056f05ccbffde4b922665f7633",
    "pr": "48274",
    "merge_sha": "12c92ebd32faed7b92d70ec9bc8700e1127768aa",
    "html": "<p>Fix mutation detection for serialized attributes backed by binary columns.</p>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   Add `ActiveRecord.disconnect_all!` method to immediately close all connections from all pools.\n\n    *Jean Boussier*",
    "project": "activerecord",
    "date_merged": 1684495277000,
    "author": "Jean Boussier",
    "sha": "f1b15971a54258a0c144139d74abd050ed51160e",
    "pr": "47856",
    "merge_sha": "068bf41acd7264a44faa3266ce8c7a6149dd6341",
    "html": "<p>Add <code>ActiveRecord.disconnect_all!</code> method to immediately close all connections from all pools.</p>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   Discard connections which may have been left in a transaction.\n\n    There are cases where, due to an error, `within_new_transaction` may unexpectedly leave a connection in an open transaction. In these cases the connection may be reused, and the following may occur:\n    - Writes appear to fail when they actually succeed.\n    - Writes appear to succeed when they actually fail.\n    - Reads return stale or uncommitted data.\n\n    Previously, the following case was detected:\n    - An error is encountered during the transaction, then another error is encountered while attempting to roll it back.\n\n    Now, the following additional cases are detected:\n    - An error is encountered just after successfully beginning a transaction.\n    - An error is encountered while committing a transaction, then another error is encountered while attempting to roll it back.\n    - An error is encountered while rolling back a transaction.\n\n    *Nick Dower*",
    "project": "activerecord",
    "date_merged": 1684032512000,
    "author": "Nick Dower",
    "sha": "bdd00158737a9dfc9b479b2eee2971dd40c7bd0d",
    "pr": "48200",
    "merge_sha": "d1028617c5875c2da08007c5db37425481db6737",
    "html": "<p>Discard connections which may have been left in a transaction.</p>\n\n<p>There are cases where, due to an error, <code>within_new_transaction</code> may unexpectedly leave a connection in an open transaction. In these cases the connection may be reused, and the following may occur:</p>\n<ul>\n  <li>Writes appear to fail when they actually succeed.</li>\n  <li>Writes appear to succeed when they actually fail.</li>\n  <li>Reads return stale or uncommitted data.</li>\n</ul>\n\n<p>Previously, the following case was detected:</p>\n<ul>\n  <li>An error is encountered during the transaction, then another error is encountered while attempting to roll it back.</li>\n</ul>\n\n<p>Now, the following additional cases are detected:</p>\n<ul>\n  <li>An error is encountered just after successfully beginning a transaction.</li>\n  <li>An error is encountered while committing a transaction, then another error is encountered while attempting to roll it back.</li>\n  <li>An error is encountered while rolling back a transaction.</li>\n</ul>\n\n<p><em>Nick Dower</em></p>\n"
  },
  {
    "message": "*   Active Record query cache now evicts least recently used entries\n\n    By default it only keeps the `100` most recently used queries.\n\n    The cache size can be configured via `database.yml`\n\n    ```yaml\n    development:\n      adapter: mysql2\n      query_cache: 200\n    ```\n\n    It can also be entirely disabled:\n\n    ```yaml\n    development:\n      adapter: mysql2\n      query_cache: false\n    ```\n\n    *Jean Boussier*",
    "project": "activerecord",
    "date_merged": 1683818462000,
    "author": "Olivier",
    "sha": "e394c38f3eed9c5b551999fc9ee654c061134293",
    "pr": "48192",
    "merge_sha": "511a18722aef64d6d5a0ac5fabbb540cc1733e8f",
    "html": "<p>Active Record query cache now evicts least recently used entries</p>\n\n<p>By default it only keeps the <code>100</code> most recently used queries.</p>\n\n<p>The cache size can be configured via <code>database.yml</code></p>\n\n<div class=\"language-yaml highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"na\">development</span><span class=\"pi\">:</span>\n  <span class=\"na\">adapter</span><span class=\"pi\">:</span> <span class=\"s\">mysql2</span>\n  <span class=\"na\">query_cache</span><span class=\"pi\">:</span> <span class=\"m\">200</span>\n</code></pre></div></div>\n\n<p>It can also be entirely disabled:</p>\n\n<div class=\"language-yaml highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"na\">development</span><span class=\"pi\">:</span>\n  <span class=\"na\">adapter</span><span class=\"pi\">:</span> <span class=\"s\">mysql2</span>\n  <span class=\"na\">query_cache</span><span class=\"pi\">:</span> <span class=\"no\">false</span>\n</code></pre></div></div>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   Deprecate `check_pending!` in favor of `check_all_pending!`.\n\n    `check_pending!` will only check for pending migrations on the current database connection or the one passed in. This has been deprecated in favor of `check_all_pending!` which will find all pending migrations for the database configurations in a given environment.\n\n    *Eileen M. Uchitelle*",
    "project": "activerecord",
    "date_merged": 1692281081000,
    "author": "Takumi Shotoku",
    "sha": "0e41e2cd8ea825479fdaf181a9518280b8fccc20",
    "pr": "48964",
    "merge_sha": "b56f938b5f0f7c044c30790fdf618adb88188dad",
    "html": "<p>Deprecate <code>check_pending!</code> in favor of <code>check_all_pending!</code>.</p>\n\n<p><code>check_pending!</code> will only check for pending migrations on the current database connection or the one passed in. This has been deprecated in favor of <code>check_all_pending!</code> which will find all pending migrations for the database configurations in a given environment.</p>\n\n<p><em>Eileen M. Uchitelle</em></p>\n"
  },
  {
    "message": "*   Make `increment_counter`/`decrement_counter` accept an amount argument\n\n    ```ruby\n    Post.increment_counter(:comments_count, 5, by: 3)\n    ```\n\n    *fatkodima*",
    "project": "activerecord",
    "date_merged": 1683288223000,
    "author": "fatkodima",
    "sha": "cabc1842b73e5e659ce114f0802e849080eb8894",
    "pr": "48128",
    "merge_sha": "2bfb6565a4996a19065e03300d9061e9eb265d92",
    "html": "<p>Make <code>increment_counter</code>/<code>decrement_counter</code> accept an amount argument</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">Post</span><span class=\"p\">.</span><span class=\"nf\">increment_counter</span><span class=\"p\">(</span><span class=\"ss\">:comments_count</span><span class=\"p\">,</span> <span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"ss\">by: </span><span class=\"mi\">3</span><span class=\"p\">)</span>\n</code></pre></div></div>\n\n<p><em>fatkodima</em></p>\n"
  },
  {
    "message": "*   Add support for `Array#intersect?` to `ActiveRecord::Relation`.\n\n    `Array#intersect?` is only available on Ruby 3.1 or later.\n\n    This allows the Rubocop `Style/ArrayIntersect` cop to work with `ActiveRecord::Relation` objects.\n\n    *John Harry Kelly*",
    "project": "activerecord",
    "date_merged": 1687381712000,
    "author": "Guillermo Iguaran",
    "sha": "d9f22a40e2bf3778b47a2d9fbb065bb7b10257d4",
    "pr": "48544",
    "merge_sha": "860967d8044b220ca8c38eadb119942583fa35c6",
    "html": "<p>Add support for <code>Array#intersect?</code> to <code>ActiveRecord::Relation</code>.</p>\n\n<p><code>Array#intersect?</code> is only available on Ruby 3.1 or later.</p>\n\n<p>This allows the Rubocop <code>Style/ArrayIntersect</code> cop to work with <code>ActiveRecord::Relation</code> objects.</p>\n\n<p><em>John Harry Kelly</em></p>\n"
  },
  {
    "message": "*   The deferrable foreign key can be passed to `t.references`.\n\n    *Hiroyuki Ishii*",
    "project": "activerecord",
    "date_merged": 1682561798000,
    "author": "alpaca-tc",
    "sha": "ec0a2a9d98cd45afd095b6eb2435d44f41335528",
    "pr": "47671",
    "merge_sha": "53df1e140d75efaffa63c1b058d8b17834e576a1",
    "html": "<p>The deferrable foreign key can be passed to <code>t.references</code>.</p>\n\n<p><em>Hiroyuki Ishii</em></p>\n"
  },
  {
    "message": "*   Deprecate `deferrable: true` option of `add_foreign_key`.\n\n    `deferrable: true` is deprecated in favor of `deferrable: :immediate`, and\n    will be removed in Rails 7.2.\n\n    Because `deferrable: true` and `deferrable: :deferred` are hard to understand.\n    Both true and :deferred are truthy values.\n    This behavior is the same as the deferrable option of the add_unique_key method, added in #46192.\n\n    *Hiroyuki Ishii*",
    "project": "activerecord",
    "date_merged": 1682552751000,
    "author": "alpaca-tc",
    "sha": "896d35910a3e5c7363533e63903902c4a7483f1e",
    "pr": "47659",
    "merge_sha": "992d689ae6f8acd1345ee8ca389a71f80e3455ef",
    "html": "<p>Deprecate <code>deferrable: true</code> option of <code>add_foreign_key</code>.</p>\n\n<p><code>deferrable: true</code> is deprecated in favor of <code>deferrable: :immediate</code>, and<br />\nwill be removed in Rails 7.2.</p>\n\n<p>Because <code>deferrable: true</code> and <code>deferrable: :deferred</code> are hard to understand.<br />\nBoth true and :deferred are truthy values.<br />\nThis behavior is the same as the deferrable option of the add_unique_key method, added in #46192.</p>\n\n<p><em>Hiroyuki Ishii</em></p>\n"
  },
  {
    "message": "*   `AbstractAdapter#execute` and `#exec_query` now clear the query cache\n\n    If you need to perform a read only SQL query without clearing the query\n    cache, use `AbstractAdapter#select_all`.\n\n    *Jean Boussier*",
    "project": "activerecord",
    "date_merged": 1684162988000,
    "author": "eileencodes",
    "sha": "942785fb8b03772dde338cc241af8e5de4d2efbc",
    "pr": "48188",
    "merge_sha": "d12f1a2f84128085ee0bdbbbe28df9ec27a9bc64",
    "html": "<p><code>AbstractAdapter#execute</code> and <code>#exec_query</code> now clear the query cache</p>\n\n<p>If you need to perform a read only SQL query without clearing the query<br />\ncache, use <code>AbstractAdapter#select_all</code>.</p>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   Make `.joins` / `.left_outer_joins` work with CTEs.\n\n    For example:\n\n    ```ruby\n    Post\n     .with(commented_posts: Comment.select(:post_id).distinct)\n     .joins(:commented_posts)\n    #=> WITH (...) SELECT ... INNER JOIN commented_posts on posts.id = commented_posts.post_id\n    ```\n\n    *Vladimir Dementyev*",
    "project": "activerecord",
    "date_merged": 1682447228000,
    "author": "Vladimir Dementyev",
    "sha": "92bb466dde04c73b7dda6d0094fe9cc7175310a6",
    "pr": "46843",
    "merge_sha": "fb4881270b80d5c3601efa94ebcfd9bca41b0c3b",
    "html": "<p>Make <code>.joins</code> / <code>.left_outer_joins</code> work with CTEs.</p>\n\n<p>For example:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">Post</span>\n <span class=\"p\">.</span><span class=\"nf\">with</span><span class=\"p\">(</span><span class=\"ss\">commented_posts: </span><span class=\"no\">Comment</span><span class=\"p\">.</span><span class=\"nf\">select</span><span class=\"p\">(</span><span class=\"ss\">:post_id</span><span class=\"p\">).</span><span class=\"nf\">distinct</span><span class=\"p\">)</span>\n <span class=\"p\">.</span><span class=\"nf\">joins</span><span class=\"p\">(</span><span class=\"ss\">:commented_posts</span><span class=\"p\">)</span>\n<span class=\"c1\">#=&gt; WITH (...) SELECT ... INNER JOIN commented_posts on posts.id = commented_posts.post_id</span>\n</code></pre></div></div>\n\n<p><em>Vladimir Dementyev</em></p>\n"
  },
  {
    "message": "*   Add a load hook for `ActiveRecord::ConnectionAdapters::Mysql2Adapter`\n    (named `active_record_mysql2adapter`) to allow for overriding aspects of the\n    `ActiveRecord::ConnectionAdapters::Mysql2Adapter` class. This makes `Mysql2Adapter`\n    consistent with `PostgreSQLAdapter` and `SQLite3Adapter` that already have load hooks.\n\n    *fatkodima*",
    "project": "activerecord",
    "date_merged": 1682117776000,
    "author": "fatkodima",
    "sha": "00b8ce6fe5a2ec92acb33bbc5814344d320ab39b",
    "pr": "48012",
    "merge_sha": "5beb0621fc42389f0000f293571bfbd4b1efe4d8",
    "html": "<p>Add a load hook for <code>ActiveRecord::ConnectionAdapters::Mysql2Adapter</code><br />\n(named <code>active_record_mysql2adapter</code>) to allow for overriding aspects of the<br />\n<code>ActiveRecord::ConnectionAdapters::Mysql2Adapter</code> class. This makes <code>Mysql2Adapter</code><br />\nconsistent with <code>PostgreSQLAdapter</code> and <code>SQLite3Adapter</code> that already have load hooks.</p>\n\n<p><em>fatkodima</em></p>\n"
  },
  {
    "message": "*   Introduce adapter for Trilogy database client\n\n    Trilogy is a MySQL-compatible database client. Rails applications can use Trilogy\n    by configuring their `config/database.yml`:\n\n    ```yaml\n    development:\n    adapter: trilogy\n    database: blog_development\n    pool: 5\n    ```\n\n    Or by using the `DATABASE_URL` environment variable:\n\n    ```ruby\n    ENV['DATABASE_URL'] # => \"trilogy://localhost/blog_development?pool=5\"\n    ```\n\n    *Adrianna Chang*",
    "project": "activerecord",
    "date_merged": 1681757809000,
    "author": "Adrianna Chang",
    "sha": "5ed3f60df67636ffba895d641cd4ee6e2ede40da",
    "pr": "47880",
    "merge_sha": "f7a40229e3bfb6c8858ae84f287144b227c9e601",
    "html": "<p>Introduce adapter for Trilogy database client</p>\n\n<p>Trilogy is a MySQL-compatible database client. Rails applications can use Trilogy<br />\nby configuring their <code>config/database.yml</code>:</p>\n\n<div class=\"language-yaml highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"na\">development</span><span class=\"pi\">:</span>\n<span class=\"na\">adapter</span><span class=\"pi\">:</span> <span class=\"s\">trilogy</span>\n<span class=\"na\">database</span><span class=\"pi\">:</span> <span class=\"s\">blog_development</span>\n<span class=\"na\">pool</span><span class=\"pi\">:</span> <span class=\"m\">5</span>\n</code></pre></div></div>\n\n<p>Or by using the <code>DATABASE_URL</code> environment variable:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">ENV</span><span class=\"p\">[</span><span class=\"s1\">'DATABASE_URL'</span><span class=\"p\">]</span> <span class=\"c1\"># =&gt; \"trilogy://localhost/blog_development?pool=5\"</span>\n</code></pre></div></div>\n\n<p><em>Adrianna Chang</em></p>\n"
  },
  {
    "message": "*   `after_commit` callbacks defined on models now execute in the correct order.\n\n    ```ruby\n    class User < ActiveRecord::Base\n      after_commit { puts(\"this gets called first\") }\n      after_commit { puts(\"this gets called second\") }\n    end\n    ```\n\n    Previously, the callbacks executed in the reverse order. To opt in to the new behaviour:\n\n    ```ruby\n    config.active_record.run_after_transaction_callbacks_in_order_defined = true\n    ```\n\n    This is the default for new apps.\n\n    *Alex Ghiculescu*",
    "project": "activerecord",
    "date_merged": 1680887555000,
    "author": "Alex Ghiculescu",
    "sha": "3bcd167c3ec8b8f0a73101884f29769a2e62731b",
    "pr": "46992",
    "merge_sha": "a9506eb06243d309472071a5d65a3307d15580d4",
    "html": "<p><code>after_commit</code> callbacks defined on models now execute in the correct order.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">class</span> <span class=\"nc\">User</span> <span class=\"o\">&lt;</span> <span class=\"no\">ActiveRecord</span><span class=\"o\">::</span><span class=\"no\">Base</span>\n  <span class=\"n\">after_commit</span> <span class=\"p\">{</span> <span class=\"nb\">puts</span><span class=\"p\">(</span><span class=\"s2\">\"this gets called first\"</span><span class=\"p\">)</span> <span class=\"p\">}</span>\n  <span class=\"n\">after_commit</span> <span class=\"p\">{</span> <span class=\"nb\">puts</span><span class=\"p\">(</span><span class=\"s2\">\"this gets called second\"</span><span class=\"p\">)</span> <span class=\"p\">}</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p>Previously, the callbacks executed in the reverse order. To opt in to the new behaviour:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">config</span><span class=\"p\">.</span><span class=\"nf\">active_record</span><span class=\"p\">.</span><span class=\"nf\">run_after_transaction_callbacks_in_order_defined</span> <span class=\"o\">=</span> <span class=\"kp\">true</span>\n</code></pre></div></div>\n\n<p>This is the default for new apps.</p>\n\n<p><em>Alex Ghiculescu</em></p>\n"
  },
  {
    "message": "*   Infer `foreign_key` when `inverse_of` is present on `has_one` and `has_many` associations.\n\n    ```ruby\n    has_many :citations, foreign_key: \"book1_id\", inverse_of: :book\n    ```\n\n    can be simplified to\n\n    ```ruby\n    has_many :citations, inverse_of: :book\n    ```\n\n    and the foreign_key will be read from the corresponding `belongs_to` association.\n\n    *Daniel Whitney*",
    "project": "activerecord",
    "date_merged": 1680277493000,
    "author": "Viktor Habchak",
    "sha": "0bbaee32bb3fe86f27548944f93a5b8f602736d6",
    "pr": "47834",
    "merge_sha": "68e107f2925a9071bd8edfb06a6e931e4fdfe067",
    "html": "<p>Infer <code>foreign_key</code> when <code>inverse_of</code> is present on <code>has_one</code> and <code>has_many</code> associations.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">has_many</span> <span class=\"ss\">:citations</span><span class=\"p\">,</span> <span class=\"ss\">foreign_key: </span><span class=\"s2\">\"book1_id\"</span><span class=\"p\">,</span> <span class=\"ss\">inverse_of: :book</span>\n</code></pre></div></div>\n\n<p>can be simplified to</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">has_many</span> <span class=\"ss\">:citations</span><span class=\"p\">,</span> <span class=\"ss\">inverse_of: :book</span>\n</code></pre></div></div>\n\n<p>and the foreign_key will be read from the corresponding <code>belongs_to</code> association.</p>\n\n<p><em>Daniel Whitney</em></p>\n"
  },
  {
    "message": "*   Limit max length of auto generated index names\n\n    Auto generated index names are now limited to 62 bytes, which fits within\n    the default index name length limits for MySQL, Postgres and SQLite.\n\n    Any index name over the limit will fallback to the new short format.\n\n    Before (too long):\n    ```\n    index_testings_on_foo_and_bar_and_first_name_and_last_name_and_administrator\n    ```\n\n    After (short format):\n    ```\n    idx_on_foo_bar_first_name_last_name_administrator_5939248142\n    ```\n\n    The short format includes a hash to ensure the name is unique database-wide.\n\n    *Mike Coutermarsh*",
    "project": "activerecord",
    "date_merged": 1680074703000,
    "author": "Mike Coutermarsh",
    "sha": "3682aa1016e187398a7ae65e521f24f38b710d2b",
    "pr": "47753",
    "merge_sha": "c792c71eb9df1e61088a23e64cfbbda040c6e15a",
    "html": "<p>Limit max length of auto generated index names</p>\n\n<p>Auto generated index names are now limited to 62 bytes, which fits within<br />\nthe default index name length limits for MySQL, Postgres and SQLite.</p>\n\n<p>Any index name over the limit will fallback to the new short format.</p>\n\n<p>Before (too long):</p>\n<pre><code>index_testings_on_foo_and_bar_and_first_name_and_last_name_and_administrator\n</code></pre>\n\n<p>After (short format):</p>\n<pre><code>idx_on_foo_bar_first_name_last_name_administrator_5939248142\n</code></pre>\n\n<p>The short format includes a hash to ensure the name is unique database-wide.</p>\n\n<p><em>Mike Coutermarsh</em></p>\n"
  },
  {
    "message": "*   Introduce a more stable and optimized Marshal serializer for Active Record models.\n\n    Can be enabled with `config.active_record.marshalling_format_version = 7.1`.\n\n    *Jean Boussier*",
    "project": "activerecord",
    "date_merged": 1680016763000,
    "author": "Jean Boussier",
    "sha": "dee93277e3c90fd9d71907c09f88a764df51c8b4",
    "pr": "47747",
    "merge_sha": "73aa044ed594baf759a776e1626f2289bd4a4a8a",
    "html": "<p>Introduce a more stable and optimized Marshal serializer for Active Record models.</p>\n\n<p>Can be enabled with <code>config.active_record.marshalling_format_version = 7.1</code>.</p>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   Allow specifying where clauses with column-tuple syntax.\n\n    Querying through `#where` now accepts a new tuple-syntax which accepts, as\n    a key, an array of columns and, as a value, an array of corresponding tuples.\n    The key specifies a list of columns, while the value is an array of\n    ordered-tuples that conform to the column list.\n\n    For instance:\n\n    ```ruby\n    # Cpk::Book => Cpk::Book(author_id: integer, number: integer, title: string, revision: integer)\n    # Cpk::Book.primary_key => [\"author_id\", \"number\"]\n\n    book = Cpk::Book.create!(author_id: 1, number: 1)\n    Cpk::Book.where(Cpk::Book.primary_key => [[1, 2]]) # => [book]\n\n    # Topic => Topic(id: integer, title: string, author_name: string...)\n\n    Topic.where([:title, :author_name] => [[\"The Alchemist\", \"Paul Coelho\"], [\"Harry Potter\", \"J.K Rowling\"]])\n    ```\n\n    *Paarth Madan*",
    "project": "activerecord",
    "date_merged": 1679519322000,
    "author": "Paarth Madan",
    "sha": "e39e013cf7abae9d4861350c6a1f81e605012715",
    "pr": "47729",
    "merge_sha": "2cef3ac45bd85e1642b1270ab4fa31629044c962",
    "html": "<p>Allow specifying where clauses with column-tuple syntax.</p>\n\n<p>Querying through <code>#where</code> now accepts a new tuple-syntax which accepts, as<br />\na key, an array of columns and, as a value, an array of corresponding tuples.<br />\nThe key specifies a list of columns, while the value is an array of<br />\nordered-tuples that conform to the column list.</p>\n\n<p>For instance:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># Cpk::Book =&gt; Cpk::Book(author_id: integer, number: integer, title: string, revision: integer)</span>\n<span class=\"c1\"># Cpk::Book.primary_key =&gt; [\"author_id\", \"number\"]</span>\n\n<span class=\"n\">book</span> <span class=\"o\">=</span> <span class=\"no\">Cpk</span><span class=\"o\">::</span><span class=\"no\">Book</span><span class=\"p\">.</span><span class=\"nf\">create!</span><span class=\"p\">(</span><span class=\"ss\">author_id: </span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"ss\">number: </span><span class=\"mi\">1</span><span class=\"p\">)</span>\n<span class=\"no\">Cpk</span><span class=\"o\">::</span><span class=\"no\">Book</span><span class=\"p\">.</span><span class=\"nf\">where</span><span class=\"p\">(</span><span class=\"no\">Cpk</span><span class=\"o\">::</span><span class=\"no\">Book</span><span class=\"p\">.</span><span class=\"nf\">primary_key</span> <span class=\"o\">=&gt;</span> <span class=\"p\">[[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">]])</span> <span class=\"c1\"># =&gt; [book]</span>\n\n<span class=\"c1\"># Topic =&gt; Topic(id: integer, title: string, author_name: string...)</span>\n\n<span class=\"no\">Topic</span><span class=\"p\">.</span><span class=\"nf\">where</span><span class=\"p\">([</span><span class=\"ss\">:title</span><span class=\"p\">,</span> <span class=\"ss\">:author_name</span><span class=\"p\">]</span> <span class=\"o\">=&gt;</span> <span class=\"p\">[[</span><span class=\"s2\">\"The Alchemist\"</span><span class=\"p\">,</span> <span class=\"s2\">\"Paul Coelho\"</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"s2\">\"Harry Potter\"</span><span class=\"p\">,</span> <span class=\"s2\">\"J.K Rowling\"</span><span class=\"p\">]])</span>\n</code></pre></div></div>\n\n<p><em>Paarth Madan</em></p>\n"
  },
  {
    "message": "*   Allow warning codes to be ignore when reporting SQL warnings.\n\n    Active Record config that can ignore warning codes\n\n    ```ruby\n    # Configure allowlist of warnings that should always be ignored\n    config.active_record.db_warnings_ignore = [\n      \"1062\", # MySQL Error 1062: Duplicate entry\n    ]\n    ```\n\n    This is supported for the MySQL and PostgreSQL adapters.\n\n    *Nick Borromeo*",
    "project": "activerecord",
    "date_merged": 1679368129000,
    "author": "Nick Borromeo",
    "sha": "6bd100711c0e6ce5b29a76dc641a36d21851ef6c",
    "pr": "47650",
    "merge_sha": "05cb63abdaf6101e6c8fb43119e2c0d08e543c28",
    "html": "<p>Allow warning codes to be ignore when reporting SQL warnings.</p>\n\n<p>Active Record config that can ignore warning codes</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># Configure allowlist of warnings that should always be ignored</span>\n<span class=\"n\">config</span><span class=\"p\">.</span><span class=\"nf\">active_record</span><span class=\"p\">.</span><span class=\"nf\">db_warnings_ignore</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n  <span class=\"s2\">\"1062\"</span><span class=\"p\">,</span> <span class=\"c1\"># MySQL Error 1062: Duplicate entry</span>\n<span class=\"p\">]</span>\n</code></pre></div></div>\n\n<p>This is supported for the MySQL and PostgreSQL adapters.</p>\n\n<p><em>Nick Borromeo</em></p>\n"
  },
  {
    "message": "*   Introduce `:active_record_fixtures` lazy load hook.\n\n    Hooks defined with this name will be run whenever `TestFixtures` is included\n    in a class.\n\n    ```ruby\n    ActiveSupport.on_load(:active_record_fixtures) do\n      self.fixture_paths << \"test/fixtures\"\n    end\n\n    klass = Class.new\n    klass.include(ActiveRecord::TestFixtures)\n\n    klass.fixture_paths # => [\"test/fixtures\"]\n    ```\n\n    *Andrew Novoselac*",
    "project": "activerecord",
    "date_merged": 1679076652000,
    "author": "Andrew Novoselac",
    "sha": "49283adc1663b8a65d1062540ba731fe00cecbcf",
    "pr": "47690",
    "merge_sha": "e23e1718ead861ae43004f5706ddad780a440359",
    "html": "<p>Introduce <code>:active_record_fixtures</code> lazy load hook.</p>\n\n<p>Hooks defined with this name will be run whenever <code>TestFixtures</code> is included<br />\nin a class.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">ActiveSupport</span><span class=\"p\">.</span><span class=\"nf\">on_load</span><span class=\"p\">(</span><span class=\"ss\">:active_record_fixtures</span><span class=\"p\">)</span> <span class=\"k\">do</span>\n  <span class=\"nb\">self</span><span class=\"p\">.</span><span class=\"nf\">fixture_paths</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s2\">\"test/fixtures\"</span>\n<span class=\"k\">end</span>\n\n<span class=\"n\">klass</span> <span class=\"o\">=</span> <span class=\"no\">Class</span><span class=\"p\">.</span><span class=\"nf\">new</span>\n<span class=\"n\">klass</span><span class=\"p\">.</span><span class=\"nf\">include</span><span class=\"p\">(</span><span class=\"no\">ActiveRecord</span><span class=\"o\">::</span><span class=\"no\">TestFixtures</span><span class=\"p\">)</span>\n\n<span class=\"n\">klass</span><span class=\"p\">.</span><span class=\"nf\">fixture_paths</span> <span class=\"c1\"># =&gt; [\"test/fixtures\"]</span>\n</code></pre></div></div>\n\n<p><em>Andrew Novoselac</em></p>\n"
  },
  {
    "message": "*   Introduce `TestFixtures#fixture_paths`.\n\n    Multiple fixture paths can now be specified using the `#fixture_paths` accessor.\n    Apps will continue to have `test/fixtures` as their one fixture path by default,\n    but additional fixture paths can be specified.\n\n    ```ruby\n    ActiveSupport::TestCase.fixture_paths << \"component1/test/fixtures\"\n    ActiveSupport::TestCase.fixture_paths << \"component2/test/fixtures\"\n    ```\n\n    `TestFixtures#fixture_path` is now deprecated.\n\n    *Andrew Novoselac*",
    "project": "activerecord",
    "date_merged": 1678885544000,
    "author": "Andrew Novoselac",
    "sha": "6902cbce1b3ea7babab588171d413b9b78cb3f0f",
    "pr": "47675",
    "merge_sha": "74554cde8b96f6b9ae3e0b31ffb37783d4f56d10",
    "html": "<p>Introduce <code>TestFixtures#fixture_paths</code>.</p>\n\n<p>Multiple fixture paths can now be specified using the <code>#fixture_paths</code> accessor.<br />\nApps will continue to have <code>test/fixtures</code> as their one fixture path by default,<br />\nbut additional fixture paths can be specified.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">ActiveSupport</span><span class=\"o\">::</span><span class=\"no\">TestCase</span><span class=\"p\">.</span><span class=\"nf\">fixture_paths</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s2\">\"component1/test/fixtures\"</span>\n<span class=\"no\">ActiveSupport</span><span class=\"o\">::</span><span class=\"no\">TestCase</span><span class=\"p\">.</span><span class=\"nf\">fixture_paths</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s2\">\"component2/test/fixtures\"</span>\n</code></pre></div></div>\n\n<p><code>TestFixtures#fixture_path</code> is now deprecated.</p>\n\n<p><em>Andrew Novoselac</em></p>\n"
  },
  {
    "message": "*   Adds support for deferrable exclude constraints in PostgreSQL.\n\n    By default, exclude constraints in PostgreSQL are checked after each statement.\n    This works for most use cases, but becomes a major limitation when replacing\n    records with overlapping ranges by using multiple statements.\n\n    ```ruby\n    exclusion_constraint :users, \"daterange(valid_from, valid_to) WITH &&\", deferrable: :immediate\n    ```\n\n    Passing `deferrable: :immediate` checks constraint after each statement,\n    but allows manually deferring the check using `SET CONSTRAINTS ALL DEFERRED`\n    within a transaction. This will cause the excludes to be checked after the transaction.\n\n    It's also possible to change the default behavior from an immediate check\n    (after the statement), to a deferred check (after the transaction):\n\n    ```ruby\n    exclusion_constraint :users, \"daterange(valid_from, valid_to) WITH &&\", deferrable: :deferred\n    ```\n\n    *Hiroyuki Ishii*",
    "project": "activerecord",
    "date_merged": 1678836421000,
    "author": "alpaca-tc",
    "sha": "cbc7b59749d582f6529b085ad7facee0a0c0623f",
    "pr": "47655",
    "merge_sha": "126d2169d0e406be361e29ee547c26bdc7edaef2",
    "html": "<p>Adds support for deferrable exclude constraints in PostgreSQL.</p>\n\n<p>By default, exclude constraints in PostgreSQL are checked after each statement.<br />\nThis works for most use cases, but becomes a major limitation when replacing<br />\nrecords with overlapping ranges by using multiple statements.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">exclusion_constraint</span> <span class=\"ss\">:users</span><span class=\"p\">,</span> <span class=\"s2\">\"daterange(valid_from, valid_to) WITH &amp;&amp;\"</span><span class=\"p\">,</span> <span class=\"ss\">deferrable: :immediate</span>\n</code></pre></div></div>\n\n<p>Passing <code>deferrable: :immediate</code> checks constraint after each statement,<br />\nbut allows manually deferring the check using <code>SET CONSTRAINTS ALL DEFERRED</code><br />\nwithin a transaction. This will cause the excludes to be checked after the transaction.</p>\n\n<p>It’s also possible to change the default behavior from an immediate check<br />\n(after the statement), to a deferred check (after the transaction):</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">exclusion_constraint</span> <span class=\"ss\">:users</span><span class=\"p\">,</span> <span class=\"s2\">\"daterange(valid_from, valid_to) WITH &amp;&amp;\"</span><span class=\"p\">,</span> <span class=\"ss\">deferrable: :deferred</span>\n</code></pre></div></div>\n\n<p><em>Hiroyuki Ishii</em></p>\n"
  },
  {
    "message": "*   Respect `foreign_type` option to `delegated_type` for `{role}_class` method.\n\n    Usage of `delegated_type` with non-conventional `{role}_type` column names can now be specified with `foreign_type` option.\n    This option is the same as `foreign_type` as forwarded to the underlying `belongs_to` association that `delegated_type` wraps.\n\n    *Jason Karns*",
    "project": "activerecord",
    "date_merged": 1678802312000,
    "author": "Jason Karns",
    "sha": "1f61fd65ae1e73270154fa957b36c5a0773661c0",
    "pr": "45041",
    "merge_sha": "95fe1f3a99660dde2f3c63f52270caa8d9b15f9e",
    "html": "<p>Respect <code>foreign_type</code> option to <code>delegated_type</code> for <code>{role}_class</code> method.</p>\n\n<p>Usage of <code>delegated_type</code> with non-conventional <code>{role}_type</code> column names can now be specified with <code>foreign_type</code> option.<br />\nThis option is the same as <code>foreign_type</code> as forwarded to the underlying <code>belongs_to</code> association that <code>delegated_type</code> wraps.</p>\n\n<p><em>Jason Karns</em></p>\n"
  },
  {
    "message": "*   Add support for unique constraints (PostgreSQL-only).\n\n    ```ruby\n    add_unique_key :sections, [:position], deferrable: :deferred, name: \"unique_section_position\"\n    remove_unique_key :sections, name: \"unique_section_position\"\n    ```\n\n    See PostgreSQL's [Unique Constraints](https://www.postgresql.org/docs/current/ddl-constraints.html#DDL-CONSTRAINTS-UNIQUE-CONSTRAINTS) documentation for more on unique constraints.\n\n    By default, unique constraints in PostgreSQL are checked after each statement.\n    This works for most use cases, but becomes a major limitation when replacing\n    records with unique column by using multiple statements.\n\n    An example of swapping unique columns between records.\n\n    ```ruby\n    # position is unique column\n    old_item = Item.create!(position: 1)\n    new_item = Item.create!(position: 2)\n\n    Item.transaction do\n      old_item.update!(position: 2)\n      new_item.update!(position: 1)\n    end\n    ```\n\n    Using the default behavior, the transaction would fail when executing the\n    first `UPDATE` statement.\n\n    By passing the `:deferrable` option to the `add_unique_key` statement in\n    migrations, it's possible to defer this check.\n\n    ```ruby\n    add_unique_key :items, [:position], deferrable: :immediate\n    ```\n\n    Passing `deferrable: :immediate` does not change the behaviour of the previous example,\n    but allows manually deferring the check using `SET CONSTRAINTS ALL DEFERRED` within a transaction.\n    This will cause the unique constraints to be checked after the transaction.\n\n    It's also possible to adjust the default behavior from an immediate\n    check (after the statement), to a deferred check (after the transaction):\n\n    ```ruby\n    add_unique_key :items, [:position], deferrable: :deferred\n    ```\n\n    If you want to change an existing unique index to deferrable, you can use :using_index\n    to create deferrable unique constraints.\n\n    ```ruby\n    add_unique_key :items, deferrable: :deferred, using_index: \"index_items_on_position\"\n    ```\n\n    *Hiroyuki Ishii*",
    "project": "activerecord",
    "date_merged": 1678613498000,
    "author": "alpaca-tc",
    "sha": "d849ee04c66b12118586b02f98836afce2eda665",
    "pr": "46192",
    "merge_sha": "3025eaa09154f5f031f5c2e0e5b59553ff5c902b",
    "html": "<p>Add support for unique constraints (PostgreSQL-only).</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">add_unique_key</span> <span class=\"ss\">:sections</span><span class=\"p\">,</span> <span class=\"p\">[</span><span class=\"ss\">:position</span><span class=\"p\">],</span> <span class=\"ss\">deferrable: :deferred</span><span class=\"p\">,</span> <span class=\"ss\">name: </span><span class=\"s2\">\"unique_section_position\"</span>\n<span class=\"n\">remove_unique_key</span> <span class=\"ss\">:sections</span><span class=\"p\">,</span> <span class=\"ss\">name: </span><span class=\"s2\">\"unique_section_position\"</span>\n</code></pre></div></div>\n\n<p>See PostgreSQL’s <a href=\"https://www.postgresql.org/docs/current/ddl-constraints.html#DDL-CONSTRAINTS-UNIQUE-CONSTRAINTS\">Unique Constraints</a> documentation for more on unique constraints.</p>\n\n<p>By default, unique constraints in PostgreSQL are checked after each statement.<br />\nThis works for most use cases, but becomes a major limitation when replacing<br />\nrecords with unique column by using multiple statements.</p>\n\n<p>An example of swapping unique columns between records.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># position is unique column</span>\n<span class=\"n\">old_item</span> <span class=\"o\">=</span> <span class=\"no\">Item</span><span class=\"p\">.</span><span class=\"nf\">create!</span><span class=\"p\">(</span><span class=\"ss\">position: </span><span class=\"mi\">1</span><span class=\"p\">)</span>\n<span class=\"n\">new_item</span> <span class=\"o\">=</span> <span class=\"no\">Item</span><span class=\"p\">.</span><span class=\"nf\">create!</span><span class=\"p\">(</span><span class=\"ss\">position: </span><span class=\"mi\">2</span><span class=\"p\">)</span>\n\n<span class=\"no\">Item</span><span class=\"p\">.</span><span class=\"nf\">transaction</span> <span class=\"k\">do</span>\n  <span class=\"n\">old_item</span><span class=\"p\">.</span><span class=\"nf\">update!</span><span class=\"p\">(</span><span class=\"ss\">position: </span><span class=\"mi\">2</span><span class=\"p\">)</span>\n  <span class=\"n\">new_item</span><span class=\"p\">.</span><span class=\"nf\">update!</span><span class=\"p\">(</span><span class=\"ss\">position: </span><span class=\"mi\">1</span><span class=\"p\">)</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p>Using the default behavior, the transaction would fail when executing the<br />\nfirst <code>UPDATE</code> statement.</p>\n\n<p>By passing the <code>:deferrable</code> option to the <code>add_unique_key</code> statement in<br />\nmigrations, it’s possible to defer this check.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">add_unique_key</span> <span class=\"ss\">:items</span><span class=\"p\">,</span> <span class=\"p\">[</span><span class=\"ss\">:position</span><span class=\"p\">],</span> <span class=\"ss\">deferrable: :immediate</span>\n</code></pre></div></div>\n\n<p>Passing <code>deferrable: :immediate</code> does not change the behaviour of the previous example,<br />\nbut allows manually deferring the check using <code>SET CONSTRAINTS ALL DEFERRED</code> within a transaction.<br />\nThis will cause the unique constraints to be checked after the transaction.</p>\n\n<p>It’s also possible to adjust the default behavior from an immediate<br />\ncheck (after the statement), to a deferred check (after the transaction):</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">add_unique_key</span> <span class=\"ss\">:items</span><span class=\"p\">,</span> <span class=\"p\">[</span><span class=\"ss\">:position</span><span class=\"p\">],</span> <span class=\"ss\">deferrable: :deferred</span>\n</code></pre></div></div>\n\n<p>If you want to change an existing unique index to deferrable, you can use :using_index<br />\nto create deferrable unique constraints.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">add_unique_key</span> <span class=\"ss\">:items</span><span class=\"p\">,</span> <span class=\"ss\">deferrable: :deferred</span><span class=\"p\">,</span> <span class=\"ss\">using_index: </span><span class=\"s2\">\"index_items_on_position\"</span>\n</code></pre></div></div>\n\n<p><em>Hiroyuki Ishii</em></p>\n"
  },
  {
    "message": "*   Remove deprecated `Tasks::DatabaseTasks.schema_file_type`.\n\n    *Rafael Mendonça França*",
    "project": "activerecord",
    "date_merged": 1677805729000,
    "author": "Rafael Mendonça França",
    "sha": "049dfd4ccf22b9abc4283053ca8d38a6235c237e",
    "pr": "47556",
    "merge_sha": "dd7ecb073c67fee00e409049f02d72accece94a2",
    "html": "<p>Remove deprecated <code>Tasks::DatabaseTasks.schema_file_type</code>.</p>\n\n<p><em>Rafael Mendonça França</em></p>\n"
  },
  {
    "message": "*   Remove deprecated `config.active_record.partial_writes`.\n\n    *Rafael Mendonça França*",
    "project": "activerecord",
    "date_merged": 1677805729000,
    "author": "Rafael Mendonça França",
    "sha": "96b9fd6f140674c58e2b83740d8478cdb02236ad",
    "pr": "47556",
    "merge_sha": "dd7ecb073c67fee00e409049f02d72accece94a2",
    "html": "<p>Remove deprecated <code>config.active_record.partial_writes</code>.</p>\n\n<p><em>Rafael Mendonça França</em></p>\n"
  },
  {
    "message": "*   Remove deprecated `ActiveRecord::Base` config accessors.\n\n    *Rafael Mendonça França*",
    "project": "activerecord",
    "date_merged": 1677805729000,
    "author": "Rafael Mendonça França",
    "sha": "96c9db1b4829cb5d2f0e7054bec5a9c6b33f8725",
    "pr": "47556",
    "merge_sha": "dd7ecb073c67fee00e409049f02d72accece94a2",
    "html": "<p>Remove deprecated <code>ActiveRecord::Base</code> config accessors.</p>\n\n<p><em>Rafael Mendonça França</em></p>\n"
  },
  {
    "message": "*   Remove the `:include_replicas` argument from `configs_for`. Use `:include_hidden` argument instead.\n\n    *Eileen M. Uchitelle*",
    "project": "activerecord",
    "date_merged": 1677607326000,
    "author": "eileencodes",
    "sha": "232aed8504995df9ea2ddf136f5c45266fd542bb",
    "pr": "47536",
    "merge_sha": "5d0e443fe6542c7bacc569e4123eaebef0abcfc7",
    "html": "<p>Remove the <code>:include_replicas</code> argument from <code>configs_for</code>. Use <code>:include_hidden</code> argument instead.</p>\n\n<p><em>Eileen M. Uchitelle</em></p>\n"
  },
  {
    "message": "*   Allow applications to lookup a config via a custom hash key.\n\n    If you have registered a custom config or want to find configs where the hash matches a specific key, now you can pass `config_key` to `configs_for`. For example if you have a `db_config` with the key `vitess` you can look up a database configuration hash by  matching that key.\n\n    ```ruby\n    ActiveRecord::Base.configurations.configs_for(env_name: \"development\", name: \"primary\", config_key: :vitess)\n    ActiveRecord::Base.configurations.configs_for(env_name: \"development\", config_key: :vitess)\n    ```\n\n    *Eileen M. Uchitelle*",
    "project": "activerecord",
    "date_merged": 1677607326000,
    "author": "eileencodes",
    "sha": "232aed8504995df9ea2ddf136f5c45266fd542bb",
    "pr": "47536",
    "merge_sha": "5d0e443fe6542c7bacc569e4123eaebef0abcfc7",
    "html": "<p>Allow applications to lookup a config via a custom hash key.</p>\n\n<p>If you have registered a custom config or want to find configs where the hash matches a specific key, now you can pass <code>config_key</code> to <code>configs_for</code>. For example if you have a <code>db_config</code> with the key <code>vitess</code> you can look up a database configuration hash by  matching that key.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">ActiveRecord</span><span class=\"o\">::</span><span class=\"no\">Base</span><span class=\"p\">.</span><span class=\"nf\">configurations</span><span class=\"p\">.</span><span class=\"nf\">configs_for</span><span class=\"p\">(</span><span class=\"ss\">env_name: </span><span class=\"s2\">\"development\"</span><span class=\"p\">,</span> <span class=\"ss\">name: </span><span class=\"s2\">\"primary\"</span><span class=\"p\">,</span> <span class=\"ss\">config_key: :vitess</span><span class=\"p\">)</span>\n<span class=\"no\">ActiveRecord</span><span class=\"o\">::</span><span class=\"no\">Base</span><span class=\"p\">.</span><span class=\"nf\">configurations</span><span class=\"p\">.</span><span class=\"nf\">configs_for</span><span class=\"p\">(</span><span class=\"ss\">env_name: </span><span class=\"s2\">\"development\"</span><span class=\"p\">,</span> <span class=\"ss\">config_key: :vitess</span><span class=\"p\">)</span>\n</code></pre></div></div>\n\n<p><em>Eileen M. Uchitelle</em></p>\n"
  },
  {
    "message": "*   Allow applications to register a custom database configuration handler.\n\n    Adds a mechanism for registering a custom handler for cases where you want database configurations to respond to custom methods. This is useful for non-Rails database adapters or tools like Vitess that you may want to configure differently from a standard `HashConfig` or `UrlConfig`.\n\n    Given the following database YAML we want the `animals` db to create a `CustomConfig` object instead while the `primary` database will be a `UrlConfig`:\n\n    ```yaml\n    development:\n      primary:\n        url: postgres://localhost/primary\n      animals:\n        url: postgres://localhost/animals\n        custom_config:\n          sharded: 1\n    ```\n\n    To register a custom handler first make a class that has your custom methods:\n\n    ```ruby\n    class CustomConfig < ActiveRecord::DatabaseConfigurations::UrlConfig\n      def sharded?\n        custom_config.fetch(\"sharded\", false)\n      end\n\n      private\n        def custom_config\n          configuration_hash.fetch(:custom_config)\n        end\n    end\n    ```\n\n    Then register the config in an initializer:\n\n    ```ruby\n    ActiveRecord::DatabaseConfigurations.register_db_config_handler do |env_name, name, url, config|\n      next unless config.key?(:custom_config)\n      CustomConfig.new(env_name, name, url, config)\n    end\n    ```\n\n    When the application is booted, configuration hashes with the `:custom_config` key will be `CustomConfig` objects and respond to `sharded?`. Applications must handle the condition in which Active Record should use their custom handler.\n\n    *Eileen M. Uchitelle and John Crepezzi*",
    "project": "activerecord",
    "date_merged": 1677600088000,
    "author": "eileencodes",
    "sha": "3d004435b4a9f3e8159a0f1f10b440a3335fc1dd",
    "pr": "47522",
    "merge_sha": "b8a399cd6ffea47450586afbfccbba3ccac84859",
    "html": "<p>Allow applications to register a custom database configuration handler.</p>\n\n<p>Adds a mechanism for registering a custom handler for cases where you want database configurations to respond to custom methods. This is useful for non-Rails database adapters or tools like Vitess that you may want to configure differently from a standard <code>HashConfig</code> or <code>UrlConfig</code>.</p>\n\n<p>Given the following database YAML we want the <code>animals</code> db to create a <code>CustomConfig</code> object instead while the <code>primary</code> database will be a <code>UrlConfig</code>:</p>\n\n<div class=\"language-yaml highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"na\">development</span><span class=\"pi\">:</span>\n  <span class=\"na\">primary</span><span class=\"pi\">:</span>\n    <span class=\"na\">url</span><span class=\"pi\">:</span> <span class=\"s\">postgres://localhost/primary</span>\n  <span class=\"na\">animals</span><span class=\"pi\">:</span>\n    <span class=\"na\">url</span><span class=\"pi\">:</span> <span class=\"s\">postgres://localhost/animals</span>\n    <span class=\"na\">custom_config</span><span class=\"pi\">:</span>\n      <span class=\"na\">sharded</span><span class=\"pi\">:</span> <span class=\"m\">1</span>\n</code></pre></div></div>\n\n<p>To register a custom handler first make a class that has your custom methods:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">class</span> <span class=\"nc\">CustomConfig</span> <span class=\"o\">&lt;</span> <span class=\"no\">ActiveRecord</span><span class=\"o\">::</span><span class=\"no\">DatabaseConfigurations</span><span class=\"o\">::</span><span class=\"no\">UrlConfig</span>\n  <span class=\"k\">def</span> <span class=\"nf\">sharded?</span>\n    <span class=\"n\">custom_config</span><span class=\"p\">.</span><span class=\"nf\">fetch</span><span class=\"p\">(</span><span class=\"s2\">\"sharded\"</span><span class=\"p\">,</span> <span class=\"kp\">false</span><span class=\"p\">)</span>\n  <span class=\"k\">end</span>\n\n  <span class=\"kp\">private</span>\n    <span class=\"k\">def</span> <span class=\"nf\">custom_config</span>\n      <span class=\"n\">configuration_hash</span><span class=\"p\">.</span><span class=\"nf\">fetch</span><span class=\"p\">(</span><span class=\"ss\">:custom_config</span><span class=\"p\">)</span>\n    <span class=\"k\">end</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p>Then register the config in an initializer:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">ActiveRecord</span><span class=\"o\">::</span><span class=\"no\">DatabaseConfigurations</span><span class=\"p\">.</span><span class=\"nf\">register_db_config_handler</span> <span class=\"k\">do</span> <span class=\"o\">|</span><span class=\"n\">env_name</span><span class=\"p\">,</span> <span class=\"nb\">name</span><span class=\"p\">,</span> <span class=\"n\">url</span><span class=\"p\">,</span> <span class=\"n\">config</span><span class=\"o\">|</span>\n  <span class=\"k\">next</span> <span class=\"k\">unless</span> <span class=\"n\">config</span><span class=\"p\">.</span><span class=\"nf\">key?</span><span class=\"p\">(</span><span class=\"ss\">:custom_config</span><span class=\"p\">)</span>\n  <span class=\"no\">CustomConfig</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"n\">env_name</span><span class=\"p\">,</span> <span class=\"nb\">name</span><span class=\"p\">,</span> <span class=\"n\">url</span><span class=\"p\">,</span> <span class=\"n\">config</span><span class=\"p\">)</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p>When the application is booted, configuration hashes with the <code>:custom_config</code> key will be <code>CustomConfig</code> objects and respond to <code>sharded?</code>. Applications must handle the condition in which Active Record should use their custom handler.</p>\n\n<p><em>Eileen M. Uchitelle and John Crepezzi</em></p>\n"
  },
  {
    "message": "*   `ActiveRecord::Base.serialize` no longer uses YAML by default.\n\n    YAML isn't particularly performant and can lead to security issues\n    if not used carefully.\n\n    Unfortunately there isn't really any good serializers in Ruby's stdlib\n    to replace it.\n\n    The obvious choice would be JSON, which is a fine format for this use case,\n    however the JSON serializer in Ruby's stdlib isn't strict enough, as it fallback\n    to casting unknown types to strings, which could lead to corrupted data.\n\n    Some third party JSON libraries like `Oj` have a suitable strict mode.\n\n    So it's preferable that users choose a serializer based on their own constraints.\n\n    The original default can be restored by setting `config.active_record.default_column_serializer = YAML`.\n\n    *Jean Boussier*",
    "project": "activerecord",
    "date_merged": 1677288938000,
    "author": "Carlos Antonio da Silva",
    "sha": "0b328528784746650ac5f8b7d5e74c941c0051b7",
    "pr": "47492",
    "merge_sha": "b146cd473b5ad90c629d9350f0535d0bcf77febe",
    "html": "<p><code>ActiveRecord::Base.serialize</code> no longer uses YAML by default.</p>\n\n<p>YAML isn’t particularly performant and can lead to security issues<br />\nif not used carefully.</p>\n\n<p>Unfortunately there isn’t really any good serializers in Ruby’s stdlib<br />\nto replace it.</p>\n\n<p>The obvious choice would be JSON, which is a fine format for this use case,<br />\nhowever the JSON serializer in Ruby’s stdlib isn’t strict enough, as it fallback<br />\nto casting unknown types to strings, which could lead to corrupted data.</p>\n\n<p>Some third party JSON libraries like <code>Oj</code> have a suitable strict mode.</p>\n\n<p>So it’s preferable that users choose a serializer based on their own constraints.</p>\n\n<p>The original default can be restored by setting <code>config.active_record.default_column_serializer = YAML</code>.</p>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   `ActiveRecord::Base.serialize` signature changed.\n\n    Rather than a single positional argument that accepts two possible\n    types of values, `serialize` now accepts two distinct keyword arguments.\n\n    Before:\n\n    ```ruby\n      serialize :content, JSON\n      serialize :backtrace, Array\n    ```\n\n    After:\n\n    ```ruby\n      serialize :content, coder: JSON\n      serialize :backtrace, type: Array\n    ```\n\n    *Jean Boussier*",
    "project": "activerecord",
    "date_merged": 1677288938000,
    "author": "Carlos Antonio da Silva",
    "sha": "0b328528784746650ac5f8b7d5e74c941c0051b7",
    "pr": "47492",
    "merge_sha": "b146cd473b5ad90c629d9350f0535d0bcf77febe",
    "html": "<p><code>ActiveRecord::Base.serialize</code> signature changed.</p>\n\n<p>Rather than a single positional argument that accepts two possible<br />\ntypes of values, <code>serialize</code> now accepts two distinct keyword arguments.</p>\n\n<p>Before:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>  <span class=\"n\">serialize</span> <span class=\"ss\">:content</span><span class=\"p\">,</span> <span class=\"no\">JSON</span>\n  <span class=\"n\">serialize</span> <span class=\"ss\">:backtrace</span><span class=\"p\">,</span> <span class=\"no\">Array</span>\n</code></pre></div></div>\n\n<p>After:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>  <span class=\"n\">serialize</span> <span class=\"ss\">:content</span><span class=\"p\">,</span> <span class=\"ss\">coder: </span><span class=\"no\">JSON</span>\n  <span class=\"n\">serialize</span> <span class=\"ss\">:backtrace</span><span class=\"p\">,</span> <span class=\"ss\">type: </span><span class=\"no\">Array</span>\n</code></pre></div></div>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   YAML columns use `YAML.safe_dump` is available.\n\n    As of `psych 5.1.0`, `YAML.safe_dump` can now apply the same permitted\n    types restrictions than `YAML.safe_load`.\n\n    It's preferable to ensure the payload only use allowed types when we first\n    try to serialize it, otherwise you may end up with invalid records in the\n    database.\n\n    *Jean Boussier*",
    "project": "activerecord",
    "date_merged": 1676304881000,
    "author": "Jean Boussier",
    "sha": "3635d2d9cf15f1e404013e9207b3e5b80cfda59d",
    "pr": "47103",
    "merge_sha": "3bebf19f562ea85199753ca5a3737e09a7be4385",
    "html": "<p>YAML columns use <code>YAML.safe_dump</code> is available.</p>\n\n<p>As of <code>psych 5.1.0</code>, <code>YAML.safe_dump</code> can now apply the same permitted<br />\ntypes restrictions than <code>YAML.safe_load</code>.</p>\n\n<p>It’s preferable to ensure the payload only use allowed types when we first<br />\ntry to serialize it, otherwise you may end up with invalid records in the<br />\ndatabase.</p>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   `ActiveRecord::QueryLogs` better handle broken encoding.\n\n    It's not uncommon when building queries with BLOB fields to contain\n    binary data. Unless the call carefully encode the string in ASCII-8BIT\n    it generally end up being encoded in `UTF-8`, and `QueryLogs` would\n    end up failing on it.\n\n    `ActiveRecord::QueryLogs` no longer depend on the query to be properly encoded.\n\n    *Jean Boussier*",
    "project": "activerecord",
    "date_merged": 1675257648000,
    "author": "Jean Boussier",
    "sha": "0ff9beba87dea2e7ffb6ad0c87f1bcbd3fb59f7d",
    "pr": "47214",
    "merge_sha": "d3100066443080027f6e3e559cfbfe862d3ac971",
    "html": "<p><code>ActiveRecord::QueryLogs</code> better handle broken encoding.</p>\n\n<p>It’s not uncommon when building queries with BLOB fields to contain<br />\nbinary data. Unless the call carefully encode the string in ASCII-8BIT<br />\nit generally end up being encoded in <code>UTF-8</code>, and <code>QueryLogs</code> would<br />\nend up failing on it.</p>\n\n<p><code>ActiveRecord::QueryLogs</code> no longer depend on the query to be properly encoded.</p>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   Fix a bug where `ActiveRecord::Generators::ModelGenerator` would not respect create_table_migration template overrides.\n\n    ```\n    rails g model create_books title:string content:text\n    ```\n    will now read from the create_table_migration.rb.tt template in the following locations in order:\n    ```\n    lib/templates/active_record/model/create_table_migration.rb\n    lib/templates/active_record/migration/create_table_migration.rb\n    ```\n\n    *Spencer Neste*",
    "project": "activerecord",
    "date_merged": 1684970885000,
    "author": "Spencer Neste",
    "sha": "a8fe415f85a8372367001432babed65ae7a94c3f",
    "pr": "47181",
    "merge_sha": "8f9fb1e0420790b51b37cf543aa91864a6ec13da",
    "html": "<p>Fix a bug where <code>ActiveRecord::Generators::ModelGenerator</code> would not respect create_table_migration template overrides.</p>\n\n<pre><code>rails g model create_books title:string content:text\n</code></pre>\n<p>will now read from the create_table_migration.rb.tt template in the following locations in order:</p>\n<pre><code>lib/templates/active_record/model/create_table_migration.rb\nlib/templates/active_record/migration/create_table_migration.rb\n</code></pre>\n\n<p><em>Spencer Neste</em></p>\n"
  },
  {
    "message": "*   `ActiveRecord::Relation#explain` now accepts options.\n\n    For databases and adapters which support them (currently PostgreSQL\n    and MySQL), options can be passed to `explain` to provide more\n    detailed query plan analysis:\n\n    ```ruby\n    Customer.where(id: 1).joins(:orders).explain(:analyze, :verbose)\n    ```\n\n    *Reid Lynch*",
    "project": "activerecord",
    "date_merged": 1674579473000,
    "author": "Reid Lynch",
    "sha": "f61a6799023e00ea3308a899b2b9a7c996b9b2a8",
    "pr": "47043",
    "merge_sha": "cfed9600dd50c711e571a2dfc2c8675ea9f9895a",
    "html": "<p><code>ActiveRecord::Relation#explain</code> now accepts options.</p>\n\n<p>For databases and adapters which support them (currently PostgreSQL<br />\nand MySQL), options can be passed to <code>explain</code> to provide more<br />\ndetailed query plan analysis:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">Customer</span><span class=\"p\">.</span><span class=\"nf\">where</span><span class=\"p\">(</span><span class=\"ss\">id: </span><span class=\"mi\">1</span><span class=\"p\">).</span><span class=\"nf\">joins</span><span class=\"p\">(</span><span class=\"ss\">:orders</span><span class=\"p\">).</span><span class=\"nf\">explain</span><span class=\"p\">(</span><span class=\"ss\">:analyze</span><span class=\"p\">,</span> <span class=\"ss\">:verbose</span><span class=\"p\">)</span>\n</code></pre></div></div>\n\n<p><em>Reid Lynch</em></p>\n"
  },
  {
    "message": "*   Multiple `Arel::Nodes::SqlLiteral` nodes can now be added together to\n    form `Arel::Nodes::Fragments` nodes. This allows joining several pieces\n    of SQL.\n\n    *Matthew Draper*, *Ole Friis*",
    "project": "activerecord",
    "date_merged": 1674127568000,
    "author": "Ole Friis",
    "sha": "06ef7a95ac4e806cb6423caef15f7bf8a2ead889",
    "pr": "46948",
    "merge_sha": "b73fb939de66922ef3ca7ac68ddc8bd635c6dd3d",
    "html": "<p>Multiple <code>Arel::Nodes::SqlLiteral</code> nodes can now be added together to<br />\nform <code>Arel::Nodes::Fragments</code> nodes. This allows joining several pieces<br />\nof SQL.</p>\n\n<p><em>Matthew Draper</em>, <em>Ole Friis</em></p>\n"
  },
  {
    "message": "*   `ActiveRecord::Base#signed_id` raises if called on a new record.\n\n    Previously it would return an ID that was not usable, since it was based on `id = nil`.\n\n    *Alex Ghiculescu*",
    "project": "activerecord",
    "date_merged": 1677805729000,
    "author": "Rafael Mendonça França",
    "sha": "96c9db1b4829cb5d2f0e7054bec5a9c6b33f8725",
    "pr": "47556",
    "merge_sha": "dd7ecb073c67fee00e409049f02d72accece94a2",
    "html": "<p><code>ActiveRecord::Base#signed_id</code> raises if called on a new record.</p>\n\n<p>Previously it would return an ID that was not usable, since it was based on <code>id = nil</code>.</p>\n\n<p><em>Alex Ghiculescu</em></p>\n"
  },
  {
    "message": "*   Allow SQL warnings to be reported.\n\n    Active Record configs can be set to enable SQL warning reporting.\n\n    ```ruby\n    # Configure action to take when SQL query produces warning\n    config.active_record.db_warnings_action = :raise\n\n    # Configure allowlist of warnings that should always be ignored\n    config.active_record.db_warnings_ignore = [\n      /Invalid utf8mb4 character string/,\n      \"An exact warning message\",\n    ]\n    ```\n\n    This is supported for the MySQL and PostgreSQL adapters.\n\n    *Adrianna Chang*, *Paarth Madan*",
    "project": "activerecord",
    "date_merged": 1674026453000,
    "author": "Adrianna Chang",
    "sha": "56c56853245b880436b188197218fd6d8551e2fd",
    "pr": "46690",
    "merge_sha": "fc04ad8ce0f828d1b4bea45c807fef19e4784862",
    "html": "<p>Allow SQL warnings to be reported.</p>\n\n<p>Active Record configs can be set to enable SQL warning reporting.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># Configure action to take when SQL query produces warning</span>\n<span class=\"n\">config</span><span class=\"p\">.</span><span class=\"nf\">active_record</span><span class=\"p\">.</span><span class=\"nf\">db_warnings_action</span> <span class=\"o\">=</span> <span class=\"ss\">:raise</span>\n\n<span class=\"c1\"># Configure allowlist of warnings that should always be ignored</span>\n<span class=\"n\">config</span><span class=\"p\">.</span><span class=\"nf\">active_record</span><span class=\"p\">.</span><span class=\"nf\">db_warnings_ignore</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n  <span class=\"sr\">/Invalid utf8mb4 character string/</span><span class=\"p\">,</span>\n  <span class=\"s2\">\"An exact warning message\"</span><span class=\"p\">,</span>\n<span class=\"p\">]</span>\n</code></pre></div></div>\n\n<p>This is supported for the MySQL and PostgreSQL adapters.</p>\n\n<p><em>Adrianna Chang</em>, <em>Paarth Madan</em></p>\n"
  },
  {
    "message": "*   Add `#regroup` query method as a short-hand for `.unscope(:group).group(fields)`\n\n    Example:\n\n    ```ruby\n    Post.group(:title).regroup(:author)\n    # SELECT `posts`.`*` FROM `posts` GROUP BY `posts`.`author`\n    ```\n\n    *Danielius Visockas*",
    "project": "activerecord",
    "date_merged": 1673888962000,
    "author": "Danielius",
    "sha": "cfc01448320a001e66b5b5cc2f0974b8b66cf4bf",
    "pr": "47010",
    "merge_sha": "f519d71a9fa5b18a7b0ec36d84fda094ff7f4c35",
    "html": "<p>Add <code>#regroup</code> query method as a short-hand for <code>.unscope(:group).group(fields)</code></p>\n\n<p>Example:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">Post</span><span class=\"p\">.</span><span class=\"nf\">group</span><span class=\"p\">(</span><span class=\"ss\">:title</span><span class=\"p\">).</span><span class=\"nf\">regroup</span><span class=\"p\">(</span><span class=\"ss\">:author</span><span class=\"p\">)</span>\n<span class=\"c1\"># SELECT `posts`.`*` FROM `posts` GROUP BY `posts`.`author`</span>\n</code></pre></div></div>\n\n<p><em>Danielius Visockas</em></p>\n"
  },
  {
    "message": "*   PostgreSQL adapter method `enable_extension` now allows parameter to be `[schema_name.]<extension_name>`\n    if the extension must be installed on another schema.\n\n    Example: `enable_extension('heroku_ext.hstore')`\n\n    *Leonardo Luarte*",
    "project": "activerecord",
    "date_merged": 1673328529000,
    "author": "Leonardo Luarte González",
    "sha": "7e95d3e65367e2277c598e21656534ab06087d39",
    "pr": "46894",
    "merge_sha": "dcdd67162993046a6f3e62a25b7cdfda08afb180",
    "html": "<p>PostgreSQL adapter method <code>enable_extension</code> now allows parameter to be <code>[schema_name.]&lt;extension_name&gt;</code><br />\nif the extension must be installed on another schema.</p>\n\n<p>Example: <code>enable_extension('heroku_ext.hstore')</code></p>\n\n<p><em>Leonardo Luarte</em></p>\n"
  },
  {
    "message": "*   Add `:include` option to `add_index`.\n\n    Add support for including non-key columns in indexes for PostgreSQL\n    with the `INCLUDE` parameter.\n\n    ```ruby\n    add_index(:users, :email, include: [:id, :created_at])\n    ```\n\n    will result in:\n\n    ```sql\n    CREATE INDEX index_users_on_email USING btree (email) INCLUDE (id, created_at)\n    ```\n\n    *Steve Abrams*",
    "project": "activerecord",
    "date_merged": 1677057937000,
    "author": "zzak",
    "sha": "c7e444e3b085ab026ca4116955c6e91f0608ad23",
    "pr": "44803",
    "merge_sha": "ca6f2f16c1671b875f8a0590fadcdde459403bbe",
    "html": "<p>Add <code>:include</code> option to <code>add_index</code>.</p>\n\n<p>Add support for including non-key columns in indexes for PostgreSQL<br />\nwith the <code>INCLUDE</code> parameter.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">add_index</span><span class=\"p\">(</span><span class=\"ss\">:users</span><span class=\"p\">,</span> <span class=\"ss\">:email</span><span class=\"p\">,</span> <span class=\"ss\">include: </span><span class=\"p\">[</span><span class=\"ss\">:id</span><span class=\"p\">,</span> <span class=\"ss\">:created_at</span><span class=\"p\">])</span>\n</code></pre></div></div>\n\n<p>will result in:</p>\n\n<div class=\"language-sql highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">CREATE</span> <span class=\"k\">INDEX</span> <span class=\"n\">index_users_on_email</span> <span class=\"k\">USING</span> <span class=\"n\">btree</span> <span class=\"p\">(</span><span class=\"n\">email</span><span class=\"p\">)</span> <span class=\"n\">INCLUDE</span> <span class=\"p\">(</span><span class=\"n\">id</span><span class=\"p\">,</span> <span class=\"n\">created_at</span><span class=\"p\">)</span>\n</code></pre></div></div>\n\n<p><em>Steve Abrams</em></p>\n"
  },
  {
    "message": "*   `ActiveRecord::Relation`’s `#any?`, `#none?`, and `#one?` methods take an optional pattern\n    argument, more closely matching their `Enumerable` equivalents.\n\n    *George Claghorn*",
    "project": "activerecord",
    "date_merged": 1671696060000,
    "author": "George Claghorn",
    "sha": "827ae3c449d002ea1b569b931945d940f2b61939",
    "pr": "46728",
    "merge_sha": "ac541a6c3f943ee5cbaebecee3b9eda9075e984d",
    "html": "<p><code>ActiveRecord::Relation</code>’s <code>#any?</code>, <code>#none?</code>, and <code>#one?</code> methods take an optional pattern<br />\nargument, more closely matching their <code>Enumerable</code> equivalents.</p>\n\n<p><em>George Claghorn</em></p>\n"
  },
  {
    "message": "*   Add `ActiveRecord::Base::normalizes` to declare attribute normalizations.\n\n    A normalization is applied when the attribute is assigned or updated, and\n    the normalized value will be persisted to the database.  The normalization\n    is also applied to the corresponding keyword argument of finder methods.\n    This allows a record to be created and later queried using unnormalized\n    values.  For example:\n\n      ```ruby\n      class User < ActiveRecord::Base\n        normalizes :email, with: -> email { email.strip.downcase }\n        normalizes :phone, with: -> phone { phone.delete(\"^0-9\").delete_prefix(\"1\") }\n      end\n\n      user = User.create(email: \" CRUISE-CONTROL@EXAMPLE.COM\\n\")\n      user.email                  # => \"cruise-control@example.com\"\n\n      user = User.find_by(email: \"\\tCRUISE-CONTROL@EXAMPLE.COM \")\n      user.email                  # => \"cruise-control@example.com\"\n      user.email_before_type_cast # => \"cruise-control@example.com\"\n\n      User.where(email: \"\\tCRUISE-CONTROL@EXAMPLE.COM \").count # => 1\n\n      User.exists?(email: \"\\tCRUISE-CONTROL@EXAMPLE.COM \")         # => true\n      User.exists?([\"email = ?\", \"\\tCRUISE-CONTROL@EXAMPLE.COM \"]) # => false\n\n      User.normalize_value_for(:phone, \"+1 (555) 867-5309\") # => \"5558675309\"\n      ```\n\n    *Jonathan Hefner*",
    "project": "activerecord",
    "date_merged": 1671653275000,
    "author": "Jonathan Hefner",
    "sha": "d4c31bd8497a4f8c7ed44607076da6d54420f57a",
    "pr": "43945",
    "merge_sha": "52146dee06de7535339c2550434eb3dfd1b7115c",
    "html": "<p>Add <code>ActiveRecord::Base::normalizes</code> to declare attribute normalizations.</p>\n\n<p>A normalization is applied when the attribute is assigned or updated, and<br />\nthe normalized value will be persisted to the database.  The normalization<br />\nis also applied to the corresponding keyword argument of finder methods.<br />\nThis allows a record to be created and later queried using unnormalized<br />\nvalues.  For example:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>  <span class=\"k\">class</span> <span class=\"nc\">User</span> <span class=\"o\">&lt;</span> <span class=\"no\">ActiveRecord</span><span class=\"o\">::</span><span class=\"no\">Base</span>\n    <span class=\"n\">normalizes</span> <span class=\"ss\">:email</span><span class=\"p\">,</span> <span class=\"ss\">with: </span><span class=\"o\">-&gt;</span> <span class=\"n\">email</span> <span class=\"p\">{</span> <span class=\"n\">email</span><span class=\"p\">.</span><span class=\"nf\">strip</span><span class=\"p\">.</span><span class=\"nf\">downcase</span> <span class=\"p\">}</span>\n    <span class=\"n\">normalizes</span> <span class=\"ss\">:phone</span><span class=\"p\">,</span> <span class=\"ss\">with: </span><span class=\"o\">-&gt;</span> <span class=\"n\">phone</span> <span class=\"p\">{</span> <span class=\"n\">phone</span><span class=\"p\">.</span><span class=\"nf\">delete</span><span class=\"p\">(</span><span class=\"s2\">\"^0-9\"</span><span class=\"p\">).</span><span class=\"nf\">delete_prefix</span><span class=\"p\">(</span><span class=\"s2\">\"1\"</span><span class=\"p\">)</span> <span class=\"p\">}</span>\n  <span class=\"k\">end</span>\n\n  <span class=\"n\">user</span> <span class=\"o\">=</span> <span class=\"no\">User</span><span class=\"p\">.</span><span class=\"nf\">create</span><span class=\"p\">(</span><span class=\"ss\">email: </span><span class=\"s2\">\" CRUISE-CONTROL@EXAMPLE.COM</span><span class=\"se\">\\n</span><span class=\"s2\">\"</span><span class=\"p\">)</span>\n  <span class=\"n\">user</span><span class=\"p\">.</span><span class=\"nf\">email</span>                  <span class=\"c1\"># =&gt; \"cruise-control@example.com\"</span>\n\n  <span class=\"n\">user</span> <span class=\"o\">=</span> <span class=\"no\">User</span><span class=\"p\">.</span><span class=\"nf\">find_by</span><span class=\"p\">(</span><span class=\"ss\">email: </span><span class=\"s2\">\"</span><span class=\"se\">\\t</span><span class=\"s2\">CRUISE-CONTROL@EXAMPLE.COM \"</span><span class=\"p\">)</span>\n  <span class=\"n\">user</span><span class=\"p\">.</span><span class=\"nf\">email</span>                  <span class=\"c1\"># =&gt; \"cruise-control@example.com\"</span>\n  <span class=\"n\">user</span><span class=\"p\">.</span><span class=\"nf\">email_before_type_cast</span> <span class=\"c1\"># =&gt; \"cruise-control@example.com\"</span>\n\n  <span class=\"no\">User</span><span class=\"p\">.</span><span class=\"nf\">where</span><span class=\"p\">(</span><span class=\"ss\">email: </span><span class=\"s2\">\"</span><span class=\"se\">\\t</span><span class=\"s2\">CRUISE-CONTROL@EXAMPLE.COM \"</span><span class=\"p\">).</span><span class=\"nf\">count</span> <span class=\"c1\"># =&gt; 1</span>\n\n  <span class=\"no\">User</span><span class=\"p\">.</span><span class=\"nf\">exists?</span><span class=\"p\">(</span><span class=\"ss\">email: </span><span class=\"s2\">\"</span><span class=\"se\">\\t</span><span class=\"s2\">CRUISE-CONTROL@EXAMPLE.COM \"</span><span class=\"p\">)</span>         <span class=\"c1\"># =&gt; true</span>\n  <span class=\"no\">User</span><span class=\"p\">.</span><span class=\"nf\">exists?</span><span class=\"p\">([</span><span class=\"s2\">\"email = ?\"</span><span class=\"p\">,</span> <span class=\"s2\">\"</span><span class=\"se\">\\t</span><span class=\"s2\">CRUISE-CONTROL@EXAMPLE.COM \"</span><span class=\"p\">])</span> <span class=\"c1\"># =&gt; false</span>\n\n  <span class=\"no\">User</span><span class=\"p\">.</span><span class=\"nf\">normalize_value_for</span><span class=\"p\">(</span><span class=\"ss\">:phone</span><span class=\"p\">,</span> <span class=\"s2\">\"+1 (555) 867-5309\"</span><span class=\"p\">)</span> <span class=\"c1\"># =&gt; \"5558675309\"</span>\n</code></pre></div></div>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Hide changes to before_committed! callback behaviour behind flag.\n\n    In #46525, behavior around before_committed! callbacks was changed so that callbacks\n    would run on every enrolled record in a transaction, not just the first copy of a record.\n    This change in behavior is now controlled by a configuration option,\n    `config.active_record.before_committed_on_all_records`. It will be enabled by default on Rails 7.1.\n\n    *Adrianna Chang*",
    "project": "activerecord",
    "date_merged": 1671124155000,
    "author": "Adrianna Chang",
    "sha": "0b5a705e1b5d593a460361020098ef68131f6f5e",
    "pr": "46739",
    "merge_sha": "2da863e0c380ef6bb9ddbd223a301554feb6a40e",
    "html": "<p>Hide changes to before_committed! callback behaviour behind flag.</p>\n\n<p>In #46525, behavior around before_committed! callbacks was changed so that callbacks<br />\nwould run on every enrolled record in a transaction, not just the first copy of a record.<br />\nThis change in behavior is now controlled by a configuration option,<br />\n<code>config.active_record.before_committed_on_all_records</code>. It will be enabled by default on Rails 7.1.</p>\n\n<p><em>Adrianna Chang</em></p>\n"
  },
  {
    "message": "*   The `namespaced_controller` Query Log tag now matches the `controller` format\n\n    For example, a request processed by `NameSpaced::UsersController` will now log as:\n\n    ```\n    :controller # \"users\"\n    :namespaced_controller # \"name_spaced/users\"\n    ```\n\n    *Alex Ghiculescu*",
    "project": "activerecord",
    "date_merged": 1670955214000,
    "author": "Alex Ghiculescu",
    "sha": "090d1acfe4208ffb43e870d889462849ee0d772c",
    "pr": "46641",
    "merge_sha": "b94b9bd9841d367de71fdd9e88d1fc839146c1cc",
    "html": "<p>The <code>namespaced_controller</code> Query Log tag now matches the <code>controller</code> format</p>\n\n<p>For example, a request processed by <code>NameSpaced::UsersController</code> will now log as:</p>\n\n<pre><code>:controller # \"users\"\n:namespaced_controller # \"name_spaced/users\"\n</code></pre>\n\n<p><em>Alex Ghiculescu</em></p>\n"
  },
  {
    "message": "*   Return only unique ids from ActiveRecord::Calculations#ids\n\n    Updated ActiveRecord::Calculations#ids to only return the unique ids of the base model\n    when using eager_load, preload and includes.\n\n    ```ruby\n    Post.find_by(id: 1).comments.count\n    # => 5\n    Post.includes(:comments).where(id: 1).pluck(:id)\n    # => [1, 1, 1, 1, 1]\n    Post.includes(:comments).where(id: 1).ids\n    # => [1]\n    ```\n\n    *Joshua Young*",
    "project": "activerecord",
    "date_merged": 1670586092000,
    "author": "Joshua Young",
    "sha": "8fd336927a5d7519adac4361c47aa09a295bfe3d",
    "pr": "46455",
    "merge_sha": "4435b7afe3bf3f2d0f2f3b77aedd44d93219be18",
    "html": "<p>Return only unique ids from ActiveRecord::Calculations#ids</p>\n\n<p>Updated ActiveRecord::Calculations#ids to only return the unique ids of the base model<br />\nwhen using eager_load, preload and includes.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">Post</span><span class=\"p\">.</span><span class=\"nf\">find_by</span><span class=\"p\">(</span><span class=\"ss\">id: </span><span class=\"mi\">1</span><span class=\"p\">).</span><span class=\"nf\">comments</span><span class=\"p\">.</span><span class=\"nf\">count</span>\n<span class=\"c1\"># =&gt; 5</span>\n<span class=\"no\">Post</span><span class=\"p\">.</span><span class=\"nf\">includes</span><span class=\"p\">(</span><span class=\"ss\">:comments</span><span class=\"p\">).</span><span class=\"nf\">where</span><span class=\"p\">(</span><span class=\"ss\">id: </span><span class=\"mi\">1</span><span class=\"p\">).</span><span class=\"nf\">pluck</span><span class=\"p\">(</span><span class=\"ss\">:id</span><span class=\"p\">)</span>\n<span class=\"c1\"># =&gt; [1, 1, 1, 1, 1]</span>\n<span class=\"no\">Post</span><span class=\"p\">.</span><span class=\"nf\">includes</span><span class=\"p\">(</span><span class=\"ss\">:comments</span><span class=\"p\">).</span><span class=\"nf\">where</span><span class=\"p\">(</span><span class=\"ss\">id: </span><span class=\"mi\">1</span><span class=\"p\">).</span><span class=\"nf\">ids</span>\n<span class=\"c1\"># =&gt; [1]</span>\n</code></pre></div></div>\n\n<p><em>Joshua Young</em></p>\n"
  },
  {
    "message": "*   Stop using `LOWER()` for case-insensitive queries on `citext` columns\n\n    Previously, `LOWER()` was added for e.g. uniqueness validations with\n    `case_sensitive: false`.\n    It wasn't mentioned in the documentation that the index without `LOWER()`\n    wouldn't be used in this case.\n\n    *Phil Pirozhkov*",
    "project": "activerecord",
    "date_merged": 1669795948000,
    "author": "Phil Pirozhkov",
    "sha": "61464b072854a282e354fe40857ca543558848d4",
    "pr": "46592",
    "merge_sha": "a51e9676e611f578bdfd10fcf6891d9e2d762a23",
    "html": "<p>Stop using <code>LOWER()</code> for case-insensitive queries on <code>citext</code> columns</p>\n\n<p>Previously, <code>LOWER()</code> was added for e.g. uniqueness validations with<br />\n<code>case_sensitive: false</code>.<br />\nIt wasn’t mentioned in the documentation that the index without <code>LOWER()</code><br />\nwouldn’t be used in this case.</p>\n\n<p><em>Phil Pirozhkov</em></p>\n"
  },
  {
    "message": "*   Extract `#sync_timezone_changes` method in AbstractMysqlAdapter to enable subclasses\n    to sync database timezone changes without overriding `#raw_execute`.\n\n    *Adrianna Chang*, *Paarth Madan*",
    "project": "activerecord",
    "date_merged": 1669749793000,
    "author": "Adrianna Chang",
    "sha": "dc8c0865722e8b3192d4ff4658f4b6c74a40040c",
    "pr": "46604",
    "merge_sha": "ea2e3cccf988621fe14cba64e75c2affe344a5df",
    "html": "<p>Extract <code>#sync_timezone_changes</code> method in AbstractMysqlAdapter to enable subclasses<br />\nto sync database timezone changes without overriding <code>#raw_execute</code>.</p>\n\n<p><em>Adrianna Chang</em>, <em>Paarth Madan</em></p>\n"
  },
  {
    "message": "*   Do not write additional new lines when dumping sql migration versions\n\n    This change updates the `insert_versions_sql` function so that the database insert string containing the current database migration versions does not end with two additional new lines.\n\n    *Misha Schwartz*",
    "project": "activerecord",
    "date_merged": 1669663317000,
    "author": "mishaschwartz",
    "sha": "691dbf09974ba914e537b80bb99853941907c221",
    "pr": "46454",
    "merge_sha": "53c42483a865d9c833bdb7e21ab82b00c84ac924",
    "html": "<p>Do not write additional new lines when dumping sql migration versions</p>\n\n<p>This change updates the <code>insert_versions_sql</code> function so that the database insert string containing the current database migration versions does not end with two additional new lines.</p>\n\n<p><em>Misha Schwartz</em></p>\n"
  },
  {
    "message": "*   Fix `composed_of` value freezing and duplication.\n\n    Previously composite values exhibited two confusing behaviors:\n\n    - When reading a compositve value it'd _NOT_ be frozen, allowing it to get out of sync with its underlying database\n      columns.\n    - When writing a compositve value the argument would be frozen, potentially confusing the caller.\n\n    Currently, composite values instantiated based on database columns are frozen (addressing the first issue) and\n    assigned compositve values are duplicated and the duplicate is frozen (addressing the second issue).\n\n    *Greg Navis*",
    "project": "activerecord",
    "date_merged": 1669394915000,
    "author": "Greg Navis",
    "sha": "461d88a59b2f8115de0e21e0bc790927887a14f8",
    "pr": "46377",
    "merge_sha": "9413cbeb21ffa01702066e513d0cd8ce8de9edd3",
    "html": "<p>Fix <code>composed_of</code> value freezing and duplication.</p>\n\n<p>Previously composite values exhibited two confusing behaviors:</p>\n\n<ul>\n  <li>When reading a compositve value it’d <em>NOT</em> be frozen, allowing it to get out of sync with its underlying database<br />\ncolumns.</li>\n  <li>When writing a compositve value the argument would be frozen, potentially confusing the caller.</li>\n</ul>\n\n<p>Currently, composite values instantiated based on database columns are frozen (addressing the first issue) and<br />\nassigned compositve values are duplicated and the duplicate is frozen (addressing the second issue).</p>\n\n<p><em>Greg Navis</em></p>\n"
  },
  {
    "message": "*   Fix redundant updates to the column insensitivity cache\n\n    Fixed redundant queries checking column capability for insensitive\n    comparison.\n\n    *Phil Pirozhkov*",
    "project": "activerecord",
    "date_merged": 1669382934000,
    "author": "Phil Pirozhkov",
    "sha": "b39050e8d574b814d3580688276e933a3d08aca8",
    "pr": "46568",
    "merge_sha": "25a7d2a87f7819220c9d1c26d3cbd9949257755e",
    "html": "<p>Fix redundant updates to the column insensitivity cache</p>\n\n<p>Fixed redundant queries checking column capability for insensitive<br />\ncomparison.</p>\n\n<p><em>Phil Pirozhkov</em></p>\n"
  },
  {
    "message": "*   Allow disabling methods generated by `ActiveRecord.enum`.\n\n    *Alfred Dominic*",
    "project": "activerecord",
    "date_merged": 1669297239000,
    "author": "Alfred Dominic",
    "sha": "61b82533876ce61d951762138c940f086a6363a9",
    "pr": "46490",
    "merge_sha": "cef42e692e1c9ac52299e8d5443d173d89abeec7",
    "html": "<p>Allow disabling methods generated by <code>ActiveRecord.enum</code>.</p>\n\n<p><em>Alfred Dominic</em></p>\n"
  },
  {
    "message": "*   Avoid validating `belongs_to` association if it has not changed.\n\n    Previously, when updating a record, Active Record will perform an extra query to check for the presence of\n    `belongs_to` associations (if the presence is configured to be mandatory), even if that attribute hasn't changed.\n\n    Currently, only `belongs_to`-related columns are checked for presence. It is possible to have orphaned records with\n    this approach. To avoid this problem, you need to use a foreign key.\n\n    This behavior can be controlled by configuration:\n\n    ```ruby\n    config.active_record.belongs_to_required_validates_foreign_key = false\n    ```\n\n    and will be disabled by default with `config.load_defaults 7.1`.\n\n    *fatkodima*",
    "project": "activerecord",
    "date_merged": 1669288956000,
    "author": "fatkodima",
    "sha": "e5d15140d2dfd25f33e306ab8522f7accd410dc3",
    "pr": "46522",
    "merge_sha": "3bb8cb920459485f082c912c945b9fdc510cad74",
    "html": "<p>Avoid validating <code>belongs_to</code> association if it has not changed.</p>\n\n<p>Previously, when updating a record, Active Record will perform an extra query to check for the presence of<br />\n<code>belongs_to</code> associations (if the presence is configured to be mandatory), even if that attribute hasn’t changed.</p>\n\n<p>Currently, only <code>belongs_to</code>-related columns are checked for presence. It is possible to have orphaned records with<br />\nthis approach. To avoid this problem, you need to use a foreign key.</p>\n\n<p>This behavior can be controlled by configuration:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">config</span><span class=\"p\">.</span><span class=\"nf\">active_record</span><span class=\"p\">.</span><span class=\"nf\">belongs_to_required_validates_foreign_key</span> <span class=\"o\">=</span> <span class=\"kp\">false</span>\n</code></pre></div></div>\n\n<p>and will be disabled by default with <code>config.load_defaults 7.1</code>.</p>\n\n<p><em>fatkodima</em></p>\n"
  },
  {
    "message": "*   `has_one` and `belongs_to` associations now define a `reset_association` method\n    on the owner model (where `association` is the name of the association). This\n    method unloads the cached associate record, if any, and causes the next access\n    to query it from the database.\n\n    *George Claghorn*",
    "project": "activerecord",
    "date_merged": 1669235115000,
    "author": "George Claghorn",
    "sha": "725ee799712e551c1e5a1687036d9a0c18ad2fb8",
    "pr": "46165",
    "merge_sha": "e32e09228aff02c5c6662212b1c0c451d7f6a0e3",
    "html": "<p><code>has_one</code> and <code>belongs_to</code> associations now define a <code>reset_association</code> method<br />\non the owner model (where <code>association</code> is the name of the association). This<br />\nmethod unloads the cached associate record, if any, and causes the next access<br />\nto query it from the database.</p>\n\n<p><em>George Claghorn</em></p>\n"
  },
  {
    "message": "*   Allow per attribute setting of YAML permitted classes (safe load) and unsafe load.\n\n    *Carlos Palhares*",
    "project": "activerecord",
    "date_merged": 1669228272000,
    "author": "Carlos Palhares",
    "sha": "e313fc5a4d8891149b8c7b1a66c882d22c22c348",
    "pr": "45660",
    "merge_sha": "4a075537dc0592753718b0f2d264ba56297ee4d3",
    "html": "<p>Allow per attribute setting of YAML permitted classes (safe load) and unsafe load.</p>\n\n<p><em>Carlos Palhares</em></p>\n"
  },
  {
    "message": "*   Add a build persistence method\n\n    Provides a wrapper for `new`, to provide feature parity with `create`s\n    ability to create multiple records from an array of hashes, using the\n    same notation as the `build` method on associations.\n\n    *Sean Denny*",
    "project": "activerecord",
    "date_merged": 1669222440000,
    "author": "Sean Denny",
    "sha": "313a379a0142088ba1aa12db1087f3e7abc5e04b",
    "pr": "45696",
    "merge_sha": "2434e201cf028bd37ff5e1aba52451d8d86a9d5b",
    "html": "<p>Add a build persistence method</p>\n\n<p>Provides a wrapper for <code>new</code>, to provide feature parity with <code>create</code>s<br />\nability to create multiple records from an array of hashes, using the<br />\nsame notation as the <code>build</code> method on associations.</p>\n\n<p><em>Sean Denny</em></p>\n"
  },
  {
    "message": "*   Raise on assignment to readonly attributes\n\n    ```ruby\n    class Post < ActiveRecord::Base\n      attr_readonly :content\n    end\n    Post.create!(content: \"cannot be updated\")\n    post.content # \"cannot be updated\"\n    post.content = \"something else\" # => ActiveRecord::ReadonlyAttributeError\n    ```\n\n    Previously, assignment would succeed but silently not write to the database.\n\n    This behavior can be controlled by configuration:\n\n    ```ruby\n    config.active_record.raise_on_assign_to_attr_readonly = true\n    ```\n\n    and will be enabled by default with `config.load_defaults 7.1`.\n\n    *Alex Ghiculescu*, *Hartley McGuire*",
    "project": "activerecord",
    "date_merged": 1668713315000,
    "author": "Hartley McGuire",
    "sha": "7b6720dfc8d1606c0b3ed7c92b735180dcfa7e9d",
    "pr": "46105",
    "merge_sha": "f2bbe6eb28f2a11b687db82e53648cf29e3242ea",
    "html": "<p>Raise on assignment to readonly attributes</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">class</span> <span class=\"nc\">Post</span> <span class=\"o\">&lt;</span> <span class=\"no\">ActiveRecord</span><span class=\"o\">::</span><span class=\"no\">Base</span>\n  <span class=\"n\">attr_readonly</span> <span class=\"ss\">:content</span>\n<span class=\"k\">end</span>\n<span class=\"no\">Post</span><span class=\"p\">.</span><span class=\"nf\">create!</span><span class=\"p\">(</span><span class=\"ss\">content: </span><span class=\"s2\">\"cannot be updated\"</span><span class=\"p\">)</span>\n<span class=\"n\">post</span><span class=\"p\">.</span><span class=\"nf\">content</span> <span class=\"c1\"># \"cannot be updated\"</span>\n<span class=\"n\">post</span><span class=\"p\">.</span><span class=\"nf\">content</span> <span class=\"o\">=</span> <span class=\"s2\">\"something else\"</span> <span class=\"c1\"># =&gt; ActiveRecord::ReadonlyAttributeError</span>\n</code></pre></div></div>\n\n<p>Previously, assignment would succeed but silently not write to the database.</p>\n\n<p>This behavior can be controlled by configuration:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">config</span><span class=\"p\">.</span><span class=\"nf\">active_record</span><span class=\"p\">.</span><span class=\"nf\">raise_on_assign_to_attr_readonly</span> <span class=\"o\">=</span> <span class=\"kp\">true</span>\n</code></pre></div></div>\n\n<p>and will be enabled by default with <code>config.load_defaults 7.1</code>.</p>\n\n<p><em>Alex Ghiculescu</em>, <em>Hartley McGuire</em></p>\n"
  },
  {
    "message": "*   Allow unscoping of preload and eager_load associations\n\n    Added the ability to unscope preload and eager_load associations just like\n    includes, joins, etc. See ActiveRecord::QueryMethods::VALID_UNSCOPING_VALUES\n    for the full list of supported unscopable scopes.\n\n    ```ruby\n    query.unscope(:eager_load, :preload).group(:id).select(:id)\n    ```\n\n    *David Morehouse*",
    "project": "activerecord",
    "date_merged": 1668468757000,
    "author": "Dave Morehouse",
    "sha": "e2c720fbb890973bd00331c45d33597439c4e080",
    "pr": "45147",
    "merge_sha": "f7af67e8f53e21537a1a8b0a29a0644914798b2e",
    "html": "<p>Allow unscoping of preload and eager_load associations</p>\n\n<p>Added the ability to unscope preload and eager_load associations just like<br />\nincludes, joins, etc. See ActiveRecord::QueryMethods::VALID_UNSCOPING_VALUES<br />\nfor the full list of supported unscopable scopes.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">query</span><span class=\"p\">.</span><span class=\"nf\">unscope</span><span class=\"p\">(</span><span class=\"ss\">:eager_load</span><span class=\"p\">,</span> <span class=\"ss\">:preload</span><span class=\"p\">).</span><span class=\"nf\">group</span><span class=\"p\">(</span><span class=\"ss\">:id</span><span class=\"p\">).</span><span class=\"nf\">select</span><span class=\"p\">(</span><span class=\"ss\">:id</span><span class=\"p\">)</span>\n</code></pre></div></div>\n\n<p><em>David Morehouse</em></p>\n"
  },
  {
    "message": "*   Add automatic filtering of encrypted attributes on inspect\n\n    This feature is enabled by default but can be disabled with\n\n    ```ruby\n    config.active_record.encryption.add_to_filter_parameters = false\n    ```\n\n    *Hartley McGuire*",
    "project": "activerecord",
    "date_merged": 1668290224000,
    "author": "Hartley McGuire",
    "sha": "9b7ae2b24a7b758647336a8db4d446985e02dd43",
    "pr": "46453",
    "merge_sha": "90cba59ddd26a1fbbad85e9a9810583e2de85279",
    "html": "<p>Add automatic filtering of encrypted attributes on inspect</p>\n\n<p>This feature is enabled by default but can be disabled with</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">config</span><span class=\"p\">.</span><span class=\"nf\">active_record</span><span class=\"p\">.</span><span class=\"nf\">encryption</span><span class=\"p\">.</span><span class=\"nf\">add_to_filter_parameters</span> <span class=\"o\">=</span> <span class=\"kp\">false</span>\n</code></pre></div></div>\n\n<p><em>Hartley McGuire</em></p>\n"
  },
  {
    "message": "*   Clear locking column on #dup\n\n    This change fixes not to duplicate locking_column like id and timestamps.\n\n    ```\n    car = Car.create!\n    car.touch\n    car.lock_version #=> 1\n    car.dup.lock_version #=> 0\n    ```\n\n    *Shouichi Kamiya*, *Seonggi Yang*, *Ryohei UEDA*",
    "project": "activerecord",
    "date_merged": 1667385350000,
    "author": "Shouichi Kamiya",
    "sha": "13d3fc9d323288b6db9294aedcc7eced02dd54f0",
    "pr": "46243",
    "merge_sha": "7db044f38594eb43e1d241cc82025155666cc6f1",
    "html": "<p>Clear locking column on #dup</p>\n\n<p>This change fixes not to duplicate locking_column like id and timestamps.</p>\n\n<pre><code>car = Car.create!\ncar.touch\ncar.lock_version #=&gt; 1\ncar.dup.lock_version #=&gt; 0\n</code></pre>\n\n<p><em>Shouichi Kamiya</em>, <em>Seonggi Yang</em>, <em>Ryohei UEDA</em></p>\n"
  },
  {
    "message": "*   Invalidate transaction as early as possible\n\n    After rescuing a `TransactionRollbackError` exception Rails invalidates transactions earlier in the flow\n    allowing the framework to skip issuing the `ROLLBACK` statement in more cases.\n    Only affects adapters that have `savepoint_errors_invalidate_transactions?` configured as `true`,\n    which at this point is only applicable to the `mysql2` adapter.\n\n    *Nikita Vasilevsky*",
    "project": "activerecord",
    "date_merged": 1667352002000,
    "author": "Nikita Vasilevsky",
    "sha": "bf24af73ff146e884339a215ebe30d3fc5a88091",
    "pr": "46367",
    "merge_sha": "fbe60e9cffce63108afe4f9fb0ac694bbbb35643",
    "html": "<p>Invalidate transaction as early as possible</p>\n\n<p>After rescuing a <code>TransactionRollbackError</code> exception Rails invalidates transactions earlier in the flow<br />\nallowing the framework to skip issuing the <code>ROLLBACK</code> statement in more cases.<br />\nOnly affects adapters that have <code>savepoint_errors_invalidate_transactions?</code> configured as <code>true</code>,<br />\nwhich at this point is only applicable to the <code>mysql2</code> adapter.</p>\n\n<p><em>Nikita Vasilevsky</em></p>\n"
  },
  {
    "message": "*   Allow configuring columns list to be used in SQL queries issued by an `ActiveRecord::Base` object\n\n    It is now possible to configure columns list that will be used to build an SQL query clauses when\n    updating, deleting or reloading an `ActiveRecord::Base` object\n\n    ```ruby\n    class Developer < ActiveRecord::Base\n      query_constraints :company_id, :id\n    end\n    developer = Developer.first.update(name: \"Bob\")\n    # => UPDATE \"developers\" SET \"name\" = 'Bob' WHERE \"developers\".\"company_id\" = 1 AND \"developers\".\"id\" = 1\n    ```\n\n    *Nikita Vasilevsky*",
    "project": "activerecord",
    "date_merged": 1667318774000,
    "author": "Nikita Vasilevsky",
    "sha": "415e6b639146649b58ed6e94c70f5dd6e7d9c7c2",
    "pr": "46331",
    "merge_sha": "232a057dd11976925efd751911275a38e8e2bb0d",
    "html": "<p>Allow configuring columns list to be used in SQL queries issued by an <code>ActiveRecord::Base</code> object</p>\n\n<p>It is now possible to configure columns list that will be used to build an SQL query clauses when<br />\nupdating, deleting or reloading an <code>ActiveRecord::Base</code> object</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">class</span> <span class=\"nc\">Developer</span> <span class=\"o\">&lt;</span> <span class=\"no\">ActiveRecord</span><span class=\"o\">::</span><span class=\"no\">Base</span>\n  <span class=\"n\">query_constraints</span> <span class=\"ss\">:company_id</span><span class=\"p\">,</span> <span class=\"ss\">:id</span>\n<span class=\"k\">end</span>\n<span class=\"n\">developer</span> <span class=\"o\">=</span> <span class=\"no\">Developer</span><span class=\"p\">.</span><span class=\"nf\">first</span><span class=\"p\">.</span><span class=\"nf\">update</span><span class=\"p\">(</span><span class=\"ss\">name: </span><span class=\"s2\">\"Bob\"</span><span class=\"p\">)</span>\n<span class=\"c1\"># =&gt; UPDATE \"developers\" SET \"name\" = 'Bob' WHERE \"developers\".\"company_id\" = 1 AND \"developers\".\"id\" = 1</span>\n</code></pre></div></div>\n\n<p><em>Nikita Vasilevsky</em></p>\n"
  },
  {
    "message": "*   Adds `validate` to foreign keys and check constraints in schema.rb\n\n    Previously, `schema.rb` would not record if `validate: false` had been used when adding a foreign key or check\n    constraint, so restoring a database from the schema could result in foreign keys or check constraints being\n    incorrectly validated.\n\n    *Tommy Graves*",
    "project": "activerecord",
    "date_merged": 1666742056000,
    "author": "Tommy Graves",
    "sha": "26f316a8555757f456c5024bb99e4d8239599698",
    "pr": "46339",
    "merge_sha": "1562651e5fb02d7687ffe13498c0cc3aee9249f0",
    "html": "<p>Adds <code>validate</code> to foreign keys and check constraints in schema.rb</p>\n\n<p>Previously, <code>schema.rb</code> would not record if <code>validate: false</code> had been used when adding a foreign key or check<br />\nconstraint, so restoring a database from the schema could result in foreign keys or check constraints being<br />\nincorrectly validated.</p>\n\n<p><em>Tommy Graves</em></p>\n"
  },
  {
    "message": "*   Adapter `#execute` methods now accept an `allow_retry` option. When set to `true`, the SQL statement will be\n    retried, up to the database's configured `connection_retries` value, upon encountering connection-related errors.\n\n    *Adrianna Chang*",
    "project": "activerecord",
    "date_merged": 1666712738000,
    "author": "Adrianna Chang",
    "sha": "8f780c58ea2a5af17d61ac5858b33ead2c7aa494",
    "pr": "46273",
    "merge_sha": "b4344c86ad1a7ab91eb83c16dcce5d5f67f06e01",
    "html": "<p>Adapter <code>#execute</code> methods now accept an <code>allow_retry</code> option. When set to <code>true</code>, the SQL statement will be<br />\nretried, up to the database’s configured <code>connection_retries</code> value, upon encountering connection-related errors.</p>\n\n<p><em>Adrianna Chang</em></p>\n"
  },
  {
    "message": "*   Only trigger `after_commit :destroy` callbacks when a database row is deleted.\n\n    This prevents `after_commit :destroy` callbacks from being triggered again\n    when `destroy` is called multiple times on the same record.\n\n    *Ben Sheldon*",
    "project": "activerecord",
    "date_merged": 1666378857000,
    "author": "Ben Sheldon",
    "sha": "e32c7043d7b66f4b11ce0aecd982fb572d23d6ca",
    "pr": "46197",
    "merge_sha": "7fdcbe747f7ab5ef664b894f73c8e0ada04c5c50",
    "html": "<p>Only trigger <code>after_commit :destroy</code> callbacks when a database row is deleted.</p>\n\n<p>This prevents <code>after_commit :destroy</code> callbacks from being triggered again<br />\nwhen <code>destroy</code> is called multiple times on the same record.</p>\n\n<p><em>Ben Sheldon</em></p>\n"
  },
  {
    "message": "*   Fix `ciphertext_for` for yet-to-be-encrypted values.\n\n    Previously, `ciphertext_for` returned the cleartext of values that had not\n    yet been encrypted, such as with an unpersisted record:\n\n      ```ruby\n      Post.encrypts :body\n\n      post = Post.create!(body: \"Hello\")\n      post.ciphertext_for(:body)\n      # => \"{\\\"p\\\":\\\"abc...\"\n\n      post.body = \"World\"\n      post.ciphertext_for(:body)\n      # => \"World\"\n      ```\n\n    Now, `ciphertext_for` will always return the ciphertext of encrypted\n    attributes:\n\n      ```ruby\n      Post.encrypts :body\n\n      post = Post.create!(body: \"Hello\")\n      post.ciphertext_for(:body)\n      # => \"{\\\"p\\\":\\\"abc...\"\n\n      post.body = \"World\"\n      post.ciphertext_for(:body)\n      # => \"{\\\"p\\\":\\\"xyz...\"\n      ```\n\n    *Jonathan Hefner*",
    "project": "activerecord",
    "date_merged": 1666303019000,
    "author": "Jonathan Hefner",
    "sha": "02e351e48c5b33a84c574e889a0c49df3b3bacbb",
    "pr": "46284",
    "merge_sha": "b96ddea5f0b4ff8ed6e9dfe4df62f7571b147b11",
    "html": "<p>Fix <code>ciphertext_for</code> for yet-to-be-encrypted values.</p>\n\n<p>Previously, <code>ciphertext_for</code> returned the cleartext of values that had not<br />\nyet been encrypted, such as with an unpersisted record:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>  <span class=\"no\">Post</span><span class=\"p\">.</span><span class=\"nf\">encrypts</span> <span class=\"ss\">:body</span>\n\n  <span class=\"n\">post</span> <span class=\"o\">=</span> <span class=\"no\">Post</span><span class=\"p\">.</span><span class=\"nf\">create!</span><span class=\"p\">(</span><span class=\"ss\">body: </span><span class=\"s2\">\"Hello\"</span><span class=\"p\">)</span>\n  <span class=\"n\">post</span><span class=\"p\">.</span><span class=\"nf\">ciphertext_for</span><span class=\"p\">(</span><span class=\"ss\">:body</span><span class=\"p\">)</span>\n  <span class=\"c1\"># =&gt; \"{\\\"p\\\":\\\"abc...\"</span>\n\n  <span class=\"n\">post</span><span class=\"p\">.</span><span class=\"nf\">body</span> <span class=\"o\">=</span> <span class=\"s2\">\"World\"</span>\n  <span class=\"n\">post</span><span class=\"p\">.</span><span class=\"nf\">ciphertext_for</span><span class=\"p\">(</span><span class=\"ss\">:body</span><span class=\"p\">)</span>\n  <span class=\"c1\"># =&gt; \"World\"</span>\n</code></pre></div></div>\n\n<p>Now, <code>ciphertext_for</code> will always return the ciphertext of encrypted<br />\nattributes:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>  <span class=\"no\">Post</span><span class=\"p\">.</span><span class=\"nf\">encrypts</span> <span class=\"ss\">:body</span>\n\n  <span class=\"n\">post</span> <span class=\"o\">=</span> <span class=\"no\">Post</span><span class=\"p\">.</span><span class=\"nf\">create!</span><span class=\"p\">(</span><span class=\"ss\">body: </span><span class=\"s2\">\"Hello\"</span><span class=\"p\">)</span>\n  <span class=\"n\">post</span><span class=\"p\">.</span><span class=\"nf\">ciphertext_for</span><span class=\"p\">(</span><span class=\"ss\">:body</span><span class=\"p\">)</span>\n  <span class=\"c1\"># =&gt; \"{\\\"p\\\":\\\"abc...\"</span>\n\n  <span class=\"n\">post</span><span class=\"p\">.</span><span class=\"nf\">body</span> <span class=\"o\">=</span> <span class=\"s2\">\"World\"</span>\n  <span class=\"n\">post</span><span class=\"p\">.</span><span class=\"nf\">ciphertext_for</span><span class=\"p\">(</span><span class=\"ss\">:body</span><span class=\"p\">)</span>\n  <span class=\"c1\"># =&gt; \"{\\\"p\\\":\\\"xyz...\"</span>\n</code></pre></div></div>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Fix a bug where using groups and counts with long table names would return incorrect results.\n\n    *Shota Toguchi*, *Yusaku Ono*",
    "project": "activerecord",
    "date_merged": 1666258485000,
    "author": "Dooor",
    "sha": "31c15b4791a8581cbf354c22bbadb463a90bcd1a",
    "pr": "46287",
    "merge_sha": "64c152b06e882aac99d849c8c0ee279b0096d596",
    "html": "<p>Fix a bug where using groups and counts with long table names would return incorrect results.</p>\n\n<p><em>Shota Toguchi</em>, <em>Yusaku Ono</em></p>\n"
  },
  {
    "message": "*   Fix encryption of column default values.\n\n    Previously, encrypted attributes that used column default values appeared to\n    be encrypted on create, but were not:\n\n      ```ruby\n      Book.encrypts :name\n\n      book = Book.create!\n      book.name\n      # => \"<untitled>\"\n      book.name_before_type_cast\n      # => \"{\\\"p\\\":\\\"abc...\"\n      book.reload.name_before_type_cast\n      # => \"<untitled>\"\n      ```\n\n    Now, attributes with column default values are encrypted:\n\n      ```ruby\n      Book.encrypts :name\n\n      book = Book.create!\n      book.name\n      # => \"<untitled>\"\n      book.name_before_type_cast\n      # => \"{\\\"p\\\":\\\"abc...\"\n      book.reload.name_before_type_cast\n      # => \"{\\\"p\\\":\\\"abc...\"\n      ```\n\n    *Jonathan Hefner*",
    "project": "activerecord",
    "date_merged": 1666239423000,
    "author": "Jonathan Hefner",
    "sha": "c48a83020a05a3bc6e429923dac31ee9e6b8e301",
    "pr": "46281",
    "merge_sha": "6676989957cb12b1332862ce05013ff0b3f5f6bb",
    "html": "<p>Fix encryption of column default values.</p>\n\n<p>Previously, encrypted attributes that used column default values appeared to<br />\nbe encrypted on create, but were not:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>  <span class=\"no\">Book</span><span class=\"p\">.</span><span class=\"nf\">encrypts</span> <span class=\"ss\">:name</span>\n\n  <span class=\"n\">book</span> <span class=\"o\">=</span> <span class=\"no\">Book</span><span class=\"p\">.</span><span class=\"nf\">create!</span>\n  <span class=\"n\">book</span><span class=\"p\">.</span><span class=\"nf\">name</span>\n  <span class=\"c1\"># =&gt; \"&lt;untitled&gt;\"</span>\n  <span class=\"n\">book</span><span class=\"p\">.</span><span class=\"nf\">name_before_type_cast</span>\n  <span class=\"c1\"># =&gt; \"{\\\"p\\\":\\\"abc...\"</span>\n  <span class=\"n\">book</span><span class=\"p\">.</span><span class=\"nf\">reload</span><span class=\"p\">.</span><span class=\"nf\">name_before_type_cast</span>\n  <span class=\"c1\"># =&gt; \"&lt;untitled&gt;\"</span>\n</code></pre></div></div>\n\n<p>Now, attributes with column default values are encrypted:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>  <span class=\"no\">Book</span><span class=\"p\">.</span><span class=\"nf\">encrypts</span> <span class=\"ss\">:name</span>\n\n  <span class=\"n\">book</span> <span class=\"o\">=</span> <span class=\"no\">Book</span><span class=\"p\">.</span><span class=\"nf\">create!</span>\n  <span class=\"n\">book</span><span class=\"p\">.</span><span class=\"nf\">name</span>\n  <span class=\"c1\"># =&gt; \"&lt;untitled&gt;\"</span>\n  <span class=\"n\">book</span><span class=\"p\">.</span><span class=\"nf\">name_before_type_cast</span>\n  <span class=\"c1\"># =&gt; \"{\\\"p\\\":\\\"abc...\"</span>\n  <span class=\"n\">book</span><span class=\"p\">.</span><span class=\"nf\">reload</span><span class=\"p\">.</span><span class=\"nf\">name_before_type_cast</span>\n  <span class=\"c1\"># =&gt; \"{\\\"p\\\":\\\"abc...\"</span>\n</code></pre></div></div>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Deprecate delegation from `Base` to `connection_handler`.\n\n    Calling `Base.clear_all_connections!`, `Base.clear_active_connections!`, `Base.clear_reloadable_connections!` and `Base.flush_idle_connections!` is deprecated. Please call these methods on the connection handler directly. In future Rails versions, the delegation from `Base` to the `connection_handler` will be removed.\n\n    *Eileen M. Uchitelle*",
    "project": "activerecord",
    "date_merged": 1666190378000,
    "author": "eileencodes",
    "sha": "a93d8fe29440c0791bdd71adb07b617dd8a9b33d",
    "pr": "46274",
    "merge_sha": "2453ec71a950bb102b52d0b3025f68f39ca48883",
    "html": "<p>Deprecate delegation from <code>Base</code> to <code>connection_handler</code>.</p>\n\n<p>Calling <code>Base.clear_all_connections!</code>, <code>Base.clear_active_connections!</code>, <code>Base.clear_reloadable_connections!</code> and <code>Base.flush_idle_connections!</code> is deprecated. Please call these methods on the connection handler directly. In future Rails versions, the delegation from <code>Base</code> to the <code>connection_handler</code> will be removed.</p>\n\n<p><em>Eileen M. Uchitelle</em></p>\n"
  },
  {
    "message": "*   Allow ActiveRecord::QueryMethods#reselect to receive hash values, similar to ActiveRecord::QueryMethods#select\n\n    *Sampat Badhe*",
    "project": "activerecord",
    "date_merged": 1666041004000,
    "author": "sampatbadhe",
    "sha": "90e96e51225aaa030605f177e2a37bc3c4c948ef",
    "pr": "46253",
    "merge_sha": "d73d3cdda58684c62df907ef9b8eeead18b0355b",
    "html": "<p>Allow ActiveRecord::QueryMethods#reselect to receive hash values, similar to ActiveRecord::QueryMethods#select</p>\n\n<p><em>Sampat Badhe</em></p>\n"
  },
  {
    "message": "*   Validate options when managing columns and tables in migrations.\n\n    If an invalid option is passed to a migration method like `create_table` and `add_column`, an error will be raised\n    instead of the option being silently ignored. Validation of the options will only be applied for new migrations\n    that are created.\n\n    *Guo Xiang Tan*, *George Wambold*",
    "project": "activerecord",
    "date_merged": 1665475354000,
    "author": "Alan Guo Xiang Tan",
    "sha": "e6da3ebd6c65af23d134a9e01145f26600912008",
    "pr": "46178",
    "merge_sha": "556bf2e520620b15db8714c1b8c6bf82249a6547",
    "html": "<p>Validate options when managing columns and tables in migrations.</p>\n\n<p>If an invalid option is passed to a migration method like <code>create_table</code> and <code>add_column</code>, an error will be raised<br />\ninstead of the option being silently ignored. Validation of the options will only be applied for new migrations<br />\nthat are created.</p>\n\n<p><em>Guo Xiang Tan</em>, <em>George Wambold</em></p>\n"
  },
  {
    "message": "*   Update query log tags to use the [SQLCommenter](https://open-telemetry.github.io/opentelemetry-sqlcommenter/) format by default. See [#46179](https://github.com/rails/rails/issues/46179)\n\n    To opt out of SQLCommenter-formatted query log tags, set `config.active_record.query_log_tags_format = :legacy`. By default, this is set to `:sqlcommenter`.\n\n    *Modulitos* and *Iheanyi*",
    "project": "activerecord",
    "date_merged": 1666519802000,
    "author": "modulitos",
    "sha": "e333bda8760764d5dabd73810fcbe9f81e9a42b9",
    "pr": "46310",
    "merge_sha": "76c48fb9c336d2612177460718a90a4530e3584f",
    "html": "<p>Update query log tags to use the <a href=\"https://open-telemetry.github.io/opentelemetry-sqlcommenter/\">SQLCommenter</a> format by default. See <a href=\"https://github.com/rails/rails/issues/46179\">#46179</a></p>\n\n<p>To opt out of SQLCommenter-formatted query log tags, set <code>config.active_record.query_log_tags_format = :legacy</code>. By default, this is set to <code>:sqlcommenter</code>.</p>\n\n<p><em>Modulitos</em> and <em>Iheanyi</em></p>\n"
  },
  {
    "message": "*   Allow any ERB in the database.yml when creating rake tasks.\n\n    Any ERB can be used in `database.yml` even if it accesses environment\n    configurations.\n\n    Deprecates `config.active_record.suppress_multiple_database_warning`.\n\n    *Eike Send*",
    "project": "activerecord",
    "date_merged": 1664292446000,
    "author": "Eike Send",
    "sha": "5ba8aa585491c6e7d0af1e6ed772cb67ced34ea7",
    "pr": "46134",
    "merge_sha": "5b8421f56ed2a07a77e5b4950d3d0179dba39b9b",
    "html": "<p>Allow any ERB in the database.yml when creating rake tasks.</p>\n\n<p>Any ERB can be used in <code>database.yml</code> even if it accesses environment<br />\nconfigurations.</p>\n\n<p>Deprecates <code>config.active_record.suppress_multiple_database_warning</code>.</p>\n\n<p><em>Eike Send</em></p>\n"
  },
  {
    "message": "*   Add table to error for duplicate column definitions.\n\n    If a migration defines duplicate columns for a table, the error message\n    shows which table it concerns.\n\n    *Petrik de Heus*",
    "project": "activerecord",
    "date_merged": 1663947834000,
    "author": "Petrik",
    "sha": "39a20095bf006de816eec32b4d431226b80f10cf",
    "pr": "46117",
    "merge_sha": "91895c0936d7713da011d6520925b37643ceeeee",
    "html": "<p>Add table to error for duplicate column definitions.</p>\n\n<p>If a migration defines duplicate columns for a table, the error message<br />\nshows which table it concerns.</p>\n\n<p><em>Petrik de Heus</em></p>\n"
  },
  {
    "message": "*   Fix erroneous nil default precision on virtual datetime columns.\n\n    Prior to this change, virtual datetime columns did not have the same\n    default precision as regular datetime columns, resulting in the following\n    being erroneously equivalent:\n\n        t.virtual :name, type: datetime,                 as: \"expression\"\n        t.virtual :name, type: datetime, precision: nil, as: \"expression\"\n\n    This change fixes the default precision lookup, so virtual and regular\n    datetime column default precisions match.\n\n    *Sam Bostock*",
    "project": "activerecord",
    "date_merged": 1663885258000,
    "author": "Sam Bostock",
    "sha": "b85ee91633bbc157ceb571cb4d3e5861ca7c15b6",
    "pr": "46110",
    "merge_sha": "dd163f8168d79676a92ff6ddf87d99e53d456907",
    "html": "<p>Fix erroneous nil default precision on virtual datetime columns.</p>\n\n<p>Prior to this change, virtual datetime columns did not have the same<br />\ndefault precision as regular datetime columns, resulting in the following<br />\nbeing erroneously equivalent:</p>\n\n<pre><code>t.virtual :name, type: datetime,                 as: \"expression\"\nt.virtual :name, type: datetime, precision: nil, as: \"expression\"\n</code></pre>\n\n<p>This change fixes the default precision lookup, so virtual and regular<br />\ndatetime column default precisions match.</p>\n\n<p><em>Sam Bostock</em></p>\n"
  },
  {
    "message": "*   Use connection from `#with_raw_connection` in `#quote_string`.\n\n    This ensures that the string quoting is wrapped in the reconnect and retry logic\n    that `#with_raw_connection` offers.\n\n    *Adrianna Chang*",
    "project": "activerecord",
    "date_merged": 1663882057000,
    "author": "Adrianna Chang",
    "sha": "b00ca21999094ed02a3a1443aea69ad680dcf833",
    "pr": "46108",
    "merge_sha": "b5e5fad4ded363d01a180e0d962ec34015942329",
    "html": "<p>Use connection from <code>#with_raw_connection</code> in <code>#quote_string</code>.</p>\n\n<p>This ensures that the string quoting is wrapped in the reconnect and retry logic<br />\nthat <code>#with_raw_connection</code> offers.</p>\n\n<p><em>Adrianna Chang</em></p>\n"
  },
  {
    "message": "*   Add `expires_in` option to `signed_id`.\n\n    *Shouichi Kamiya*",
    "project": "activerecord",
    "date_merged": 1663882057000,
    "author": "Shouichi Kamiya",
    "sha": "364939c2b17b219fc8c158da63a8517e57f892ab",
    "pr": "46108",
    "merge_sha": "b5e5fad4ded363d01a180e0d962ec34015942329",
    "html": "<p>Add <code>expires_in</code> option to <code>signed_id</code>.</p>\n\n<p><em>Shouichi Kamiya</em></p>\n"
  },
  {
    "message": "*   Allow applications to set retry deadline for query retries.\n\n    Building on the work done in #44576 and #44591, we extend the logic that automatically\n    reconnects database connections to take into account a timeout limit. We won't retry\n    a query if a given amount of time has elapsed since the query was first attempted. This\n    value defaults to nil, meaning that all retryable queries are retried regardless of time elapsed,\n    but this can be changed via the `retry_deadline` option in the database config.\n\n    *Adrianna Chang*",
    "project": "activerecord",
    "date_merged": 1663872589000,
    "author": "Adrianna Chang",
    "sha": "4d13f05a2eebb16f9ab7407c54388f05d439b3d6",
    "pr": "46046",
    "merge_sha": "6c70d02f02c62a6f15687c795cac7ce27010a111",
    "html": "<p>Allow applications to set retry deadline for query retries.</p>\n\n<p>Building on the work done in #44576 and #44591, we extend the logic that automatically<br />\nreconnects database connections to take into account a timeout limit. We won’t retry<br />\na query if a given amount of time has elapsed since the query was first attempted. This<br />\nvalue defaults to nil, meaning that all retryable queries are retried regardless of time elapsed,<br />\nbut this can be changed via the <code>retry_deadline</code> option in the database config.</p>\n\n<p><em>Adrianna Chang</em></p>\n"
  },
  {
    "message": "*   Fix a case where the query cache can return wrong values. See #46044\n\n    *Aaron Patterson*",
    "project": "activerecord",
    "date_merged": 1663576626000,
    "author": "Aaron Patterson",
    "sha": "5abb45d53ae32f9d80fac5a21fe4cda9b83412a1",
    "pr": "46048",
    "merge_sha": "f4418db137f8ecc311cf3f2290ffbef83e96711b",
    "html": "<p>Fix a case where the query cache can return wrong values. See #46044</p>\n\n<p><em>Aaron Patterson</em></p>\n"
  },
  {
    "message": "*   Support MySQL's ssl-mode option for MySQLDatabaseTasks.\n\n    Verifying the identity of the database server requires setting the ssl-mode\n    option to VERIFY_CA or VERIFY_IDENTITY. This option was previously ignored\n    for MySQL database tasks like creating a database and dumping the structure.\n\n    *Petrik de Heus*",
    "project": "activerecord",
    "date_merged": 1663314711000,
    "author": "Petrik",
    "sha": "ed3b92b38f6db2a487b10b68d5320ab6b118521f",
    "pr": "46008",
    "merge_sha": "8c619c30967564e9e3fe01dd1e37b03f32d65933",
    "html": "<p>Support MySQL’s ssl-mode option for MySQLDatabaseTasks.</p>\n\n<p>Verifying the identity of the database server requires setting the ssl-mode<br />\noption to VERIFY_CA or VERIFY_IDENTITY. This option was previously ignored<br />\nfor MySQL database tasks like creating a database and dumping the structure.</p>\n\n<p><em>Petrik de Heus</em></p>\n"
  },
  {
    "message": "*   Move `ActiveRecord::InternalMetadata` to an independent object.\n\n    `ActiveRecord::InternalMetadata` no longer inherits from `ActiveRecord::Base` and is now an independent object that should be instantiated with a `connection`. This class is private and should not be used by applications directly. If you want to interact with the schema migrations table, please access it on the connection directly, for example: `ActiveRecord::Base.connection.schema_migration`.\n\n    *Eileen M. Uchitelle*",
    "project": "activerecord",
    "date_merged": 1662991509000,
    "author": "eileencodes",
    "sha": "93ddf338a0763c2e6e81e8c9e64cea5cc891a523",
    "pr": "45982",
    "merge_sha": "53992c1a6639422600d6ed20d158089a074152e6",
    "html": "<p>Move <code>ActiveRecord::InternalMetadata</code> to an independent object.</p>\n\n<p><code>ActiveRecord::InternalMetadata</code> no longer inherits from <code>ActiveRecord::Base</code> and is now an independent object that should be instantiated with a <code>connection</code>. This class is private and should not be used by applications directly. If you want to interact with the schema migrations table, please access it on the connection directly, for example: <code>ActiveRecord::Base.connection.schema_migration</code>.</p>\n\n<p><em>Eileen M. Uchitelle</em></p>\n"
  },
  {
    "message": "*   Deprecate quoting `ActiveSupport::Duration` as an integer\n\n    Using ActiveSupport::Duration as an interpolated bind parameter in a SQL\n    string template is deprecated. To avoid this warning, you should explicitly\n    convert the duration to a more specific database type. For example, if you\n    want to use a duration as an integer number of seconds:\n    ```\n    Record.where(\"duration = ?\", 1.hour.to_i)\n    ```\n    If you want to use a duration as an ISO 8601 string:\n    ```\n    Record.where(\"duration = ?\", 1.hour.iso8601)\n    ```\n\n    *Aram Greenman*",
    "project": "activerecord",
    "date_merged": 1662758048000,
    "author": "Aram Greenman",
    "sha": "affb8cf2fe872276f2a6d17efd7e2df062897d11",
    "pr": "44438",
    "merge_sha": "9f372c94eaba780307f5bb91eb52a9dd16b8b2ba",
    "html": "<p>Deprecate quoting <code>ActiveSupport::Duration</code> as an integer</p>\n\n<p>Using ActiveSupport::Duration as an interpolated bind parameter in a SQL<br />\nstring template is deprecated. To avoid this warning, you should explicitly<br />\nconvert the duration to a more specific database type. For example, if you<br />\nwant to use a duration as an integer number of seconds:</p>\n<pre><code>Record.where(\"duration = ?\", 1.hour.to_i)\n</code></pre>\n<p>If you want to use a duration as an ISO 8601 string:</p>\n<pre><code>Record.where(\"duration = ?\", 1.hour.iso8601)\n</code></pre>\n\n<p><em>Aram Greenman</em></p>\n"
  },
  {
    "message": "*   Allow `QueryMethods#in_order_of` to order by a string column name.\n\n    ```ruby\n    Post.in_order_of(\"id\", [4,2,3,1]).to_a\n    Post.joins(:author).in_order_of(\"authors.name\", [\"Bob\", \"Anna\", \"John\"]).to_a\n    ```\n\n    *Igor Kasyanchuk*",
    "project": "activerecord",
    "date_merged": 1662752373000,
    "author": "admin",
    "sha": "62c358595c5427d246d8cf6a51597bc24d7d7cd6",
    "pr": "45971",
    "merge_sha": "556f0b61f12f1a30ca4edfb0119a31fe827ce23b",
    "html": "<p>Allow <code>QueryMethods#in_order_of</code> to order by a string column name.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">Post</span><span class=\"p\">.</span><span class=\"nf\">in_order_of</span><span class=\"p\">(</span><span class=\"s2\">\"id\"</span><span class=\"p\">,</span> <span class=\"p\">[</span><span class=\"mi\">4</span><span class=\"p\">,</span><span class=\"mi\">2</span><span class=\"p\">,</span><span class=\"mi\">3</span><span class=\"p\">,</span><span class=\"mi\">1</span><span class=\"p\">]).</span><span class=\"nf\">to_a</span>\n<span class=\"no\">Post</span><span class=\"p\">.</span><span class=\"nf\">joins</span><span class=\"p\">(</span><span class=\"ss\">:author</span><span class=\"p\">).</span><span class=\"nf\">in_order_of</span><span class=\"p\">(</span><span class=\"s2\">\"authors.name\"</span><span class=\"p\">,</span> <span class=\"p\">[</span><span class=\"s2\">\"Bob\"</span><span class=\"p\">,</span> <span class=\"s2\">\"Anna\"</span><span class=\"p\">,</span> <span class=\"s2\">\"John\"</span><span class=\"p\">]).</span><span class=\"nf\">to_a</span>\n</code></pre></div></div>\n\n<p><em>Igor Kasyanchuk</em></p>\n"
  },
  {
    "message": "*   Move `ActiveRecord::SchemaMigration` to an independent object.\n\n    `ActiveRecord::SchemaMigration` no longer inherits from `ActiveRecord::Base` and is now an independent object that should be instantiated with a `connection`. This class is private and should not be used by applications directly. If you want to interact with the schema migrations table, please access it on the connection directly, for example: `ActiveRecord::Base.connection.schema_migration`.\n\n    *Eileen M. Uchitelle*",
    "project": "activerecord",
    "date_merged": 1662733081000,
    "author": "eileencodes",
    "sha": "436277da88507f9aae0874e62f3e61a8546b9683",
    "pr": "45908",
    "merge_sha": "063db854bbbb946aad8893b411b02f56bbdfb0ec",
    "html": "<p>Move <code>ActiveRecord::SchemaMigration</code> to an independent object.</p>\n\n<p><code>ActiveRecord::SchemaMigration</code> no longer inherits from <code>ActiveRecord::Base</code> and is now an independent object that should be instantiated with a <code>connection</code>. This class is private and should not be used by applications directly. If you want to interact with the schema migrations table, please access it on the connection directly, for example: <code>ActiveRecord::Base.connection.schema_migration</code>.</p>\n\n<p><em>Eileen M. Uchitelle</em></p>\n"
  },
  {
    "message": "*   Deprecate `all_connection_pools` and make `connection_pool_list` more explicit.\n\n    Following on #45924 `all_connection_pools` is now deprecated. `connection_pool_list` will either take an explicit role or applications can opt into the new behavior by passing `:all`.\n\n    *Eileen M. Uchitelle*",
    "project": "activerecord",
    "date_merged": 1662578148000,
    "author": "eileencodes",
    "sha": "69396b75c91cdbbf141331356ef7c41bbfea1950",
    "pr": "45961",
    "merge_sha": "86a280a34781d708180bdcfd9c255192d96dbb77",
    "html": "<p>Deprecate <code>all_connection_pools</code> and make <code>connection_pool_list</code> more explicit.</p>\n\n<p>Following on #45924 <code>all_connection_pools</code> is now deprecated. <code>connection_pool_list</code> will either take an explicit role or applications can opt into the new behavior by passing <code>:all</code>.</p>\n\n<p><em>Eileen M. Uchitelle</em></p>\n"
  },
  {
    "message": "*   Fix connection handler methods to operate on all pools.\n\n    `active_connections?`, `clear_active_connections!`, `clear_reloadable_connections!`, `clear_all_connections!`, and `flush_idle_connections!` now operate on all pools by default. Previously they would default to using the `current_role` or `:writing` role unless specified.\n\n    *Eileen M. Uchitelle*",
    "project": "activerecord",
    "date_merged": 1662573880000,
    "author": "eileencodes",
    "sha": "74cb960e66510454791ecccd574e1275b9c8dc37",
    "pr": "45924",
    "merge_sha": "cebd9ab11bb899021908f0a416daa7fb8cf5231b",
    "html": "<p>Fix connection handler methods to operate on all pools.</p>\n\n<p><code>active_connections?</code>, <code>clear_active_connections!</code>, <code>clear_reloadable_connections!</code>, <code>clear_all_connections!</code>, and <code>flush_idle_connections!</code> now operate on all pools by default. Previously they would default to using the <code>current_role</code> or <code>:writing</code> role unless specified.</p>\n\n<p><em>Eileen M. Uchitelle</em></p>\n"
  },
  {
    "message": "*   Allow ActiveRecord::QueryMethods#select to receive hash values.\n\n    Currently, `select` might receive only raw sql and symbols to define columns and aliases to select.\n\n    With this change we can provide `hash` as argument, for example:\n\n    ```ruby\n    Post.joins(:comments).select(posts: [:id, :title, :created_at], comments: [:id, :body, :author_id])\n    #=> \"SELECT \\\"posts\\\".\\\"id\\\", \\\"posts\\\".\\\"title\\\", \\\"posts\\\".\\\"created_at\\\", \\\"comments\\\".\\\"id\\\", \\\"comments\\\".\\\"body\\\", \\\"comments\\\".\\\"author_id\\\"\n    #   FROM \\\"posts\\\" INNER JOIN \\\"comments\\\" ON \\\"comments\\\".\\\"post_id\\\" = \\\"posts\\\".\\\"id\\\"\"\n\n    Post.joins(:comments).select(posts: { id: :post_id, title: :post_title }, comments: { id: :comment_id, body: :comment_body })\n    #=> \"SELECT posts.id as post_id, posts.title as post_title, comments.id as comment_id, comments.body as comment_body\n    #    FROM \\\"posts\\\" INNER JOIN \\\"comments\\\" ON \\\"comments\\\".\\\"post_id\\\" = \\\"posts\\\".\\\"id\\\"\"\n    ```\n    *Oleksandr Holubenko*, *Josef Šimánek*, *Jean Boussier*",
    "project": "activerecord",
    "date_merged": 1662111236000,
    "author": "alextrueman",
    "sha": "f4cfc2acdd29f1654930cdbed342eff0c449479b",
    "pr": "45612",
    "merge_sha": "2b01f332c6f4f56c8d3f3e680890642bd4ea3e16",
    "html": "<p>Allow ActiveRecord::QueryMethods#select to receive hash values.</p>\n\n<p>Currently, <code>select</code> might receive only raw sql and symbols to define columns and aliases to select.</p>\n\n<p>With this change we can provide <code>hash</code> as argument, for example:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">Post</span><span class=\"p\">.</span><span class=\"nf\">joins</span><span class=\"p\">(</span><span class=\"ss\">:comments</span><span class=\"p\">).</span><span class=\"nf\">select</span><span class=\"p\">(</span><span class=\"ss\">posts: </span><span class=\"p\">[</span><span class=\"ss\">:id</span><span class=\"p\">,</span> <span class=\"ss\">:title</span><span class=\"p\">,</span> <span class=\"ss\">:created_at</span><span class=\"p\">],</span> <span class=\"ss\">comments: </span><span class=\"p\">[</span><span class=\"ss\">:id</span><span class=\"p\">,</span> <span class=\"ss\">:body</span><span class=\"p\">,</span> <span class=\"ss\">:author_id</span><span class=\"p\">])</span>\n<span class=\"c1\">#=&gt; \"SELECT \\\"posts\\\".\\\"id\\\", \\\"posts\\\".\\\"title\\\", \\\"posts\\\".\\\"created_at\\\", \\\"comments\\\".\\\"id\\\", \\\"comments\\\".\\\"body\\\", \\\"comments\\\".\\\"author_id\\\"</span>\n<span class=\"c1\">#   FROM \\\"posts\\\" INNER JOIN \\\"comments\\\" ON \\\"comments\\\".\\\"post_id\\\" = \\\"posts\\\".\\\"id\\\"\"</span>\n\n<span class=\"no\">Post</span><span class=\"p\">.</span><span class=\"nf\">joins</span><span class=\"p\">(</span><span class=\"ss\">:comments</span><span class=\"p\">).</span><span class=\"nf\">select</span><span class=\"p\">(</span><span class=\"ss\">posts: </span><span class=\"p\">{</span> <span class=\"ss\">id: :post_id</span><span class=\"p\">,</span> <span class=\"ss\">title: :post_title</span> <span class=\"p\">},</span> <span class=\"ss\">comments: </span><span class=\"p\">{</span> <span class=\"ss\">id: :comment_id</span><span class=\"p\">,</span> <span class=\"ss\">body: :comment_body</span> <span class=\"p\">})</span>\n<span class=\"c1\">#=&gt; \"SELECT posts.id as post_id, posts.title as post_title, comments.id as comment_id, comments.body as comment_body</span>\n<span class=\"c1\">#    FROM \\\"posts\\\" INNER JOIN \\\"comments\\\" ON \\\"comments\\\".\\\"post_id\\\" = \\\"posts\\\".\\\"id\\\"\"</span>\n</code></pre></div></div>\n<p><em>Oleksandr Holubenko</em>, <em>Josef Šimánek</em>, <em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   Adapts virtual attributes on `ActiveRecord::Persistence#becomes`.\n\n    When source and target classes have a different set of attributes adapts\n    attributes such that the extra attributes from target are added.\n\n    ```ruby\n    class Person < ApplicationRecord\n    end\n\n    class WebUser < Person\n      attribute :is_admin, :boolean\n      after_initialize :set_admin\n\n      def set_admin\n        write_attribute(:is_admin, email =~ /@ourcompany\\.com$/)\n      end\n    end\n\n    person = Person.find_by(email: \"email@ourcompany.com\")\n    person.respond_to? :is_admin\n    # => false\n    person.becomes(WebUser).is_admin?\n    # => true\n    ```\n\n    *Jacopo Beschi*, *Sampson Crowley*",
    "project": "activerecord",
    "date_merged": 1661442534000,
    "author": "Jacopo",
    "sha": "2f5136a3be5e87c95e0e5578f8eae69f54fcd0ac",
    "pr": "42650",
    "merge_sha": "0fbac7f409a8e1b93f5ad6d56b34c6798d8bf27d",
    "html": "<p>Adapts virtual attributes on <code>ActiveRecord::Persistence#becomes</code>.</p>\n\n<p>When source and target classes have a different set of attributes adapts<br />\nattributes such that the extra attributes from target are added.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">class</span> <span class=\"nc\">Person</span> <span class=\"o\">&lt;</span> <span class=\"no\">ApplicationRecord</span>\n<span class=\"k\">end</span>\n\n<span class=\"k\">class</span> <span class=\"nc\">WebUser</span> <span class=\"o\">&lt;</span> <span class=\"no\">Person</span>\n  <span class=\"n\">attribute</span> <span class=\"ss\">:is_admin</span><span class=\"p\">,</span> <span class=\"ss\">:boolean</span>\n  <span class=\"n\">after_initialize</span> <span class=\"ss\">:set_admin</span>\n\n  <span class=\"k\">def</span> <span class=\"nf\">set_admin</span>\n    <span class=\"n\">write_attribute</span><span class=\"p\">(</span><span class=\"ss\">:is_admin</span><span class=\"p\">,</span> <span class=\"n\">email</span> <span class=\"o\">=~</span> <span class=\"sr\">/@ourcompany\\.com$/</span><span class=\"p\">)</span>\n  <span class=\"k\">end</span>\n<span class=\"k\">end</span>\n\n<span class=\"n\">person</span> <span class=\"o\">=</span> <span class=\"no\">Person</span><span class=\"p\">.</span><span class=\"nf\">find_by</span><span class=\"p\">(</span><span class=\"ss\">email: </span><span class=\"s2\">\"email@ourcompany.com\"</span><span class=\"p\">)</span>\n<span class=\"n\">person</span><span class=\"p\">.</span><span class=\"nf\">respond_to?</span> <span class=\"ss\">:is_admin</span>\n<span class=\"c1\"># =&gt; false</span>\n<span class=\"n\">person</span><span class=\"p\">.</span><span class=\"nf\">becomes</span><span class=\"p\">(</span><span class=\"no\">WebUser</span><span class=\"p\">).</span><span class=\"nf\">is_admin?</span>\n<span class=\"c1\"># =&gt; true</span>\n</code></pre></div></div>\n\n<p><em>Jacopo Beschi</em>, <em>Sampson Crowley</em></p>\n"
  },
  {
    "message": "*   Fix `ActiveRecord::QueryMethods#in_order_of` to include `nil`s, to match the\n    behavior of `Enumerable#in_order_of`.\n\n    For example, `Post.in_order_of(:title, [nil, \"foo\"])` will now include posts\n    with `nil` titles, the same as `Post.all.to_a.in_order_of(:title, [nil, \"foo\"])`.\n\n    *fatkodima*",
    "project": "activerecord",
    "date_merged": 1660796735000,
    "author": "Jonathan Hefner",
    "sha": "18f8c6ac9ba97715d77085133d7b6fa7e21fd235",
    "pr": "45670",
    "merge_sha": "8b55410c388541f72eae719652fce718a3e98dc7",
    "html": "<p>Fix <code>ActiveRecord::QueryMethods#in_order_of</code> to include <code>nil</code>s, to match the<br />\nbehavior of <code>Enumerable#in_order_of</code>.</p>\n\n<p>For example, <code>Post.in_order_of(:title, [nil, \"foo\"])</code> will now include posts<br />\nwith <code>nil</code> titles, the same as <code>Post.all.to_a.in_order_of(:title, [nil, \"foo\"])</code>.</p>\n\n<p><em>fatkodima</em></p>\n"
  },
  {
    "message": "*   Optimize `add_timestamps` to use a single SQL statement.\n\n    ```ruby\n    add_timestamps :my_table\n    ```\n\n    Now results in the following SQL:\n\n    ```sql\n    ALTER TABLE \"my_table\" ADD COLUMN \"created_at\" datetime(6) NOT NULL, ADD COLUMN \"updated_at\" datetime(6) NOT NULL\n    ```\n\n    *Iliana Hadzhiatanasova*",
    "project": "activerecord",
    "date_merged": 1660267804000,
    "author": "Iliana Hadzhiatanasova",
    "sha": "79096618f04e08b9c1e9ba3100dd889ba8fd08e6",
    "pr": "45723",
    "merge_sha": "0c212836bcca5909f4833a5b7ed6a70bb666a98a",
    "html": "<p>Optimize <code>add_timestamps</code> to use a single SQL statement.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">add_timestamps</span> <span class=\"ss\">:my_table</span>\n</code></pre></div></div>\n\n<p>Now results in the following SQL:</p>\n\n<div class=\"language-sql highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">ALTER</span> <span class=\"k\">TABLE</span> <span class=\"nv\">\"my_table\"</span> <span class=\"k\">ADD</span> <span class=\"k\">COLUMN</span> <span class=\"nv\">\"created_at\"</span> <span class=\"nb\">datetime</span><span class=\"p\">(</span><span class=\"mi\">6</span><span class=\"p\">)</span> <span class=\"k\">NOT</span> <span class=\"k\">NULL</span><span class=\"p\">,</span> <span class=\"k\">ADD</span> <span class=\"k\">COLUMN</span> <span class=\"nv\">\"updated_at\"</span> <span class=\"nb\">datetime</span><span class=\"p\">(</span><span class=\"mi\">6</span><span class=\"p\">)</span> <span class=\"k\">NOT</span> <span class=\"k\">NULL</span>\n</code></pre></div></div>\n\n<p><em>Iliana Hadzhiatanasova</em></p>\n"
  },
  {
    "message": "*   Add `drop_enum` migration command for PostgreSQL\n\n    This does the inverse of `create_enum`. Before dropping an enum, ensure you have\n    dropped columns that depend on it.\n\n    *Alex Ghiculescu*",
    "project": "activerecord",
    "date_merged": 1659572806000,
    "author": "Alex Ghiculescu",
    "sha": "bd0fdc8094294fb214b102a78f72a2c0d0063b5b",
    "pr": "45735",
    "merge_sha": "a0c1d33d2f934ebe050b8dd69336200cbca2ae3e",
    "html": "<p>Add <code>drop_enum</code> migration command for PostgreSQL</p>\n\n<p>This does the inverse of <code>create_enum</code>. Before dropping an enum, ensure you have<br />\ndropped columns that depend on it.</p>\n\n<p><em>Alex Ghiculescu</em></p>\n"
  },
  {
    "message": "*   Adds support for `if_exists` option when removing a check constraint.\n\n    The `remove_check_constraint` method now accepts an `if_exists` option. If set\n    to true an error won't be raised if the check constraint doesn't exist.\n\n    *Margaret Parsa* and *Aditya Bhutani*",
    "project": "activerecord",
    "date_merged": 1659558782000,
    "author": "eileencodes",
    "sha": "25f97a66bdae6efe788b2d0ab7ab9cef6fc5a23a",
    "pr": "45743",
    "merge_sha": "cf0873010a131c2a1e43adbb15ca4dda380f103c",
    "html": "<p>Adds support for <code>if_exists</code> option when removing a check constraint.</p>\n\n<p>The <code>remove_check_constraint</code> method now accepts an <code>if_exists</code> option. If set<br />\nto true an error won’t be raised if the check constraint doesn’t exist.</p>\n\n<p><em>Margaret Parsa</em> and <em>Aditya Bhutani</em></p>\n"
  },
  {
    "message": "*   `find_or_create_by` now try to find a second time if it hits a unicity constraint.\n\n    `find_or_create_by` always has been inherently racy, either creating multiple\n    duplicate records or failing with `ActiveRecord::RecordNotUnique` depending on\n    whether a proper unicity constraint was set.\n\n    `create_or_find_by` was introduced for this use case, however it's quite wasteful\n    when the record is expected to exist most of the time, as INSERT require to send\n    more data than SELECT and require more work from the database. Also on some\n    databases it can actually consume a primary key increment which is undesirable.\n\n    So for case where most of the time the record is expected to exist, `find_or_create_by`\n    can be made race-condition free by re-trying the `find` if the `create` failed\n    with `ActiveRecord::RecordNotUnique`. This assumes that the table has the proper\n    unicity constraints, if not, `find_or_create_by` will still lead to duplicated records.\n\n    *Jean Boussier*, *Alex Kitchens*",
    "project": "activerecord",
    "date_merged": 1659445880000,
    "author": "Jean Boussier",
    "sha": "023a3eb3c046091a5d52027393a6d29d0576da01",
    "pr": "45720",
    "merge_sha": "408d061a80a49878ad26b305616ed9ba88ee1411",
    "html": "<p><code>find_or_create_by</code> now try to find a second time if it hits a unicity constraint.</p>\n\n<p><code>find_or_create_by</code> always has been inherently racy, either creating multiple<br />\nduplicate records or failing with <code>ActiveRecord::RecordNotUnique</code> depending on<br />\nwhether a proper unicity constraint was set.</p>\n\n<p><code>create_or_find_by</code> was introduced for this use case, however it’s quite wasteful<br />\nwhen the record is expected to exist most of the time, as INSERT require to send<br />\nmore data than SELECT and require more work from the database. Also on some<br />\ndatabases it can actually consume a primary key increment which is undesirable.</p>\n\n<p>So for case where most of the time the record is expected to exist, <code>find_or_create_by</code><br />\ncan be made race-condition free by re-trying the <code>find</code> if the <code>create</code> failed<br />\nwith <code>ActiveRecord::RecordNotUnique</code>. This assumes that the table has the proper<br />\nunicity constraints, if not, <code>find_or_create_by</code> will still lead to duplicated records.</p>\n\n<p><em>Jean Boussier</em>, <em>Alex Kitchens</em></p>\n"
  },
  {
    "message": "*   Introduce a simpler constructor API for ActiveRecord database adapters.\n\n    Previously the adapter had to know how to build a new raw connection to\n    support reconnect, but also expected to be passed an initial already-\n    established connection.\n\n    When manually creating an adapter instance, it will now accept a single\n    config hash, and only establish the real connection on demand.\n\n    *Matthew Draper*",
    "project": "activerecord",
    "date_merged": 1659127561000,
    "author": "Matthew Draper",
    "sha": "1adb6170d5685e18d6918118a0eaf80453dd0175",
    "pr": "44576",
    "merge_sha": "73909f45be912414651e78ee49ccfe5e379721af",
    "html": "<p>Introduce a simpler constructor API for ActiveRecord database adapters.</p>\n\n<p>Previously the adapter had to know how to build a new raw connection to<br />\nsupport reconnect, but also expected to be passed an initial already-<br />\nestablished connection.</p>\n\n<p>When manually creating an adapter instance, it will now accept a single<br />\nconfig hash, and only establish the real connection on demand.</p>\n\n<p><em>Matthew Draper</em></p>\n"
  },
  {
    "message": "*   Avoid redundant `SELECT 1` connection-validation query during DB pool\n    checkout when possible.\n\n    If the first query run during a request is known to be idempotent, it can be\n    used directly to validate the connection, saving a network round-trip.\n\n    *Matthew Draper*",
    "project": "activerecord",
    "date_merged": 1659127561000,
    "author": "Matthew Draper",
    "sha": "1adb6170d5685e18d6918118a0eaf80453dd0175",
    "pr": "44576",
    "merge_sha": "73909f45be912414651e78ee49ccfe5e379721af",
    "html": "<p>Avoid redundant <code>SELECT 1</code> connection-validation query during DB pool<br />\ncheckout when possible.</p>\n\n<p>If the first query run during a request is known to be idempotent, it can be<br />\nused directly to validate the connection, saving a network round-trip.</p>\n\n<p><em>Matthew Draper</em></p>\n"
  },
  {
    "message": "*   Automatically reconnect broken database connections when safe, even\n    mid-request.\n\n    When an error occurs while attempting to run a known-idempotent query, and\n    not inside a transaction, it is safe to immediately reconnect to the\n    database server and try again, so this is now the default behavior.\n\n    This new default should always be safe -- to support that, it's consciously\n    conservative about which queries are considered idempotent -- but if\n    necessary it can be disabled by setting the `connection_retries` connection\n    option to `0`.\n\n    *Matthew Draper*",
    "project": "activerecord",
    "date_merged": 1659127561000,
    "author": "Matthew Draper",
    "sha": "1adb6170d5685e18d6918118a0eaf80453dd0175",
    "pr": "44576",
    "merge_sha": "73909f45be912414651e78ee49ccfe5e379721af",
    "html": "<p>Automatically reconnect broken database connections when safe, even<br />\nmid-request.</p>\n\n<p>When an error occurs while attempting to run a known-idempotent query, and<br />\nnot inside a transaction, it is safe to immediately reconnect to the<br />\ndatabase server and try again, so this is now the default behavior.</p>\n\n<p>This new default should always be safe – to support that, it’s consciously<br />\nconservative about which queries are considered idempotent – but if<br />\nnecessary it can be disabled by setting the <code>connection_retries</code> connection<br />\noption to <code>0</code>.</p>\n\n<p><em>Matthew Draper</em></p>\n"
  },
  {
    "message": "*   Avoid removing a PostgreSQL extension when there are dependent objects.\n\n    Previously, removing an extension also implicitly removed dependent objects. Now, this will raise an error.\n\n    You can force removing the extension:\n\n    ```ruby\n    disable_extension :citext, force: :cascade\n    ```\n\n    Fixes #29091.\n\n    *fatkodima*",
    "project": "activerecord",
    "date_merged": 1658750148000,
    "author": "fatkodima",
    "sha": "515a9215d1e68e071522831f61fb71772f15272a",
    "pr": "45474",
    "merge_sha": "1755c5ac28a0baf10df305573569f71babdf7545",
    "html": "<p>Avoid removing a PostgreSQL extension when there are dependent objects.</p>\n\n<p>Previously, removing an extension also implicitly removed dependent objects. Now, this will raise an error.</p>\n\n<p>You can force removing the extension:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">disable_extension</span> <span class=\"ss\">:citext</span><span class=\"p\">,</span> <span class=\"ss\">force: :cascade</span>\n</code></pre></div></div>\n\n<p>Fixes #29091.</p>\n\n<p><em>fatkodima</em></p>\n"
  },
  {
    "message": "*   Allow nested functions as safe SQL string\n\n    *Michael Siegfried*",
    "project": "activerecord",
    "date_merged": 1658257455000,
    "author": "Michael Siegfried",
    "sha": "8fe1bd555f82715508d386b823a9d91628d10aab",
    "pr": "44010",
    "merge_sha": "71c59c69f40cef908d0a97ef4b4c5496778559e5",
    "html": "<p>Allow nested functions as safe SQL string</p>\n\n<p><em>Michael Siegfried</em></p>\n"
  },
  {
    "message": "*   Allow `destroy_association_async_job=` to be configured with a class string instead of a constant.\n\n    Defers an autoloading dependency between `ActiveRecord::Base` and `ActiveJob::Base`\n    and moves the configuration of `ActiveRecord::DestroyAssociationAsyncJob`\n    from ActiveJob to ActiveRecord.\n\n    Deprecates `ActiveRecord::ActiveJobRequiredError` and now raises a `NameError`\n    if the job class is unloadable or an `ActiveRecord::ConfigurationError` if\n    `dependent: :destroy_async` is declared on an association but there is no job\n    class configured.\n\n    *Ben Sheldon*",
    "project": "activerecord",
    "date_merged": 1657735599000,
    "author": "Ben Sheldon",
    "sha": "8fceabd1e857f5babf4ba1ff0174b564fc372d84",
    "pr": "45476",
    "merge_sha": "4dafe6a1eb38b834eea98f2c8e9e808b0579b58a",
    "html": "<p>Allow <code>destroy_association_async_job=</code> to be configured with a class string instead of a constant.</p>\n\n<p>Defers an autoloading dependency between <code>ActiveRecord::Base</code> and <code>ActiveJob::Base</code><br />\nand moves the configuration of <code>ActiveRecord::DestroyAssociationAsyncJob</code><br />\nfrom ActiveJob to ActiveRecord.</p>\n\n<p>Deprecates <code>ActiveRecord::ActiveJobRequiredError</code> and now raises a <code>NameError</code><br />\nif the job class is unloadable or an <code>ActiveRecord::ConfigurationError</code> if<br />\n<code>dependent: :destroy_async</code> is declared on an association but there is no job<br />\nclass configured.</p>\n\n<p><em>Ben Sheldon</em></p>\n"
  },
  {
    "message": "*   Fix `ActiveRecord::Store` to serialize as a regular Hash\n\n    Previously it would serialize as an `ActiveSupport::HashWithIndifferentAccess`\n    which is wasteful and cause problem with YAML safe_load.\n\n    *Jean Boussier*",
    "project": "activerecord",
    "date_merged": 1657731157000,
    "author": "Jean Boussier",
    "sha": "05fdb3edfd0abe9b7e99f6b1fbb518e791a5c3ec",
    "pr": "45591",
    "merge_sha": "f002cada62bd6bad9a9b5a6f4ac1da7473a72b13",
    "html": "<p>Fix <code>ActiveRecord::Store</code> to serialize as a regular Hash</p>\n\n<p>Previously it would serialize as an <code>ActiveSupport::HashWithIndifferentAccess</code><br />\nwhich is wasteful and cause problem with YAML safe_load.</p>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   Add `timestamptz` as a time zone aware type for PostgreSQL\n\n    This is required for correctly parsing `timestamp with time zone` values in your database.\n\n    If you don't want this, you can opt out by adding this initializer:\n\n    ```ruby\n    ActiveRecord::Base.time_zone_aware_types -= [:timestamptz]\n    ```\n\n    *Alex Ghiculescu*",
    "project": "activerecord",
    "date_merged": 1657495384000,
    "author": "Alex Ghiculescu",
    "sha": "75c406d774cbc4debf0d672a59a1e726b64cd57c",
    "pr": "44601",
    "merge_sha": "2cf8f37d50977006dda88cfc947bf28f03270c68",
    "html": "<p>Add <code>timestamptz</code> as a time zone aware type for PostgreSQL</p>\n\n<p>This is required for correctly parsing <code>timestamp with time zone</code> values in your database.</p>\n\n<p>If you don’t want this, you can opt out by adding this initializer:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">ActiveRecord</span><span class=\"o\">::</span><span class=\"no\">Base</span><span class=\"p\">.</span><span class=\"nf\">time_zone_aware_types</span> <span class=\"o\">-=</span> <span class=\"p\">[</span><span class=\"ss\">:timestamptz</span><span class=\"p\">]</span>\n</code></pre></div></div>\n\n<p><em>Alex Ghiculescu</em></p>\n"
  },
  {
    "message": "*   Add new `ActiveRecord::Base::generates_token_for` API.\n\n    Currently, `signed_id` fulfills the role of generating tokens for e.g.\n    resetting a password.  However, signed IDs cannot reflect record state, so\n    if a token is intended to be single-use, it must be tracked in a database at\n    least until it expires.\n\n    With `generates_token_for`, a token can embed data from a record.  When\n    using the token to fetch the record, the data from the token and the data\n    from the record will be compared.  If the two do not match, the token will\n    be treated as invalid, the same as if it had expired.  For example:\n\n    ```ruby\n    class User < ActiveRecord::Base\n      has_secure_password\n\n      generates_token_for :password_reset, expires_in: 15.minutes do\n        # A password's BCrypt salt changes when the password is updated.\n        # By embedding (part of) the salt in a token, the token will\n        # expire when the password is updated.\n        BCrypt::Password.new(password_digest).salt[-10..]\n      end\n    end\n\n    user = User.first\n    token = user.generate_token_for(:password_reset)\n\n    User.find_by_token_for(:password_reset, token) # => user\n\n    user.update!(password: \"new password\")\n    User.find_by_token_for(:password_reset, token) # => nil\n    ```\n\n    *Jonathan Hefner*",
    "project": "activerecord",
    "date_merged": 1657345167000,
    "author": "Jonathan Hefner",
    "sha": "d44e786d216f82584c7752ffee91ef4d5bea14ba",
    "pr": "44189",
    "merge_sha": "6f20be9f972340ecb2dabb21c95598238b9c260f",
    "html": "<p>Add new <code>ActiveRecord::Base::generates_token_for</code> API.</p>\n\n<p>Currently, <code>signed_id</code> fulfills the role of generating tokens for e.g.<br />\nresetting a password.  However, signed IDs cannot reflect record state, so<br />\nif a token is intended to be single-use, it must be tracked in a database at<br />\nleast until it expires.</p>\n\n<p>With <code>generates_token_for</code>, a token can embed data from a record.  When<br />\nusing the token to fetch the record, the data from the token and the data<br />\nfrom the record will be compared.  If the two do not match, the token will<br />\nbe treated as invalid, the same as if it had expired.  For example:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">class</span> <span class=\"nc\">User</span> <span class=\"o\">&lt;</span> <span class=\"no\">ActiveRecord</span><span class=\"o\">::</span><span class=\"no\">Base</span>\n  <span class=\"n\">has_secure_password</span>\n\n  <span class=\"n\">generates_token_for</span> <span class=\"ss\">:password_reset</span><span class=\"p\">,</span> <span class=\"ss\">expires_in: </span><span class=\"mi\">15</span><span class=\"p\">.</span><span class=\"nf\">minutes</span> <span class=\"k\">do</span>\n    <span class=\"c1\"># A password's BCrypt salt changes when the password is updated.</span>\n    <span class=\"c1\"># By embedding (part of) the salt in a token, the token will</span>\n    <span class=\"c1\"># expire when the password is updated.</span>\n    <span class=\"no\">BCrypt</span><span class=\"o\">::</span><span class=\"no\">Password</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"n\">password_digest</span><span class=\"p\">).</span><span class=\"nf\">salt</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">10</span><span class=\"o\">..</span><span class=\"p\">]</span>\n  <span class=\"k\">end</span>\n<span class=\"k\">end</span>\n\n<span class=\"n\">user</span> <span class=\"o\">=</span> <span class=\"no\">User</span><span class=\"p\">.</span><span class=\"nf\">first</span>\n<span class=\"n\">token</span> <span class=\"o\">=</span> <span class=\"n\">user</span><span class=\"p\">.</span><span class=\"nf\">generate_token_for</span><span class=\"p\">(</span><span class=\"ss\">:password_reset</span><span class=\"p\">)</span>\n\n<span class=\"no\">User</span><span class=\"p\">.</span><span class=\"nf\">find_by_token_for</span><span class=\"p\">(</span><span class=\"ss\">:password_reset</span><span class=\"p\">,</span> <span class=\"n\">token</span><span class=\"p\">)</span> <span class=\"c1\"># =&gt; user</span>\n\n<span class=\"n\">user</span><span class=\"p\">.</span><span class=\"nf\">update!</span><span class=\"p\">(</span><span class=\"ss\">password: </span><span class=\"s2\">\"new password\"</span><span class=\"p\">)</span>\n<span class=\"no\">User</span><span class=\"p\">.</span><span class=\"nf\">find_by_token_for</span><span class=\"p\">(</span><span class=\"ss\">:password_reset</span><span class=\"p\">,</span> <span class=\"n\">token</span><span class=\"p\">)</span> <span class=\"c1\"># =&gt; nil</span>\n</code></pre></div></div>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Optimize Active Record batching for whole table iterations.\n\n    Previously, `in_batches` got all the ids and constructed an `IN`-based query for each batch.\n    When iterating over the whole tables, this approach is not optimal as it loads unneeded ids and\n    `IN` queries with lots of items are slow.\n\n    Now, whole table iterations use range iteration (`id >= x AND id <= y`) by default which can make iteration\n    several times faster. E.g., tested on a PostgreSQL table with 10 million records: querying (`253s` vs `30s`),\n    updating (`288s` vs `124s`), deleting (`268s` vs `83s`).\n\n    Only whole table iterations use this style of iteration by default. You can disable this behavior by passing `use_ranges: false`.\n    If you iterate over the table and the only condition is, e.g., `archived_at: nil` (and only a tiny fraction\n    of the records are archived), it makes sense to opt in to this approach:\n\n    ```ruby\n    Project.where(archived_at: nil).in_batches(use_ranges: true) do |relation|\n      # do something\n    end\n    ```\n\n    See #45414 for more details.\n\n    *fatkodima*",
    "project": "activerecord",
    "date_merged": 1657095010000,
    "author": "fatkodima",
    "sha": "620f24782977b8e53e06cf0e2c905a591936e990",
    "pr": "45414",
    "merge_sha": "fd1196bd51491270e146b310c71928e911a90499",
    "html": "<p>Optimize Active Record batching for whole table iterations.</p>\n\n<p>Previously, <code>in_batches</code> got all the ids and constructed an <code>IN</code>-based query for each batch.<br />\nWhen iterating over the whole tables, this approach is not optimal as it loads unneeded ids and<br />\n<code>IN</code> queries with lots of items are slow.</p>\n\n<p>Now, whole table iterations use range iteration (<code>id &gt;= x AND id &lt;= y</code>) by default which can make iteration<br />\nseveral times faster. E.g., tested on a PostgreSQL table with 10 million records: querying (<code>253s</code> vs <code>30s</code>),<br />\nupdating (<code>288s</code> vs <code>124s</code>), deleting (<code>268s</code> vs <code>83s</code>).</p>\n\n<p>Only whole table iterations use this style of iteration by default. You can disable this behavior by passing <code>use_ranges: false</code>.<br />\nIf you iterate over the table and the only condition is, e.g., <code>archived_at: nil</code> (and only a tiny fraction<br />\nof the records are archived), it makes sense to opt in to this approach:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">Project</span><span class=\"p\">.</span><span class=\"nf\">where</span><span class=\"p\">(</span><span class=\"ss\">archived_at: </span><span class=\"kp\">nil</span><span class=\"p\">).</span><span class=\"nf\">in_batches</span><span class=\"p\">(</span><span class=\"ss\">use_ranges: </span><span class=\"kp\">true</span><span class=\"p\">)</span> <span class=\"k\">do</span> <span class=\"o\">|</span><span class=\"n\">relation</span><span class=\"o\">|</span>\n  <span class=\"c1\"># do something</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p>See #45414 for more details.</p>\n\n<p><em>fatkodima</em></p>\n"
  },
  {
    "message": "*   `.with` query method added. Construct common table expressions with ease and get `ActiveRecord::Relation` back.\n\n    ```ruby\n    Post.with(posts_with_comments: Post.where(\"comments_count > ?\", 0))\n    # => ActiveRecord::Relation\n    # WITH posts_with_comments AS (SELECT * FROM posts WHERE (comments_count > 0)) SELECT * FROM posts\n    ```\n\n    *Vlado Cingel*",
    "project": "activerecord",
    "date_merged": 1657003169000,
    "author": "Vlado Cingel",
    "sha": "098b0eb5dbcf1a942c4e727dcdc150151bea51ab",
    "pr": "37944",
    "merge_sha": "b3175b953cf5e7d0f3afb3cc4268ec452993b2ad",
    "html": "<p><code>.with</code> query method added. Construct common table expressions with ease and get <code>ActiveRecord::Relation</code> back.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">Post</span><span class=\"p\">.</span><span class=\"nf\">with</span><span class=\"p\">(</span><span class=\"ss\">posts_with_comments: </span><span class=\"no\">Post</span><span class=\"p\">.</span><span class=\"nf\">where</span><span class=\"p\">(</span><span class=\"s2\">\"comments_count &gt; ?\"</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">))</span>\n<span class=\"c1\"># =&gt; ActiveRecord::Relation</span>\n<span class=\"c1\"># WITH posts_with_comments AS (SELECT * FROM posts WHERE (comments_count &gt; 0)) SELECT * FROM posts</span>\n</code></pre></div></div>\n\n<p><em>Vlado Cingel</em></p>\n"
  },
  {
    "message": "*   Don't establish a new connection if an identical pool exists already.\n\n    Previously, if `establish_connection` was called on a class that already had an established connection, the existing connection would be removed regardless of whether it was the same config. Now if a pool is found with the same values as the new connection, the existing connection will be returned instead of creating a new one.\n\n    This has a slight change in behavior if application code is depending on a new connection being established regardless of whether it's identical to an existing connection. If the old behavior is desirable, applications should call `ActiveRecord::Base#remove_connection` before establishing a new one. Calling `establish_connection` with a different config works the same way as it did previously.\n\n    *Eileen M. Uchitelle*",
    "project": "activerecord",
    "date_merged": 1656524266000,
    "author": "eileencodes",
    "sha": "adb64db43dba5cad1007ce57e25df67f8b3e91f8",
    "pr": "45450",
    "merge_sha": "462545c0a5b94882a16245e5532b600044263bec",
    "html": "<p>Don’t establish a new connection if an identical pool exists already.</p>\n\n<p>Previously, if <code>establish_connection</code> was called on a class that already had an established connection, the existing connection would be removed regardless of whether it was the same config. Now if a pool is found with the same values as the new connection, the existing connection will be returned instead of creating a new one.</p>\n\n<p>This has a slight change in behavior if application code is depending on a new connection being established regardless of whether it’s identical to an existing connection. If the old behavior is desirable, applications should call <code>ActiveRecord::Base#remove_connection</code> before establishing a new one. Calling <code>establish_connection</code> with a different config works the same way as it did previously.</p>\n\n<p><em>Eileen M. Uchitelle</em></p>\n"
  },
  {
    "message": "*   Update `db:prepare` task to load schema when an uninitialized database exists, and dump schema after migrations.\n\n    *Ben Sheldon*",
    "project": "activerecord",
    "date_merged": 1656444155000,
    "author": "Ben Sheldon [he/him]",
    "sha": "660fee087d4c92f0c7c31f11bc29b5f40e399caa",
    "pr": "45464",
    "merge_sha": "7ebda0aded3d1f004fd644496cbb80abd94ced19",
    "html": "<p>Update <code>db:prepare</code> task to load schema when an uninitialized database exists, and dump schema after migrations.</p>\n\n<p><em>Ben Sheldon</em></p>\n"
  },
  {
    "message": "*   Fix supporting timezone awareness for `tsrange` and `tstzrange` array columns.\n\n    ```ruby\n    # In database migrations\n    add_column :shops, :open_hours, :tsrange, array: true\n    # In app config\n    ActiveRecord::Base.time_zone_aware_types += [:tsrange]\n    # In the code times are properly converted to app time zone\n    Shop.create!(open_hours: [Time.current..8.hour.from_now])\n    ```\n\n    *Wojciech Wnętrzak*",
    "project": "activerecord",
    "date_merged": 1656331605000,
    "author": "Wojciech Wnętrzak",
    "sha": "73b1a153b504468ae7d1273d62445710b4a5cdb1",
    "pr": "45348",
    "merge_sha": "1f21fae6e8efa0878ae6b582d77fb3df1e7c9f24",
    "html": "<p>Fix supporting timezone awareness for <code>tsrange</code> and <code>tstzrange</code> array columns.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># In database migrations</span>\n<span class=\"n\">add_column</span> <span class=\"ss\">:shops</span><span class=\"p\">,</span> <span class=\"ss\">:open_hours</span><span class=\"p\">,</span> <span class=\"ss\">:tsrange</span><span class=\"p\">,</span> <span class=\"ss\">array: </span><span class=\"kp\">true</span>\n<span class=\"c1\"># In app config</span>\n<span class=\"no\">ActiveRecord</span><span class=\"o\">::</span><span class=\"no\">Base</span><span class=\"p\">.</span><span class=\"nf\">time_zone_aware_types</span> <span class=\"o\">+=</span> <span class=\"p\">[</span><span class=\"ss\">:tsrange</span><span class=\"p\">]</span>\n<span class=\"c1\"># In the code times are properly converted to app time zone</span>\n<span class=\"no\">Shop</span><span class=\"p\">.</span><span class=\"nf\">create!</span><span class=\"p\">(</span><span class=\"ss\">open_hours: </span><span class=\"p\">[</span><span class=\"no\">Time</span><span class=\"p\">.</span><span class=\"nf\">current</span><span class=\"o\">..</span><span class=\"mi\">8</span><span class=\"p\">.</span><span class=\"nf\">hour</span><span class=\"p\">.</span><span class=\"nf\">from_now</span><span class=\"p\">])</span>\n</code></pre></div></div>\n\n<p><em>Wojciech Wnętrzak</em></p>\n"
  },
  {
    "message": "*   Introduce strategy pattern for executing migrations.\n\n    By default, migrations will use a strategy object that delegates the method\n    to the connection adapter. Consumers can implement custom strategy objects\n    to change how their migrations run.\n\n    *Adrianna Chang*",
    "project": "activerecord",
    "date_merged": 1656070623000,
    "author": "Adrianna Chang",
    "sha": "6673d8ef3b857ede36fc74923bcf16d6964bdfc9",
    "pr": "45324",
    "merge_sha": "d51b17184932f54d60e2098fccbdcceaa76ba753",
    "html": "<p>Introduce strategy pattern for executing migrations.</p>\n\n<p>By default, migrations will use a strategy object that delegates the method<br />\nto the connection adapter. Consumers can implement custom strategy objects<br />\nto change how their migrations run.</p>\n\n<p><em>Adrianna Chang</em></p>\n"
  },
  {
    "message": "*   Add adapter option disallowing foreign keys\n\n    This adds a new option to be added to `database.yml` which enables skipping\n    foreign key constraints usage even if the underlying database supports them.\n\n    Usage:\n    ```yaml\n    development:\n        <<: *default\n        database: storage/development.sqlite3\n        foreign_keys: false\n    ```\n\n    *Paulo Barros*",
    "project": "activerecord",
    "date_merged": 1655717443000,
    "author": "Paulo Barros",
    "sha": "db82002f2bfb89072ea26bd04aedad26fd527571",
    "pr": "45301",
    "merge_sha": "65f135aac6d1c6669b2bd67109fca04200352b1c",
    "html": "<p>Add adapter option disallowing foreign keys</p>\n\n<p>This adds a new option to be added to <code>database.yml</code> which enables skipping<br />\nforeign key constraints usage even if the underlying database supports them.</p>\n\n<p>Usage:</p>\n<div class=\"language-yaml highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"na\">development</span><span class=\"pi\">:</span>\n    <span class=\"na\">&lt;&lt;</span><span class=\"pi\">:</span> <span class=\"nv\">*default</span>\n    <span class=\"na\">database</span><span class=\"pi\">:</span> <span class=\"s\">storage/development.sqlite3</span>\n    <span class=\"na\">foreign_keys</span><span class=\"pi\">:</span> <span class=\"no\">false</span>\n</code></pre></div></div>\n\n<p><em>Paulo Barros</em></p>\n"
  },
  {
    "message": "*   Add configurable deprecation warning for singular associations\n\n    This adds a deprecation warning when using the plural name of a singular associations in `where`.\n    It is possible to opt into the new more performant behavior with `config.active_record.allow_deprecated_singular_associations_name = false`\n\n    *Adam Hess*",
    "project": "activerecord",
    "date_merged": 1655396754000,
    "author": "HParker",
    "sha": "3a04c7b339072a97c00bf123ec4b95200b5723e0",
    "pr": "45344",
    "merge_sha": "1a377562a944bf7f64171c260f6c693a7fb82d0f",
    "html": "<p>Add configurable deprecation warning for singular associations</p>\n\n<p>This adds a deprecation warning when using the plural name of a singular associations in <code>where</code>.<br />\nIt is possible to opt into the new more performant behavior with <code>config.active_record.allow_deprecated_singular_associations_name = false</code></p>\n\n<p><em>Adam Hess</em></p>\n"
  },
  {
    "message": "*   Run transactional callbacks on the freshest instance to save a given\n    record within a transaction.\n\n    When multiple Active Record instances change the same record within a\n    transaction, Rails runs `after_commit` or `after_rollback` callbacks for\n    only one of them. `config.active_record.run_commit_callbacks_on_first_saved_instances_in_transaction`\n    was added to specify how Rails chooses which instance receives the\n    callbacks. The framework defaults were changed to use the new logic.\n\n    When `config.active_record.run_commit_callbacks_on_first_saved_instances_in_transaction`\n    is `true`, transactional callbacks are run on the first instance to save,\n    even though its instance state may be stale.\n\n    When it is `false`, which is the new framework default starting with version\n    7.1, transactional callbacks are run on the instances with the freshest\n    instance state. Those instances are chosen as follows:\n\n    - In general, run transactional callbacks on the last instance to save a\n      given record within the transaction.\n    - There are two exceptions:\n        - If the record is created within the transaction, then updated by\n          another instance, `after_create_commit` callbacks will be run on the\n          second instance. This is instead of the `after_update_commit`\n          callbacks that would naively be run based on that instance’s state.\n        - If the record is destroyed within the transaction, then\n          `after_destroy_commit` callbacks will be fired on the last destroyed\n          instance, even if a stale instance subsequently performed an update\n          (which will have affected 0 rows).\n\n    *Cameron Bothner and Mitch Vollebregt*",
    "project": "activerecord",
    "date_merged": 1656231378000,
    "author": "Yasuo Honda",
    "sha": "681ada187973b7cd02150b7eaf7521dcf8eccaf8",
    "pr": "45462",
    "merge_sha": "7f5e89915667162744b01e3080c82fd5b5e3448b",
    "html": "<p>Run transactional callbacks on the freshest instance to save a given<br />\nrecord within a transaction.</p>\n\n<p>When multiple Active Record instances change the same record within a<br />\ntransaction, Rails runs <code>after_commit</code> or <code>after_rollback</code> callbacks for<br />\nonly one of them. <code>config.active_record.run_commit_callbacks_on_first_saved_instances_in_transaction</code><br />\nwas added to specify how Rails chooses which instance receives the<br />\ncallbacks. The framework defaults were changed to use the new logic.</p>\n\n<p>When <code>config.active_record.run_commit_callbacks_on_first_saved_instances_in_transaction</code><br />\nis <code>true</code>, transactional callbacks are run on the first instance to save,<br />\neven though its instance state may be stale.</p>\n\n<p>When it is <code>false</code>, which is the new framework default starting with version<br />\n7.1, transactional callbacks are run on the instances with the freshest<br />\ninstance state. Those instances are chosen as follows:</p>\n\n<ul>\n  <li>In general, run transactional callbacks on the last instance to save a<br />\ngiven record within the transaction.</li>\n  <li>There are two exceptions:\n    <ul>\n      <li>If the record is created within the transaction, then updated by<br />\nanother instance, <code>after_create_commit</code> callbacks will be run on the<br />\nsecond instance. This is instead of the <code>after_update_commit</code><br />\ncallbacks that would naively be run based on that instance’s state.</li>\n      <li>If the record is destroyed within the transaction, then<br />\n<code>after_destroy_commit</code> callbacks will be fired on the last destroyed<br />\ninstance, even if a stale instance subsequently performed an update<br />\n(which will have affected 0 rows).</li>\n    </ul>\n  </li>\n</ul>\n\n<p><em>Cameron Bothner and Mitch Vollebregt</em></p>\n"
  },
  {
    "message": "*   Enable strict strings mode for `SQLite3Adapter`.\n\n    Configures SQLite with a strict strings mode, which disables double-quoted string literals.\n\n    SQLite has some quirks around double-quoted string literals.\n    It first tries to consider double-quoted strings as identifier names, but if they don't exist\n    it then considers them as string literals. Because of this, typos can silently go unnoticed.\n    For example, it is possible to create an index for a non existing column.\n    See [SQLite documentation](https://www.sqlite.org/quirks.html#double_quoted_string_literals_are_accepted) for more details.\n\n    If you don't want this behavior, you can disable it via:\n\n    ```ruby\n    # config/application.rb\n    config.active_record.sqlite3_adapter_strict_strings_by_default = false\n    ```\n\n    Fixes #27782.\n\n    *fatkodima*, *Jean Boussier*",
    "project": "activerecord",
    "date_merged": 1655240490000,
    "author": "fatkodima",
    "sha": "21a6dbd313efa9fb7feac4d95acaf6271112801f",
    "pr": "45346",
    "merge_sha": "4f6f3c9dec5af986abc13761904b21cdae588540",
    "html": "<p>Enable strict strings mode for <code>SQLite3Adapter</code>.</p>\n\n<p>Configures SQLite with a strict strings mode, which disables double-quoted string literals.</p>\n\n<p>SQLite has some quirks around double-quoted string literals.<br />\nIt first tries to consider double-quoted strings as identifier names, but if they don’t exist<br />\nit then considers them as string literals. Because of this, typos can silently go unnoticed.<br />\nFor example, it is possible to create an index for a non existing column.<br />\nSee <a href=\"https://www.sqlite.org/quirks.html#double_quoted_string_literals_are_accepted\">SQLite documentation</a> for more details.</p>\n\n<p>If you don’t want this behavior, you can disable it via:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># config/application.rb</span>\n<span class=\"n\">config</span><span class=\"p\">.</span><span class=\"nf\">active_record</span><span class=\"p\">.</span><span class=\"nf\">sqlite3_adapter_strict_strings_by_default</span> <span class=\"o\">=</span> <span class=\"kp\">false</span>\n</code></pre></div></div>\n\n<p>Fixes #27782.</p>\n\n<p><em>fatkodima</em>, <em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   Resolve issue where a relation cache_version could be left stale.\n\n    Previously, when `reset` was called on a relation object it did not reset the cache_versions\n    ivar. This led to a confusing situation where despite having the correct data the relation\n    still reported a stale cache_version.\n\n    Usage:\n\n    ```ruby\n    developers = Developer.all\n    developers.cache_version\n\n    Developer.update_all(updated_at: Time.now.utc + 1.second)\n\n    developers.cache_version # Stale cache_version\n    developers.reset\n    developers.cache_version # Returns the current correct cache_version\n    ```\n\n    Fixes #45341.\n\n    *Austen Madden*",
    "project": "activerecord",
    "date_merged": 1655226332000,
    "author": "Austen Madden",
    "sha": "a237867e8fada034d977b4b7e04e012470c14a5b",
    "pr": "45342",
    "merge_sha": "7ea7f64c9be46d990ef6370e8d56c10b15d18281",
    "html": "<p>Resolve issue where a relation cache_version could be left stale.</p>\n\n<p>Previously, when <code>reset</code> was called on a relation object it did not reset the cache_versions<br />\nivar. This led to a confusing situation where despite having the correct data the relation<br />\nstill reported a stale cache_version.</p>\n\n<p>Usage:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">developers</span> <span class=\"o\">=</span> <span class=\"no\">Developer</span><span class=\"p\">.</span><span class=\"nf\">all</span>\n<span class=\"n\">developers</span><span class=\"p\">.</span><span class=\"nf\">cache_version</span>\n\n<span class=\"no\">Developer</span><span class=\"p\">.</span><span class=\"nf\">update_all</span><span class=\"p\">(</span><span class=\"ss\">updated_at: </span><span class=\"no\">Time</span><span class=\"p\">.</span><span class=\"nf\">now</span><span class=\"p\">.</span><span class=\"nf\">utc</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">.</span><span class=\"nf\">second</span><span class=\"p\">)</span>\n\n<span class=\"n\">developers</span><span class=\"p\">.</span><span class=\"nf\">cache_version</span> <span class=\"c1\"># Stale cache_version</span>\n<span class=\"n\">developers</span><span class=\"p\">.</span><span class=\"nf\">reset</span>\n<span class=\"n\">developers</span><span class=\"p\">.</span><span class=\"nf\">cache_version</span> <span class=\"c1\"># Returns the current correct cache_version</span>\n</code></pre></div></div>\n\n<p>Fixes #45341.</p>\n\n<p><em>Austen Madden</em></p>\n"
  },
  {
    "message": "*   Add support for exclusion constraints (PostgreSQL-only).\n\n    ```ruby\n    add_exclusion_constraint :invoices, \"daterange(start_date, end_date) WITH &&\", using: :gist, name: \"invoices_date_overlap\"\n    remove_exclusion_constraint :invoices, name: \"invoices_date_overlap\"\n    ```\n\n    See PostgreSQL's [`CREATE TABLE ... EXCLUDE ...`](https://www.postgresql.org/docs/12/sql-createtable.html#SQL-CREATETABLE-EXCLUDE) documentation for more on exclusion constraints.\n\n    *Alex Robbin*",
    "project": "activerecord",
    "date_merged": 1655211361000,
    "author": "Alex Robbin",
    "sha": "1ceffeb4d906dbd616ff03d4f96fcaae60ad12df",
    "pr": "40224",
    "merge_sha": "6d703793b6705e895075f82c8ecf4be01d0fbdab",
    "html": "<p>Add support for exclusion constraints (PostgreSQL-only).</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">add_exclusion_constraint</span> <span class=\"ss\">:invoices</span><span class=\"p\">,</span> <span class=\"s2\">\"daterange(start_date, end_date) WITH &amp;&amp;\"</span><span class=\"p\">,</span> <span class=\"ss\">using: :gist</span><span class=\"p\">,</span> <span class=\"ss\">name: </span><span class=\"s2\">\"invoices_date_overlap\"</span>\n<span class=\"n\">remove_exclusion_constraint</span> <span class=\"ss\">:invoices</span><span class=\"p\">,</span> <span class=\"ss\">name: </span><span class=\"s2\">\"invoices_date_overlap\"</span>\n</code></pre></div></div>\n\n<p>See PostgreSQL’s <a href=\"https://www.postgresql.org/docs/12/sql-createtable.html#SQL-CREATETABLE-EXCLUDE\"><code>CREATE TABLE ... EXCLUDE ...</code></a> documentation for more on exclusion constraints.</p>\n\n<p><em>Alex Robbin</em></p>\n"
  },
  {
    "message": "*   `change_column_null` raises if a non-boolean argument is provided\n\n    Previously if you provided a non-boolean argument, `change_column_null` would\n    treat it as truthy and make your column nullable. This could be surprising, so now\n    the input must be either `true` or `false`.\n\n    ```ruby\n    change_column_null :table, :column, true # good\n    change_column_null :table, :column, false # good\n    change_column_null :table, :column, from: true, to: false # raises (previously this made the column nullable)\n    ```\n\n    *Alex Ghiculescu*",
    "project": "activerecord",
    "date_merged": 1655146882000,
    "author": "Alex Ghiculescu",
    "sha": "08dc02b0057d1abb74524d5c3144d24c42c4ce16",
    "pr": "45229",
    "merge_sha": "2026d5ba3fe79cddb184c04b60d38e615bc0070f",
    "html": "<p><code>change_column_null</code> raises if a non-boolean argument is provided</p>\n\n<p>Previously if you provided a non-boolean argument, <code>change_column_null</code> would<br />\ntreat it as truthy and make your column nullable. This could be surprising, so now<br />\nthe input must be either <code>true</code> or <code>false</code>.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">change_column_null</span> <span class=\"ss\">:table</span><span class=\"p\">,</span> <span class=\"ss\">:column</span><span class=\"p\">,</span> <span class=\"kp\">true</span> <span class=\"c1\"># good</span>\n<span class=\"n\">change_column_null</span> <span class=\"ss\">:table</span><span class=\"p\">,</span> <span class=\"ss\">:column</span><span class=\"p\">,</span> <span class=\"kp\">false</span> <span class=\"c1\"># good</span>\n<span class=\"n\">change_column_null</span> <span class=\"ss\">:table</span><span class=\"p\">,</span> <span class=\"ss\">:column</span><span class=\"p\">,</span> <span class=\"ss\">from: </span><span class=\"kp\">true</span><span class=\"p\">,</span> <span class=\"ss\">to: </span><span class=\"kp\">false</span> <span class=\"c1\"># raises (previously this made the column nullable)</span>\n</code></pre></div></div>\n\n<p><em>Alex Ghiculescu</em></p>\n"
  },
  {
    "message": "*   Enforce limit on table names length.\n\n    Fixes #45130.\n\n    *fatkodima*",
    "project": "activerecord",
    "date_merged": 1655144860000,
    "author": "fatkodima",
    "sha": "1ec879d02b0c456f1a87ac1e6c1c9ba26e6ab814",
    "pr": "45136",
    "merge_sha": "5b54da55f564ad209bd119fe1d179ee409a3673b",
    "html": "<p>Enforce limit on table names length.</p>\n\n<p>Fixes #45130.</p>\n\n<p><em>fatkodima</em></p>\n"
  },
  {
    "message": "*   Adjust the minimum MariaDB version for check constraints support.\n\n    *Eddie Lebow*",
    "project": "activerecord",
    "date_merged": 1655041147000,
    "author": "Eddie Lebow",
    "sha": "d5cbc24594d53214cec98dd63e76686d0e8eaaea",
    "pr": "45326",
    "merge_sha": "a4662721965e127bfd7de2192dbd829339ab2058",
    "html": "<p>Adjust the minimum MariaDB version for check constraints support.</p>\n\n<p><em>Eddie Lebow</em></p>\n"
  },
  {
    "message": "*   Fix Hstore deserialize regression.\n\n    *edsharp*",
    "project": "activerecord",
    "date_merged": 1654004243000,
    "author": "Ed Sharp",
    "sha": "57f70612a113d036c741bcbcd9aa7b0393b2f17f",
    "pr": "45222",
    "merge_sha": "3a19ec09bfd7821e52b25b3c8111504ce5a59db6",
    "html": "<p>Fix Hstore deserialize regression.</p>\n\n<p><em>edsharp</em></p>\n"
  },
  {
    "message": "*   Add validity for PostgreSQL indexes.\n\n    ```ruby\n    connection.index_exists?(:users, :email, valid: true)\n    connection.indexes(:users).select(&:valid?)\n    ```\n\n    *fatkodima*",
    "project": "activerecord",
    "date_merged": 1653987898000,
    "author": "fatkodima",
    "sha": "d152a11a4c75ed21816e97191a1fce2110a4a2ce",
    "pr": "45160",
    "merge_sha": "ad62267f6466060e00417720850085f608f00646",
    "html": "<p>Add validity for PostgreSQL indexes.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">connection</span><span class=\"p\">.</span><span class=\"nf\">index_exists?</span><span class=\"p\">(</span><span class=\"ss\">:users</span><span class=\"p\">,</span> <span class=\"ss\">:email</span><span class=\"p\">,</span> <span class=\"ss\">valid: </span><span class=\"kp\">true</span><span class=\"p\">)</span>\n<span class=\"n\">connection</span><span class=\"p\">.</span><span class=\"nf\">indexes</span><span class=\"p\">(</span><span class=\"ss\">:users</span><span class=\"p\">).</span><span class=\"nf\">select</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"ss\">:valid?</span><span class=\"p\">)</span>\n</code></pre></div></div>\n\n<p><em>fatkodima</em></p>\n"
  },
  {
    "message": "*   Fix eager loading for models without primary keys.\n\n    *Anmol Chopra*, *Matt Lawrence*, and *Jonathan Hefner*",
    "project": "activerecord",
    "date_merged": 1653776548000,
    "author": "Matt Lawrence",
    "sha": "ae9beace34322fe82363c4df9d5d6b7f17acdb7a",
    "pr": "43402",
    "merge_sha": "98a944f0b3f3613ec1710d43703cd1028c8b4150",
    "html": "<p>Fix eager loading for models without primary keys.</p>\n\n<p><em>Anmol Chopra</em>, <em>Matt Lawrence</em>, and <em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Avoid validating a unique field if it has not changed and is backed by a unique index.\n\n    Previously, when saving a record, Active Record will perform an extra query to check for the\n    uniqueness of each attribute having a `uniqueness` validation, even if that attribute hasn't changed.\n    If the database has the corresponding unique index, then this validation can never fail for persisted\n    records, and we could safely skip it.\n\n    *fatkodima*",
    "project": "activerecord",
    "date_merged": 1653494680000,
    "author": "fatkodima",
    "sha": "c2bdc6b0c2d160254f0db7d705a697336aca388a",
    "pr": "45149",
    "merge_sha": "1554cf1685dfdd8248ebdc9d9620bfd74542ba06",
    "html": "<p>Avoid validating a unique field if it has not changed and is backed by a unique index.</p>\n\n<p>Previously, when saving a record, Active Record will perform an extra query to check for the<br />\nuniqueness of each attribute having a <code>uniqueness</code> validation, even if that attribute hasn’t changed.<br />\nIf the database has the corresponding unique index, then this validation can never fail for persisted<br />\nrecords, and we could safely skip it.</p>\n\n<p><em>fatkodima</em></p>\n"
  },
  {
    "message": "*   Stop setting `sql_auto_is_null`\n\n    Since version 5.5 the default has been off, we no longer have to manually turn it off.\n\n    *Adam Hess*",
    "project": "activerecord",
    "date_merged": 1652983767000,
    "author": "HParker",
    "sha": "a79c1a6c888115a0184f0c275362859dcc428fa4",
    "pr": "45134",
    "merge_sha": "0100a27a4a4ca4b7b64a009878a8adf941a55961",
    "html": "<p>Stop setting <code>sql_auto_is_null</code></p>\n\n<p>Since version 5.5 the default has been off, we no longer have to manually turn it off.</p>\n\n<p><em>Adam Hess</em></p>\n"
  },
  {
    "message": "*   Fix `touch` to raise an error for readonly columns.\n\n    *fatkodima*",
    "project": "activerecord",
    "date_merged": 1652977326000,
    "author": "fatkodima",
    "sha": "4184ee73231df73e5e501f39dfcdad31ef617b2d",
    "pr": "45125",
    "merge_sha": "23ba1188fdb36a52f8867b83191bf45bc3704e35",
    "html": "<p>Fix <code>touch</code> to raise an error for readonly columns.</p>\n\n<p><em>fatkodima</em></p>\n"
  },
  {
    "message": "*   Add ability to ignore tables by regexp for SQL schema dumps.\n\n    ```ruby\n    ActiveRecord::SchemaDumper.ignore_tables = [/^_/]\n    ```\n\n    *fatkodima*",
    "project": "activerecord",
    "date_merged": 1652539727000,
    "author": "fatkodima",
    "sha": "a3dc8511596ece175837fdaa5421770a72d12c97",
    "pr": "45091",
    "merge_sha": "0977e9eccd7b753138c9e57ec8fc19687a9c7ad9",
    "html": "<p>Add ability to ignore tables by regexp for SQL schema dumps.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">ActiveRecord</span><span class=\"o\">::</span><span class=\"no\">SchemaDumper</span><span class=\"p\">.</span><span class=\"nf\">ignore_tables</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"sr\">/^_/</span><span class=\"p\">]</span>\n</code></pre></div></div>\n\n<p><em>fatkodima</em></p>\n"
  },
  {
    "message": "*   Avoid queries when performing calculations on contradictory relations.\n\n    Previously calculations would make a query even when passed a\n    contradiction, such as `User.where(id: []).count`. We no longer perform a\n    query in that scenario.\n\n    This applies to the following calculations: `count`, `sum`, `average`,\n    `minimum` and `maximum`\n\n    *Luan Vieira, John Hawthorn and Daniel Colson*",
    "project": "activerecord",
    "date_merged": 1652308681000,
    "author": "Luan Vieira",
    "sha": "a1f76dd7120777364b203e5b2fe398c5840aeb28",
    "pr": "45030",
    "merge_sha": "3ab2cd6fa115ef0624c1417e2c7c84364ed5016c",
    "html": "<p>Avoid queries when performing calculations on contradictory relations.</p>\n\n<p>Previously calculations would make a query even when passed a<br />\ncontradiction, such as <code>User.where(id: []).count</code>. We no longer perform a<br />\nquery in that scenario.</p>\n\n<p>This applies to the following calculations: <code>count</code>, <code>sum</code>, <code>average</code>,<br />\n<code>minimum</code> and <code>maximum</code></p>\n\n<p><em>Luan Vieira, John Hawthorn and Daniel Colson</em></p>\n"
  },
  {
    "message": "*   Allow using aliased attributes with `insert_all`/`upsert_all`.\n\n    ```ruby\n    class Book < ApplicationRecord\n      alias_attribute :title, :name\n    end\n\n    Book.insert_all [{ title: \"Remote\", author_id: 1 }], returning: :title\n    ```\n\n    *fatkodima*",
    "project": "activerecord",
    "date_merged": 1652281287000,
    "author": "fatkodima",
    "sha": "fd2afb331e724a209aad88a53c7a9f558e9ddaf9",
    "pr": "45036",
    "merge_sha": "79b087ebda1eeec7421e6011eaabf41bdf6471c0",
    "html": "<p>Allow using aliased attributes with <code>insert_all</code>/<code>upsert_all</code>.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">class</span> <span class=\"nc\">Book</span> <span class=\"o\">&lt;</span> <span class=\"no\">ApplicationRecord</span>\n  <span class=\"n\">alias_attribute</span> <span class=\"ss\">:title</span><span class=\"p\">,</span> <span class=\"ss\">:name</span>\n<span class=\"k\">end</span>\n\n<span class=\"no\">Book</span><span class=\"p\">.</span><span class=\"nf\">insert_all</span> <span class=\"p\">[{</span> <span class=\"ss\">title: </span><span class=\"s2\">\"Remote\"</span><span class=\"p\">,</span> <span class=\"ss\">author_id: </span><span class=\"mi\">1</span> <span class=\"p\">}],</span> <span class=\"ss\">returning: :title</span>\n</code></pre></div></div>\n\n<p><em>fatkodima</em></p>\n"
  },
  {
    "message": "*   Support encrypted attributes on columns with default db values.\n\n    This adds support for encrypted attributes defined on columns with default values.\n    It will encrypt those values at creation time. Before, it would raise an\n    error unless `config.active_record.encryption.support_unencrypted_data` was true.\n\n    *Jorge Manrubia* and *Dima Fatko*",
    "project": "activerecord",
    "date_merged": 1652098432000,
    "author": "Jorge Manrubia",
    "sha": "238432d1cb5b47d61764fb54fc3d701c1def852d",
    "pr": "45033",
    "merge_sha": "d94b65aad605fc53b196cfe06329b60c6468b9a7",
    "html": "<p>Support encrypted attributes on columns with default db values.</p>\n\n<p>This adds support for encrypted attributes defined on columns with default values.<br />\nIt will encrypt those values at creation time. Before, it would raise an<br />\nerror unless <code>config.active_record.encryption.support_unencrypted_data</code> was true.</p>\n\n<p><em>Jorge Manrubia</em> and <em>Dima Fatko</em></p>\n"
  },
  {
    "message": "*   Allow overriding `reading_request?` in `DatabaseSelector::Resolver`\n\n    The default implementation checks if a request is a `get?` or `head?`,\n    but you can now change it to anything you like. If the method returns true,\n    `Resolver#read` gets called meaning the request could be served by the\n    replica database.\n\n    *Alex Ghiculescu*",
    "project": "activerecord",
    "date_merged": 1650909627000,
    "author": "Alex Ghiculescu",
    "sha": "439119c8c504a7643a7e8e1f116e9100553109c7",
    "pr": "44944",
    "merge_sha": "8106e12b5276f5c9240a2bf6f47a838055a9050f",
    "html": "<p>Allow overriding <code>reading_request?</code> in <code>DatabaseSelector::Resolver</code></p>\n\n<p>The default implementation checks if a request is a <code>get?</code> or <code>head?</code>,<br />\nbut you can now change it to anything you like. If the method returns true,<br />\n<code>Resolver#read</code> gets called meaning the request could be served by the<br />\nreplica database.</p>\n\n<p><em>Alex Ghiculescu</em></p>\n"
  },
  {
    "message": "*   Remove `ActiveRecord.legacy_connection_handling`.\n\n    *Eileen M. Uchitelle*",
    "project": "activerecord",
    "date_merged": 1649085007000,
    "author": "eileencodes",
    "sha": "ad52c0a19714a1b87a7d0c626a8b364cf95414cf",
    "pr": "44827",
    "merge_sha": "313dd2e98105c3cb724a7d3a5c6a4eaabd9420ed",
    "html": "<p>Remove <code>ActiveRecord.legacy_connection_handling</code>.</p>\n\n<p><em>Eileen M. Uchitelle</em></p>\n"
  },
  {
    "message": "*   `rails db:schema:{dump,load}` now checks `ENV[\"SCHEMA_FORMAT\"]` before config\n\n    Since `rails db:structure:{dump,load}` was deprecated there wasn't a simple\n    way to dump a schema to both SQL and Ruby formats. You can now do this with\n    an environment variable. For example:\n\n    ```\n    SCHEMA_FORMAT=sql rake db:schema:dump\n    ```\n\n    *Alex Ghiculescu*",
    "project": "activerecord",
    "date_merged": 1649078717000,
    "author": "Alex Ghiculescu",
    "sha": "d5fc7da4c39470a8f5b0055eddc2d1bca2d034e3",
    "pr": "44834",
    "merge_sha": "ca6d15ba177605a7817e0518a73fcb9f128e634d",
    "html": "<p><code>rails db:schema:{dump,load}</code> now checks <code>ENV[\"SCHEMA_FORMAT\"]</code> before config</p>\n\n<p>Since <code>rails db:structure:{dump,load}</code> was deprecated there wasn’t a simple<br />\nway to dump a schema to both SQL and Ruby formats. You can now do this with<br />\nan environment variable. For example:</p>\n\n<pre><code>SCHEMA_FORMAT=sql rake db:schema:dump\n</code></pre>\n\n<p><em>Alex Ghiculescu</em></p>\n"
  },
  {
    "message": "*   Fixed MariaDB default function support.\n\n    Defaults would be written wrong in \"db/schema.rb\" and not work correctly\n    if using `db:schema:load`. Further more the function name would be\n    added as string content when saving new records.\n\n    *kaspernj*",
    "project": "activerecord",
    "date_merged": 1647196976000,
    "author": "kaspernj",
    "sha": "4ccd79cdd6664c568c37195df0809fe6f02952a0",
    "pr": "44654",
    "merge_sha": "a1c6fc313bb1ce0453d88cdeec69ac9f7643a15e",
    "html": "<p>Fixed MariaDB default function support.</p>\n\n<p>Defaults would be written wrong in “db/schema.rb” and not work correctly<br />\nif using <code>db:schema:load</code>. Further more the function name would be<br />\nadded as string content when saving new records.</p>\n\n<p><em>kaspernj</em></p>\n"
  },
  {
    "message": "*   Add `active_record.destroy_association_async_batch_size` configuration\n\n    This allows applications to specify the maximum number of records that will\n    be destroyed in a single background job by the `dependent: :destroy_async`\n    association option. By default, the current behavior will remain the same:\n    when a parent record is destroyed, all dependent records will be destroyed\n    in a single background job. If the number of dependent records is greater\n    than this configuration, the records will be destroyed in multiple\n    background jobs.\n\n    *Nick Holden*",
    "project": "activerecord",
    "date_merged": 1646849788000,
    "author": "Nick Holden",
    "sha": "c773ae65af0af7ebfc067f64f9a80bdb6cbfb937",
    "pr": "44617",
    "merge_sha": "9070d563b9e31a0717f6ae0face1579582727961",
    "html": "<p>Add <code>active_record.destroy_association_async_batch_size</code> configuration</p>\n\n<p>This allows applications to specify the maximum number of records that will<br />\nbe destroyed in a single background job by the <code>dependent: :destroy_async</code><br />\nassociation option. By default, the current behavior will remain the same:<br />\nwhen a parent record is destroyed, all dependent records will be destroyed<br />\nin a single background job. If the number of dependent records is greater<br />\nthan this configuration, the records will be destroyed in multiple<br />\nbackground jobs.</p>\n\n<p><em>Nick Holden</em></p>\n"
  },
  {
    "message": "*   Fix `remove_foreign_key` with `:if_exists` option when foreign key actually exists.\n\n    *fatkodima*",
    "project": "activerecord",
    "date_merged": 1646835722000,
    "author": "fatkodima",
    "sha": "1f70f3cb8b0f9eeec0fd0b3f18d858704a2bb534",
    "pr": "44637",
    "merge_sha": "7684256ede66a6fd0a91f86b2bb43648b794cffa",
    "html": "<p>Fix <code>remove_foreign_key</code> with <code>:if_exists</code> option when foreign key actually exists.</p>\n\n<p><em>fatkodima</em></p>\n"
  },
  {
    "message": "*   Remove `--no-comments` flag in structure dumps for PostgreSQL\n\n    This broke some apps that used custom schema comments. If you don't want\n    comments in your structure dump, you can use:\n\n    ```ruby\n    ActiveRecord::Tasks::DatabaseTasks.structure_dump_flags = ['--no-comments']\n    ```\n\n    *Alex Ghiculescu*",
    "project": "activerecord",
    "date_merged": 1646680054000,
    "author": "Alex Ghiculescu",
    "sha": "c94ac46cd8293ae723bb69d1516d19f175cf0084",
    "pr": "44633",
    "merge_sha": "b2669d7361fe43e1b1d5ce2add3cb63c9061b761",
    "html": "<p>Remove <code>--no-comments</code> flag in structure dumps for PostgreSQL</p>\n\n<p>This broke some apps that used custom schema comments. If you don’t want<br />\ncomments in your structure dump, you can use:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">ActiveRecord</span><span class=\"o\">::</span><span class=\"no\">Tasks</span><span class=\"o\">::</span><span class=\"no\">DatabaseTasks</span><span class=\"p\">.</span><span class=\"nf\">structure_dump_flags</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s1\">'--no-comments'</span><span class=\"p\">]</span>\n</code></pre></div></div>\n\n<p><em>Alex Ghiculescu</em></p>\n"
  },
  {
    "message": "*   Reduce the memory footprint of fixtures accessors.\n\n    Until now fixtures accessors were eagerly defined using `define_method`.\n    So the memory usage was directly dependent of the number of fixtures and\n    test suites.\n\n    Instead fixtures accessors are now implemented with `method_missing`,\n    so they incur much less memory and CPU overhead.\n\n    *Jean Boussier*",
    "project": "activerecord",
    "date_merged": 1645691652000,
    "author": "Jean Boussier",
    "sha": "05d80fc24f03ca5310931eacefdc247a393dd861",
    "pr": "44528",
    "merge_sha": "00b03b884e7440e555b13cbffb24e3352d27d9e8",
    "html": "<p>Reduce the memory footprint of fixtures accessors.</p>\n\n<p>Until now fixtures accessors were eagerly defined using <code>define_method</code>.<br />\nSo the memory usage was directly dependent of the number of fixtures and<br />\ntest suites.</p>\n\n<p>Instead fixtures accessors are now implemented with <code>method_missing</code>,<br />\nso they incur much less memory and CPU overhead.</p>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   Fix `config.active_record.destroy_association_async_job` configuration\n\n    `config.active_record.destroy_association_async_job` should allow\n    applications to specify the job that will be used to destroy associated\n    records in the background for `has_many` associations with the\n    `dependent: :destroy_async` option. Previously, that was ignored, which\n    meant the default `ActiveRecord::DestroyAssociationAsyncJob` always\n    destroyed records in the background.\n\n    *Nick Holden*",
    "project": "activerecord",
    "date_merged": 1645052124000,
    "author": "Nick Holden",
    "sha": "edf4ef9b263f5509b8e6b5d7c114f926afd75940",
    "pr": "44309",
    "merge_sha": "0dbe699d5cd2b57a4a253283a7d7b7ffdd74db28",
    "html": "<p>Fix <code>config.active_record.destroy_association_async_job</code> configuration</p>\n\n<p><code>config.active_record.destroy_association_async_job</code> should allow<br />\napplications to specify the job that will be used to destroy associated<br />\nrecords in the background for <code>has_many</code> associations with the<br />\n<code>dependent: :destroy_async</code> option. Previously, that was ignored, which<br />\nmeant the default <code>ActiveRecord::DestroyAssociationAsyncJob</code> always<br />\ndestroyed records in the background.</p>\n\n<p><em>Nick Holden</em></p>\n"
  },
  {
    "message": "*   Fix `change_column_comment` to preserve column's AUTO_INCREMENT in the MySQL adapter\n\n    *fatkodima*",
    "project": "activerecord",
    "date_merged": 1646067830000,
    "author": "Abhay Nikam",
    "sha": "d5596e8599f06f1e0ee7c87c393174cb30ec3653",
    "pr": "44577",
    "merge_sha": "6719f02d25eb253783be70cc8fff8fbabdf945ab",
    "html": "<p>Fix <code>change_column_comment</code> to preserve column’s AUTO_INCREMENT in the MySQL adapter</p>\n\n<p><em>fatkodima</em></p>\n"
  },
  {
    "message": "*   Fix quoting of `ActiveSupport::Duration` and `Rational` numbers in the MySQL adapter.\n\n    *Kevin McPhillips*",
    "project": "activerecord",
    "date_merged": 1644863421000,
    "author": "Kevin McPhillips",
    "sha": "f572e0ea1ccb7f4b42c73d6ec2e11c2280bde190",
    "pr": "44404",
    "merge_sha": "7ac90d9ad75c50129850572ed6c7dcd42fecbf3b",
    "html": "<p>Fix quoting of <code>ActiveSupport::Duration</code> and <code>Rational</code> numbers in the MySQL adapter.</p>\n\n<p><em>Kevin McPhillips</em></p>\n"
  },
  {
    "message": "*   Allow column name with COLLATE (e.g., title COLLATE \"C\") as safe SQL string\n\n    *Shugo Maeda*",
    "project": "activerecord",
    "date_merged": 1644667684000,
    "author": "Shugo Maeda",
    "sha": "d12e4daca93f52ffb6c01231b5b28841ed2dde83",
    "pr": "44384",
    "merge_sha": "269948fd23d33299f1e0db8b406bb1eb67b9c16a",
    "html": "<p>Allow column name with COLLATE (e.g., title COLLATE “C”) as safe SQL string</p>\n\n<p><em>Shugo Maeda</em></p>\n"
  },
  {
    "message": "*   Permit underscores in the VERSION argument to database rake tasks.\n\n    *Eddie Lebow*",
    "project": "activerecord",
    "date_merged": 1644659506000,
    "author": "Eddie Lebow",
    "sha": "ef4bf94e2c962e0a5873eb0597bfb2115914f7cd",
    "pr": "44276",
    "merge_sha": "41c9d15b74fc99da3f82b9966585eccfeb7c219a",
    "html": "<p>Permit underscores in the VERSION argument to database rake tasks.</p>\n\n<p><em>Eddie Lebow</em></p>\n"
  },
  {
    "message": "*   Reversed the order of `INSERT` statements in `structure.sql` dumps\n\n    This should decrease the likelihood of merge conflicts. New migrations\n    will now be added at the top of the list.\n\n    For existing apps, there will be a large diff the next time `structure.sql`\n    is generated.\n\n    *Alex Ghiculescu*, *Matt Larraz*",
    "project": "activerecord",
    "date_merged": 1644358618000,
    "author": "Alex Ghiculescu",
    "sha": "7c8ac6c0dc243444d676358d4345bbbe119eae77",
    "pr": "44363",
    "merge_sha": "4d4497b42e4fd54434265cb2c72be7355f46d54d",
    "html": "<p>Reversed the order of <code>INSERT</code> statements in <code>structure.sql</code> dumps</p>\n\n<p>This should decrease the likelihood of merge conflicts. New migrations<br />\nwill now be added at the top of the list.</p>\n\n<p>For existing apps, there will be a large diff the next time <code>structure.sql</code><br />\nis generated.</p>\n\n<p><em>Alex Ghiculescu</em>, <em>Matt Larraz</em></p>\n"
  },
  {
    "message": "*   Fix PG.connect keyword arguments deprecation warning on ruby 2.7\n\n    Fixes #44307.\n\n    *Nikita Vasilevsky*",
    "project": "activerecord",
    "date_merged": 1644351850000,
    "author": "Nikita Vasilevsky",
    "sha": "c3a0e326e8565bcbe5c9b1b1f595a293f7e4954d",
    "pr": "44346",
    "merge_sha": "b923f70d155c17a217aed5da4624cad1c0f59ce4",
    "html": "<p>Fix PG.connect keyword arguments deprecation warning on ruby 2.7</p>\n\n<p>Fixes #44307.</p>\n\n<p><em>Nikita Vasilevsky</em></p>\n"
  },
  {
    "message": "*   Fix dropping DB connections after serialization failures and deadlocks.\n\n    Prior to 6.1.4, serialization failures and deadlocks caused rollbacks to be\n    issued for both real transactions and savepoints. This breaks MySQL which\n    disallows rollbacks of savepoints following a deadlock.\n\n    6.1.4 removed these rollbacks, for both transactions and savepoints, causing\n    the DB connection to be left in an unknown state and thus discarded.\n\n    These rollbacks are now restored, except for savepoints on MySQL.\n\n    *Thomas Morgan*",
    "project": "activerecord",
    "date_merged": 1644228522000,
    "author": "thomas morgan",
    "sha": "6a8a90ea39527f1c78793698e36e430e6014b3c6",
    "pr": "43130",
    "merge_sha": "6beee45c3f071c6a17149be0fabb1697609edbe8",
    "html": "<p>Fix dropping DB connections after serialization failures and deadlocks.</p>\n\n<p>Prior to 6.1.4, serialization failures and deadlocks caused rollbacks to be<br />\nissued for both real transactions and savepoints. This breaks MySQL which<br />\ndisallows rollbacks of savepoints following a deadlock.</p>\n\n<p>6.1.4 removed these rollbacks, for both transactions and savepoints, causing<br />\nthe DB connection to be left in an unknown state and thus discarded.</p>\n\n<p>These rollbacks are now restored, except for savepoints on MySQL.</p>\n\n<p><em>Thomas Morgan</em></p>\n"
  },
  {
    "message": "*   Make `ActiveRecord::ConnectionPool` Fiber-safe\n\n    When `ActiveSupport::IsolatedExecutionState.isolation_level` is set to `:fiber`,\n    the connection pool now supports multiple Fibers from the same Thread checking\n    out connections from the pool.\n\n    *Alex Matchneer*",
    "project": "activerecord",
    "date_merged": 1644056030000,
    "author": "machty",
    "sha": "449101e753c20af35661afd31ff3fa090b7e919d",
    "pr": "44219",
    "merge_sha": "2b3af27d8232db8def0c6600e89a714287381e18",
    "html": "<p>Make <code>ActiveRecord::ConnectionPool</code> Fiber-safe</p>\n\n<p>When <code>ActiveSupport::IsolatedExecutionState.isolation_level</code> is set to <code>:fiber</code>,<br />\nthe connection pool now supports multiple Fibers from the same Thread checking<br />\nout connections from the pool.</p>\n\n<p><em>Alex Matchneer</em></p>\n"
  },
  {
    "message": "*   Add `update_attribute!` to `ActiveRecord::Persistence`\n\n    Similar to `update_attribute`, but raises `ActiveRecord::RecordNotSaved` when a `before_*` callback throws `:abort`.\n\n    ```ruby\n    class Topic < ActiveRecord::Base\n      before_save :check_title\n\n      def check_title\n        throw(:abort) if title == \"abort\"\n      end\n    end\n\n    topic = Topic.create(title: \"Test Title\")\n    # #=> #<Topic title: \"Test Title\">\n    topic.update_attribute!(:title, \"Another Title\")\n    # #=> #<Topic title: \"Another Title\">\n    topic.update_attribute!(:title, \"abort\")\n    # raises ActiveRecord::RecordNotSaved\n    ```\n\n    *Drew Tempelmeyer*",
    "project": "activerecord",
    "date_merged": 1641941030000,
    "author": "Drew Tempelmeyer",
    "sha": "c03fddfa0a64cc839f08391f7b4aea881a421e2c",
    "pr": "44141",
    "merge_sha": "0638d35a7870663a84dcd2c3ed6edb696397043c",
    "html": "<p>Add <code>update_attribute!</code> to <code>ActiveRecord::Persistence</code></p>\n\n<p>Similar to <code>update_attribute</code>, but raises <code>ActiveRecord::RecordNotSaved</code> when a <code>before_*</code> callback throws <code>:abort</code>.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">class</span> <span class=\"nc\">Topic</span> <span class=\"o\">&lt;</span> <span class=\"no\">ActiveRecord</span><span class=\"o\">::</span><span class=\"no\">Base</span>\n  <span class=\"n\">before_save</span> <span class=\"ss\">:check_title</span>\n\n  <span class=\"k\">def</span> <span class=\"nf\">check_title</span>\n    <span class=\"kp\">throw</span><span class=\"p\">(</span><span class=\"ss\">:abort</span><span class=\"p\">)</span> <span class=\"k\">if</span> <span class=\"n\">title</span> <span class=\"o\">==</span> <span class=\"s2\">\"abort\"</span>\n  <span class=\"k\">end</span>\n<span class=\"k\">end</span>\n\n<span class=\"n\">topic</span> <span class=\"o\">=</span> <span class=\"no\">Topic</span><span class=\"p\">.</span><span class=\"nf\">create</span><span class=\"p\">(</span><span class=\"ss\">title: </span><span class=\"s2\">\"Test Title\"</span><span class=\"p\">)</span>\n<span class=\"c1\"># #=&gt; #&lt;Topic title: \"Test Title\"&gt;</span>\n<span class=\"n\">topic</span><span class=\"p\">.</span><span class=\"nf\">update_attribute!</span><span class=\"p\">(</span><span class=\"ss\">:title</span><span class=\"p\">,</span> <span class=\"s2\">\"Another Title\"</span><span class=\"p\">)</span>\n<span class=\"c1\"># #=&gt; #&lt;Topic title: \"Another Title\"&gt;</span>\n<span class=\"n\">topic</span><span class=\"p\">.</span><span class=\"nf\">update_attribute!</span><span class=\"p\">(</span><span class=\"ss\">:title</span><span class=\"p\">,</span> <span class=\"s2\">\"abort\"</span><span class=\"p\">)</span>\n<span class=\"c1\"># raises ActiveRecord::RecordNotSaved</span>\n</code></pre></div></div>\n\n<p><em>Drew Tempelmeyer</em></p>\n"
  },
  {
    "message": "*   Avoid loading every record in `ActiveRecord::Relation#pretty_print`\n\n    ```ruby\n    # Before\n    pp Foo.all # Loads the whole table.\n\n    # After\n    pp Foo.all # Shows 10 items and an ellipsis.\n    ```\n\n    *Ulysse Buonomo*",
    "project": "activerecord",
    "date_merged": 1641838547000,
    "author": "Petrik",
    "sha": "b553fd84c3bd836cc8bdcbdc283cd79fff9c2f2d",
    "pr": "44137",
    "merge_sha": "88e06d17ad9419bf0e9239e4c6c0cfbfc5bb80cc",
    "html": "<p>Avoid loading every record in <code>ActiveRecord::Relation#pretty_print</code></p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># Before</span>\n<span class=\"n\">pp</span> <span class=\"no\">Foo</span><span class=\"p\">.</span><span class=\"nf\">all</span> <span class=\"c1\"># Loads the whole table.</span>\n\n<span class=\"c1\"># After</span>\n<span class=\"n\">pp</span> <span class=\"no\">Foo</span><span class=\"p\">.</span><span class=\"nf\">all</span> <span class=\"c1\"># Shows 10 items and an ellipsis.</span>\n</code></pre></div></div>\n\n<p><em>Ulysse Buonomo</em></p>\n"
  },
  {
    "message": "*   Change `QueryMethods#in_order_of` to drop records not listed in values.\n\n    `in_order_of` now filters down to the values provided, to match the behavior of the `Enumerable` version.\n\n    *Kevin Newton*",
    "project": "activerecord",
    "date_merged": 1641498871000,
    "author": "Kevin Newton",
    "sha": "e7c3219cb50e0aa3a31e329c0ac2c161653d537c",
    "pr": "44097",
    "merge_sha": "ea7e58c2f46afb291d2aba98bade6095c9a391f8",
    "html": "<p>Change <code>QueryMethods#in_order_of</code> to drop records not listed in values.</p>\n\n<p><code>in_order_of</code> now filters down to the values provided, to match the behavior of the <code>Enumerable</code> version.</p>\n\n<p><em>Kevin Newton</em></p>\n"
  },
  {
    "message": "*   Allow named expression indexes to be revertible.\n\n    Previously, the following code would raise an error in a reversible migration executed while rolling back, due to the index name not being used in the index removal.\n\n    ```ruby\n    add_index(:settings, \"(data->'property')\", using: :gin, name: :index_settings_data_property)\n    ```\n\n    Fixes #43331.\n\n    *Oliver Günther*",
    "project": "activerecord",
    "date_merged": 1641207529000,
    "author": "Oliver Günther",
    "sha": "5c200f8448a3f8a3bcc09c42a6be4b4a698a589a",
    "pr": "43333",
    "merge_sha": "a3930799eac5d255180d8feefde6dff36c941483",
    "html": "<p>Allow named expression indexes to be revertible.</p>\n\n<p>Previously, the following code would raise an error in a reversible migration executed while rolling back, due to the index name not being used in the index removal.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">add_index</span><span class=\"p\">(</span><span class=\"ss\">:settings</span><span class=\"p\">,</span> <span class=\"s2\">\"(data-&gt;'property')\"</span><span class=\"p\">,</span> <span class=\"ss\">using: :gin</span><span class=\"p\">,</span> <span class=\"ss\">name: :index_settings_data_property</span><span class=\"p\">)</span>\n</code></pre></div></div>\n\n<p>Fixes #43331.</p>\n\n<p><em>Oliver Günther</em></p>\n"
  },
  {
    "message": "*   Fix incorrect argument in PostgreSQL structure dump tasks.\n\n    Updating the `--no-comment` argument added in Rails 7 to the correct `--no-comments` argument.\n\n    *Alex Dent*",
    "project": "activerecord",
    "date_merged": 1641092324000,
    "author": "Alex Dent",
    "sha": "71068365d0cd3e77de30b4d8d2a53d65f215c035",
    "pr": "44028",
    "merge_sha": "8b29524a386edd243243fd436f9f815e8c28eb13",
    "html": "<p>Fix incorrect argument in PostgreSQL structure dump tasks.</p>\n\n<p>Updating the <code>--no-comment</code> argument added in Rails 7 to the correct <code>--no-comments</code> argument.</p>\n\n<p><em>Alex Dent</em></p>\n"
  },
  {
    "message": "*   Fix migration compatibility to create SQLite references/belongs_to column as integer when migration version is 6.0.\n\n    Reference/belongs_to in migrations with version 6.0 were creating columns as\n    bigint instead of integer for the SQLite Adapter.\n\n    *Marcelo Lauxen*",
    "project": "activerecord",
    "date_merged": 1640071719000,
    "author": "Marcelo Lauxen",
    "sha": "99eea87e2559f08266639f51695e4f3a06e4c213",
    "pr": "43295",
    "merge_sha": "2ea5268cd2994a8d4628fbdb02c64e4d25549c7f",
    "html": "<p>Fix migration compatibility to create SQLite references/belongs_to column as integer when migration version is 6.0.</p>\n\n<p>Reference/belongs_to in migrations with version 6.0 were creating columns as<br />\nbigint instead of integer for the SQLite Adapter.</p>\n\n<p><em>Marcelo Lauxen</em></p>\n"
  },
  {
    "message": "*   Fix `QueryMethods#in_order_of` to handle empty order list.\n\n    ```ruby\n    Post.in_order_of(:id, []).to_a\n    ```\n\n    Also more explicitly set the column as secondary order, so that any other\n    value is still ordered.\n\n    *Jean Boussier*",
    "project": "activerecord",
    "date_merged": 1640040147000,
    "author": "Jean Boussier",
    "sha": "fb77d4a39dcfcb23162bc61d365245c38fe46d67",
    "pr": "43916",
    "merge_sha": "68075af82e04cf0e4e115ab35d0d2b51be05049a",
    "html": "<p>Fix <code>QueryMethods#in_order_of</code> to handle empty order list.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">Post</span><span class=\"p\">.</span><span class=\"nf\">in_order_of</span><span class=\"p\">(</span><span class=\"ss\">:id</span><span class=\"p\">,</span> <span class=\"p\">[]).</span><span class=\"nf\">to_a</span>\n</code></pre></div></div>\n\n<p>Also more explicitly set the column as secondary order, so that any other<br />\nvalue is still ordered.</p>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   Fix quoting of column aliases generated by calculation methods.\n\n    Since the alias is derived from the table name, we can't assume the result\n    is a valid identifier.\n\n    ```ruby\n    class Test < ActiveRecord::Base\n      self.table_name = '1abc'\n    end\n    Test.group(:id).count\n    # syntax error at or near \"1\" (ActiveRecord::StatementInvalid)\n    # LINE 1: SELECT COUNT(*) AS count_all, \"1abc\".\"id\" AS 1abc_id FROM \"1...\n    ```\n\n    *Jean Boussier*",
    "project": "activerecord",
    "date_merged": 1639743022000,
    "author": "Jean Boussier",
    "sha": "7e6e9091e55c3357b0162d44b6ab955ed0c718d5",
    "pr": "43911",
    "merge_sha": "3e705d725954fde5f92e73877deb7890af289191",
    "html": "<p>Fix quoting of column aliases generated by calculation methods.</p>\n\n<p>Since the alias is derived from the table name, we can’t assume the result<br />\nis a valid identifier.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">class</span> <span class=\"nc\">Test</span> <span class=\"o\">&lt;</span> <span class=\"no\">ActiveRecord</span><span class=\"o\">::</span><span class=\"no\">Base</span>\n  <span class=\"nb\">self</span><span class=\"p\">.</span><span class=\"nf\">table_name</span> <span class=\"o\">=</span> <span class=\"s1\">'1abc'</span>\n<span class=\"k\">end</span>\n<span class=\"no\">Test</span><span class=\"p\">.</span><span class=\"nf\">group</span><span class=\"p\">(</span><span class=\"ss\">:id</span><span class=\"p\">).</span><span class=\"nf\">count</span>\n<span class=\"c1\"># syntax error at or near \"1\" (ActiveRecord::StatementInvalid)</span>\n<span class=\"c1\"># LINE 1: SELECT COUNT(*) AS count_all, \"1abc\".\"id\" AS 1abc_id FROM \"1...</span>\n</code></pre></div></div>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   Add `authenticate_by` when using `has_secure_password`.\n\n    `authenticate_by` is intended to replace code like the following, which\n    returns early when a user with a matching email is not found:\n\n    ```ruby\n    User.find_by(email: \"...\")&.authenticate(\"...\")\n    ```\n\n    Such code is vulnerable to timing-based enumeration attacks, wherein an\n    attacker can determine if a user account with a given email exists. After\n    confirming that an account exists, the attacker can try passwords associated\n    with that email address from other leaked databases, in case the user\n    re-used a password across multiple sites (a common practice). Additionally,\n    knowing an account email address allows the attacker to attempt a targeted\n    phishing (\"spear phishing\") attack.\n\n    `authenticate_by` addresses the vulnerability by taking the same amount of\n    time regardless of whether a user with a matching email is found:\n\n    ```ruby\n    User.authenticate_by(email: \"...\", password: \"...\")\n    ```\n\n    *Jonathan Hefner*",
    "project": "activerecord",
    "date_merged": 1639594590000,
    "author": "Rafael Mendonça França",
    "sha": "139183cbce9b8251a2071d255b264ac0d99687d7",
    "pr": "43880",
    "merge_sha": "5e75674196376b5e46e68419e004886379a31f6c",
    "html": "<p>Add <code>authenticate_by</code> when using <code>has_secure_password</code>.</p>\n\n<p><code>authenticate_by</code> is intended to replace code like the following, which<br />\nreturns early when a user with a matching email is not found:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">User</span><span class=\"p\">.</span><span class=\"nf\">find_by</span><span class=\"p\">(</span><span class=\"ss\">email: </span><span class=\"s2\">\"...\"</span><span class=\"p\">)</span><span class=\"o\">&amp;</span><span class=\"p\">.</span><span class=\"nf\">authenticate</span><span class=\"p\">(</span><span class=\"s2\">\"...\"</span><span class=\"p\">)</span>\n</code></pre></div></div>\n\n<p>Such code is vulnerable to timing-based enumeration attacks, wherein an<br />\nattacker can determine if a user account with a given email exists. After<br />\nconfirming that an account exists, the attacker can try passwords associated<br />\nwith that email address from other leaked databases, in case the user<br />\nre-used a password across multiple sites (a common practice). Additionally,<br />\nknowing an account email address allows the attacker to attempt a targeted<br />\nphishing (“spear phishing”) attack.</p>\n\n<p><code>authenticate_by</code> addresses the vulnerability by taking the same amount of<br />\ntime regardless of whether a user with a matching email is found:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">User</span><span class=\"p\">.</span><span class=\"nf\">authenticate_by</span><span class=\"p\">(</span><span class=\"ss\">email: </span><span class=\"s2\">\"...\"</span><span class=\"p\">,</span> <span class=\"ss\">password: </span><span class=\"s2\">\"...\"</span><span class=\"p\">)</span>\n</code></pre></div></div>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Fix Active Job log message to correctly report a job failed to enqueue\n    when the adapter raises an `ActiveJob::EnqueueError`.\n\n    *Ben Sheldon*",
    "project": "activejob",
    "date_merged": 1693883818000,
    "author": "Ben Sheldon",
    "sha": "b1b7debaa392c01a6e1b9bd46f6fae5261c5eeb8",
    "pr": "47865",
    "merge_sha": "b32c8a04bd7798f7a9a2409253aadd6c773e0241",
    "html": "<p>Fix Active Job log message to correctly report a job failed to enqueue<br />\nwhen the adapter raises an <code>ActiveJob::EnqueueError</code>.</p>\n\n<p><em>Ben Sheldon</em></p>\n"
  },
  {
    "message": "*   Add `after_discard` method.\n\n    This method lets job authors define a block which will be run when a job is about to be discarded. For example:\n\n    ```ruby\n      class AfterDiscardJob < ActiveJob::Base\n        after_discard do |job, exception|\n          Rails.logger.info(\"#{job.class} raised an exception: #{exception}\")\n        end\n\n        def perform\n          raise StandardError\n        end\n      end\n    ```\n\n    The above job will run the block passed to `after_discard` after the job is discarded. The exception will\n    still be raised after the block has been run.\n\n    *Rob Cardy*",
    "project": "activejob",
    "date_merged": 1692640546000,
    "author": "Rafael Mendonça França",
    "sha": "53a3a95d01df9107aea8e483c982a63b7c98a61d",
    "pr": "48010",
    "merge_sha": "6beb3482cd16f48246bb5d596347a7d0a05cd8e9",
    "html": "<p>Add <code>after_discard</code> method.</p>\n\n<p>This method lets job authors define a block which will be run when a job is about to be discarded. For example:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>  <span class=\"k\">class</span> <span class=\"nc\">AfterDiscardJob</span> <span class=\"o\">&lt;</span> <span class=\"no\">ActiveJob</span><span class=\"o\">::</span><span class=\"no\">Base</span>\n    <span class=\"n\">after_discard</span> <span class=\"k\">do</span> <span class=\"o\">|</span><span class=\"n\">job</span><span class=\"p\">,</span> <span class=\"n\">exception</span><span class=\"o\">|</span>\n      <span class=\"no\">Rails</span><span class=\"p\">.</span><span class=\"nf\">logger</span><span class=\"p\">.</span><span class=\"nf\">info</span><span class=\"p\">(</span><span class=\"s2\">\"</span><span class=\"si\">#{</span><span class=\"n\">job</span><span class=\"p\">.</span><span class=\"nf\">class</span><span class=\"si\">}</span><span class=\"s2\"> raised an exception: </span><span class=\"si\">#{</span><span class=\"n\">exception</span><span class=\"si\">}</span><span class=\"s2\">\"</span><span class=\"p\">)</span>\n    <span class=\"k\">end</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">perform</span>\n      <span class=\"k\">raise</span> <span class=\"no\">StandardError</span>\n    <span class=\"k\">end</span>\n  <span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p>The above job will run the block passed to <code>after_discard</code> after the job is discarded. The exception will<br />\nstill be raised after the block has been run.</p>\n\n<p><em>Rob Cardy</em></p>\n"
  },
  {
    "message": "*   Fix deserialization of ActiveSupport::Duration\n\n    Previously, a deserialized Duration would return an array from Duration#parts.\n    It will now return a hash just like a regular Duration.\n\n    This also fixes an error when trying to add or subtract from a deserialized Duration\n    (eg `duration + 1.year`).\n\n    *Jonathan del Strother*",
    "project": "activejob",
    "date_merged": 1692036365000,
    "author": "Jonathan del Strother",
    "sha": "074d431493f0d770fb571e3d19292f038dfab775",
    "pr": "44262",
    "merge_sha": "3779b5069dd1742d878cc0e322fc642e730efa42",
    "html": "<p>Fix deserialization of ActiveSupport::Duration</p>\n\n<p>Previously, a deserialized Duration would return an array from Duration#parts.<br />\nIt will now return a hash just like a regular Duration.</p>\n\n<p>This also fixes an error when trying to add or subtract from a deserialized Duration<br />\n(eg <code>duration + 1.year</code>).</p>\n\n<p><em>Jonathan del Strother</em></p>\n"
  },
  {
    "message": "*   `perform_enqueued_jobs` is now compatible with all Active Job adapters\n\n    This means that methods that depend on it, like Action Mailer's `assert_emails`,\n    will work correctly even if the test adapter is not used.\n\n    *Alex Ghiculescu*",
    "project": "activejob",
    "date_merged": 1687972223000,
    "author": "Alex Ghiculescu",
    "sha": "ba70a5be866775165ec546ba8aab3cbbe1efde30",
    "pr": "48599",
    "merge_sha": "5b2523edaa131eec7b18780b7916760828262df4",
    "html": "<p><code>perform_enqueued_jobs</code> is now compatible with all Active Job adapters</p>\n\n<p>This means that methods that depend on it, like Action Mailer’s <code>assert_emails</code>,<br />\nwill work correctly even if the test adapter is not used.</p>\n\n<p><em>Alex Ghiculescu</em></p>\n"
  },
  {
    "message": "*   Allow queue adapters to provide a custom name by implementing `queue_adapter_name`\n\n    *Sander Verdonschot*",
    "project": "activejob",
    "date_merged": 1682021139000,
    "author": "Sander Verdonschot",
    "sha": "6daba18791a674baae4722a80003d1facfe36177",
    "pr": "48003",
    "merge_sha": "9f8f5583ca7c67a5eae799fd48ab20ec0e24f8e5",
    "html": "<p>Allow queue adapters to provide a custom name by implementing <code>queue_adapter_name</code></p>\n\n<p><em>Sander Verdonschot</em></p>\n"
  },
  {
    "message": "*   Log background job enqueue callers\n\n    Add `verbose_enqueue_logs` configuration option to display the caller\n    of background job enqueue in the log to help with debugging.\n\n    Example log line:\n\n    ```\n    Enqueued AvatarThumbnailsJob (Job ID: ab528951-41fb-4c48-9129-3171791c27d6) to Sidekiq(default) with arguments: 1092412064\n    ↳ app/models/user.rb:421:in `generate_avatar_thumbnails'\n    ```\n\n    Enabled in development only for new and upgraded applications. Not recommended for use\n    in the production environment since it relies on Ruby's `Kernel#caller` which is fairly slow.\n\n    *fatkodima*",
    "project": "activejob",
    "date_merged": 1680508313000,
    "author": "fatkodima",
    "sha": "f6d56fed27cfd11aa7161129e2c59a972f90b76b",
    "pr": "47839",
    "merge_sha": "b113b7fc4a26419efe52a4946d2c07bd1bd38d0c",
    "html": "<p>Log background job enqueue callers</p>\n\n<p>Add <code>verbose_enqueue_logs</code> configuration option to display the caller<br />\nof background job enqueue in the log to help with debugging.</p>\n\n<p>Example log line:</p>\n\n<pre><code>Enqueued AvatarThumbnailsJob (Job ID: ab528951-41fb-4c48-9129-3171791c27d6) to Sidekiq(default) with arguments: 1092412064\n↳ app/models/user.rb:421:in `generate_avatar_thumbnails'\n</code></pre>\n\n<p>Enabled in development only for new and upgraded applications. Not recommended for use<br />\nin the production environment since it relies on Ruby’s <code>Kernel#caller</code> which is fairly slow.</p>\n\n<p><em>fatkodima</em></p>\n"
  },
  {
    "message": "*   Set `provider_job_id` for Backburner jobs\n\n    *Cameron Matheson*",
    "project": "activejob",
    "date_merged": 1679757700000,
    "author": "Cameron Matheson",
    "sha": "0cb0880b1a1d1dc6ac7c38039cfc0377ab937692",
    "pr": "47732",
    "merge_sha": "05104e82b8e0e49c18198210422870aaec544bfc",
    "html": "<p>Set <code>provider_job_id</code> for Backburner jobs</p>\n\n<p><em>Cameron Matheson</em></p>\n"
  },
  {
    "message": "*   Add `perform_all_later` to enqueue multiple jobs at once\n\n    This adds the ability to bulk enqueue jobs, without running callbacks, by\n    passing multiple jobs or an array of jobs. For example:\n\n    ```ruby\n    ActiveJob.perform_all_later(MyJob.new(\"hello\", 42), MyJob.new(\"world\", 0))\n\n    user_jobs = User.pluck(:id).map { |id| UserJob.new(user_id: id) }\n    ActiveJob.perform_all_later(user_jobs)\n    ```\n\n    This can greatly reduce the number of round-trips to the queue datastore.\n    For queue adapters that do not implement the new `enqueue_all` method, we\n    fall back to enqueuing jobs individually. The Sidekiq adapter implements\n    `enqueue_all` with `push_bulk`.\n\n    This method does not use the existing `enqueue.active_job` event, but adds a\n    new event `enqueue_all.active_job`.\n\n    *Sander Verdonschot*",
    "project": "activejob",
    "date_merged": 1676318638000,
    "author": "Sander Verdonschot",
    "sha": "9b62f88a2fde0d2bf8c4f6e3bcd06ecba7ca9d8d",
    "pr": "46603",
    "merge_sha": "9b797982978994692ae9037600eb13f591764f1e",
    "html": "<p>Add <code>perform_all_later</code> to enqueue multiple jobs at once</p>\n\n<p>This adds the ability to bulk enqueue jobs, without running callbacks, by<br />\npassing multiple jobs or an array of jobs. For example:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"no\">ActiveJob</span><span class=\"p\">.</span><span class=\"nf\">perform_all_later</span><span class=\"p\">(</span><span class=\"no\">MyJob</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"s2\">\"hello\"</span><span class=\"p\">,</span> <span class=\"mi\">42</span><span class=\"p\">),</span> <span class=\"no\">MyJob</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"s2\">\"world\"</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">))</span>\n\n<span class=\"n\">user_jobs</span> <span class=\"o\">=</span> <span class=\"no\">User</span><span class=\"p\">.</span><span class=\"nf\">pluck</span><span class=\"p\">(</span><span class=\"ss\">:id</span><span class=\"p\">).</span><span class=\"nf\">map</span> <span class=\"p\">{</span> <span class=\"o\">|</span><span class=\"nb\">id</span><span class=\"o\">|</span> <span class=\"no\">UserJob</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"ss\">user_id: </span><span class=\"nb\">id</span><span class=\"p\">)</span> <span class=\"p\">}</span>\n<span class=\"no\">ActiveJob</span><span class=\"p\">.</span><span class=\"nf\">perform_all_later</span><span class=\"p\">(</span><span class=\"n\">user_jobs</span><span class=\"p\">)</span>\n</code></pre></div></div>\n\n<p>This can greatly reduce the number of round-trips to the queue datastore.<br />\nFor queue adapters that do not implement the new <code>enqueue_all</code> method, we<br />\nfall back to enqueuing jobs individually. The Sidekiq adapter implements<br />\n<code>enqueue_all</code> with <code>push_bulk</code>.</p>\n\n<p>This method does not use the existing <code>enqueue.active_job</code> event, but adds a<br />\nnew event <code>enqueue_all.active_job</code>.</p>\n\n<p><em>Sander Verdonschot</em></p>\n"
  },
  {
    "message": "*   Don't double log the `job` when using `ActiveRecord::QueryLog`\n\n    Previously if you set `config.active_record.query_log_tags` to an array that included\n    `:job`, the job name would get logged twice. This bug has been fixed.\n\n    *Alex Ghiculescu*",
    "project": "activejob",
    "date_merged": 1666480961000,
    "author": "Alex Ghiculescu",
    "sha": "f737b5ec1380963d2e354d25550e27ee3930831a",
    "pr": "46279",
    "merge_sha": "971fa17502deaf5d720a7bc0fdf8f258afb556b6",
    "html": "<p>Don’t double log the <code>job</code> when using <code>ActiveRecord::QueryLog</code></p>\n\n<p>Previously if you set <code>config.active_record.query_log_tags</code> to an array that included<br />\n<code>:job</code>, the job name would get logged twice. This bug has been fixed.</p>\n\n<p><em>Alex Ghiculescu</em></p>\n"
  },
  {
    "message": "*   Add support for Sidekiq's transaction-aware client\n\n    *Jonathan del Strother*",
    "project": "activejob",
    "date_merged": 1663707843000,
    "author": "Jonathan del Strother",
    "sha": "b38992038f78731665c17a3ac06aada7bd9c1476",
    "pr": "46080",
    "merge_sha": "a168949736e06a938ab793004ea2c09e9df08711",
    "html": "<p>Add support for Sidekiq’s transaction-aware client</p>\n\n<p><em>Jonathan del Strother</em></p>\n"
  },
  {
    "message": "*   Remove QueAdapter from Active Job.\n\n    After maintaining Active Job QueAdapter by Rails and Que side\n    to support Ruby 3 keyword arguments and options provided as top level keywords,\n    it is quite difficult to maintain it this way.\n\n    Active Job Que adapter can be included in the future version of que gem itself.\n\n    *Yasuo Honda*",
    "project": "activejob",
    "date_merged": 1663024693000,
    "author": "Yasuo Honda",
    "sha": "cb22eb2b3628de428171175063371155d70a136c",
    "pr": "46005",
    "merge_sha": "1f7676efa54a05628e98b657019133fa261b87cb",
    "html": "<p>Remove QueAdapter from Active Job.</p>\n\n<p>After maintaining Active Job QueAdapter by Rails and Que side<br />\nto support Ruby 3 keyword arguments and options provided as top level keywords,<br />\nit is quite difficult to maintain it this way.</p>\n\n<p>Active Job Que adapter can be included in the future version of que gem itself.</p>\n\n<p><em>Yasuo Honda</em></p>\n"
  },
  {
    "message": "*   Fix BigDecimal (de)serialization for adapters using JSON.\n\n    Previously, BigDecimal was listed as not needing a serializer.  However,\n    when used with an adapter storing the job arguments as JSON, it would get\n    serialized as a simple String, resulting in deserialization also producing\n    a String (instead of a BigDecimal).\n\n    By using a serializer, we ensure the round trip is safe.\n\n    To ensure applications using BigDecimal job arguments are not subject to\n    race conditions during deployment (where a replica running a version of\n    Rails without BigDecimalSerializer fails to deserialize an argument\n    serialized with it), `ActiveJob.use_big_decimal_serializer` is disabled by\n    default, and can be set to true in a following deployment..\n\n    *Sam Bostock*",
    "project": "activejob",
    "date_merged": 1658411908000,
    "author": "Sam Bostock",
    "sha": "bc1f3233384601fa8720ee164bced84ffbf3acf2",
    "pr": "45618",
    "merge_sha": "17fd2edafbe10d9294a52f3b7771cfe0c5348467",
    "html": "<p>Fix BigDecimal (de)serialization for adapters using JSON.</p>\n\n<p>Previously, BigDecimal was listed as not needing a serializer.  However,<br />\nwhen used with an adapter storing the job arguments as JSON, it would get<br />\nserialized as a simple String, resulting in deserialization also producing<br />\na String (instead of a BigDecimal).</p>\n\n<p>By using a serializer, we ensure the round trip is safe.</p>\n\n<p>To ensure applications using BigDecimal job arguments are not subject to<br />\nrace conditions during deployment (where a replica running a version of<br />\nRails without BigDecimalSerializer fails to deserialize an argument<br />\nserialized with it), <code>ActiveJob.use_big_decimal_serializer</code> is disabled by<br />\ndefault, and can be set to true in a following deployment..</p>\n\n<p><em>Sam Bostock</em></p>\n"
  },
  {
    "message": "*   Preserve full-precision `enqueued_at` timestamps for serialized jobs,\n    allowing more accurate reporting of how long a job spent waiting in the\n    queue before it was performed.\n\n    Retains IS08601 format compatibility.\n\n    *Jeremy Daer*",
    "project": "activejob",
    "date_merged": 1657717327000,
    "author": "Jeremy Daer",
    "sha": "8d9d8013caa88efa2514aa741eeaf673c7520415",
    "pr": "45584",
    "merge_sha": "05ae3faaf3779d53935ab983b75f2dc7c6dfb7fa",
    "html": "<p>Preserve full-precision <code>enqueued_at</code> timestamps for serialized jobs,<br />\nallowing more accurate reporting of how long a job spent waiting in the<br />\nqueue before it was performed.</p>\n\n<p>Retains IS08601 format compatibility.</p>\n\n<p><em>Jeremy Daer</em></p>\n"
  },
  {
    "message": "*   Add `--parent` option to job generator to specify parent class of job.\n\n    Example:\n\n    `bin/rails g job process_payment --parent=payment_job` generates:\n\n    ```ruby\n    class ProcessPaymentJob < PaymentJob\n      # ...\n    end\n    ```\n\n    *Gannon McGibbon*",
    "project": "activejob",
    "date_merged": 1657227455000,
    "author": "Gannon McGibbon",
    "sha": "02444d9267e77f52bae4bf8035468e823ed0b0c9",
    "pr": "45528",
    "merge_sha": "e240daa6cc013b5a24fb692a8b82ce18dc44ad11",
    "html": "<p>Add <code>--parent</code> option to job generator to specify parent class of job.</p>\n\n<p>Example:</p>\n\n<p><code>bin/rails g job process_payment --parent=payment_job</code> generates:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">class</span> <span class=\"nc\">ProcessPaymentJob</span> <span class=\"o\">&lt;</span> <span class=\"no\">PaymentJob</span>\n  <span class=\"c1\"># ...</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p><em>Gannon McGibbon</em></p>\n"
  },
  {
    "message": "*   Add more detailed description to job generator.\n\n    *Gannon McGibbon*",
    "project": "activejob",
    "date_merged": 1655153632000,
    "author": "Gannon McGibbon",
    "sha": "5f57c7d35254a9a7edb2726b3e279c33a0c07f26",
    "pr": "45327",
    "merge_sha": "effe5040468d4d0b06a14ea8c91d2b444a984de3",
    "html": "<p>Add more detailed description to job generator.</p>\n\n<p><em>Gannon McGibbon</em></p>\n"
  },
  {
    "message": "*   `perform.active_job` notification payloads now include `:db_runtime`, which\n    is the total time (in ms) taken by database queries while performing a job.\n    This value can be used to better understand how a job's time is spent.\n\n    *Jonathan Hefner*",
    "project": "activejob",
    "date_merged": 1652989174000,
    "author": "Jonathan Hefner",
    "sha": "9574a39a7acf38453d08a31f56a9797c7e417e94",
    "pr": "40058",
    "merge_sha": "82b78af4b8537e8194be824ea6964cf9252d3e5b",
    "html": "<p><code>perform.active_job</code> notification payloads now include <code>:db_runtime</code>, which<br />\nis the total time (in ms) taken by database queries while performing a job.<br />\nThis value can be used to better understand how a job’s time is spent.</p>\n\n<p><em>Jonathan Hefner</em></p>\n"
  },
  {
    "message": "*   Update `ActiveJob::QueueAdapters::QueAdapter` to remove deprecation warning.\n\n    Remove a deprecation warning introduced in que 1.2 to prepare for changes in\n    que 2.0 necessary for Ruby 3 compatibility.\n\n    *Damir Zekic* and *Adis Hasovic*",
    "project": "activejob",
    "date_merged": 1661812120000,
    "author": "Ryuta Kamizono",
    "sha": "e0e64e9474b2738b3181e7c55499b47b1c5dbff4",
    "pr": "45896",
    "merge_sha": "9b6abb50b2c99fe4c5b1249367f790d30fc1e64d",
    "html": "<p>Update <code>ActiveJob::QueueAdapters::QueAdapter</code> to remove deprecation warning.</p>\n\n<p>Remove a deprecation warning introduced in que 1.2 to prepare for changes in<br />\nque 2.0 necessary for Ruby 3 compatibility.</p>\n\n<p><em>Damir Zekic</em> and <em>Adis Hasovic</em></p>\n"
  },
  {
    "message": "*   Add missing `bigdecimal` require in `ActiveJob::Arguments`\n\n    Could cause `uninitialized constant ActiveJob::Arguments::BigDecimal (NameError)`\n    when loading Active Job in isolation.\n\n    *Jean Boussier*",
    "project": "activejob",
    "date_merged": 1644656886000,
    "author": "Jean Boussier",
    "sha": "4ca5aff9f0a050d3be9e22c805d30acbb7253c63",
    "pr": "44411",
    "merge_sha": "bcc3a49ccc1178655f599fdeb8da55d1942f134b",
    "html": "<p>Add missing <code>bigdecimal</code> require in <code>ActiveJob::Arguments</code></p>\n\n<p>Could cause <code>uninitialized constant ActiveJob::Arguments::BigDecimal (NameError)</code><br />\nwhen loading Active Job in isolation.</p>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   Allow testing `discard_on/retry_on ActiveJob::DeserializationError`\n\n    Previously in `perform_enqueued_jobs`, `deserialize_arguments_if_needed`\n    was called before calling `perform_now`. When a record no longer exists\n    and is serialized using GlobalID this led to raising\n    an `ActiveJob::DeserializationError` before reaching `perform_now` call.\n    This behavior makes difficult testing the job `discard_on/retry_on` logic.\n\n    Now `deserialize_arguments_if_needed` call is postponed to when `perform_now`\n    is called.\n\n    Example:\n\n    ```ruby\n    class UpdateUserJob < ActiveJob::Base\n      discard_on ActiveJob::DeserializationError\n\n      def perform(user)\n        # ...\n      end\n    end\n\n    # In the test\n    User.destroy_all\n    assert_nothing_raised do\n      perform_enqueued_jobs only: UpdateUserJob\n    end\n    ```\n\n    *Jacopo Beschi*",
    "project": "activejob",
    "date_merged": 1641488011000,
    "author": "Jacopo",
    "sha": "20545fc820522f87665188bd91b6c679953fb5e2",
    "pr": "43066",
    "merge_sha": "6fb54c00e48d666ea9c07b82babc9a2874c999b8",
    "html": "<p>Allow testing <code>discard_on/retry_on ActiveJob::DeserializationError</code></p>\n\n<p>Previously in <code>perform_enqueued_jobs</code>, <code>deserialize_arguments_if_needed</code><br />\nwas called before calling <code>perform_now</code>. When a record no longer exists<br />\nand is serialized using GlobalID this led to raising<br />\nan <code>ActiveJob::DeserializationError</code> before reaching <code>perform_now</code> call.<br />\nThis behavior makes difficult testing the job <code>discard_on/retry_on</code> logic.</p>\n\n<p>Now <code>deserialize_arguments_if_needed</code> call is postponed to when <code>perform_now</code><br />\nis called.</p>\n\n<p>Example:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">class</span> <span class=\"nc\">UpdateUserJob</span> <span class=\"o\">&lt;</span> <span class=\"no\">ActiveJob</span><span class=\"o\">::</span><span class=\"no\">Base</span>\n  <span class=\"n\">discard_on</span> <span class=\"no\">ActiveJob</span><span class=\"o\">::</span><span class=\"no\">DeserializationError</span>\n\n  <span class=\"k\">def</span> <span class=\"nf\">perform</span><span class=\"p\">(</span><span class=\"n\">user</span><span class=\"p\">)</span>\n    <span class=\"c1\"># ...</span>\n  <span class=\"k\">end</span>\n<span class=\"k\">end</span>\n\n<span class=\"c1\"># In the test</span>\n<span class=\"no\">User</span><span class=\"p\">.</span><span class=\"nf\">destroy_all</span>\n<span class=\"n\">assert_nothing_raised</span> <span class=\"k\">do</span>\n  <span class=\"n\">perform_enqueued_jobs</span> <span class=\"ss\">only: </span><span class=\"no\">UpdateUserJob</span>\n<span class=\"k\">end</span>\n</code></pre></div></div>\n\n<p><em>Jacopo Beschi</em></p>\n"
  },
  {
    "message": "*   Add a `@server` instance variable referencing the `ActionCable.server`\n    singleton to `ActionCable::Channel::ConnectionStub`\n\n    This lets us delegate the `pubsub` and `config` method calls\n    to the server. This fixes `NoMethodError` errors when testing\n    channel logic that call `pubsub` (e.g. `stop_stream_for`).\n\n    *Julian Foo*",
    "project": "actioncable",
    "date_merged": 1689593099000,
    "author": "julianfssen",
    "sha": "9c5175e06766fd5df31a91c6267090f88260c4e9",
    "pr": "48706",
    "merge_sha": "e18791c0bf2e03d3e6380f69b44e946564c6f873",
    "html": "<p>Add a <code>@server</code> instance variable referencing the <code>ActionCable.server</code><br />\nsingleton to <code>ActionCable::Channel::ConnectionStub</code></p>\n\n<p>This lets us delegate the <code>pubsub</code> and <code>config</code> method calls<br />\nto the server. This fixes <code>NoMethodError</code> errors when testing<br />\nchannel logic that call <code>pubsub</code> (e.g. <code>stop_stream_for</code>).</p>\n\n<p><em>Julian Foo</em></p>\n"
  },
  {
    "message": "*   Added `health_check_path` and `health_check_application` config to\n    mount a given health check rack app on a given path.\n    Useful when mounting Action Cable standalone.\n\n    *Joé Dupuis*",
    "project": "actioncable",
    "date_merged": 1685478912000,
    "author": "Joé Dupuis",
    "sha": "32e7028aa1b6f85c6b46de591868d6df96a6327b",
    "pr": "48222",
    "merge_sha": "74b8a3798b41833e94ce1abba6d32abdc1a1dd7f",
    "html": "<p>Added <code>health_check_path</code> and <code>health_check_application</code> config to<br />\nmount a given health check rack app on a given path.<br />\nUseful when mounting Action Cable standalone.</p>\n\n<p><em>Joé Dupuis</em></p>\n"
  },
  {
    "message": "*   Introduce the `capture_broadcasts` test helper.\n\n    Returns all messages broadcast in a block.\n\n    ```ruby\n    messages = capture_broadcasts(\"test\") do\n      ActionCable.server.broadcast \"test\", { message: \"one\" }\n      ActionCable.server.broadcast \"test\", { message: \"two\" }\n    end\n    assert_equal 2, messages.length\n    assert_equal({ \"message\" => \"one\" }, messages.first)\n    assert_equal({ \"message\" => \"two\" }, messages.last)\n    ```\n\n    *Alex Ghiculescu*",
    "project": "actioncable",
    "date_merged": 1690296673000,
    "author": "Alex Ghiculescu",
    "sha": "455e922b49c5de92882d10783c3014f6bf34a146",
    "pr": "48798",
    "merge_sha": "06e8bb5b4cc52fc26b72073c2a5c2b29ff569610",
    "html": "<p>Introduce the <code>capture_broadcasts</code> test helper.</p>\n\n<p>Returns all messages broadcast in a block.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">messages</span> <span class=\"o\">=</span> <span class=\"n\">capture_broadcasts</span><span class=\"p\">(</span><span class=\"s2\">\"test\"</span><span class=\"p\">)</span> <span class=\"k\">do</span>\n  <span class=\"no\">ActionCable</span><span class=\"p\">.</span><span class=\"nf\">server</span><span class=\"p\">.</span><span class=\"nf\">broadcast</span> <span class=\"s2\">\"test\"</span><span class=\"p\">,</span> <span class=\"p\">{</span> <span class=\"ss\">message: </span><span class=\"s2\">\"one\"</span> <span class=\"p\">}</span>\n  <span class=\"no\">ActionCable</span><span class=\"p\">.</span><span class=\"nf\">server</span><span class=\"p\">.</span><span class=\"nf\">broadcast</span> <span class=\"s2\">\"test\"</span><span class=\"p\">,</span> <span class=\"p\">{</span> <span class=\"ss\">message: </span><span class=\"s2\">\"two\"</span> <span class=\"p\">}</span>\n<span class=\"k\">end</span>\n<span class=\"n\">assert_equal</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">messages</span><span class=\"p\">.</span><span class=\"nf\">length</span>\n<span class=\"n\">assert_equal</span><span class=\"p\">({</span> <span class=\"s2\">\"message\"</span> <span class=\"o\">=&gt;</span> <span class=\"s2\">\"one\"</span> <span class=\"p\">},</span> <span class=\"n\">messages</span><span class=\"p\">.</span><span class=\"nf\">first</span><span class=\"p\">)</span>\n<span class=\"n\">assert_equal</span><span class=\"p\">({</span> <span class=\"s2\">\"message\"</span> <span class=\"o\">=&gt;</span> <span class=\"s2\">\"two\"</span> <span class=\"p\">},</span> <span class=\"n\">messages</span><span class=\"p\">.</span><span class=\"nf\">last</span><span class=\"p\">)</span>\n</code></pre></div></div>\n\n<p><em>Alex Ghiculescu</em></p>\n"
  },
  {
    "message": "*   Display broadcasted messages on error message when using `assert_broadcast_on`\n\n    *Stéphane Robino*",
    "project": "actioncable",
    "date_merged": 1675553086000,
    "author": "StephaneRob",
    "sha": "1333260e11de38822ffd96b4ab0a0e61373245e8",
    "pr": "47204",
    "merge_sha": "3d0d027bfd57521c34d5df214b3842f07e2bc408",
    "html": "<p>Display broadcasted messages on error message when using <code>assert_broadcast_on</code></p>\n\n<p><em>Stéphane Robino</em></p>\n"
  },
  {
    "message": "*   The Action Cable client now supports subprotocols to allow passing arbitrary data\n    to the server.\n\n    ```js\n    const consumer = ActionCable.createConsumer()\n\n    consumer.addSubProtocol('custom-protocol')\n\n    consumer.connect()\n    ```\n\n    See also:\n\n    * https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API/Writing_WebSocket_servers#subprotocols\n\n    *Guillaume Hain*",
    "project": "actioncable",
    "date_merged": 1674864265000,
    "author": "zzak",
    "sha": "b1f605471d1128493a73e14e0b6670741a735ef3",
    "pr": "41415",
    "merge_sha": "6b30c3f41098c26abb71b73e5be377ceae85e573",
    "html": "<p>The Action Cable client now supports subprotocols to allow passing arbitrary data<br />\nto the server.</p>\n\n<div class=\"language-js highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">const</span> <span class=\"nx\">consumer</span> <span class=\"o\">=</span> <span class=\"nx\">ActionCable</span><span class=\"p\">.</span><span class=\"nx\">createConsumer</span><span class=\"p\">()</span>\n\n<span class=\"nx\">consumer</span><span class=\"p\">.</span><span class=\"nx\">addSubProtocol</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">custom-protocol</span><span class=\"dl\">'</span><span class=\"p\">)</span>\n\n<span class=\"nx\">consumer</span><span class=\"p\">.</span><span class=\"nx\">connect</span><span class=\"p\">()</span>\n</code></pre></div></div>\n\n<p>See also:</p>\n\n<ul>\n  <li>https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API/Writing_WebSocket_servers#subprotocols</li>\n</ul>\n\n<p><em>Guillaume Hain</em></p>\n"
  },
  {
    "message": "*   Redis pub/sub adapter now automatically reconnects when Redis connection is lost.\n\n    *Vladimir Dementyev*",
    "project": "actioncable",
    "date_merged": 1669289238000,
    "author": "Vladimir Dementyev",
    "sha": "ae649b152e2cae91ac1f2e9c3a7ef7638d3ec8bc",
    "pr": "46562",
    "merge_sha": "3e13388c31f12c59715ee4a1b9f4cfb61debceb9",
    "html": "<p>Redis pub/sub adapter now automatically reconnects when Redis connection is lost.</p>\n\n<p><em>Vladimir Dementyev</em></p>\n"
  },
  {
    "message": "*   The `connected()` callback can now take a `{reconnected}` parameter to differentiate\n    connections from reconnections.\n\n    ```js\n    import consumer from \"./consumer\"\n\n    consumer.subscriptions.create(\"ExampleChannel\", {\n      connected({reconnected}) {\n        if (reconnected) {\n          ...\n        } else {\n          ...\n        }\n      }\n    })\n    ```\n\n    *Mansa Keïta*",
    "project": "actioncable",
    "date_merged": 1663435717000,
    "author": "Mansa Keïta",
    "sha": "09152576d61e741b769e47bc09b46c71340064c7",
    "pr": "45738",
    "merge_sha": "e5288b2760aa21560413dfec3597d9a32c87ef9d",
    "html": "<p>The <code>connected()</code> callback can now take a <code>{reconnected}</code> parameter to differentiate<br />\nconnections from reconnections.</p>\n\n<div class=\"language-js highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">import</span> <span class=\"nx\">consumer</span> <span class=\"k\">from</span> <span class=\"dl\">\"</span><span class=\"s2\">./consumer</span><span class=\"dl\">\"</span>\n\n<span class=\"nx\">consumer</span><span class=\"p\">.</span><span class=\"nx\">subscriptions</span><span class=\"p\">.</span><span class=\"nx\">create</span><span class=\"p\">(</span><span class=\"dl\">\"</span><span class=\"s2\">ExampleChannel</span><span class=\"dl\">\"</span><span class=\"p\">,</span> <span class=\"p\">{</span>\n  <span class=\"nx\">connected</span><span class=\"p\">({</span><span class=\"nx\">reconnected</span><span class=\"p\">})</span> <span class=\"p\">{</span>\n    <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nx\">reconnected</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n      <span class=\"p\">...</span>\n    <span class=\"p\">}</span> <span class=\"k\">else</span> <span class=\"p\">{</span>\n      <span class=\"p\">...</span>\n    <span class=\"p\">}</span>\n  <span class=\"p\">}</span>\n<span class=\"p\">})</span>\n</code></pre></div></div>\n\n<p><em>Mansa Keïta</em></p>\n"
  },
  {
    "message": "*   The Redis adapter is now compatible with redis-rb 5.0\n\n    Compatibility with redis-rb 3.x was dropped.\n\n    *Jean Boussier*",
    "project": "actioncable",
    "date_merged": 1661156236000,
    "author": "Jean Boussier",
    "sha": "7587b7e99a8c52192a21c081bb029318104dd22b",
    "pr": "45856",
    "merge_sha": "1aac6f3bf43521cb51b45e85a19fa5f87a90acdf",
    "html": "<p>The Redis adapter is now compatible with redis-rb 5.0</p>\n\n<p>Compatibility with redis-rb 3.x was dropped.</p>\n\n<p><em>Jean Boussier</em></p>\n"
  },
  {
    "message": "*   The Action Cable server is now mounted with `anchor: true`.\n\n    This means that routes that also start with `/cable` will no longer clash with Action Cable.\n\n    *Alex Ghiculescu*",
    "project": "actioncable",
    "date_merged": 1656528254000,
    "author": "Alex Ghiculescu",
    "sha": "1ee984dfe4136767a907b25c30341f307198200c",
    "pr": "45490",
    "merge_sha": "8648ac791591aa3995d8997d128b0e249123a125",
    "html": "<p>The Action Cable server is now mounted with <code>anchor: true</code>.</p>\n\n<p>This means that routes that also start with <code>/cable</code> will no longer clash with Action Cable.</p>\n\n<p><em>Alex Ghiculescu</em></p>\n"
  },
  {
    "message": "*   `ActionCable.server.remote_connections.where(...).disconnect` now sends `disconnect` message\n    before closing the connection with the reconnection strategy specified (defaults to `true`).\n\n    *Vladimir Dementyev*",
    "project": "actioncable",
    "date_merged": 1652730099000,
    "author": "Jeremy Daer",
    "sha": "df88a42e5fdfbb216242ee70c8b529034acf418d",
    "pr": "45072",
    "merge_sha": "712ecf774959588d435f035412a12d9f5f8a55df",
    "html": "<p><code>ActionCable.server.remote_connections.where(...).disconnect</code> now sends <code>disconnect</code> message<br />\nbefore closing the connection with the reconnection strategy specified (defaults to <code>true</code>).</p>\n\n<p><em>Vladimir Dementyev</em></p>\n"
  },
  {
    "message": "*   Added command callbacks to `ActionCable::Connection::Base`.\n\n    Now you can define `before_command`, `after_command`, and `around_command` to be invoked before, after or around any command received by a client respectively.\n\n    *Vladimir Dementyev*",
    "project": "actioncable",
    "date_merged": 1672088620000,
    "author": "Akira Matsuda",
    "sha": "4732c91d14c12aa36452fa2bddfc9a4e9d0121b0",
    "pr": "46829",
    "merge_sha": "85bc6ca9d2c0768796bbd6e496b2b3206853127f",
    "html": "<p>Added command callbacks to <code>ActionCable::Connection::Base</code>.</p>\n\n<p>Now you can define <code>before_command</code>, <code>after_command</code>, and <code>around_command</code> to be invoked before, after or around any command received by a client respectively.</p>\n\n<p><em>Vladimir Dementyev</em></p>\n"
  }
]